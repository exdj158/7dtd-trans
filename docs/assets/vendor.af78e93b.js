var Ji=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function oi(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Qf=function(e){return e&&e.Math==Math&&e},De=Qf(typeof globalThis=="object"&&globalThis)||Qf(typeof window=="object"&&window)||Qf(typeof self=="object"&&self)||Qf(typeof Ji=="object"&&Ji)||function(){return this}()||Function("return this")(),Gn={},it=function(e){try{return!!e()}catch{return!0}},tV=it,cr=!tV(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),rV=it,rf=!rV(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),nV=rf,Zf=Function.prototype.call,mr=nV?Zf.bind(Zf):function(){return Zf.apply(Zf,arguments)},nf={},zD={}.propertyIsEnumerable,YD=Object.getOwnPropertyDescriptor,oV=YD&&!zD.call({1:2},1);nf.f=oV?function(t){var r=YD(this,t);return!!r&&r.enumerable}:zD;var of=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},GD=rf,KD=Function.prototype,iV=KD.bind,Ay=KD.call,aV=GD&&iV.bind(Ay,Ay),Ke=GD?function(e){return e&&aV(e)}:function(e){return e&&function(){return Ay.apply(e,arguments)}},XD=Ke,sV=XD({}.toString),lV=XD("".slice),Ei=function(e){return lV(sV(e),8,-1)},uV=De,fV=Ke,cV=it,hV=Ei,cp=uV.Object,dV=fV("".split),af=cV(function(){return!cp("z").propertyIsEnumerable(0)})?function(e){return hV(e)=="String"?dV(e,""):cp(e)}:cp,vV=De,pV=vV.TypeError,Hr=function(e){if(e==null)throw pV("Can't call method on "+e);return e},gV=af,yV=Hr,Xr=function(e){return gV(yV(e))},Bt=function(e){return typeof e=="function"},mV=Bt,qt=function(e){return typeof e=="object"?e!==null:mV(e)},hp=De,bV=Bt,wV=function(e){return bV(e)?e:void 0},Ti=function(e,t){return arguments.length<2?wV(hp[e]):hp[e]&&hp[e][t]},_V=Ke,ki=_V({}.isPrototypeOf),SV=Ti,Fa=SV("navigator","userAgent")||"",qD=De,dp=Fa,zE=qD.process,YE=qD.Deno,GE=zE&&zE.versions||YE&&YE.version,KE=GE&&GE.v8,yn,Mh;KE&&(yn=KE.split("."),Mh=yn[0]>0&&yn[0]<4?1:+(yn[0]+yn[1]));!Mh&&dp&&(yn=dp.match(/Edge\/(\d+)/),(!yn||yn[1]>=74)&&(yn=dp.match(/Chrome\/(\d+)/),yn&&(Mh=+yn[1])));var sf=Mh,XE=sf,CV=it,tC=!!Object.getOwnPropertySymbols&&!CV(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&XE&&XE<41}),OV=tC,QD=OV&&!Symbol.sham&&typeof Symbol.iterator=="symbol",RV=De,EV=Ti,TV=Bt,kV=ki,AV=QD,IV=RV.Object,Gd=AV?function(e){return typeof e=="symbol"}:function(e){var t=EV("Symbol");return TV(t)&&kV(t.prototype,IV(e))},PV=De,MV=PV.String,Kd=function(e){try{return MV(e)}catch{return"Object"}},$V=De,DV=Bt,xV=Kd,NV=$V.TypeError,bl=function(e){if(DV(e))return e;throw NV(xV(e)+" is not a function")},HV=bl,ja=function(e,t){var r=e[t];return r==null?void 0:HV(r)},LV=De,vp=mr,pp=Bt,gp=qt,FV=LV.TypeError,jV=function(e,t){var r,n;if(t==="string"&&pp(r=e.toString)&&!gp(n=vp(r,e))||pp(r=e.valueOf)&&!gp(n=vp(r,e))||t!=="string"&&pp(r=e.toString)&&!gp(n=vp(r,e)))return n;throw FV("Can't convert object to primitive value")},lf={exports:{}},qE=De,BV=Object.defineProperty,rC=function(e,t){try{BV(qE,e,{value:t,configurable:!0,writable:!0})}catch{qE[e]=t}return t},VV=De,WV=rC,QE="__core-js_shared__",UV=VV[QE]||WV(QE,{}),nC=UV,ZE=nC;(lf.exports=function(e,t){return ZE[e]||(ZE[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.21.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"});var zV=De,YV=Hr,GV=zV.Object,Lr=function(e){return GV(YV(e))},KV=Ke,XV=Lr,qV=KV({}.hasOwnProperty),hr=Object.hasOwn||function(t,r){return qV(XV(t),r)},QV=Ke,ZV=0,JV=Math.random(),eW=QV(1 .toString),Xd=function(e){return"Symbol("+(e===void 0?"":e)+")_"+eW(++ZV+JV,36)},tW=De,rW=lf.exports,JE=hr,nW=Xd,eT=tC,ZD=QD,Ja=rW("wks"),Ra=tW.Symbol,tT=Ra&&Ra.for,oW=ZD?Ra:Ra&&Ra.withoutSetter||nW,Nt=function(e){if(!JE(Ja,e)||!(eT||typeof Ja[e]=="string")){var t="Symbol."+e;eT&&JE(Ra,e)?Ja[e]=Ra[e]:ZD&&tT?Ja[e]=tT(t):Ja[e]=oW(t)}return Ja[e]},iW=De,aW=mr,rT=qt,nT=Gd,sW=ja,lW=jV,uW=Nt,fW=iW.TypeError,cW=uW("toPrimitive"),JD=function(e,t){if(!rT(e)||nT(e))return e;var r=sW(e,cW),n;if(r){if(t===void 0&&(t="default"),n=aW(r,e,t),!rT(n)||nT(n))return n;throw fW("Can't convert object to primitive value")}return t===void 0&&(t="number"),lW(e,t)},hW=JD,dW=Gd,qd=function(e){var t=hW(e,"string");return dW(t)?t:t+""},vW=De,oT=qt,Iy=vW.document,pW=oT(Iy)&&oT(Iy.createElement),Qd=function(e){return pW?Iy.createElement(e):{}},gW=cr,yW=it,mW=Qd,ex=!gW&&!yW(function(){return Object.defineProperty(mW("div"),"a",{get:function(){return 7}}).a!=7}),bW=cr,wW=mr,_W=nf,SW=of,CW=Xr,OW=qd,RW=hr,EW=ex,iT=Object.getOwnPropertyDescriptor;Gn.f=bW?iT:function(t,r){if(t=CW(t),r=OW(r),EW)try{return iT(t,r)}catch{}if(RW(t,r))return SW(!wW(_W.f,t,r),t[r])};var br={},TW=cr,kW=it,tx=TW&&kW(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),rx=De,AW=qt,IW=rx.String,PW=rx.TypeError,Qt=function(e){if(AW(e))return e;throw PW(IW(e)+" is not an object")},MW=De,$W=cr,DW=ex,xW=tx,Jf=Qt,aT=qd,NW=MW.TypeError,yp=Object.defineProperty,HW=Object.getOwnPropertyDescriptor,mp="enumerable",bp="configurable",wp="writable";br.f=$W?xW?function(t,r,n){if(Jf(t),r=aT(r),Jf(n),typeof t=="function"&&r==="prototype"&&"value"in n&&wp in n&&!n[wp]){var o=HW(t,r);o&&o[wp]&&(t[r]=n.value,n={configurable:bp in n?n[bp]:o[bp],enumerable:mp in n?n[mp]:o[mp],writable:!1})}return yp(t,r,n)}:yp:function(t,r,n){if(Jf(t),r=aT(r),Jf(n),DW)try{return yp(t,r,n)}catch{}if("get"in n||"set"in n)throw NW("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var LW=cr,FW=br,jW=of,Ai=LW?function(e,t,r){return FW.f(e,t,jW(1,r))}:function(e,t,r){return e[t]=r,e},ln={exports:{}},BW=Ke,VW=Bt,Py=nC,WW=BW(Function.toString);VW(Py.inspectSource)||(Py.inspectSource=function(e){return WW(e)});var oC=Py.inspectSource,UW=De,zW=Bt,YW=oC,sT=UW.WeakMap,nx=zW(sT)&&/native code/.test(YW(sT)),GW=lf.exports,KW=Xd,lT=GW("keys"),Zd=function(e){return lT[e]||(lT[e]=KW(e))},uf={},XW=nx,ox=De,_p=Ke,qW=qt,QW=Ai,Sp=hr,Cp=nC,ZW=Zd,JW=uf,uT="Object already initialized",My=ox.TypeError,e2=ox.WeakMap,$h,Du,Dh,t2=function(e){return Dh(e)?Du(e):$h(e,{})},r2=function(e){return function(t){var r;if(!qW(t)||(r=Du(t)).type!==e)throw My("Incompatible receiver, "+e+" required");return r}};if(XW||Cp.state){var Ni=Cp.state||(Cp.state=new e2),n2=_p(Ni.get),fT=_p(Ni.has),o2=_p(Ni.set);$h=function(e,t){if(fT(Ni,e))throw new My(uT);return t.facade=e,o2(Ni,e,t),t},Du=function(e){return n2(Ni,e)||{}},Dh=function(e){return fT(Ni,e)}}else{var es=ZW("state");JW[es]=!0,$h=function(e,t){if(Sp(e,es))throw new My(uT);return t.facade=e,QW(e,es,t),t},Du=function(e){return Sp(e,es)?e[es]:{}},Dh=function(e){return Sp(e,es)}}var jo={set:$h,get:Du,has:Dh,enforce:t2,getterFor:r2},$y=cr,i2=hr,ix=Function.prototype,a2=$y&&Object.getOwnPropertyDescriptor,iC=i2(ix,"name"),s2=iC&&function(){}.name==="something",l2=iC&&(!$y||$y&&a2(ix,"name").configurable),ff={EXISTS:iC,PROPER:s2,CONFIGURABLE:l2},u2=De,cT=Bt,f2=hr,hT=Ai,c2=rC,h2=oC,ax=jo,d2=ff.CONFIGURABLE,v2=ax.get,p2=ax.enforce,g2=String(String).split("String");(ln.exports=function(e,t,r,n){var o=n?!!n.unsafe:!1,i=n?!!n.enumerable:!1,a=n?!!n.noTargetGet:!1,s=n&&n.name!==void 0?n.name:t,l;if(cT(r)&&(String(s).slice(0,7)==="Symbol("&&(s="["+String(s).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!f2(r,"name")||d2&&r.name!==s)&&hT(r,"name",s),l=p2(r),l.source||(l.source=g2.join(typeof s=="string"?s:""))),e===u2){i?e[t]=r:c2(t,r);return}else o?!a&&e[t]&&(i=!0):delete e[t];i?e[t]=r:hT(e,t,r)})(Function.prototype,"toString",function(){return cT(this)&&v2(this).source||h2(this)});var Ba={},y2=Math.ceil,m2=Math.floor,Ii=function(e){var t=+e;return t!==t||t===0?0:(t>0?m2:y2)(t)},b2=Ii,w2=Math.max,_2=Math.min,cf=function(e,t){var r=b2(e);return r<0?w2(r+t,0):_2(r,t)},S2=Ii,C2=Math.min,Va=function(e){return e>0?C2(S2(e),9007199254740991):0},O2=Va,un=function(e){return O2(e.length)},R2=Xr,E2=cf,T2=un,dT=function(e){return function(t,r,n){var o=R2(t),i=T2(o),a=E2(n,i),s;if(e&&r!=r){for(;i>a;)if(s=o[a++],s!=s)return!0}else for(;i>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},aC={includes:dT(!0),indexOf:dT(!1)},k2=Ke,Op=hr,A2=Xr,I2=aC.indexOf,P2=uf,vT=k2([].push),sx=function(e,t){var r=A2(e),n=0,o=[],i;for(i in r)!Op(P2,i)&&Op(r,i)&&vT(o,i);for(;t.length>n;)Op(r,i=t[n++])&&(~I2(o,i)||vT(o,i));return o},sC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],M2=sx,$2=sC,D2=$2.concat("length","prototype");Ba.f=Object.getOwnPropertyNames||function(t){return M2(t,D2)};var Jd={};Jd.f=Object.getOwnPropertySymbols;var x2=Ti,N2=Ke,H2=Ba,L2=Jd,F2=Qt,j2=N2([].concat),lx=x2("Reflect","ownKeys")||function(t){var r=H2.f(F2(t)),n=L2.f;return n?j2(r,n(t)):r},pT=hr,B2=lx,V2=Gn,W2=br,ux=function(e,t,r){for(var n=B2(t),o=W2.f,i=V2.f,a=0;a<n.length;a++){var s=n[a];!pT(e,s)&&!(r&&pT(r,s))&&o(e,s,i(t,s))}},U2=it,z2=Bt,Y2=/#|\.prototype\./,hf=function(e,t){var r=K2[G2(e)];return r==q2?!0:r==X2?!1:z2(t)?U2(t):!!t},G2=hf.normalize=function(e){return String(e).replace(Y2,".").toLowerCase()},K2=hf.data={},X2=hf.NATIVE="N",q2=hf.POLYFILL="P",ev=hf,Rp=De,Q2=Gn.f,Z2=Ai,J2=ln.exports,eU=rC,tU=ux,rU=ev,qe=function(e,t){var r=e.target,n=e.global,o=e.stat,i,a,s,l,u,f;if(n?a=Rp:o?a=Rp[r]||eU(r,{}):a=(Rp[r]||{}).prototype,a)for(s in t){if(u=t[s],e.noTargetGet?(f=Q2(a,s),l=f&&f.value):l=a[s],i=rU(n?s:r+(o?".":"#")+s,e.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;tU(u,l)}(e.sham||l&&l.sham)&&Z2(u,"sham",!0),J2(a,s,u,e)}},tv={},nU=qd,oU=br,iU=of,wl=function(e,t,r){var n=nU(t);n in e?oU.f(e,n,iU(0,r)):e[n]=r},aU=De,gT=cf,sU=un,lU=wl,uU=aU.Array,fU=Math.max,lC=function(e,t,r){for(var n=sU(e),o=gT(t,n),i=gT(r===void 0?n:r,n),a=uU(fU(i-o,0)),s=0;o<i;o++,s++)lU(a,s,e[o]);return a.length=s,a},cU=Ei,hU=Xr,fx=Ba.f,dU=lC,cx=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],vU=function(e){try{return fx(e)}catch{return dU(cx)}};tv.f=function(t){return cx&&cU(t)=="Window"?vU(t):fx(hU(t))};var pU=qe,gU=it,yU=tv.f,mU=gU(function(){return!Object.getOwnPropertyNames(1)});pU({target:"Object",stat:!0,forced:mU},{getOwnPropertyNames:yU});var bU=Nt,wU=bU("toStringTag"),hx={};hx[wU]="z";var uC=String(hx)==="[object z]",_U=De,SU=uC,CU=Bt,Xc=Ei,OU=Nt,RU=OU("toStringTag"),EU=_U.Object,TU=Xc(function(){return arguments}())=="Arguments",kU=function(e,t){try{return e[t]}catch{}},rv=SU?Xc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=kU(t=EU(e),RU))=="string"?r:TU?Xc(t):(n=Xc(t))=="Object"&&CU(t.callee)?"Arguments":n},AU=De,IU=rv,PU=AU.String,dr=function(e){if(IU(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return PU(e)},yT=lC,MU=Math.floor,Dy=function(e,t){var r=e.length,n=MU(r/2);return r<8?$U(e,t):DU(e,Dy(yT(e,0,n),t),Dy(yT(e,n),t),t)},$U=function(e,t){for(var r=e.length,n=1,o,i;n<r;){for(i=n,o=e[n];i&&t(e[i-1],o)>0;)e[i]=e[--i];i!==n++&&(e[i]=o)}return e},DU=function(e,t,r,n){for(var o=t.length,i=r.length,a=0,s=0;a<o||s<i;)e[a+s]=a<o&&s<i?n(t[a],r[s])<=0?t[a++]:r[s++]:a<o?t[a++]:r[s++];return e},xU=Dy,NU=it,_l=function(e,t){var r=[][e];return!!r&&NU(function(){r.call(null,t||function(){return 1},1)})},HU=Fa,mT=HU.match(/firefox\/(\d+)/i),LU=!!mT&&+mT[1],FU=Fa,jU=/MSIE|Trident/.test(FU),BU=Fa,bT=BU.match(/AppleWebKit\/(\d+)\./),VU=!!bT&&+bT[1],WU=qe,dx=Ke,UU=bl,zU=Lr,YU=un,wT=dr,fC=it,GU=xU,KU=_l,_T=LU,XU=jU,ST=sf,CT=VU,ii=[],OT=dx(ii.sort),qU=dx(ii.push),QU=fC(function(){ii.sort(void 0)}),ZU=fC(function(){ii.sort(null)}),JU=KU("sort"),vx=!fC(function(){if(ST)return ST<70;if(!(_T&&_T>3)){if(XU)return!0;if(CT)return CT<603;var e="",t,r,n,o;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)ii.push({k:r+o,v:n})}for(ii.sort(function(i,a){return a.v-i.v}),o=0;o<ii.length;o++)r=ii[o].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),ez=QU||!ZU||!JU||!vx,tz=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:wT(t)>wT(r)?1:-1}};WU({target:"Array",proto:!0,forced:ez},{sort:function(t){t!==void 0&&UU(t);var r=zU(this);if(vx)return t===void 0?OT(r):OT(r,t);var n=[],o=YU(r),i,a;for(a=0;a<o;a++)a in r&&qU(n,r[a]);for(GU(n,tz(t)),i=n.length,a=0;a<i;)r[a]=n[a++];for(;a<o;)delete r[a++];return r}});var rz=Ei,df=Array.isArray||function(t){return rz(t)=="Array"},nz=Ke,oz=it,px=Bt,iz=rv,az=Ti,sz=oC,gx=function(){},lz=[],yx=az("Reflect","construct"),cC=/^\s*(?:class|function)\b/,uz=nz(cC.exec),fz=!cC.exec(gx),Hl=function(t){if(!px(t))return!1;try{return yx(gx,lz,t),!0}catch{return!1}},mx=function(t){if(!px(t))return!1;switch(iz(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return fz||!!uz(cC,sz(t))}catch{return!0}};mx.sham=!0;var nv=!yx||oz(function(){var e;return Hl(Hl.call)||!Hl(Object)||!Hl(function(){e=!0})||e})?mx:Hl,cz=De,RT=df,hz=nv,dz=qt,vz=Nt,pz=vz("species"),ET=cz.Array,gz=function(e){var t;return RT(e)&&(t=e.constructor,hz(t)&&(t===ET||RT(t.prototype))?t=void 0:dz(t)&&(t=t[pz],t===null&&(t=void 0))),t===void 0?ET:t},yz=gz,hC=function(e,t){return new(yz(e))(t===0?0:t)},mz=it,bz=Nt,wz=sf,_z=bz("species"),vf=function(e){return wz>=51||!mz(function(){var t=[],r=t.constructor={};return r[_z]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Sz=qe,Cz=De,Oz=cf,Rz=Ii,Ez=un,Tz=Lr,kz=hC,Az=wl,Iz=vf,Pz=Iz("splice"),Mz=Cz.TypeError,$z=Math.max,Dz=Math.min,xz=9007199254740991,Nz="Maximum allowed length exceeded";Sz({target:"Array",proto:!0,forced:!Pz},{splice:function(t,r){var n=Tz(this),o=Ez(n),i=Oz(t,o),a=arguments.length,s,l,u,f,c,h;if(a===0?s=l=0:a===1?(s=0,l=o-i):(s=a-2,l=Dz($z(Rz(r),0),o-i)),o+s-l>xz)throw Mz(Nz);for(u=kz(n,l),f=0;f<l;f++)c=i+f,c in n&&Az(u,f,n[c]);if(u.length=l,s<l){for(f=i;f<o-l;f++)c=f+l,h=f+s,c in n?n[h]=n[c]:delete n[h];for(f=o;f>o-l+s;f--)delete n[f-1]}else if(s>l)for(f=o-l;f>i;f--)c=f+l-1,h=f+s-1,c in n?n[h]=n[c]:delete n[h];for(f=0;f<s;f++)n[f+i]=arguments[f+2];return n.length=o-l+s,u}});var Hz=qt,Lz=Math.floor,Fz=Number.isInteger||function(t){return!Hz(t)&&isFinite(t)&&Lz(t)===t},jz=qe,Bz=Fz;jz({target:"Number",stat:!0},{isInteger:Bz});var bx=De,Vz=Bt,Wz=bx.String,Uz=bx.TypeError,zz=function(e){if(typeof e=="object"||Vz(e))return e;throw Uz("Can't set "+Wz(e)+" as a prototype")},Yz=Ke,Gz=Qt,Kz=zz,dC=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=Yz(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(o,i){return Gz(o),Kz(i),e?r(o,i):o.__proto__=i,o}}():void 0),Xz=Bt,qz=qt,TT=dC,vC=function(e,t,r){var n,o;return TT&&Xz(n=t.constructor)&&n!==r&&qz(o=n.prototype)&&o!==r.prototype&&TT(e,o),e},Qz=Ke,wx=Qz(1 .valueOf),_x=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,Zz=Ke,Jz=Hr,eY=dr,tY=_x,kT=Zz("".replace),xh="["+tY+"]",rY=RegExp("^"+xh+xh+"*"),nY=RegExp(xh+xh+"*$"),Ep=function(e){return function(t){var r=eY(Jz(t));return e&1&&(r=kT(r,rY,"")),e&2&&(r=kT(r,nY,"")),r}},Sx={start:Ep(1),end:Ep(2),trim:Ep(3)},oY=cr,pC=De,Cx=Ke,iY=ev,aY=ln.exports,AT=hr,sY=vC,lY=ki,uY=Gd,Ox=JD,fY=it,cY=Ba.f,hY=Gn.f,dY=br.f,vY=wx,pY=Sx.trim,xy="Number",Qo=pC[xy],Tp=Qo.prototype,gY=pC.TypeError,yY=Cx("".slice),ec=Cx("".charCodeAt),mY=function(e){var t=Ox(e,"number");return typeof t=="bigint"?t:bY(t)},bY=function(e){var t=Ox(e,"number"),r,n,o,i,a,s,l,u;if(uY(t))throw gY("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=pY(t),r=ec(t,0),r===43||r===45){if(n=ec(t,2),n===88||n===120)return NaN}else if(r===48){switch(ec(t,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+t}for(a=yY(t,2),s=a.length,l=0;l<s;l++)if(u=ec(a,l),u<48||u>i)return NaN;return parseInt(a,o)}}return+t};if(iY(xy,!Qo(" 0o1")||!Qo("0b1")||Qo("+0x1"))){for(var ts=function(t){var r=arguments.length<1?0:Qo(mY(t)),n=this;return lY(Tp,n)&&fY(function(){vY(n)})?sY(Object(r),n,ts):r},IT=oY?cY(Qo):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),kp=0,tc;IT.length>kp;kp++)AT(Qo,tc=IT[kp])&&!AT(ts,tc)&&dY(ts,tc,hY(Qo,tc));ts.prototype=Tp,Tp.constructor=ts,aY(pC,xy,ts)}var wY=Ke,pf=wY([].slice),_Y=qe,SY=De,PT=df,CY=nv,OY=qt,MT=cf,RY=un,EY=Xr,TY=wl,kY=Nt,AY=vf,IY=pf,PY=AY("slice"),MY=kY("species"),Ap=SY.Array,$Y=Math.max;_Y({target:"Array",proto:!0,forced:!PY},{slice:function(t,r){var n=EY(this),o=RY(n),i=MT(t,o),a=MT(r===void 0?o:r,o),s,l,u;if(PT(n)&&(s=n.constructor,CY(s)&&(s===Ap||PT(s.prototype))?s=void 0:OY(s)&&(s=s[MY],s===null&&(s=void 0)),s===Ap||s===void 0))return IY(n,i,a);for(l=new(s===void 0?Ap:s)($Y(a-i,0)),u=0;i<a;i++,u++)i in n&&TY(l,u,n[i]);return l.length=u,l}});var DY=qe,xY=De,NY=it,HY=df,LY=qt,FY=Lr,jY=un,$T=wl,BY=hC,VY=vf,WY=Nt,UY=sf,Rx=WY("isConcatSpreadable"),DT=9007199254740991,xT="Maximum allowed index exceeded",NT=xY.TypeError,zY=UY>=51||!NY(function(){var e=[];return e[Rx]=!1,e.concat()[0]!==e}),YY=VY("concat"),GY=function(e){if(!LY(e))return!1;var t=e[Rx];return t!==void 0?!!t:HY(e)},KY=!zY||!YY;DY({target:"Array",proto:!0,forced:KY},{concat:function(t){var r=FY(this),n=BY(r,0),o=0,i,a,s,l,u;for(i=-1,s=arguments.length;i<s;i++)if(u=i===-1?r:arguments[i],GY(u)){if(l=jY(u),o+l>DT)throw NT(xT);for(a=0;a<l;a++,o++)a in u&&$T(n,o,u[a])}else{if(o>=DT)throw NT(xT);$T(n,o++,u)}return n.length=o,n}});var XY=Lr,HT=cf,qY=un,QY=function(t){for(var r=XY(this),n=qY(r),o=arguments.length,i=HT(o>1?arguments[1]:void 0,n),a=o>2?arguments[2]:void 0,s=a===void 0?n:HT(a,n);s>i;)r[i++]=t;return r},gC={},ZY=sx,JY=sC,gf=Object.keys||function(t){return ZY(t,JY)},eG=cr,tG=tx,rG=br,nG=Qt,oG=Xr,iG=gf;gC.f=eG&&!tG?Object.defineProperties:function(t,r){nG(t);for(var n=oG(r),o=iG(r),i=o.length,a=0,s;i>a;)rG.f(t,s=o[a++],n[s]);return t};var aG=Ti,Ex=aG("document","documentElement"),sG=Qt,lG=gC,LT=sC,uG=uf,fG=Ex,cG=Qd,hG=Zd,FT=">",jT="<",Ny="prototype",Hy="script",Tx=hG("IE_PROTO"),Ip=function(){},kx=function(e){return jT+Hy+FT+e+jT+"/"+Hy+FT},BT=function(e){e.write(kx("")),e.close();var t=e.parentWindow.Object;return e=null,t},dG=function(){var e=cG("iframe"),t="java"+Hy+":",r;return e.style.display="none",fG.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(kx("document.F=Object")),r.close(),r.F},rc,qc=function(){try{rc=new ActiveXObject("htmlfile")}catch{}qc=typeof document!="undefined"?document.domain&&rc?BT(rc):dG():BT(rc);for(var e=LT.length;e--;)delete qc[Ny][LT[e]];return qc()};uG[Tx]=!0;var Sl=Object.create||function(t,r){var n;return t!==null?(Ip[Ny]=sG(t),n=new Ip,Ip[Ny]=null,n[Tx]=t):n=qc(),r===void 0?n:lG.f(n,r)},vG=Nt,pG=Sl,gG=br,Ly=vG("unscopables"),Fy=Array.prototype;Fy[Ly]==null&&gG.f(Fy,Ly,{configurable:!0,value:pG(null)});var yf=function(e){Fy[Ly][e]=!0},yG=qe,mG=QY,bG=yf;yG({target:"Array",proto:!0},{fill:mG});bG("fill");var VT=Ke,wG=bl,_G=rf,SG=VT(VT.bind),mf=function(e,t){return wG(e),t===void 0?e:_G?SG(e,t):function(){return e.apply(t,arguments)}},CG=mf,OG=Ke,RG=af,EG=Lr,TG=un,kG=hC,WT=OG([].push),Wo=function(e){var t=e==1,r=e==2,n=e==3,o=e==4,i=e==6,a=e==7,s=e==5||i;return function(l,u,f,c){for(var h=EG(l),d=RG(h),v=CG(u,f),p=TG(d),b=0,_=c||kG,S=t?_(l,p):r||a?_(l,0):void 0,E,M;p>b;b++)if((s||b in d)&&(E=d[b],M=v(E,b,h),e))if(t)S[b]=M;else if(M)switch(e){case 3:return!0;case 5:return E;case 6:return b;case 2:WT(S,E)}else switch(e){case 4:return!1;case 7:WT(S,E)}return i?-1:n||o?o:S}},Wa={forEach:Wo(0),map:Wo(1),filter:Wo(2),some:Wo(3),every:Wo(4),find:Wo(5),findIndex:Wo(6),filterReject:Wo(7)},AG=qe,IG=Wa.map,PG=vf,MG=PG("map");AG({target:"Array",proto:!0,forced:!MG},{map:function(t){return IG(this,t,arguments.length>1?arguments[1]:void 0)}});var $G=Qt,yC=function(){var e=$G(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},mC=it,DG=De,bC=DG.RegExp,wC=mC(function(){var e=bC("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),xG=wC||mC(function(){return!bC("a","y").sticky}),NG=wC||mC(function(){var e=bC("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),_C={BROKEN_CARET:NG,MISSED_STICKY:xG,UNSUPPORTED_Y:wC},HG=it,LG=De,FG=LG.RegExp,Ax=HG(function(){var e=FG(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),jG=it,BG=De,VG=BG.RegExp,Ix=jG(function(){var e=VG("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ks=mr,ov=Ke,WG=dr,UG=yC,zG=_C,YG=lf.exports,GG=Sl,KG=jo.get,XG=Ax,qG=Ix,QG=YG("native-string-replace",String.prototype.replace),Nh=RegExp.prototype.exec,jy=Nh,ZG=ov("".charAt),JG=ov("".indexOf),e3=ov("".replace),Pp=ov("".slice),By=function(){var e=/a/,t=/b*/g;return ks(Nh,e,"a"),ks(Nh,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Px=zG.BROKEN_CARET,Vy=/()??/.exec("")[1]!==void 0,t3=By||Vy||Px||XG||qG;t3&&(jy=function(t){var r=this,n=KG(r),o=WG(t),i=n.raw,a,s,l,u,f,c,h;if(i)return i.lastIndex=r.lastIndex,a=ks(jy,i,o),r.lastIndex=i.lastIndex,a;var d=n.groups,v=Px&&r.sticky,p=ks(UG,r),b=r.source,_=0,S=o;if(v&&(p=e3(p,"y",""),JG(p,"g")===-1&&(p+="g"),S=Pp(o,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&ZG(o,r.lastIndex-1)!==`
`)&&(b="(?: "+b+")",S=" "+S,_++),s=new RegExp("^(?:"+b+")",p)),Vy&&(s=new RegExp("^"+b+"$(?!\\s)",p)),By&&(l=r.lastIndex),u=ks(Nh,v?s:r,S),v?u?(u.input=Pp(u.input,_),u[0]=Pp(u[0],_),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:By&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),Vy&&u&&u.length>1&&ks(QG,u[0],s,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=GG(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var iv=jy,r3=qe,UT=iv;r3({target:"RegExp",proto:!0,forced:/./.exec!==UT},{exec:UT});var n3=rf,Mx=Function.prototype,zT=Mx.apply,YT=Mx.call,Ua=typeof Reflect=="object"&&Reflect.apply||(n3?YT.bind(zT):function(){return YT.apply(zT,arguments)}),GT=Ke,KT=ln.exports,o3=iv,XT=it,$x=Nt,i3=Ai,a3=$x("species"),Mp=RegExp.prototype,av=function(e,t,r,n){var o=$x(e),i=!XT(function(){var u={};return u[o]=function(){return 7},""[e](u)!=7}),a=i&&!XT(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[a3]=function(){return f},f.flags="",f[o]=/./[o]),f.exec=function(){return u=!0,null},f[o](""),!u});if(!i||!a||r){var s=GT(/./[o]),l=t(o,""[e],function(u,f,c,h,d){var v=GT(u),p=f.exec;return p===o3||p===Mp.exec?i&&!d?{done:!0,value:s(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});KT(String.prototype,e,l[0]),KT(Mp,o,l[1])}n&&i3(Mp[o],"sham",!0)},SC=Ke,s3=Ii,l3=dr,u3=Hr,f3=SC("".charAt),qT=SC("".charCodeAt),c3=SC("".slice),QT=function(e){return function(t,r){var n=l3(u3(t)),o=s3(r),i=n.length,a,s;return o<0||o>=i?e?"":void 0:(a=qT(n,o),a<55296||a>56319||o+1===i||(s=qT(n,o+1))<56320||s>57343?e?f3(n,o):a:e?c3(n,o,o+2):(a-55296<<10)+(s-56320)+65536)}},CC={codeAt:QT(!1),charAt:QT(!0)},h3=CC.charAt,OC=function(e,t,r){return t+(r?h3(e,t).length:1)},RC=Ke,d3=Lr,v3=Math.floor,$p=RC("".charAt),p3=RC("".replace),Dp=RC("".slice),g3=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,y3=/\$([$&'`]|\d{1,2})/g,m3=function(e,t,r,n,o,i){var a=r+e.length,s=n.length,l=y3;return o!==void 0&&(o=d3(o),l=g3),p3(i,l,function(u,f){var c;switch($p(f,0)){case"$":return"$";case"&":return e;case"`":return Dp(t,0,r);case"'":return Dp(t,a);case"<":c=o[Dp(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>s){var d=v3(h/10);return d===0?u:d<=s?n[d-1]===void 0?$p(f,1):n[d-1]+$p(f,1):u}c=n[h-1]}return c===void 0?"":c})},b3=De,ZT=mr,w3=Qt,_3=Bt,S3=Ei,C3=iv,O3=b3.TypeError,sv=function(e,t){var r=e.exec;if(_3(r)){var n=ZT(r,e,t);return n!==null&&w3(n),n}if(S3(e)==="RegExp")return ZT(C3,e,t);throw O3("RegExp#exec called on incompatible receiver")},R3=Ua,JT=mr,lv=Ke,E3=av,T3=it,k3=Qt,A3=Bt,I3=Ii,P3=Va,rs=dr,M3=Hr,$3=OC,D3=ja,x3=m3,N3=sv,H3=Nt,Wy=H3("replace"),L3=Math.max,F3=Math.min,j3=lv([].concat),xp=lv([].push),e0=lv("".indexOf),t0=lv("".slice),B3=function(e){return e===void 0?e:String(e)},V3=function(){return"a".replace(/./,"$0")==="$0"}(),r0=function(){return/./[Wy]?/./[Wy]("a","$0")==="":!1}(),W3=!T3(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});E3("replace",function(e,t,r){var n=r0?"$":"$0";return[function(i,a){var s=M3(this),l=i==null?void 0:D3(i,Wy);return l?JT(l,i,s,a):JT(t,rs(s),i,a)},function(o,i){var a=k3(this),s=rs(o);if(typeof i=="string"&&e0(i,n)===-1&&e0(i,"$<")===-1){var l=r(t,a,s,i);if(l.done)return l.value}var u=A3(i);u||(i=rs(i));var f=a.global;if(f){var c=a.unicode;a.lastIndex=0}for(var h=[];;){var d=N3(a,s);if(d===null||(xp(h,d),!f))break;var v=rs(d[0]);v===""&&(a.lastIndex=$3(s,P3(a.lastIndex),c))}for(var p="",b=0,_=0;_<h.length;_++){d=h[_];for(var S=rs(d[0]),E=L3(F3(I3(d.index),s.length),0),M=[],k=1;k<d.length;k++)xp(M,B3(d[k]));var U=d.groups;if(u){var Y=j3([S],M,E,s);U!==void 0&&xp(Y,U);var ne=rs(R3(i,void 0,Y))}else ne=x3(S,s,E,M,U,i);E>=b&&(p+=t0(s,b,E)+ne,b=E+S.length)}return p+t0(s,b)}]},!W3||!V3||r0);var U3=mr,n0=Qt,z3=ja,Dx=function(e,t,r){var n,o;n0(e);try{if(n=z3(e,"return"),!n){if(t==="throw")throw r;return r}n=U3(n,e)}catch(i){o=!0,n=i}if(t==="throw")throw r;if(o)throw n;return n0(n),r},Y3=Qt,G3=Dx,K3=function(e,t,r,n){try{return n?t(Y3(r)[0],r[1]):t(r)}catch(o){G3(e,"throw",o)}},bf={},X3=Nt,q3=bf,Q3=X3("iterator"),Z3=Array.prototype,xx=function(e){return e!==void 0&&(q3.Array===e||Z3[Q3]===e)},J3=rv,o0=ja,eK=bf,tK=Nt,rK=tK("iterator"),EC=function(e){if(e!=null)return o0(e,rK)||o0(e,"@@iterator")||eK[J3(e)]},nK=De,oK=mr,iK=bl,aK=Qt,sK=Kd,lK=EC,uK=nK.TypeError,Nx=function(e,t){var r=arguments.length<2?lK(e):t;if(iK(r))return aK(oK(r,e));throw uK(sK(e)+" is not iterable")},fK=De,cK=mf,hK=mr,dK=Lr,vK=K3,pK=xx,gK=nv,yK=un,i0=wl,mK=Nx,bK=EC,a0=fK.Array,wK=function(t){var r=dK(t),n=gK(this),o=arguments.length,i=o>1?arguments[1]:void 0,a=i!==void 0;a&&(i=cK(i,o>2?arguments[2]:void 0));var s=bK(r),l=0,u,f,c,h,d,v;if(s&&!(this==a0&&pK(s)))for(h=mK(r,s),d=h.next,f=n?new this:[];!(c=hK(d,h)).done;l++)v=a?vK(h,i,[c.value,l],!0):c.value,i0(f,l,v);else for(u=yK(r),f=n?new this(u):a0(u);u>l;l++)v=a?i(r[l],l):r[l],i0(f,l,v);return f.length=l,f},_K=Nt,Hx=_K("iterator"),Lx=!1;try{var SK=0,s0={next:function(){return{done:!!SK++}},return:function(){Lx=!0}};s0[Hx]=function(){return this},Array.from(s0,function(){throw 2})}catch{}var Fx=function(e,t){if(!t&&!Lx)return!1;var r=!1;try{var n={};n[Hx]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},CK=qe,OK=wK,RK=Fx,EK=!RK(function(e){Array.from(e)});CK({target:"Array",stat:!0,forced:EK},{from:OK});var TK=it,jx=!TK(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),kK=De,AK=hr,IK=Bt,PK=Lr,MK=Zd,$K=jx,l0=MK("IE_PROTO"),Uy=kK.Object,DK=Uy.prototype,uv=$K?Uy.getPrototypeOf:function(e){var t=PK(e);if(AK(t,l0))return t[l0];var r=t.constructor;return IK(r)&&t instanceof r?r.prototype:t instanceof Uy?DK:null},xK=it,NK=Bt,u0=uv,HK=ln.exports,LK=Nt,zy=LK("iterator"),Bx=!1,Aa,Np,Hp;[].keys&&(Hp=[].keys(),"next"in Hp?(Np=u0(u0(Hp)),Np!==Object.prototype&&(Aa=Np)):Bx=!0);var FK=Aa==null||xK(function(){var e={};return Aa[zy].call(e)!==e});FK&&(Aa={});NK(Aa[zy])||HK(Aa,zy,function(){return this});var Vx={IteratorPrototype:Aa,BUGGY_SAFARI_ITERATORS:Bx},jK=br.f,BK=hr,VK=Nt,f0=VK("toStringTag"),fv=function(e,t,r){e&&!r&&(e=e.prototype),e&&!BK(e,f0)&&jK(e,f0,{configurable:!0,value:t})},WK=Vx.IteratorPrototype,UK=Sl,zK=of,YK=fv,GK=bf,KK=function(){return this},XK=function(e,t,r,n){var o=t+" Iterator";return e.prototype=UK(WK,{next:zK(+!n,r)}),YK(e,o,!1),GK[o]=KK,e},qK=qe,QK=mr,Wx=ff,ZK=Bt,JK=XK,c0=uv,h0=dC,e4=fv,t4=Ai,Lp=ln.exports,r4=Nt,n4=bf,Ux=Vx,o4=Wx.PROPER,i4=Wx.CONFIGURABLE,d0=Ux.IteratorPrototype,nc=Ux.BUGGY_SAFARI_ITERATORS,Ll=r4("iterator"),v0="keys",Fl="values",p0="entries",a4=function(){return this},TC=function(e,t,r,n,o,i,a){JK(r,t,n);var s=function(_){if(_===o&&h)return h;if(!nc&&_ in f)return f[_];switch(_){case v0:return function(){return new r(this,_)};case Fl:return function(){return new r(this,_)};case p0:return function(){return new r(this,_)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,f=e.prototype,c=f[Ll]||f["@@iterator"]||o&&f[o],h=!nc&&c||s(o),d=t=="Array"&&f.entries||c,v,p,b;if(d&&(v=c0(d.call(new e)),v!==Object.prototype&&v.next&&(c0(v)!==d0&&(h0?h0(v,d0):ZK(v[Ll])||Lp(v,Ll,a4)),e4(v,l,!0))),o4&&o==Fl&&c&&c.name!==Fl&&(i4?t4(f,"name",Fl):(u=!0,h=function(){return QK(c,this)})),o)if(p={values:s(Fl),keys:i?h:s(v0),entries:s(p0)},a)for(b in p)(nc||u||!(b in f))&&Lp(f,b,p[b]);else qK({target:t,proto:!0,forced:nc||u},p);return f[Ll]!==h&&Lp(f,Ll,h,{name:o}),n4[t]=h,p},s4=CC.charAt,l4=dr,zx=jo,u4=TC,Yx="String Iterator",f4=zx.set,c4=zx.getterFor(Yx);u4(String,"String",function(e){f4(this,{type:Yx,string:l4(e),index:0})},function(){var t=c4(this),r=t.string,n=t.index,o;return n>=r.length?{value:void 0,done:!0}:(o=s4(r,n),t.index+=o.length,{value:o,done:!1})});var h4=qe,d4=Ke,v4=aC.indexOf,p4=_l,Yy=d4([].indexOf),g0=!!Yy&&1/Yy([1],1,-0)<0,g4=p4("indexOf");h4({target:"Array",proto:!0,forced:g0||!g4},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return g0?Yy(this,t,r)||0:v4(this,t,r)}});var y4=qe,m4=Ke,b4=df,w4=m4([].reverse),y0=[1,2];y4({target:"Array",proto:!0,forced:String(y0)===String(y0.reverse())},{reverse:function(){return b4(this)&&(this.length=this.length),w4(this)}});var _4=uC,S4=rv,C4=_4?{}.toString:function(){return"[object "+S4(this)+"]"},O4=uC,R4=ln.exports,E4=C4;O4||R4(Object.prototype,"toString",E4,{unsafe:!0});var Gx={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},T4=Qd,Fp=T4("span").classList,m0=Fp&&Fp.constructor&&Fp.constructor.prototype,Kx=m0===Object.prototype?void 0:m0,k4=Wa.forEach,A4=_l,I4=A4("forEach"),P4=I4?[].forEach:function(t){return k4(this,t,arguments.length>1?arguments[1]:void 0)},b0=De,w0=Gx,M4=Kx,jp=P4,$4=Ai,Xx=function(e){if(e&&e.forEach!==jp)try{$4(e,"forEach",jp)}catch{e.forEach=jp}};for(var Bp in w0)w0[Bp]&&Xx(b0[Bp]&&b0[Bp].prototype);Xx(M4);var D4=De,x4=D4.TypeError,qx=function(e,t){if(e<t)throw x4("Not enough arguments");return e},N4=qe,Gy=De,H4=Ua,L4=Bt,F4=Fa,j4=pf,B4=qx,V4=/MSIE .\./.test(F4),W4=Gy.Function,_0=function(e){return function(t,r){var n=B4(arguments.length,1)>2,o=L4(t)?t:W4(t),i=n?j4(arguments,2):void 0;return e(n?function(){H4(o,this,i)}:o,r)}};N4({global:!0,bind:!0,forced:V4},{setTimeout:_0(Gy.setTimeout),setInterval:_0(Gy.setInterval)});var U4=Fa,z4=/(?:ipad|iphone|ipod).*applewebkit/i.test(U4),Y4=Ei,G4=De,Qx=Y4(G4.process)=="process",Yr=De,K4=Ua,X4=mf,S0=Bt,q4=hr,Q4=it,C0=Ex,Z4=pf,O0=Qd,J4=qx,e6=z4,t6=Qx,Ky=Yr.setImmediate,Xy=Yr.clearImmediate,r6=Yr.process,Vp=Yr.Dispatch,n6=Yr.Function,R0=Yr.MessageChannel,o6=Yr.String,Wp=0,yu={},E0="onreadystatechange",xu,Hi,Up,zp;try{xu=Yr.location}catch{}var kC=function(e){if(q4(yu,e)){var t=yu[e];delete yu[e],t()}},Yp=function(e){return function(){kC(e)}},T0=function(e){kC(e.data)},k0=function(e){Yr.postMessage(o6(e),xu.protocol+"//"+xu.host)};(!Ky||!Xy)&&(Ky=function(t){J4(arguments.length,1);var r=S0(t)?t:n6(t),n=Z4(arguments,1);return yu[++Wp]=function(){K4(r,void 0,n)},Hi(Wp),Wp},Xy=function(t){delete yu[t]},t6?Hi=function(e){r6.nextTick(Yp(e))}:Vp&&Vp.now?Hi=function(e){Vp.now(Yp(e))}:R0&&!e6?(Up=new R0,zp=Up.port2,Up.port1.onmessage=T0,Hi=X4(zp.postMessage,zp)):Yr.addEventListener&&S0(Yr.postMessage)&&!Yr.importScripts&&xu&&xu.protocol!=="file:"&&!Q4(k0)?(Hi=k0,Yr.addEventListener("message",T0,!1)):E0 in O0("script")?Hi=function(e){C0.appendChild(O0("script"))[E0]=function(){C0.removeChild(this),kC(e)}}:Hi=function(e){setTimeout(Yp(e),0)});var i6={set:Ky,clear:Xy},a6=qe,A0=De,I0=i6,s6=!A0.setImmediate||!A0.clearImmediate;a6({global:!0,bind:!0,enumerable:!0,forced:s6},{setImmediate:I0.set,clearImmediate:I0.clear});var AC={},l6=Nt;AC.f=l6;var u6=De,f6=u6,P0=f6,c6=hr,h6=AC,d6=br.f,Zx=function(e){var t=P0.Symbol||(P0.Symbol={});c6(t,e)||d6(t,e,{value:h6.f(e)})},Cl=qe,IC=De,v6=Ti,p6=Ua,wf=mr,g6=Ke,Gs=cr,Ia=tC,PC=it,nr=hr,y6=df,m6=Bt,b6=qt,w6=ki,qy=Gd,Qy=Qt,_6=Lr,cv=Xr,MC=qd,Jx=dr,Zy=of,Nu=Sl,eN=gf,S6=Ba,tN=tv,Jy=Jd,rN=Gn,nN=br,C6=gC,oN=nf,O6=pf,Qc=ln.exports,_f=lf.exports,R6=Zd,iN=uf,M0=Xd,aN=Nt,E6=AC,T6=Zx,k6=fv,sN=jo,hv=Wa.forEach,Nr=R6("hidden"),dv="Symbol",Hu="prototype",$0=aN("toPrimitive"),A6=sN.set,D0=sN.getterFor(dv),nn=Object[Hu],Do=IC.Symbol,ai=Do&&Do[Hu],lN=IC.TypeError,Gp=IC.QObject,jl=v6("JSON","stringify"),uN=rN.f,ri=nN.f,fN=tN.f,I6=oN.f,cN=g6([].push),No=_f("symbols"),Sf=_f("op-symbols"),Kp=_f("string-to-symbol-registry"),Xp=_f("symbol-to-string-registry"),P6=_f("wks"),em=!Gp||!Gp[Hu]||!Gp[Hu].findChild,tm=Gs&&PC(function(){return Nu(ri({},"a",{get:function(){return ri(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=uN(nn,t);n&&delete nn[t],ri(e,t,r),n&&e!==nn&&ri(nn,t,n)}:ri,qp=function(e,t){var r=No[e]=Nu(ai);return A6(r,{type:dv,tag:e,description:t}),Gs||(r.description=t),r},vv=function(t,r,n){t===nn&&vv(Sf,r,n),Qy(t);var o=MC(r);return Qy(n),nr(No,o)?(n.enumerable?(nr(t,Nr)&&t[Nr][o]&&(t[Nr][o]=!1),n=Nu(n,{enumerable:Zy(0,!1)})):(nr(t,Nr)||ri(t,Nr,Zy(1,{})),t[Nr][o]=!0),tm(t,o,n)):ri(t,o,n)},$C=function(t,r){Qy(t);var n=cv(r),o=eN(n).concat(DC(n));return hv(o,function(i){(!Gs||wf(rm,n,i))&&vv(t,i,n[i])}),t},M6=function(t,r){return r===void 0?Nu(t):$C(Nu(t),r)},rm=function(t){var r=MC(t),n=wf(I6,this,r);return this===nn&&nr(No,r)&&!nr(Sf,r)?!1:n||!nr(this,r)||!nr(No,r)||nr(this,Nr)&&this[Nr][r]?n:!0},hN=function(t,r){var n=cv(t),o=MC(r);if(!(n===nn&&nr(No,o)&&!nr(Sf,o))){var i=uN(n,o);return i&&nr(No,o)&&!(nr(n,Nr)&&n[Nr][o])&&(i.enumerable=!0),i}},dN=function(t){var r=fN(cv(t)),n=[];return hv(r,function(o){!nr(No,o)&&!nr(iN,o)&&cN(n,o)}),n},DC=function(t){var r=t===nn,n=fN(r?Sf:cv(t)),o=[];return hv(n,function(i){nr(No,i)&&(!r||nr(nn,i))&&cN(o,No[i])}),o};Ia||(Do=function(){if(w6(ai,this))throw lN("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:Jx(arguments[0]),r=M0(t),n=function(o){this===nn&&wf(n,Sf,o),nr(this,Nr)&&nr(this[Nr],r)&&(this[Nr][r]=!1),tm(this,r,Zy(1,o))};return Gs&&em&&tm(nn,r,{configurable:!0,set:n}),qp(r,t)},ai=Do[Hu],Qc(ai,"toString",function(){return D0(this).tag}),Qc(Do,"withoutSetter",function(e){return qp(M0(e),e)}),oN.f=rm,nN.f=vv,C6.f=$C,rN.f=hN,S6.f=tN.f=dN,Jy.f=DC,E6.f=function(e){return qp(aN(e),e)},Gs&&(ri(ai,"description",{configurable:!0,get:function(){return D0(this).description}}),Qc(nn,"propertyIsEnumerable",rm,{unsafe:!0})));Cl({global:!0,wrap:!0,forced:!Ia,sham:!Ia},{Symbol:Do});hv(eN(P6),function(e){T6(e)});Cl({target:dv,stat:!0,forced:!Ia},{for:function(e){var t=Jx(e);if(nr(Kp,t))return Kp[t];var r=Do(t);return Kp[t]=r,Xp[r]=t,r},keyFor:function(t){if(!qy(t))throw lN(t+" is not a symbol");if(nr(Xp,t))return Xp[t]},useSetter:function(){em=!0},useSimple:function(){em=!1}});Cl({target:"Object",stat:!0,forced:!Ia,sham:!Gs},{create:M6,defineProperty:vv,defineProperties:$C,getOwnPropertyDescriptor:hN});Cl({target:"Object",stat:!0,forced:!Ia},{getOwnPropertyNames:dN,getOwnPropertySymbols:DC});Cl({target:"Object",stat:!0,forced:PC(function(){Jy.f(1)})},{getOwnPropertySymbols:function(t){return Jy.f(_6(t))}});if(jl){var $6=!Ia||PC(function(){var e=Do();return jl([e])!="[null]"||jl({a:e})!="{}"||jl(Object(e))!="{}"});Cl({target:"JSON",stat:!0,forced:$6},{stringify:function(t,r,n){var o=O6(arguments),i=r;if(!(!b6(r)&&t===void 0||qy(t)))return y6(r)||(r=function(a,s){if(m6(i)&&(s=wf(i,this,a,s)),!qy(s))return s}),o[1]=r,p6(jl,null,o)}})}if(!ai[$0]){var D6=ai.valueOf;Qc(ai,$0,function(e){return wf(D6,this)})}k6(Do,dv);iN[Nr]=!0;var x6=qe,N6=cr,H6=De,oc=Ke,L6=hr,F6=Bt,j6=ki,B6=dr,V6=br.f,W6=ux,to=H6.Symbol,Li=to&&to.prototype;if(N6&&F6(to)&&(!("description"in Li)||to().description!==void 0)){var x0={},ic=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:B6(arguments[0]),r=j6(Li,this)?new to(t):t===void 0?to():to(t);return t===""&&(x0[r]=!0),r};W6(ic,to),ic.prototype=Li,Li.constructor=ic;var U6=String(to("test"))=="Symbol(test)",z6=oc(Li.toString),Y6=oc(Li.valueOf),G6=/^Symbol\((.*)\)[^)]+$/,K6=oc("".replace),X6=oc("".slice);V6(Li,"description",{configurable:!0,get:function(){var t=Y6(this),r=z6(t);if(L6(x0,t))return"";var n=U6?X6(r,7,-1):K6(r,G6,"$1");return n===""?void 0:n}}),x6({global:!0,forced:!0},{Symbol:ic})}var q6=Zx;q6("iterator");var Q6=Xr,xC=yf,N0=bf,vN=jo,Z6=br.f,J6=TC,e8=cr,pN="Array Iterator",t8=vN.set,r8=vN.getterFor(pN),n8=J6(Array,"Array",function(e,t){t8(this,{type:pN,target:Q6(e),index:0,kind:t})},function(){var e=r8(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):r=="keys"?{value:n,done:!1}:r=="values"?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}},"values"),H0=N0.Arguments=N0.Array;xC("keys");xC("values");xC("entries");if(e8&&H0.name!=="values")try{Z6(H0,"name",{value:"values"})}catch{}var L0=De,gN=Gx,o8=Kx,cu=n8,Qp=Ai,yN=Nt,Zp=yN("iterator"),F0=yN("toStringTag"),Jp=cu.values,mN=function(e,t){if(e){if(e[Zp]!==Jp)try{Qp(e,Zp,Jp)}catch{e[Zp]=Jp}if(e[F0]||Qp(e,F0,t),gN[t]){for(var r in cu)if(e[r]!==cu[r])try{Qp(e,r,cu[r])}catch{e[r]=cu[r]}}}};for(var eg in gN)mN(L0[eg]&&L0[eg].prototype,eg);mN(o8,"DOMTokenList");var i8=cr,a8=ff.EXISTS,bN=Ke,s8=br.f,wN=Function.prototype,l8=bN(wN.toString),_N=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u8=bN(_N.exec),f8="name";i8&&!a8&&s8(wN,f8,{configurable:!0,get:function(){try{return u8(_N,l8(this))[1]}catch{return""}}});var c8=qe,h8=it,d8=Lr,SN=uv,v8=jx,p8=h8(function(){SN(1)});c8({target:"Object",stat:!0,forced:p8,sham:!v8},{getPrototypeOf:function(t){return SN(d8(t))}});var g8=qe,y8=aC.includes,m8=yf;g8({target:"Array",proto:!0},{includes:function(t){return y8(this,t,arguments.length>1?arguments[1]:void 0)}});m8("includes");var b8=qt,w8=Ei,_8=Nt,S8=_8("match"),NC=function(e){var t;return b8(e)&&((t=e[S8])!==void 0?!!t:w8(e)=="RegExp")},C8=De,O8=NC,R8=C8.TypeError,HC=function(e){if(O8(e))throw R8("The method doesn't accept regular expressions");return e},E8=Nt,T8=E8("match"),LC=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[T8]=!1,"/./"[e](t)}catch{}}return!1},k8=qe,A8=Ke,I8=HC,P8=Hr,j0=dr,M8=LC,$8=A8("".indexOf);k8({target:"String",proto:!0,forced:!M8("includes")},{includes:function(t){return!!~$8(j0(P8(this)),j0(I8(t)),arguments.length>1?arguments[1]:void 0)}});var D8=qe,x8=Wa.filter,N8=vf,H8=N8("filter");D8({target:"Array",proto:!0,forced:!H8},{filter:function(t){return x8(this,t,arguments.length>1?arguments[1]:void 0)}});var L8=De,F8=nv,j8=Kd,B8=L8.TypeError,CN=function(e){if(F8(e))return e;throw B8(j8(e)+" is not a constructor")},B0=Qt,V8=CN,W8=Nt,U8=W8("species"),z8=function(e,t){var r=B0(e).constructor,n;return r===void 0||(n=B0(r)[U8])==null?t:V8(n)},Y8=Ua,Bl=mr,FC=Ke,G8=av,K8=NC,X8=Qt,V0=Hr,q8=z8,Q8=OC,Z8=Va,tg=dr,J8=ja,W0=lC,U0=sv,eX=iv,tX=_C,rX=it,ns=tX.UNSUPPORTED_Y,z0=4294967295,nX=Math.min,ON=[].push,oX=FC(/./.exec),os=FC(ON),Vl=FC("".slice),iX=!rX(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});G8("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=tg(V0(this)),s=i===void 0?z0:i>>>0;if(s===0)return[];if(o===void 0)return[a];if(!K8(o))return Bl(t,a,o,s);for(var l=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),f=0,c=new RegExp(o.source,u+"g"),h,d,v;(h=Bl(eX,c,a))&&(d=c.lastIndex,!(d>f&&(os(l,Vl(a,f,h.index)),h.length>1&&h.index<a.length&&Y8(ON,l,W0(h,1)),v=h[0].length,f=d,l.length>=s)));)c.lastIndex===h.index&&c.lastIndex++;return f===a.length?(v||!oX(c,""))&&os(l,""):os(l,Vl(a,f)),l.length>s?W0(l,0,s):l}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Bl(t,this,o,i)}:n=t,[function(i,a){var s=V0(this),l=i==null?void 0:J8(i,e);return l?Bl(l,i,s,a):Bl(n,tg(s),i,a)},function(o,i){var a=X8(this),s=tg(o),l=r(n,a,s,i,n!==t);if(l.done)return l.value;var u=q8(a,RegExp),f=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ns?"g":"y"),h=new u(ns?"^(?:"+a.source+")":a,c),d=i===void 0?z0:i>>>0;if(d===0)return[];if(s.length===0)return U0(h,s)===null?[s]:[];for(var v=0,p=0,b=[];p<s.length;){h.lastIndex=ns?0:p;var _=U0(h,ns?Vl(s,p):s),S;if(_===null||(S=nX(Z8(h.lastIndex+(ns?p:0)),s.length))===v)p=Q8(s,p,f);else{if(os(b,Vl(s,v,p)),b.length===d)return b;for(var E=1;E<=_.length-1;E++)if(os(b,_[E]),b.length===d)return b;p=v=S}}return os(b,Vl(s,v)),b}]},!iX,ns);var aX=Ti,sX=br,lX=Nt,uX=cr,Y0=lX("species"),RN=function(e){var t=aX(e),r=sX.f;uX&&t&&!t[Y0]&&r(t,Y0,{configurable:!0,get:function(){return this}})},fX=cr,jC=De,Ol=Ke,cX=ev,hX=vC,dX=Ai,vX=br.f,pX=Ba.f,G0=ki,gX=NC,K0=dr,yX=yC,EN=_C,mX=ln.exports,bX=it,wX=hr,_X=jo.enforce,SX=RN,CX=Nt,TN=Ax,kN=Ix,OX=CX("match"),ao=jC.RegExp,Os=ao.prototype,RX=jC.SyntaxError,EX=Ol(yX),TX=Ol(Os.exec),Hh=Ol("".charAt),X0=Ol("".replace),q0=Ol("".indexOf),kX=Ol("".slice),AX=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ea=/a/g,rg=/a/g,IX=new ao(Ea)!==Ea,AN=EN.MISSED_STICKY,PX=EN.UNSUPPORTED_Y,MX=fX&&(!IX||AN||TN||kN||bX(function(){return rg[OX]=!1,ao(Ea)!=Ea||ao(rg)==rg||ao(Ea,"i")!="/a/i"})),$X=function(e){for(var t=e.length,r=0,n="",o=!1,i;r<=t;r++){if(i=Hh(e,r),i==="\\"){n+=i+Hh(e,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},DX=function(e){for(var t=e.length,r=0,n="",o=[],i={},a=!1,s=!1,l=0,u="",f;r<=t;r++){if(f=Hh(e,r),f==="\\")f=f+Hh(e,++r);else if(f==="]")a=!1;else if(!a)switch(!0){case f==="[":a=!0;break;case f==="(":TX(AX,kX(e,r+1))&&(r+=2,s=!0),n+=f,l++;continue;case(f===">"&&s):if(u===""||wX(i,u))throw new RX("Invalid capture group name");i[u]=!0,o[o.length]=[u,l],s=!1,u="";continue}s?u+=f:n+=f}return[n,o]};if(cX("RegExp",MX)){for(var Uo=function(t,r){var n=G0(Os,this),o=gX(t),i=r===void 0,a=[],s=t,l,u,f,c,h,d;if(!n&&o&&i&&t.constructor===Uo)return t;if((o||G0(Os,t))&&(t=t.source,i&&(r="flags"in s?s.flags:EX(s))),t=t===void 0?"":K0(t),r=r===void 0?"":K0(r),s=t,TN&&"dotAll"in Ea&&(u=!!r&&q0(r,"s")>-1,u&&(r=X0(r,/s/g,""))),l=r,AN&&"sticky"in Ea&&(f=!!r&&q0(r,"y")>-1,f&&PX&&(r=X0(r,/y/g,""))),kN&&(c=DX(t),t=c[0],a=c[1]),h=hX(ao(t,r),n?this:Os,Uo),(u||f||a.length)&&(d=_X(h),u&&(d.dotAll=!0,d.raw=Uo($X(t),l)),f&&(d.sticky=!0),a.length&&(d.groups=a)),t!==s)try{dX(h,"source",s===""?"(?:)":s)}catch{}return h},xX=function(e){e in Uo||vX(Uo,e,{configurable:!0,get:function(){return ao[e]},set:function(t){ao[e]=t}})},Q0=pX(ao),Z0=0;Q0.length>Z0;)xX(Q0[Z0++]);Os.constructor=Uo,Uo.prototype=Os,mX(jC,"RegExp",Uo)}SX("RegExp");var NX=Ke,HX=ff.PROPER,LX=ln.exports,FX=Qt,jX=ki,J0=dr,BX=it,VX=yC,BC="toString",nm=RegExp.prototype,IN=nm[BC],WX=NX(VX),UX=BX(function(){return IN.call({source:"a",flags:"b"})!="/a/b"}),zX=HX&&IN.name!=BC;(UX||zX)&&LX(RegExp.prototype,BC,function(){var t=FX(this),r=J0(t.source),n=t.flags,o=J0(n===void 0&&jX(nm,t)&&!("flags"in nm)?WX(t):n);return"/"+r+"/"+o},{unsafe:!0});var YX=qe,GX=Ke,KX=af,XX=Xr,qX=_l,QX=GX([].join),ZX=KX!=Object,JX=qX("join",",");YX({target:"Array",proto:!0,forced:ZX||!JX},{join:function(t){return QX(XX(this),t===void 0?",":t)}});var e5=ff.PROPER,t5=it,ek=_x,tk="\u200B\x85\u180E",r5=function(e){return t5(function(){return!!ek[e]()||tk[e]()!==tk||e5&&ek[e].name!==e})},n5=qe,o5=Sx.trim,i5=r5;n5({target:"String",proto:!0,forced:i5("trim")},{trim:function(){return o5(this)}});function om(e){return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}var rk=0,ac=["ms","moz","webkit","o"],Lu=window.requestAnimationFrame,Lh=window.cancelAnimationFrame;for(var Wl=0;Wl<ac.length&&!Lu;++Wl)Lu=window["".concat(ac[Wl],"RequestAnimationFrame")],Lh=window["".concat(ac[Wl],"CancelAnimationFrame")]||window["".concat(ac[Wl],"CancelRequestAnimationFrame")];Lu||(Lu=function(t){var r=new Date().getTime(),n=Math.max(0,16-(r-rk)),o=window.setTimeout(function(){t(r+n)},n);return rk=r+n,o});Lh||(Lh=function(t){clearTimeout(t)});function VC(e){return Lu.call(window,e)}function PN(){return!!document.documentElement.classList}function MN(){return!!document.createTextNode("test").textContent}function $N(){return!!window.getComputedStyle}function Fu(e){Lh.call(window,e)}function WC(){return"ontouchstart"in window}var im;function a5(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),im=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function UC(){return im===void 0&&a5(),im}var is;function DN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return is||((typeof Intl=="undefined"?"undefined":om(Intl))==="object"?is=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?is=function(n,o){return"".concat(n).localeCompare(o)}:is=function(n,o){return n===o?0:n>o?-1:1},is)}var Ul;function xN(){if(Ul!==void 0)return Ul;try{var e={get passive(){Ul=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Ul=!1}return Ul}var s5=Object.freeze(Object.defineProperty({__proto__:null,requestAnimationFrame:VC,isClassListSupported:PN,isTextContentSupported:MN,isGetComputedStyleSupported:$N,cancelAnimationFrame:Fu,isTouchSupported:WC,hasCaptionProblem:UC,getComparisonFunction:DN,isPassiveEventSupported:xN},Symbol.toStringTag,{value:"Module"})),Rl={exports:{}},l5=it,u5=l5(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),f5=it,c5=qt,h5=Ei,nk=u5,Zc=Object.isExtensible,d5=f5(function(){Zc(1)}),NN=d5||nk?function(t){return!c5(t)||nk&&h5(t)=="ArrayBuffer"?!1:Zc?Zc(t):!0}:Zc,v5=it,HN=!v5(function(){return Object.isExtensible(Object.preventExtensions({}))}),p5=qe,g5=Ke,y5=uf,m5=qt,zC=hr,b5=br.f,ok=Ba,w5=tv,YC=NN,_5=Xd,S5=HN,LN=!1,Ho=_5("meta"),C5=0,GC=function(e){b5(e,Ho,{value:{objectID:"O"+C5++,weakData:{}}})},O5=function(e,t){if(!m5(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!zC(e,Ho)){if(!YC(e))return"F";if(!t)return"E";GC(e)}return e[Ho].objectID},R5=function(e,t){if(!zC(e,Ho)){if(!YC(e))return!0;if(!t)return!1;GC(e)}return e[Ho].weakData},E5=function(e){return S5&&LN&&YC(e)&&!zC(e,Ho)&&GC(e),e},T5=function(){k5.enable=function(){},LN=!0;var e=ok.f,t=g5([].splice),r={};r[Ho]=1,e(r).length&&(ok.f=function(n){for(var o=e(n),i=0,a=o.length;i<a;i++)if(o[i]===Ho){t(o,i,1);break}return o},p5({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:w5.f}))},k5=Rl.exports={enable:T5,fastKey:O5,getWeakData:R5,onFreeze:E5};y5[Ho]=!0;var A5=De,I5=mf,P5=mr,M5=Qt,$5=Kd,D5=xx,x5=un,ik=ki,N5=Nx,H5=EC,ak=Dx,L5=A5.TypeError,Jc=function(e,t){this.stopped=e,this.result=t},sk=Jc.prototype,KC=function(e,t,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),s=I5(t,n),l,u,f,c,h,d,v,p=function(_){return l&&ak(l,"normal",_),new Jc(!0,_)},b=function(_){return o?(M5(_),a?s(_[0],_[1],p):s(_[0],_[1])):a?s(_,p):s(_)};if(i)l=e;else{if(u=H5(e),!u)throw L5($5(e)+" is not iterable");if(D5(u)){for(f=0,c=x5(e);c>f;f++)if(h=b(e[f]),h&&ik(sk,h))return h;return new Jc(!1)}l=N5(e,u)}for(d=l.next;!(v=P5(d,l)).done;){try{h=b(v.value)}catch(_){ak(l,"throw",_)}if(typeof h=="object"&&h&&ik(sk,h))return h}return new Jc(!1)},F5=De,j5=ki,B5=F5.TypeError,XC=function(e,t){if(j5(t,e))return e;throw B5("Incorrect invocation")},V5=qe,W5=De,U5=Ke,lk=ev,z5=ln.exports,Y5=Rl.exports,G5=KC,K5=XC,X5=Bt,ng=qt,og=it,q5=Fx,Q5=fv,Z5=vC,pv=function(e,t,r){var n=e.indexOf("Map")!==-1,o=e.indexOf("Weak")!==-1,i=n?"set":"add",a=W5[e],s=a&&a.prototype,l=a,u={},f=function(_){var S=U5(s[_]);z5(s,_,_=="add"?function(M){return S(this,M===0?0:M),this}:_=="delete"?function(E){return o&&!ng(E)?!1:S(this,E===0?0:E)}:_=="get"?function(M){return o&&!ng(M)?void 0:S(this,M===0?0:M)}:_=="has"?function(M){return o&&!ng(M)?!1:S(this,M===0?0:M)}:function(M,k){return S(this,M===0?0:M,k),this})},c=lk(e,!X5(a)||!(o||s.forEach&&!og(function(){new a().entries().next()})));if(c)l=r.getConstructor(t,e,n,i),Y5.enable();else if(lk(e,!0)){var h=new l,d=h[i](o?{}:-0,1)!=h,v=og(function(){h.has(1)}),p=q5(function(_){new a(_)}),b=!o&&og(function(){for(var _=new a,S=5;S--;)_[i](S,S);return!_.has(-0)});p||(l=t(function(_,S){K5(_,s);var E=Z5(new a,_,l);return S!=null&&G5(S,E[i],{that:E,AS_ENTRIES:n}),E}),l.prototype=s,s.constructor=l),(v||b)&&(f("delete"),f("has"),n&&f("get")),(b||d)&&f(i),o&&s.clear&&delete s.clear}return u[e]=l,V5({global:!0,forced:l!=a},u),Q5(l,e),o||r.setStrong(l,e,n),l},J5=ln.exports,qC=function(e,t,r){for(var n in t)J5(e,n,t[n],r);return e},e7=br.f,t7=Sl,uk=qC,r7=mf,n7=XC,o7=KC,i7=TC,a7=RN,zl=cr,fk=Rl.exports.fastKey,FN=jo,ck=FN.set,ig=FN.getterFor,jN={getConstructor:function(e,t,r,n){var o=e(function(u,f){n7(u,i),ck(u,{type:t,index:t7(null),first:void 0,last:void 0,size:0}),zl||(u.size=0),f!=null&&o7(f,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=ig(t),s=function(u,f,c){var h=a(u),d=l(u,f),v,p;return d?d.value=c:(h.last=d={index:p=fk(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),zl?h.size++:u.size++,p!=="F"&&(h.index[p]=d)),u},l=function(u,f){var c=a(u),h=fk(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return uk(i,{clear:function(){for(var f=this,c=a(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,zl?c.size=0:f.size=0},delete:function(u){var f=this,c=a(f),h=l(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),zl?c.size--:f.size--}return!!h},forEach:function(f){for(var c=a(this),h=r7(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!l(this,f)}}),uk(i,r?{get:function(f){var c=l(this,f);return c&&c.value},set:function(f,c){return s(this,f===0?0:f,c)}}:{add:function(f){return s(this,f=f===0?0:f,f)}}),zl&&e7(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=ig(t),i=ig(n);i7(e,t,function(a,s){ck(this,{type:n,target:a,state:o(a),kind:s,last:void 0})},function(){for(var a=i(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:l.key,done:!1}:s=="values"?{value:l.value,done:!1}:{value:[l.key,l.value],done:!1}},r?"entries":"values",!r,!0),a7(t)}},s7=pv,l7=jN;s7("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},l7);function BN(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function am(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function mu(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function zt(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var s=i.length;for(n&&s&&(o+=1,a=i[o]),o+=1;o<s;)a=t(a,i[o],o,i),o+=1;return a}function Gr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];t(s,r,n)&&(a+=1,i[a]=s),r+=1}return i}function et(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];a+=1,i[a]=t(s,r,n),r+=1}return i}function P(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&t(n[r],r,n)!==!1;)r+=1;return e}function VN(e){return zt(e,function(t,r){return t+r},0)}function u7(e){return zt(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function f7(e){return zt(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function c7(e){return e.length?VN(e)/e.length:0}function WN(e){return zt(e,function(t,r){return t.concat(Array.isArray(r)?WN(r):r)},[])}function QC(e){var t=[];return P(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function sm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return P(i,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function h7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return P(i,function(s){a=a.filter(function(l){return s.includes(l)})}),a}function d7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return P(i,function(s){P(s,function(l){a.has(l)||a.add(l)})}),Array.from(a)}function lm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}var v7=Object.freeze(Object.defineProperty({__proto__:null,to2dArray:BN,extendArray:am,pivot:mu,arrayReduce:zt,arrayFilter:Gr,arrayMap:et,arrayEach:P,arraySum:VN,arrayMax:u7,arrayMin:f7,arrayAvg:c7,arrayFlatten:WN,arrayUnique:QC,getDifferenceOfArrays:sm,getIntersectionOfArrays:h7,getUnionOfArrays:d7,stringToArray:lm},Symbol.toStringTag,{value:"Module"}));function hk(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ks(e){return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ks(e)}function Xs(e){var t;return Array.isArray(e)?t=[]:(t={},ot(e,function(r,n){n!=="__children"&&(r&&Ks(r)==="object"&&!Array.isArray(r)?t[n]=Xs(r):Array.isArray(r)?r.length&&Ks(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[Xs(r[0])]:t[n]=[]:t[n]=null)})),t}function Bo(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function xt(e,t,r){var n=Array.isArray(r);return ot(t,function(o,i){(n===!1||r.includes(i))&&(e[i]=o)}),e}function Cf(e,t){ot(t,function(r,n){t[n]&&Ks(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Cf(e[n],t[n])):e[n]=t[n]})}function kr(e){return Ks(e)==="object"?JSON.parse(JSON.stringify(e)):e}function _r(e){var t={};return ot(e,function(r,n){t[n]=r}),t}function wt(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return P(r,function(o){e.MIXINS.push(o.MIXIN_NAME),ot(o,function(i,a){if(e.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")e.prototype[a]=i;else{var s=function(f,c){var h="_".concat(f),d=function(p){var b=p;return(Array.isArray(b)||Ze(b))&&(b=kr(b)),b};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,a,{get:s(a,i),set:l(a),configurable:!0})}})}),e}function ZC(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ze(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kn(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function ot(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function UN(e,t){var r=t.split("."),n=e;return ot(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function eh(e,t,r){var n=t.split("."),o=e;n.forEach(function(i,a){a!==n.length-1?(Ot(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function gv(e){if(!Ze(e))return 0;var t=function r(n){var o=0;return Ze(n)?ot(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return t(e)}function Pa(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(t={_touched:!1},hk(t,n,e),hk(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),o}function Ot(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var p7=Object.freeze(Object.defineProperty({__proto__:null,duckSchema:Xs,inherit:Bo,extend:xt,deepExtend:Cf,deepClone:kr,clone:_r,mixin:wt,isObjectEqual:ZC,isObject:Ze,defineGetter:Kn,objectEach:ot,getProperty:UN,setProperty:eh,deepObjectSize:gv,createObjectPropListener:Pa,hasOwnProperty:Ot},Symbol.toStringTag,{value:"Module"})),xr=function(t){var r={value:!1};return r.test=function(n,o){r.value=t(n,o)},r},Kr={chrome:xr(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:xr(function(e){return/CriOS/.test(e)}),edge:xr(function(e){return/Edge/.test(e)}),edgeWebKit:xr(function(e){return/EdgiOS/.test(e)}),firefox:xr(function(e){return/Firefox/.test(e)}),firefoxWebKit:xr(function(e){return/FxiOS/.test(e)}),ie:xr(function(e){return/Trident/.test(e)}),ie9:xr(function(){return!!document.documentMode}),mobile:xr(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:xr(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},El={mac:xr(function(e){return/^Mac/.test(e)}),win:xr(function(e){return/^Win/.test(e)}),linux:xr(function(e){return/^Linux/.test(e)}),ios:xr(function(e){return/iPhone|iPad|iPod/i.test(e)})};function zN(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,o=n===void 0?navigator.vendor:n;ot(Kr,function(i){var a=i.test;return void a(r,o)})}function YN(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;ot(El,function(n){var o=n.test;return void o(r)})}zN();YN();function GN(){return Kr.chrome.value}function KN(){return Kr.chromeWebKit.value}function th(){return Kr.firefox.value}function XN(){return Kr.firefoxWebKit.value}function qN(){return Kr.safari.value}function QN(){return Kr.edge.value}function g7(){return Kr.edgeWebKit.value}function ZN(){return Kr.ie.value}function JN(){return Kr.ie9.value}function y7(){return Kr.ie.value||Kr.edge.value}function Sn(){return Kr.mobile.value}function JC(){return El.ios.value}function eO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&El.mac.value}function um(){return El.win.value}function eH(){return El.mac.value}function m7(){return El.linux.value}var b7=Object.freeze(Object.defineProperty({__proto__:null,setBrowserMeta:zN,setPlatformMeta:YN,isChrome:GN,isChromeWebKit:KN,isFirefox:th,isFirefoxWebKit:XN,isSafari:qN,isEdge:QN,isEdgeWebKit:g7,isIE:ZN,isIE9:JN,isMSBrowser:y7,isMobileBrowser:Sn,isIOS:JC,isIpadOS:eO,isWindowsOS:um,isMacOS:eH,isLinuxOS:m7},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */function w7(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else return Array.from(e)}var _7=Object.hasOwnProperty,dk=Object.setPrototypeOf,S7=Object.isFrozen,C7=Object.getPrototypeOf,O7=Object.getOwnPropertyDescriptor,Ar=Object.freeze,Un=Object.seal,R7=Object.create,tH=typeof Reflect!="undefined"&&Reflect,Fh=tH.apply,fm=tH.construct;Fh||(Fh=function(t,r,n){return t.apply(r,n)});Ar||(Ar=function(t){return t});Un||(Un=function(t){return t});fm||(fm=function(t,r){return new(Function.prototype.bind.apply(t,[null].concat(w7(r))))});var E7=Rn(Array.prototype.forEach),vk=Rn(Array.prototype.pop),Yl=Rn(Array.prototype.push),rh=Rn(String.prototype.toLowerCase),pk=Rn(String.prototype.match),zo=Rn(String.prototype.replace),T7=Rn(String.prototype.indexOf),k7=Rn(String.prototype.trim),Mr=Rn(RegExp.prototype.test),ag=A7(TypeError);function Rn(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Fh(e,t,n)}}function A7(e){return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return fm(e,r)}}function st(e,t){dk&&dk(e,null);for(var r=t.length;r--;){var n=t[r];if(typeof n=="string"){var o=rh(n);o!==n&&(S7(t)||(t[r]=o),n=o)}e[n]=!0}return e}function Fi(e){var t=R7(null),r=void 0;for(r in e)Fh(_7,e,[r])&&(t[r]=e[r]);return t}function sc(e,t){for(;e!==null;){var r=O7(e,t);if(r){if(r.get)return Rn(r.get);if(typeof r.value=="function")return Rn(r.value)}e=C7(e)}function n(o){return console.warn("fallback value for",o),null}return n}var gk=Ar(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sg=Ar(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lg=Ar(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),I7=Ar(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ug=Ar(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),P7=Ar(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),yk=Ar(["#text"]),mk=Ar(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),fg=Ar(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),bk=Ar(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lc=Ar(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),M7=Un(/\{\{[\s\S]*|[\s\S]*\}\}/gm),$7=Un(/<%[\s\S]*|[\s\S]*%>/gm),D7=Un(/^data-[\-\w.\u00B7-\uFFFF]/),x7=Un(/^aria-[\-\w]+$/),N7=Un(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H7=Un(/^(?:\w+script|data):/i),L7=Un(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),F7=Un(/^html$/i),hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function kn(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}else return Array.from(e)}var j7=function(){return typeof window=="undefined"?null:window},B7=function(t,r){if((typeof t=="undefined"?"undefined":hu(t))!=="object"||typeof t.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(n=r.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function rH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j7(),t=function(G){return rH(G)};if(t.version="2.3.6",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,o=e.DocumentFragment,i=e.HTMLTemplateElement,a=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=s.prototype,p=sc(v,"cloneNode"),b=sc(v,"nextSibling"),_=sc(v,"childNodes"),S=sc(v,"parentNode");if(typeof i=="function"){var E=n.createElement("template");E.content&&E.content.ownerDocument&&(n=E.content.ownerDocument)}var M=B7(d,r),k=M?M.createHTML(""):"",U=n,Y=U.implementation,ne=U.createNodeIterator,Z=U.createDocumentFragment,te=U.getElementsByTagName,se=r.importNode,he={};try{he=Fi(n).documentMode?n.documentMode:{}}catch{}var ae={};t.isSupported=typeof S=="function"&&Y&&typeof Y.createHTMLDocument!="undefined"&&he!==9;var Ce=M7,y=$7,w=D7,g=x7,m=H7,R=L7,$=N7,I=null,V=st({},[].concat(kn(gk),kn(sg),kn(lg),kn(ug),kn(yk))),q=null,oe=st({},[].concat(kn(mk),kn(fg),kn(bk),kn(lc))),ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),de=null,Te=null,me=!0,Pe=!0,We=!1,Le=!1,je=!1,Fe=!1,re=!1,Ue=!1,Be=!1,pt=!1,nt=!0,ze=!0,O=!1,T={},D=null,z=st({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),H=null,K=st({},["audio","video","img","source","image","track"]),L=null,N=st({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),W="http://www.w3.org/1998/Math/MathML",j="http://www.w3.org/2000/svg",Q="http://www.w3.org/1999/xhtml",fe=Q,Se=!1,ke=void 0,Qe=["application/xhtml+xml","text/html"],ct="text/html",Je=void 0,Ne=null,ft=n.createElement("form"),Tt=function(G){return G instanceof RegExp||G instanceof Function},ir=function(G){Ne&&Ne===G||((!G||(typeof G=="undefined"?"undefined":hu(G))!=="object")&&(G={}),G=Fi(G),I="ALLOWED_TAGS"in G?st({},G.ALLOWED_TAGS):V,q="ALLOWED_ATTR"in G?st({},G.ALLOWED_ATTR):oe,L="ADD_URI_SAFE_ATTR"in G?st(Fi(N),G.ADD_URI_SAFE_ATTR):N,H="ADD_DATA_URI_TAGS"in G?st(Fi(K),G.ADD_DATA_URI_TAGS):K,D="FORBID_CONTENTS"in G?st({},G.FORBID_CONTENTS):z,de="FORBID_TAGS"in G?st({},G.FORBID_TAGS):{},Te="FORBID_ATTR"in G?st({},G.FORBID_ATTR):{},T="USE_PROFILES"in G?G.USE_PROFILES:!1,me=G.ALLOW_ARIA_ATTR!==!1,Pe=G.ALLOW_DATA_ATTR!==!1,We=G.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=G.SAFE_FOR_TEMPLATES||!1,je=G.WHOLE_DOCUMENT||!1,Ue=G.RETURN_DOM||!1,Be=G.RETURN_DOM_FRAGMENT||!1,pt=G.RETURN_TRUSTED_TYPE||!1,re=G.FORCE_BODY||!1,nt=G.SANITIZE_DOM!==!1,ze=G.KEEP_CONTENT!==!1,O=G.IN_PLACE||!1,$=G.ALLOWED_URI_REGEXP||$,fe=G.NAMESPACE||Q,G.CUSTOM_ELEMENT_HANDLING&&Tt(G.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ee.tagNameCheck=G.CUSTOM_ELEMENT_HANDLING.tagNameCheck),G.CUSTOM_ELEMENT_HANDLING&&Tt(G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ee.attributeNameCheck=G.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),G.CUSTOM_ELEMENT_HANDLING&&typeof G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ee.allowCustomizedBuiltInElements=G.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ke=Qe.indexOf(G.PARSER_MEDIA_TYPE)===-1?ke=ct:ke=G.PARSER_MEDIA_TYPE,Je=ke==="application/xhtml+xml"?function(pe){return pe}:rh,Le&&(Pe=!1),Be&&(Ue=!0),T&&(I=st({},[].concat(kn(yk))),q=[],T.html===!0&&(st(I,gk),st(q,mk)),T.svg===!0&&(st(I,sg),st(q,fg),st(q,lc)),T.svgFilters===!0&&(st(I,lg),st(q,fg),st(q,lc)),T.mathMl===!0&&(st(I,ug),st(q,bk),st(q,lc))),G.ADD_TAGS&&(I===V&&(I=Fi(I)),st(I,G.ADD_TAGS)),G.ADD_ATTR&&(q===oe&&(q=Fi(q)),st(q,G.ADD_ATTR)),G.ADD_URI_SAFE_ATTR&&st(L,G.ADD_URI_SAFE_ATTR),G.FORBID_CONTENTS&&(D===z&&(D=Fi(D)),st(D,G.FORBID_CONTENTS)),ze&&(I["#text"]=!0),je&&st(I,["html","head","body"]),I.table&&(st(I,["tbody"]),delete de.tbody),Ar&&Ar(G),Ne=G)},Tn=st({},["mi","mo","mn","ms","mtext"]),dn=st({},["foreignobject","desc","title","annotation-xml"]),Jt=st({},sg);st(Jt,lg),st(Jt,I7);var Pr=st({},ug);st(Pr,P7);var er=function(G){var pe=S(G);(!pe||!pe.tagName)&&(pe={namespaceURI:Q,tagName:"template"});var Ee=rh(G.tagName),gt=rh(pe.tagName);if(G.namespaceURI===j)return pe.namespaceURI===Q?Ee==="svg":pe.namespaceURI===W?Ee==="svg"&&(gt==="annotation-xml"||Tn[gt]):Boolean(Jt[Ee]);if(G.namespaceURI===W)return pe.namespaceURI===Q?Ee==="math":pe.namespaceURI===j?Ee==="math"&&dn[gt]:Boolean(Pr[Ee]);if(G.namespaceURI===Q){if(pe.namespaceURI===j&&!dn[gt]||pe.namespaceURI===W&&!Tn[gt])return!1;var vr=st({},["title","style","font","a","script"]);return!Pr[Ee]&&(vr[Ee]||!Jt[Ee])}return!1},_t=function(G){Yl(t.removed,{element:G});try{G.parentNode.removeChild(G)}catch{try{G.outerHTML=k}catch{G.remove()}}},St=function(G,pe){try{Yl(t.removed,{attribute:pe.getAttributeNode(G),from:pe})}catch{Yl(t.removed,{attribute:null,from:pe})}if(pe.removeAttribute(G),G==="is"&&!q[G])if(Ue||Be)try{_t(pe)}catch{}else try{pe.setAttribute(G,"")}catch{}},Uf=function(G){var pe=void 0,Ee=void 0;if(re)G="<remove></remove>"+G;else{var gt=pk(G,/^[\r\n\t ]+/);Ee=gt&&gt[0]}ke==="application/xhtml+xml"&&(G='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+G+"</body></html>");var vr=M?M.createHTML(G):G;if(fe===Q)try{pe=new h().parseFromString(vr,ke)}catch{}if(!pe||!pe.documentElement){pe=Y.createDocument(fe,"template",null);try{pe.documentElement.innerHTML=Se?"":vr}catch{}}var pr=pe.body||pe.documentElement;return G&&Ee&&pr.insertBefore(n.createTextNode(Ee),pr.childNodes[0]||null),fe===Q?te.call(pe,je?"html":"body")[0]:je?pe.documentElement:pr},zf=function(G){return ne.call(G.ownerDocument||G,G,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},np=function(G){return G instanceof c&&(typeof G.nodeName!="string"||typeof G.textContent!="string"||typeof G.removeChild!="function"||!(G.attributes instanceof f)||typeof G.removeAttribute!="function"||typeof G.setAttribute!="function"||typeof G.namespaceURI!="string"||typeof G.insertBefore!="function")},xi=function(G){return(typeof a=="undefined"?"undefined":hu(a))==="object"?G instanceof a:G&&(typeof G=="undefined"?"undefined":hu(G))==="object"&&typeof G.nodeType=="number"&&typeof G.nodeName=="string"},vn=function(G,pe,Ee){!ae[G]||E7(ae[G],function(gt){gt.call(t,pe,Ee,Ne)})},Yf=function(G){var pe=void 0;if(vn("beforeSanitizeElements",G,null),np(G)||pk(G.nodeName,/[\u0080-\uFFFF]/))return _t(G),!0;var Ee=Je(G.nodeName);if(vn("uponSanitizeElement",G,{tagName:Ee,allowedTags:I}),!xi(G.firstElementChild)&&(!xi(G.content)||!xi(G.content.firstElementChild))&&Mr(/<[/\w]/g,G.innerHTML)&&Mr(/<[/\w]/g,G.textContent)||Ee==="select"&&Mr(/<template/i,G.innerHTML))return _t(G),!0;if(!I[Ee]||de[Ee]){if(!de[Ee]&&Gf(Ee)&&(ee.tagNameCheck instanceof RegExp&&Mr(ee.tagNameCheck,Ee)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(Ee)))return!1;if(ze&&!D[Ee]){var gt=S(G)||G.parentNode,vr=_(G)||G.childNodes;if(vr&&gt)for(var pr=vr.length,ar=pr-1;ar>=0;--ar)gt.insertBefore(p(vr[ar],!0),b(G))}return _t(G),!0}return G instanceof s&&!er(G)||(Ee==="noscript"||Ee==="noembed")&&Mr(/<\/no(script|embed)/i,G.innerHTML)?(_t(G),!0):(Le&&G.nodeType===3&&(pe=G.textContent,pe=zo(pe,Ce," "),pe=zo(pe,y," "),G.textContent!==pe&&(Yl(t.removed,{element:G.cloneNode()}),G.textContent=pe)),vn("afterSanitizeElements",G,null),!1)},Dl=function(G,pe,Ee){if(nt&&(pe==="id"||pe==="name")&&(Ee in n||Ee in ft))return!1;if(!(Pe&&!Te[pe]&&Mr(w,pe))){if(!(me&&Mr(g,pe))){if(!q[pe]||Te[pe]){if(!(Gf(G)&&(ee.tagNameCheck instanceof RegExp&&Mr(ee.tagNameCheck,G)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(G))&&(ee.attributeNameCheck instanceof RegExp&&Mr(ee.attributeNameCheck,pe)||ee.attributeNameCheck instanceof Function&&ee.attributeNameCheck(pe))||pe==="is"&&ee.allowCustomizedBuiltInElements&&(ee.tagNameCheck instanceof RegExp&&Mr(ee.tagNameCheck,Ee)||ee.tagNameCheck instanceof Function&&ee.tagNameCheck(Ee))))return!1}else if(!L[pe]){if(!Mr($,zo(Ee,R,""))){if(!((pe==="src"||pe==="xlink:href"||pe==="href")&&G!=="script"&&T7(Ee,"data:")===0&&H[G])){if(!(We&&!Mr(m,zo(Ee,R,"")))){if(Ee)return!1}}}}}}return!0},Gf=function(G){return G.indexOf("-")>0},Kf=function(G){var pe=void 0,Ee=void 0,gt=void 0,vr=void 0;vn("beforeSanitizeAttributes",G,null);var pr=G.attributes;if(!!pr){var ar={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q};for(vr=pr.length;vr--;){pe=pr[vr];var Qa=pe,wr=Qa.name,Xf=Qa.namespaceURI;if(Ee=k7(pe.value),gt=Je(wr),ar.attrName=gt,ar.attrValue=Ee,ar.keepAttr=!0,ar.forceKeepAttr=void 0,vn("uponSanitizeAttribute",G,ar),Ee=ar.attrValue,!ar.forceKeepAttr&&(St(wr,G),!!ar.keepAttr)){if(Mr(/\/>/i,Ee)){St(wr,G);continue}Le&&(Ee=zo(Ee,Ce," "),Ee=zo(Ee,y," "));var ip=Je(G.nodeName);if(!!Dl(ip,gt,Ee))try{Xf?G.setAttributeNS(Xf,wr,Ee):G.setAttribute(wr,Ee),vk(t.removed)}catch{}}}vn("afterSanitizeAttributes",G,null)}},op=function $e(G){var pe=void 0,Ee=zf(G);for(vn("beforeSanitizeShadowDOM",G,null);pe=Ee.nextNode();)vn("uponSanitizeShadowNode",pe,null),!Yf(pe)&&(pe.content instanceof o&&$e(pe.content),Kf(pe));vn("afterSanitizeShadowDOM",G,null)};return t.sanitize=function($e,G){var pe=void 0,Ee=void 0,gt=void 0,vr=void 0,pr=void 0;if(Se=!$e,Se&&($e="<!-->"),typeof $e!="string"&&!xi($e)){if(typeof $e.toString!="function")throw ag("toString is not a function");if($e=$e.toString(),typeof $e!="string")throw ag("dirty is not a string, aborting")}if(!t.isSupported){if(hu(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof $e=="string")return e.toStaticHTML($e);if(xi($e))return e.toStaticHTML($e.outerHTML)}return $e}if(Fe||ir(G),t.removed=[],typeof $e=="string"&&(O=!1),O){if($e.nodeName){var ar=Je($e.nodeName);if(!I[ar]||de[ar])throw ag("root node is forbidden and cannot be sanitized in-place")}}else if($e instanceof a)pe=Uf("<!---->"),Ee=pe.ownerDocument.importNode($e,!0),Ee.nodeType===1&&Ee.nodeName==="BODY"||Ee.nodeName==="HTML"?pe=Ee:pe.appendChild(Ee);else{if(!Ue&&!Le&&!je&&$e.indexOf("<")===-1)return M&&pt?M.createHTML($e):$e;if(pe=Uf($e),!pe)return Ue?null:pt?k:""}pe&&re&&_t(pe.firstChild);for(var Qa=zf(O?$e:pe);gt=Qa.nextNode();)gt.nodeType===3&&gt===vr||Yf(gt)||(gt.content instanceof o&&op(gt.content),Kf(gt),vr=gt);if(vr=null,O)return $e;if(Ue){if(Be)for(pr=Z.call(pe.ownerDocument);pe.firstChild;)pr.appendChild(pe.firstChild);else pr=pe;return q.shadowroot&&(pr=se.call(r,pr,!0)),pr}var wr=je?pe.outerHTML:pe.innerHTML;return je&&I["!doctype"]&&pe.ownerDocument&&pe.ownerDocument.doctype&&pe.ownerDocument.doctype.name&&Mr(F7,pe.ownerDocument.doctype.name)&&(wr="<!DOCTYPE "+pe.ownerDocument.doctype.name+`>
`+wr),Le&&(wr=zo(wr,Ce," "),wr=zo(wr,y," ")),M&&pt?M.createHTML(wr):wr},t.setConfig=function($e){ir($e),Fe=!0},t.clearConfig=function(){Ne=null,Fe=!1},t.isValidAttribute=function($e,G,pe){Ne||ir({});var Ee=Je($e),gt=Je(G);return Dl(Ee,gt,pe)},t.addHook=function($e,G){typeof G=="function"&&(ae[$e]=ae[$e]||[],Yl(ae[$e],G))},t.removeHook=function($e){ae[$e]&&vk(ae[$e])},t.removeHooks=function($e){ae[$e]&&(ae[$e]=[])},t.removeAllHooks=function(){ae={}},t}var V7=rH(),W7=qe,U7=HN,z7=it,Y7=qt,G7=Rl.exports.onFreeze,cm=Object.freeze,K7=z7(function(){cm(1)});W7({target:"Object",stat:!0,forced:K7,sham:!U7},{freeze:function(t){return cm&&Y7(t)?cm(G7(t)):t}});var X7=qe,q7=CC.codeAt;X7({target:"String",proto:!0},{codePointAt:function(t){return q7(this,t)}});var Q7=De,Z7=Ii,J7=dr,e9=Hr,t9=Q7.RangeError,nH=function(t){var r=J7(e9(this)),n="",o=Z7(t);if(o<0||o==1/0)throw t9("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(r+=r))o&1&&(n+=r);return n},oH=Ke,r9=Va,wk=dr,n9=nH,o9=Hr,i9=oH(n9),a9=oH("".slice),s9=Math.ceil,_k=function(e){return function(t,r,n){var o=wk(o9(t)),i=r9(r),a=o.length,s=n===void 0?" ":wk(n),l,u;return i<=a||s==""?o:(l=i-a,u=i9(s,s9(l/s.length)),u.length>l&&(u=a9(u,0,l)),e?o+u:u+o)}},l9={start:_k(!1),end:_k(!0)},u9=Fa,f9=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(u9),c9=qe,h9=l9.start,d9=f9;c9({target:"String",proto:!0,forced:d9},{padStart:function(t){return h9(this,t,arguments.length>1?arguments[1]:void 0)}});var iH;function ve(){return iH.apply(null,arguments)}function v9(e){iH=e}function zn(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function bu(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function p9(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function Dr(e){return e===void 0}function Ma(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function yv(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function aH(e,t){var r=[],n;for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function Xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function si(e,t){for(var r in t)Xt(t,r)&&(e[r]=t[r]);return Xt(t,"toString")&&(e.toString=t.toString),Xt(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Xn(e,t,r,n){return $H(e,t,r,n,!0).utc()}function g9(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function lt(e){return e._pf==null&&(e._pf=g9()),e._pf}var hm;Array.prototype.some?hm=Array.prototype.some:hm=function(e){for(var t=Object(this),r=t.length>>>0,n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function tO(e){if(e._isValid==null){var t=lt(e),r=hm.call(t.parsedDateParts,function(o){return o!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function mv(e){var t=Xn(NaN);return e!=null?si(lt(t),e):lt(t).userInvalidated=!0,t}var cg=ve.momentProperties=[];function rO(e,t){var r,n,o;if(Dr(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Dr(t._i)||(e._i=t._i),Dr(t._f)||(e._f=t._f),Dr(t._l)||(e._l=t._l),Dr(t._strict)||(e._strict=t._strict),Dr(t._tzm)||(e._tzm=t._tzm),Dr(t._isUTC)||(e._isUTC=t._isUTC),Dr(t._offset)||(e._offset=t._offset),Dr(t._pf)||(e._pf=lt(t)),Dr(t._locale)||(e._locale=t._locale),cg.length>0)for(r=0;r<cg.length;r++)n=cg[r],o=t[n],Dr(o)||(e[n]=o);return e}var hg=!1;function Of(e){rO(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hg===!1&&(hg=!0,ve.updateOffset(this),hg=!1)}function Yn(e){return e instanceof Of||e!=null&&e._isAMomentObject!=null}function rn(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ut(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=rn(t)),r}function sH(e,t,r){var n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),i=0,a;for(a=0;a<n;a++)(r&&e[a]!==t[a]||!r&&ut(e[a])!==ut(t[a]))&&i++;return i+o}function lH(e){ve.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+e)}function fn(e,t){var r=!0;return si(function(){if(ve.deprecationHandler!=null&&ve.deprecationHandler(null,e),r){for(var n=[],o,i=0;i<arguments.length;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(var a in arguments[0])o+=a+": "+arguments[0][a]+", ";o=o.slice(0,-2)}else o=arguments[i];n.push(o)}lH(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var Sk={};function uH(e,t){ve.deprecationHandler!=null&&ve.deprecationHandler(e,t),Sk[e]||(lH(t),Sk[e]=!0)}ve.suppressDeprecationWarnings=!1;ve.deprecationHandler=null;function qn(e){return e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function y9(e){var t,r;for(r in e)t=e[r],qn(t)?this[r]=t:this["_"+r]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function fH(e,t){var r=si({},e),n;for(n in t)Xt(t,n)&&(bu(e[n])&&bu(t[n])?(r[n]={},si(r[n],e[n]),si(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Xt(e,n)&&!Xt(t,n)&&bu(e[n])&&(r[n]=si({},r[n]));return r}function nO(e){e!=null&&this.set(e)}var dm;Object.keys?dm=Object.keys:dm=function(e){var t,r=[];for(t in e)Xt(e,t)&&r.push(t);return r};var m9={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function b9(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return qn(n)?n.call(t,r):n}var w9={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function _9(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[e])}var S9="Invalid date";function C9(){return this._invalidDate}var O9="%d",R9=/\d{1,2}/;function E9(e){return this._ordinal.replace("%d",e)}var T9={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function k9(e,t,r,n){var o=this._relativeTime[r];return qn(o)?o(e,t,r,n):o.replace(/%d/i,e)}function A9(e,t){var r=this._relativeTime[e>0?"future":"past"];return qn(r)?r(t):r.replace(/%s/i,t)}var wu={};function Sr(e,t){var r=e.toLowerCase();wu[r]=wu[r+"s"]=wu[t]=e}function cn(e){return typeof e=="string"?wu[e]||wu[e.toLowerCase()]:void 0}function oO(e){var t={},r,n;for(n in e)Xt(e,n)&&(r=cn(n),r&&(t[r]=e[n]));return t}var cH={};function Cr(e,t){cH[e]=t}function I9(e){var t=[];for(var r in e)t.push({unit:r,priority:cH[r]});return t.sort(function(n,o){return n.priority-o.priority}),t}function Lo(e,t,r){var n=""+Math.abs(e),o=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var hH=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,uc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dg={},Ps={};function Ye(e,t,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),e&&(Ps[e]=o),t&&(Ps[t[0]]=function(){return Lo(o.apply(this,arguments),t[1],t[2])}),r&&(Ps[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function P9(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function M9(e){var t=e.match(hH),r,n;for(r=0,n=t.length;r<n;r++)Ps[t[r]]?t[r]=Ps[t[r]]:t[r]=P9(t[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=qn(t[a])?t[a].call(o,e):t[a];return i}}function nh(e,t){return e.isValid()?(t=dH(t,e.localeData()),dg[t]=dg[t]||M9(t),dg[t](e)):e.localeData().invalidDate()}function dH(e,t){var r=5;function n(o){return t.longDateFormat(o)||o}for(uc.lastIndex=0;r>=0&&uc.test(e);)e=e.replace(uc,n),uc.lastIndex=0,r-=1;return e}var vH=/\d/,qr=/\d\d/,pH=/\d{3}/,iO=/\d{4}/,bv=/[+-]?\d{6}/,Mt=/\d\d?/,gH=/\d\d\d\d?/,yH=/\d\d\d\d\d\d?/,wv=/\d{1,3}/,aO=/\d{1,4}/,_v=/[+-]?\d{1,6}/,$9=/\d+/,Sv=/[+-]?\d+/,D9=/Z|[+-]\d\d:?\d\d/gi,Cv=/Z|[+-]\d\d(?::?\d\d)?/gi,x9=/[+-]?\d+(\.\d{1,3})?/,Rf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vm={};function xe(e,t,r){vm[e]=qn(t)?t:function(n,o){return n&&r?r:t}}function N9(e,t){return Xt(vm,e)?vm[e](t._strict,t._locale):new RegExp(H9(e))}function H9(e){return Ta(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,o,i){return r||n||o||i}))}function Ta(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var pm={};function $t(e,t){var r,n=t;for(typeof e=="string"&&(e=[e]),Ma(t)&&(n=function(o,i){i[t]=ut(o)}),r=0;r<e.length;r++)pm[e[r]]=n}function Ef(e,t){$t(e,function(r,n,o,i){o._w=o._w||{},t(r,o._w,o,i)})}function L9(e,t,r){t!=null&&Xt(pm,e)&&pm[e](t,r._a,r,e)}var On=0,so=1,jn=2,ur=3,Cn=4,lo=5,ea=6,F9=7,j9=8;Ye("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e});Ye(0,["YY",2],0,function(){return this.year()%100});Ye(0,["YYYY",4],0,"year");Ye(0,["YYYYY",5],0,"year");Ye(0,["YYYYYY",6,!0],0,"year");Sr("year","y");Cr("year",1);xe("Y",Sv);xe("YY",Mt,qr);xe("YYYY",aO,iO);xe("YYYYY",_v,bv);xe("YYYYYY",_v,bv);$t(["YYYYY","YYYYYY"],On);$t("YYYY",function(e,t){t[On]=e.length===2?ve.parseTwoDigitYear(e):ut(e)});$t("YY",function(e,t){t[On]=ve.parseTwoDigitYear(e)});$t("Y",function(e,t){t[On]=parseInt(e,10)});function _u(e){return Ov(e)?366:365}function Ov(e){return e%4===0&&e%100!==0||e%400===0}ve.parseTwoDigitYear=function(e){return ut(e)+(ut(e)>68?1900:2e3)};var mH=Tl("FullYear",!0);function B9(){return Ov(this.year())}function Tl(e,t){return function(r){return r!=null?(bH(this,e,r),ve.updateOffset(this,t),this):jh(this,e)}}function jh(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function bH(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&Ov(e.year())&&e.month()===1&&e.date()===29?e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Rv(r,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function V9(e){return e=cn(e),qn(this[e])?this[e]():this}function W9(e,t){if(typeof e=="object"){e=oO(e);for(var r=I9(e),n=0;n<r.length;n++)this[r[n].unit](e[r[n].unit])}else if(e=cn(e),qn(this[e]))return this[e](t);return this}function U9(e,t){return(e%t+t)%t}var Gt;Array.prototype.indexOf?Gt=Array.prototype.indexOf:Gt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Rv(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=U9(t,12);return e+=(t-r)/12,r===1?Ov(e)?29:28:31-r%7%2}Ye("M",["MM",2],"Mo",function(){return this.month()+1});Ye("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Ye("MMMM",0,0,function(e){return this.localeData().months(this,e)});Sr("month","M");Cr("month",8);xe("M",Mt);xe("MM",Mt,qr);xe("MMM",function(e,t){return t.monthsShortRegex(e)});xe("MMMM",function(e,t){return t.monthsRegex(e)});$t(["M","MM"],function(e,t){t[so]=ut(e)-1});$t(["MMM","MMMM"],function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);o!=null?t[so]=o:lt(r).invalidMonth=e});var wH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,z9="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function Y9(e,t){return e?zn(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||wH).test(t)?"format":"standalone"][e.month()]:zn(this._months)?this._months:this._months.standalone}var _H="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function G9(e,t){return e?zn(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[wH.test(t)?"format":"standalone"][e.month()]:zn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function K9(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Xn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(o=Gt.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Gt.call(this._longMonthsParse,a),o!==-1?o:null):t==="MMM"?(o=Gt.call(this._shortMonthsParse,a),o!==-1?o:(o=Gt.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Gt.call(this._longMonthsParse,a),o!==-1?o:(o=Gt.call(this._shortMonthsParse,a),o!==-1?o:null))}function X9(e,t,r){var n,o,i;if(this._monthsParseExact)return K9.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=Xn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function SH(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=ut(t);else if(t=e.localeData().monthsParse(t),!Ma(t))return e}return r=Math.min(e.date(),Rv(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function CH(e){return e!=null?(SH(this,e),ve.updateOffset(this,!0),this):jh(this,"Month")}function q9(){return Rv(this.year(),this.month())}var Q9=Rf;function Z9(e){return this._monthsParseExact?(Xt(this,"_monthsRegex")||OH.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Xt(this,"_monthsShortRegex")||(this._monthsShortRegex=Q9),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}var J9=Rf;function eq(e){return this._monthsParseExact?(Xt(this,"_monthsRegex")||OH.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Xt(this,"_monthsRegex")||(this._monthsRegex=J9),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function OH(){function e(a,s){return s.length-a.length}var t=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Xn([2e3,o]),t.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(t.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)t[o]=Ta(t[o]),r[o]=Ta(r[o]);for(o=0;o<24;o++)n[o]=Ta(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function tq(e,t,r,n,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,o,i,a),s}function ju(e){var t;if(e<100&&e>=0){var r=Array.prototype.slice.call(arguments);r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Bh(e,t,r){var n=7+t-r,o=(7+ju(e,0,n).getUTCDay()-t)%7;return-o+n-1}function RH(e,t,r,n,o){var i=(7+r-n)%7,a=Bh(e,n,o),s=1+7*(t-1)+i+a,l,u;return s<=0?(l=e-1,u=_u(l)+s):s>_u(e)?(l=e+1,u=s-_u(e)):(l=e,u=s),{year:l,dayOfYear:u}}function Bu(e,t,r){var n=Bh(e.year(),t,r),o=Math.floor((e.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=e.year()-1,i=o+ka(a,t,r)):o>ka(e.year(),t,r)?(i=o-ka(e.year(),t,r),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function ka(e,t,r){var n=Bh(e,t,r),o=Bh(e+1,t,r);return(_u(e)-n+o)/7}Ye("w",["ww",2],"wo","week");Ye("W",["WW",2],"Wo","isoWeek");Sr("week","w");Sr("isoWeek","W");Cr("week",5);Cr("isoWeek",5);xe("w",Mt);xe("ww",Mt,qr);xe("W",Mt);xe("WW",Mt,qr);Ef(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=ut(e)});function rq(e){return Bu(e,this._week.dow,this._week.doy).week}var nq={dow:0,doy:6};function oq(){return this._week.dow}function iq(){return this._week.doy}function aq(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function sq(e){var t=Bu(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Ye("d",0,"do","day");Ye("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Ye("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Ye("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Ye("e",0,0,"weekday");Ye("E",0,0,"isoWeekday");Sr("day","d");Sr("weekday","e");Sr("isoWeekday","E");Cr("day",11);Cr("weekday",11);Cr("isoWeekday",11);xe("d",Mt);xe("e",Mt);xe("E",Mt);xe("dd",function(e,t){return t.weekdaysMinRegex(e)});xe("ddd",function(e,t){return t.weekdaysShortRegex(e)});xe("dddd",function(e,t){return t.weekdaysRegex(e)});Ef(["dd","ddd","dddd"],function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);o!=null?t.d=o:lt(r).invalidWeekday=e});Ef(["d","e","E"],function(e,t,r,n){t[n]=ut(e)});function lq(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function uq(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function sO(e,t){return e.slice(t,7).concat(e.slice(0,t))}var fq="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function cq(e,t){var r=zn(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?sO(r,this._week.dow):e?r[e.day()]:r}var EH="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function hq(e){return e===!0?sO(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var dq="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function vq(e){return e===!0?sO(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function pq(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Xn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(o=Gt.call(this._weekdaysParse,a),o!==-1?o:null):t==="ddd"?(o=Gt.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Gt.call(this._minWeekdaysParse,a),o!==-1?o:null):t==="dddd"?(o=Gt.call(this._weekdaysParse,a),o!==-1||(o=Gt.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Gt.call(this._minWeekdaysParse,a),o!==-1?o:null)):t==="ddd"?(o=Gt.call(this._shortWeekdaysParse,a),o!==-1||(o=Gt.call(this._weekdaysParse,a),o!==-1)?o:(o=Gt.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Gt.call(this._minWeekdaysParse,a),o!==-1||(o=Gt.call(this._weekdaysParse,a),o!==-1)?o:(o=Gt.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function gq(e,t,r){var n,o,i;if(this._weekdaysParseExact)return pq.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=Xn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function yq(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=lq(e,this.localeData()),this.add(e-t,"d")):t}function mq(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function bq(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=uq(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}var wq=Rf;function _q(e){return this._weekdaysParseExact?(Xt(this,"_weekdaysRegex")||lO.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Xt(this,"_weekdaysRegex")||(this._weekdaysRegex=wq),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var Sq=Rf;function Cq(e){return this._weekdaysParseExact?(Xt(this,"_weekdaysRegex")||lO.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Xt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Sq),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var Oq=Rf;function Rq(e){return this._weekdaysParseExact?(Xt(this,"_weekdaysRegex")||lO.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Xt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Oq),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function lO(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],o=[],i,a,s,l,u;for(i=0;i<7;i++)a=Xn([2e3,1]).day(i),s=this.weekdaysMin(a,""),l=this.weekdaysShort(a,""),u=this.weekdays(a,""),t.push(s),r.push(l),n.push(u),o.push(s),o.push(l),o.push(u);for(t.sort(e),r.sort(e),n.sort(e),o.sort(e),i=0;i<7;i++)r[i]=Ta(r[i]),n[i]=Ta(n[i]),o[i]=Ta(o[i]);this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function uO(){return this.hours()%12||12}function Eq(){return this.hours()||24}Ye("H",["HH",2],0,"hour");Ye("h",["hh",2],0,uO);Ye("k",["kk",2],0,Eq);Ye("hmm",0,0,function(){return""+uO.apply(this)+Lo(this.minutes(),2)});Ye("hmmss",0,0,function(){return""+uO.apply(this)+Lo(this.minutes(),2)+Lo(this.seconds(),2)});Ye("Hmm",0,0,function(){return""+this.hours()+Lo(this.minutes(),2)});Ye("Hmmss",0,0,function(){return""+this.hours()+Lo(this.minutes(),2)+Lo(this.seconds(),2)});function TH(e,t){Ye(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}TH("a",!0);TH("A",!1);Sr("hour","h");Cr("hour",13);function kH(e,t){return t._meridiemParse}xe("a",kH);xe("A",kH);xe("H",Mt);xe("h",Mt);xe("k",Mt);xe("HH",Mt,qr);xe("hh",Mt,qr);xe("kk",Mt,qr);xe("hmm",gH);xe("hmmss",yH);xe("Hmm",gH);xe("Hmmss",yH);$t(["H","HH"],ur);$t(["k","kk"],function(e,t,r){var n=ut(e);t[ur]=n===24?0:n});$t(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});$t(["h","hh"],function(e,t,r){t[ur]=ut(e),lt(r).bigHour=!0});$t("hmm",function(e,t,r){var n=e.length-2;t[ur]=ut(e.substr(0,n)),t[Cn]=ut(e.substr(n)),lt(r).bigHour=!0});$t("hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[ur]=ut(e.substr(0,n)),t[Cn]=ut(e.substr(n,2)),t[lo]=ut(e.substr(o)),lt(r).bigHour=!0});$t("Hmm",function(e,t,r){var n=e.length-2;t[ur]=ut(e.substr(0,n)),t[Cn]=ut(e.substr(n))});$t("Hmmss",function(e,t,r){var n=e.length-4,o=e.length-2;t[ur]=ut(e.substr(0,n)),t[Cn]=ut(e.substr(n,2)),t[lo]=ut(e.substr(o))});function Tq(e){return(e+"").toLowerCase().charAt(0)==="p"}var kq=/[ap]\.?m?\.?/i;function Aq(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Iq=Tl("Hours",!0),AH={calendar:m9,longDateFormat:w9,invalidDate:S9,ordinal:O9,dayOfMonthOrdinalParse:R9,relativeTime:T9,months:z9,monthsShort:_H,week:nq,weekdays:fq,weekdaysMin:dq,weekdaysShort:EH,meridiemParse:kq},lr={},Gl={},Vu;function Ck(e){return e&&e.toLowerCase().replace("_","-")}function Pq(e){for(var t=0,r,n,o,i;t<e.length;){for(i=Ck(e[t]).split("-"),r=i.length,n=Ck(e[t+1]),n=n?n.split("-"):null;r>0;){if(o=Ev(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&sH(i,n,!0)>=r-1)break;r--}t++}return Vu}function Ev(e){var t=null;if(!lr[e]&&typeof module!="undefined"&&module&&module.exports)try{t=Vu._abbr;var r=require;r("./locale/"+e),kl(t)}catch{}return lr[e]}function kl(e,t){var r;return e&&(Dr(t)?r=Pi(e):r=fO(e,t),r?Vu=r:typeof console!="undefined"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Vu._abbr}function fO(e,t){if(t!==null){var r,n=AH;if(t.abbr=e,lr[e]!=null)uH("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=lr[e]._config;else if(t.parentLocale!=null)if(lr[t.parentLocale]!=null)n=lr[t.parentLocale]._config;else if(r=Ev(t.parentLocale),r!=null)n=r._config;else return Gl[t.parentLocale]||(Gl[t.parentLocale]=[]),Gl[t.parentLocale].push({name:e,config:t}),null;return lr[e]=new nO(fH(n,t)),Gl[e]&&Gl[e].forEach(function(o){fO(o.name,o.config)}),kl(e),lr[e]}else return delete lr[e],null}function Mq(e,t){if(t!=null){var r,n,o=AH;n=Ev(e),n!=null&&(o=n._config),t=fH(o,t),r=new nO(t),r.parentLocale=lr[e],lr[e]=r,kl(e)}else lr[e]!=null&&(lr[e].parentLocale!=null?lr[e]=lr[e].parentLocale:lr[e]!=null&&delete lr[e]);return lr[e]}function Pi(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Vu;if(!zn(e)){if(t=Ev(e),t)return t;e=[e]}return Pq(e)}function $q(){return dm(lr)}function cO(e){var t,r=e._a;return r&&lt(e).overflow===-2&&(t=r[so]<0||r[so]>11?so:r[jn]<1||r[jn]>Rv(r[On],r[so])?jn:r[ur]<0||r[ur]>24||r[ur]===24&&(r[Cn]!==0||r[lo]!==0||r[ea]!==0)?ur:r[Cn]<0||r[Cn]>59?Cn:r[lo]<0||r[lo]>59?lo:r[ea]<0||r[ea]>999?ea:-1,lt(e)._overflowDayOfYear&&(t<On||t>jn)&&(t=jn),lt(e)._overflowWeeks&&t===-1&&(t=F9),lt(e)._overflowWeekday&&t===-1&&(t=j9),lt(e).overflow=t),e}function Rs(e,t,r){return e!=null?e:t!=null?t:r}function Dq(e){var t=new Date(ve.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function hO(e){var t,r,n=[],o,i,a;if(!e._d){for(o=Dq(e),e._w&&e._a[jn]==null&&e._a[so]==null&&xq(e),e._dayOfYear!=null&&(a=Rs(e._a[On],o[On]),(e._dayOfYear>_u(a)||e._dayOfYear===0)&&(lt(e)._overflowDayOfYear=!0),r=ju(a,0,e._dayOfYear),e._a[so]=r.getUTCMonth(),e._a[jn]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=o[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[ur]===24&&e._a[Cn]===0&&e._a[lo]===0&&e._a[ea]===0&&(e._nextDay=!0,e._a[ur]=0),e._d=(e._useUTC?ju:tq).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ur]=24),e._w&&typeof e._w.d!="undefined"&&e._w.d!==i&&(lt(e).weekdayMismatch=!0)}}function xq(e){var t,r,n,o,i,a,s,l;if(t=e._w,t.GG!=null||t.W!=null||t.E!=null)i=1,a=4,r=Rs(t.GG,e._a[On],Bu(Pt(),1,4).year),n=Rs(t.W,1),o=Rs(t.E,1),(o<1||o>7)&&(l=!0);else{i=e._locale._week.dow,a=e._locale._week.doy;var u=Bu(Pt(),i,a);r=Rs(t.gg,e._a[On],u.year),n=Rs(t.w,u.week),t.d!=null?(o=t.d,(o<0||o>6)&&(l=!0)):t.e!=null?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i}n<1||n>ka(r,i,a)?lt(e)._overflowWeeks=!0:l!=null?lt(e)._overflowWeekday=!0:(s=RH(r,n,o,i,a),e._a[On]=s.year,e._dayOfYear=s.dayOfYear)}var Nq=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hq=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lq=/Z|[+-]\d\d(?::?\d\d)?/,fc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],vg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Fq=/^\/?Date\((\-?\d+)/i;function IH(e){var t,r,n=e._i,o=Nq.exec(n)||Hq.exec(n),i,a,s,l;if(o){for(lt(e).iso=!0,t=0,r=fc.length;t<r;t++)if(fc[t][1].exec(o[1])){a=fc[t][0],i=fc[t][2]!==!1;break}if(a==null){e._isValid=!1;return}if(o[3]){for(t=0,r=vg.length;t<r;t++)if(vg[t][1].exec(o[3])){s=(o[2]||" ")+vg[t][0];break}if(s==null){e._isValid=!1;return}}if(!i&&s!=null){e._isValid=!1;return}if(o[4])if(Lq.exec(o[4]))l="Z";else{e._isValid=!1;return}e._f=a+(s||"")+(l||""),dO(e)}else e._isValid=!1}var jq=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Bq(e,t,r,n,o,i){var a=[Vq(e),_H.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function Vq(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Wq(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Uq(e,t,r){if(e){var n=EH.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(n!==o)return lt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}var zq={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Yq(e,t,r){if(e)return zq[e];if(t)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function PH(e){var t=jq.exec(Wq(e._i));if(t){var r=Bq(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Uq(t[1],r,e))return;e._a=r,e._tzm=Yq(t[8],t[9],t[10]),e._d=ju.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),lt(e).rfc2822=!0}else e._isValid=!1}function Gq(e){var t=Fq.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(IH(e),e._isValid===!1)delete e._isValid;else return;if(PH(e),e._isValid===!1)delete e._isValid;else return;ve.createFromInputFallback(e)}ve.createFromInputFallback=fn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});ve.ISO_8601=function(){};ve.RFC_2822=function(){};function dO(e){if(e._f===ve.ISO_8601){IH(e);return}if(e._f===ve.RFC_2822){PH(e);return}e._a=[],lt(e).empty=!0;var t=""+e._i,r,n,o,i,a,s=t.length,l=0;for(o=dH(e._f,e._locale).match(hH)||[],r=0;r<o.length;r++)i=o[r],n=(t.match(N9(i,e))||[])[0],n&&(a=t.substr(0,t.indexOf(n)),a.length>0&&lt(e).unusedInput.push(a),t=t.slice(t.indexOf(n)+n.length),l+=n.length),Ps[i]?(n?lt(e).empty=!1:lt(e).unusedTokens.push(i),L9(i,n,e)):e._strict&&!n&&lt(e).unusedTokens.push(i);lt(e).charsLeftOver=s-l,t.length>0&&lt(e).unusedInput.push(t),e._a[ur]<=12&&lt(e).bigHour===!0&&e._a[ur]>0&&(lt(e).bigHour=void 0),lt(e).parsedDateParts=e._a.slice(0),lt(e).meridiem=e._meridiem,e._a[ur]=Kq(e._locale,e._a[ur],e._meridiem),hO(e),cO(e)}function Kq(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function Xq(e){var t,r,n,o,i;if(e._f.length===0){lt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(o=0;o<e._f.length;o++)i=0,t=rO({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[o],dO(t),tO(t)&&(i+=lt(t).charsLeftOver,i+=lt(t).unusedTokens.length*10,lt(t).score=i,(n==null||i<n)&&(n=i,r=t));si(e,r||t)}function qq(e){if(!e._d){var t=oO(e._i);e._a=aH([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(r){return r&&parseInt(r,10)}),hO(e)}}function Qq(e){var t=new Of(cO(MH(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function MH(e){var t=e._i,r=e._f;return e._locale=e._locale||Pi(e._l),t===null||r===void 0&&t===""?mv({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),Yn(t)?new Of(cO(t)):(yv(t)?e._d=t:zn(r)?Xq(e):r?dO(e):Zq(e),tO(e)||(e._d=null),e))}function Zq(e){var t=e._i;Dr(t)?e._d=new Date(ve.now()):yv(t)?e._d=new Date(t.valueOf()):typeof t=="string"?Gq(e):zn(t)?(e._a=aH(t.slice(0),function(r){return parseInt(r,10)}),hO(e)):bu(t)?qq(e):Ma(t)?e._d=new Date(t):ve.createFromInputFallback(e)}function $H(e,t,r,n,o){var i={};return(r===!0||r===!1)&&(n=r,r=void 0),(bu(e)&&p9(e)||zn(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=e,i._f=t,i._strict=n,Qq(i)}function Pt(e,t,r,n){return $H(e,t,r,n,!1)}var Jq=fn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Pt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:mv()}),eQ=fn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Pt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:mv()});function DH(e,t){var r,n;if(t.length===1&&zn(t[0])&&(t=t[0]),!t.length)return Pt();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function tQ(){var e=[].slice.call(arguments,0);return DH("isBefore",e)}function rQ(){var e=[].slice.call(arguments,0);return DH("isAfter",e)}var nQ=function(){return Date.now?Date.now():+new Date},Kl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function oQ(e){for(var t in e)if(!(Gt.call(Kl,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(var r=!1,n=0;n<Kl.length;++n)if(e[Kl[n]]){if(r)return!1;parseFloat(e[Kl[n]])!==ut(e[Kl[n]])&&(r=!0)}return!0}function iQ(){return this._isValid}function aQ(){return En(NaN)}function Tv(e){var t=oO(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=oQ(t),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Pi(),this._bubble()}function gm(e){return e instanceof Tv}function ym(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function xH(e,t){Ye(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Lo(~~(r/60),2)+t+Lo(~~r%60,2)})}xH("Z",":");xH("ZZ","");xe("Z",Cv);xe("ZZ",Cv);$t(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=vO(Cv,e)});var sQ=/([\+\-]|\d\d)/gi;function vO(e,t){var r=(t||"").match(e);if(r===null)return null;var n=r[r.length-1]||[],o=(n+"").match(sQ)||["-",0,0],i=+(o[1]*60)+ut(o[2]);return i===0?0:o[0]==="+"?i:-i}function pO(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(Yn(e)||yv(e)?e.valueOf():Pt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ve.updateOffset(r,!1),r):Pt(e).local()}function mm(e){return-Math.round(e._d.getTimezoneOffset()/15)*15}ve.updateOffset=function(){};function lQ(e,t,r){var n=this._offset||0,o;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=vO(Cv,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(o=mm(this)),this._offset=e,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?LH(this,En(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ve.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:mm(this)}function uQ(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function fQ(e){return this.utcOffset(0,e)}function cQ(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(mm(this),"m")),this}function hQ(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=vO(D9,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function dQ(e){return this.isValid()?(e=e?Pt(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function vQ(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pQ(){if(!Dr(this._isDSTShifted))return this._isDSTShifted;var e={};if(rO(e,this),e=MH(e),e._a){var t=e._isUTC?Xn(e._a):Pt(e._a);this._isDSTShifted=this.isValid()&&sH(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function gQ(){return this.isValid()?!this._isUTC:!1}function yQ(){return this.isValid()?this._isUTC:!1}function NH(){return this.isValid()?this._isUTC&&this._offset===0:!1}var mQ=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,bQ=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function En(e,t){var r=e,n=null,o,i,a;return gm(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Ma(e)?(r={},t?r[t]=e:r.milliseconds=e):(n=mQ.exec(e))?(o=n[1]==="-"?-1:1,r={y:0,d:ut(n[jn])*o,h:ut(n[ur])*o,m:ut(n[Cn])*o,s:ut(n[lo])*o,ms:ut(ym(n[ea]*1e3))*o}):(n=bQ.exec(e))?(o=n[1]==="-"?-1:1,r={y:ji(n[2],o),M:ji(n[3],o),w:ji(n[4],o),d:ji(n[5],o),h:ji(n[6],o),m:ji(n[7],o),s:ji(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=wQ(Pt(r.from),Pt(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Tv(r),gm(e)&&Xt(e,"_locale")&&(i._locale=e._locale),i}En.fn=Tv.prototype;En.invalid=aQ;function ji(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function Ok(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function wQ(e,t){var r;return e.isValid()&&t.isValid()?(t=pO(t,e),e.isBefore(t)?r=Ok(e,t):(r=Ok(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function HH(e,t){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(uH(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),r=typeof r=="string"?+r:r,o=En(r,n),LH(this,o,e),this}}function LH(e,t,r,n){var o=t._milliseconds,i=ym(t._days),a=ym(t._months);!e.isValid()||(n=n==null?!0:n,a&&SH(e,jh(e,"Month")+a*r),i&&bH(e,"Date",jh(e,"Date")+i*r),o&&e._d.setTime(e._d.valueOf()+o*r),n&&ve.updateOffset(e,i||a))}var _Q=HH(1,"add"),SQ=HH(-1,"subtract");function CQ(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function OQ(e,t){var r=e||Pt(),n=pO(r,this).startOf("day"),o=ve.calendarFormat(this,n)||"sameElse",i=t&&(qn(t[o])?t[o].call(this,r):t[o]);return this.format(i||this.localeData().calendar(o,this,Pt(r)))}function RQ(){return new Of(this)}function EQ(e,t){var r=Yn(e)?e:Pt(e);return this.isValid()&&r.isValid()?(t=cn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function TQ(e,t){var r=Yn(e)?e:Pt(e);return this.isValid()&&r.isValid()?(t=cn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function kQ(e,t,r,n){var o=Yn(e)?e:Pt(e),i=Yn(t)?t:Pt(t);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function AQ(e,t){var r=Yn(e)?e:Pt(e),n;return this.isValid()&&r.isValid()?(t=cn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function IQ(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function PQ(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function MQ(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(n=pO(e,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,t=cn(t),t){case"year":i=pg(this,n)/12;break;case"month":i=pg(this,n);break;case"quarter":i=pg(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:rn(i)}function pg(e,t){var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),o,i;return t-n<0?(o=e.clone().add(r-1,"months"),i=(t-n)/(n-o)):(o=e.clone().add(r+1,"months"),i=(t-n)/(o-n)),-(r+i)||0}ve.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ve.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function $Q(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function DQ(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?nh(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):qn(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",nh(r,"Z")):nh(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function xQ(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z");var r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]';return this.format(r+n+o+i)}function NQ(e){e||(e=this.isUtc()?ve.defaultFormatUtc:ve.defaultFormat);var t=nh(this,e);return this.localeData().postformat(t)}function HQ(e,t){return this.isValid()&&(Yn(e)&&e.isValid()||Pt(e).isValid())?En({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function LQ(e){return this.from(Pt(),e)}function FQ(e,t){return this.isValid()&&(Yn(e)&&e.isValid()||Pt(e).isValid())?En({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function jQ(e){return this.to(Pt(),e)}function FH(e){var t;return e===void 0?this._locale._abbr:(t=Pi(e),t!=null&&(this._locale=t),this)}var jH=fn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function BH(){return this._locale}var Vh=1e3,Ms=60*Vh,Wh=60*Ms,VH=(365*400+97)*24*Wh;function $s(e,t){return(e%t+t)%t}function WH(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-VH:new Date(e,t,r).valueOf()}function UH(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-VH:Date.UTC(e,t,r)}function BQ(e){var t;if(e=cn(e),e===void 0||e==="millisecond"||!this.isValid())return this;var r=this._isUTC?UH:WH;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=$s(t+(this._isUTC?0:this.utcOffset()*Ms),Wh);break;case"minute":t=this._d.valueOf(),t-=$s(t,Ms);break;case"second":t=this._d.valueOf(),t-=$s(t,Vh);break}return this._d.setTime(t),ve.updateOffset(this,!0),this}function VQ(e){var t;if(e=cn(e),e===void 0||e==="millisecond"||!this.isValid())return this;var r=this._isUTC?UH:WH;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Wh-$s(t+(this._isUTC?0:this.utcOffset()*Ms),Wh)-1;break;case"minute":t=this._d.valueOf(),t+=Ms-$s(t,Ms)-1;break;case"second":t=this._d.valueOf(),t+=Vh-$s(t,Vh)-1;break}return this._d.setTime(t),ve.updateOffset(this,!0),this}function WQ(){return this._d.valueOf()-(this._offset||0)*6e4}function UQ(){return Math.floor(this.valueOf()/1e3)}function zQ(){return new Date(this.valueOf())}function YQ(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function GQ(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function KQ(){return this.isValid()?this.toISOString():null}function XQ(){return tO(this)}function qQ(){return si({},lt(this))}function QQ(){return lt(this).overflow}function ZQ(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ye(0,["gg",2],0,function(){return this.weekYear()%100});Ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function kv(e,t){Ye(0,[e,e.length],0,t)}kv("gggg","weekYear");kv("ggggg","weekYear");kv("GGGG","isoWeekYear");kv("GGGGG","isoWeekYear");Sr("weekYear","gg");Sr("isoWeekYear","GG");Cr("weekYear",1);Cr("isoWeekYear",1);xe("G",Sv);xe("g",Sv);xe("GG",Mt,qr);xe("gg",Mt,qr);xe("GGGG",aO,iO);xe("gggg",aO,iO);xe("GGGGG",_v,bv);xe("ggggg",_v,bv);Ef(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=ut(e)});Ef(["gg","GG"],function(e,t,r,n){t[n]=ve.parseTwoDigitYear(e)});function JQ(e){return zH.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function eZ(e){return zH.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function tZ(){return ka(this.year(),1,4)}function rZ(){var e=this.localeData()._week;return ka(this.year(),e.dow,e.doy)}function zH(e,t,r,n,o){var i;return e==null?Bu(this,n,o).year:(i=ka(e,n,o),t>i&&(t=i),nZ.call(this,e,t,r,n,o))}function nZ(e,t,r,n,o){var i=RH(e,t,r,n,o),a=ju(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Ye("Q",0,"Qo","quarter");Sr("quarter","Q");Cr("quarter",7);xe("Q",vH);$t("Q",function(e,t){t[so]=(ut(e)-1)*3});function oZ(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Ye("D",["DD",2],"Do","date");Sr("date","D");Cr("date",9);xe("D",Mt);xe("DD",Mt,qr);xe("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});$t(["D","DD"],jn);$t("Do",function(e,t){t[jn]=ut(e.match(Mt)[0])});var YH=Tl("Date",!0);Ye("DDD",["DDDD",3],"DDDo","dayOfYear");Sr("dayOfYear","DDD");Cr("dayOfYear",4);xe("DDD",wv);xe("DDDD",pH);$t(["DDD","DDDD"],function(e,t,r){r._dayOfYear=ut(e)});function iZ(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Ye("m",["mm",2],0,"minute");Sr("minute","m");Cr("minute",14);xe("m",Mt);xe("mm",Mt,qr);$t(["m","mm"],Cn);var aZ=Tl("Minutes",!1);Ye("s",["ss",2],0,"second");Sr("second","s");Cr("second",15);xe("s",Mt);xe("ss",Mt,qr);$t(["s","ss"],lo);var sZ=Tl("Seconds",!1);Ye("S",0,0,function(){return~~(this.millisecond()/100)});Ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ye(0,["SSS",3],0,"millisecond");Ye(0,["SSSS",4],0,function(){return this.millisecond()*10});Ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Sr("millisecond","ms");Cr("millisecond",16);xe("S",wv,vH);xe("SS",wv,qr);xe("SSS",wv,pH);var li;for(li="SSSS";li.length<=9;li+="S")xe(li,$9);function lZ(e,t){t[ea]=ut(("0."+e)*1e3)}for(li="S";li.length<=9;li+="S")$t(li,lZ);var uZ=Tl("Milliseconds",!1);Ye("z",0,0,"zoneAbbr");Ye("zz",0,0,"zoneName");function fZ(){return this._isUTC?"UTC":""}function cZ(){return this._isUTC?"Coordinated Universal Time":""}var be=Of.prototype;be.add=_Q;be.calendar=OQ;be.clone=RQ;be.diff=MQ;be.endOf=VQ;be.format=NQ;be.from=HQ;be.fromNow=LQ;be.to=FQ;be.toNow=jQ;be.get=V9;be.invalidAt=QQ;be.isAfter=EQ;be.isBefore=TQ;be.isBetween=kQ;be.isSame=AQ;be.isSameOrAfter=IQ;be.isSameOrBefore=PQ;be.isValid=XQ;be.lang=jH;be.locale=FH;be.localeData=BH;be.max=eQ;be.min=Jq;be.parsingFlags=qQ;be.set=W9;be.startOf=BQ;be.subtract=SQ;be.toArray=YQ;be.toObject=GQ;be.toDate=zQ;be.toISOString=DQ;be.inspect=xQ;be.toJSON=KQ;be.toString=$Q;be.unix=UQ;be.valueOf=WQ;be.creationData=ZQ;be.year=mH;be.isLeapYear=B9;be.weekYear=JQ;be.isoWeekYear=eZ;be.quarter=be.quarters=oZ;be.month=CH;be.daysInMonth=q9;be.week=be.weeks=aq;be.isoWeek=be.isoWeeks=sq;be.weeksInYear=rZ;be.isoWeeksInYear=tZ;be.date=YH;be.day=be.days=yq;be.weekday=mq;be.isoWeekday=bq;be.dayOfYear=iZ;be.hour=be.hours=Iq;be.minute=be.minutes=aZ;be.second=be.seconds=sZ;be.millisecond=be.milliseconds=uZ;be.utcOffset=lQ;be.utc=fQ;be.local=cQ;be.parseZone=hQ;be.hasAlignedHourOffset=dQ;be.isDST=vQ;be.isLocal=gQ;be.isUtcOffset=yQ;be.isUtc=NH;be.isUTC=NH;be.zoneAbbr=fZ;be.zoneName=cZ;be.dates=fn("dates accessor is deprecated. Use date instead.",YH);be.months=fn("months accessor is deprecated. Use month instead",CH);be.years=fn("years accessor is deprecated. Use year instead",mH);be.zone=fn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",uQ);be.isDSTShifted=fn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pQ);function hZ(e){return Pt(e*1e3)}function dZ(){return Pt.apply(null,arguments).parseZone()}function GH(e){return e}var Et=nO.prototype;Et.calendar=b9;Et.longDateFormat=_9;Et.invalidDate=C9;Et.ordinal=E9;Et.preparse=GH;Et.postformat=GH;Et.relativeTime=k9;Et.pastFuture=A9;Et.set=y9;Et.months=Y9;Et.monthsShort=G9;Et.monthsParse=X9;Et.monthsRegex=eq;Et.monthsShortRegex=Z9;Et.week=rq;Et.firstDayOfYear=iq;Et.firstDayOfWeek=oq;Et.weekdays=cq;Et.weekdaysMin=vq;Et.weekdaysShort=hq;Et.weekdaysParse=gq;Et.weekdaysRegex=_q;Et.weekdaysShortRegex=Cq;Et.weekdaysMinRegex=Rq;Et.isPM=Tq;Et.meridiem=Aq;function Uh(e,t,r,n){var o=Pi(),i=Xn().set(n,t);return o[r](i,e)}function KH(e,t,r){if(Ma(e)&&(t=e,e=void 0),e=e||"",t!=null)return Uh(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Uh(e,n,r,"month");return o}function gO(e,t,r,n){typeof e=="boolean"?(Ma(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Ma(t)&&(r=t,t=void 0),t=t||"");var o=Pi(),i=e?o._week.dow:0;if(r!=null)return Uh(t,(r+i)%7,n,"day");var a,s=[];for(a=0;a<7;a++)s[a]=Uh(t,(a+i)%7,n,"day");return s}function vZ(e,t){return KH(e,t,"months")}function pZ(e,t){return KH(e,t,"monthsShort")}function gZ(e,t,r){return gO(e,t,r,"weekdays")}function yZ(e,t,r){return gO(e,t,r,"weekdaysShort")}function mZ(e,t,r){return gO(e,t,r,"weekdaysMin")}kl("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=ut(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ve.lang=fn("moment.lang is deprecated. Use moment.locale instead.",kl);ve.langData=fn("moment.langData is deprecated. Use moment.localeData instead.",Pi);var Qn=Math.abs;function bZ(){var e=this._data;return this._milliseconds=Qn(this._milliseconds),this._days=Qn(this._days),this._months=Qn(this._months),e.milliseconds=Qn(e.milliseconds),e.seconds=Qn(e.seconds),e.minutes=Qn(e.minutes),e.hours=Qn(e.hours),e.months=Qn(e.months),e.years=Qn(e.years),this}function XH(e,t,r,n){var o=En(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function wZ(e,t){return XH(this,e,t,1)}function _Z(e,t){return XH(this,e,t,-1)}function Rk(e){return e<0?Math.floor(e):Math.ceil(e)}function SZ(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,o,i,a,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=Rk(bm(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,o=rn(e/1e3),n.seconds=o%60,i=rn(o/60),n.minutes=i%60,a=rn(i/60),n.hours=a%24,t+=rn(a/24),l=rn(qH(t)),r+=l,t-=Rk(bm(l)),s=rn(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function qH(e){return e*4800/146097}function bm(e){return e*146097/4800}function CZ(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=cn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+qH(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(bm(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function OZ(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+ut(this._months/12)*31536e6:NaN}function Vo(e){return function(){return this.as(e)}}var RZ=Vo("ms"),EZ=Vo("s"),TZ=Vo("m"),kZ=Vo("h"),AZ=Vo("d"),IZ=Vo("w"),PZ=Vo("M"),MZ=Vo("Q"),$Z=Vo("y");function DZ(){return En(this)}function xZ(e){return e=cn(e),this.isValid()?this[e+"s"]():NaN}function za(e){return function(){return this.isValid()?this._data[e]:NaN}}var NZ=za("milliseconds"),HZ=za("seconds"),LZ=za("minutes"),FZ=za("hours"),jZ=za("days"),BZ=za("months"),VZ=za("years");function WZ(){return rn(this.days()/7)}var ei=Math.round,Fn={ss:44,s:45,m:45,h:22,d:26,M:11};function UZ(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function zZ(e,t,r){var n=En(e).abs(),o=ei(n.as("s")),i=ei(n.as("m")),a=ei(n.as("h")),s=ei(n.as("d")),l=ei(n.as("M")),u=ei(n.as("y")),f=o<=Fn.ss&&["s",o]||o<Fn.s&&["ss",o]||i<=1&&["m"]||i<Fn.m&&["mm",i]||a<=1&&["h"]||a<Fn.h&&["hh",a]||s<=1&&["d"]||s<Fn.d&&["dd",s]||l<=1&&["M"]||l<Fn.M&&["MM",l]||u<=1&&["y"]||["yy",u];return f[2]=t,f[3]=+e>0,f[4]=r,UZ.apply(null,f)}function YZ(e){return e===void 0?ei:typeof e=="function"?(ei=e,!0):!1}function GZ(e,t){return Fn[e]===void 0?!1:t===void 0?Fn[e]:(Fn[e]=t,e==="s"&&(Fn.ss=t-1),!0)}function KZ(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),r=zZ(this,!e,t);return e&&(r=t.pastFuture(+this,r)),t.postformat(r)}var gg=Math.abs;function as(e){return(e>0)-(e<0)||+e}function Av(){if(!this.isValid())return this.localeData().invalidDate();var e=gg(this._milliseconds)/1e3,t=gg(this._days),r=gg(this._months),n,o,i;n=rn(e/60),o=rn(n/60),e%=60,n%=60,i=rn(r/12),r%=12;var a=i,s=r,l=t,u=o,f=n,c=e?e.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var d=h<0?"-":"",v=as(this._months)!==as(h)?"-":"",p=as(this._days)!==as(h)?"-":"",b=as(this._milliseconds)!==as(h)?"-":"";return d+"P"+(a?v+a+"Y":"")+(s?v+s+"M":"")+(l?p+l+"D":"")+(u||f||c?"T":"")+(u?b+u+"H":"")+(f?b+f+"M":"")+(c?b+c+"S":"")}var dt=Tv.prototype;dt.isValid=iQ;dt.abs=bZ;dt.add=wZ;dt.subtract=_Z;dt.as=CZ;dt.asMilliseconds=RZ;dt.asSeconds=EZ;dt.asMinutes=TZ;dt.asHours=kZ;dt.asDays=AZ;dt.asWeeks=IZ;dt.asMonths=PZ;dt.asQuarters=MZ;dt.asYears=$Z;dt.valueOf=OZ;dt._bubble=SZ;dt.clone=DZ;dt.get=xZ;dt.milliseconds=NZ;dt.seconds=HZ;dt.minutes=LZ;dt.hours=FZ;dt.days=jZ;dt.weeks=WZ;dt.months=BZ;dt.years=VZ;dt.humanize=KZ;dt.toISOString=Av;dt.toString=Av;dt.toJSON=Av;dt.locale=FH;dt.localeData=BH;dt.toIsoString=fn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Av);dt.lang=jH;Ye("X",0,0,"unix");Ye("x",0,0,"valueOf");xe("x",Sv);xe("X",x9);$t("X",function(e,t,r){r._d=new Date(parseFloat(e,10)*1e3)});$t("x",function(e,t,r){r._d=new Date(ut(e))});//! moment.js
ve.version="2.24.0";v9(Pt);ve.fn=be;ve.min=tQ;ve.max=rQ;ve.now=nQ;ve.utc=Xn;ve.unix=hZ;ve.months=vZ;ve.isDate=yv;ve.locale=kl;ve.invalid=mv;ve.duration=En;ve.isMoment=Yn;ve.weekdays=gZ;ve.parseZone=dZ;ve.localeData=Pi;ve.isDuration=gm;ve.monthsShort=pZ;ve.weekdaysMin=mZ;ve.defineLocale=fO;ve.updateLocale=Mq;ve.locales=$q;ve.weekdaysShort=yZ;ve.normalizeUnits=cn;ve.relativeTimeRounding=YZ;ve.relativeTimeThreshold=GZ;ve.calendarFormat=CQ;ve.prototype=be;ve.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Rt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=zt(e,function(i,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return i+l+u},"");return o.trim()}var Ek,Tk,kk,Ak,Ik,Pk;function Ds(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function wm(e){return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wm(e)}function jt(e){var t;switch(wm(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function He(e){return typeof e!="undefined"}function It(e){return typeof e=="undefined"}function or(e){return e===null||e===""||It(e)}function QH(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var du="length",Su=function(t){return parseInt(t,16)},Mk=function(t){return parseInt(t,10)},zh=function(t,r,n){return t.substr(r,n)},Cu=function(t){return t.codePointAt(0)-65},_m=function(t){return"".concat(t).replace(/\-/g,"")},XZ=function(t){return Su(zh(_m(t),Su("12"),Cu("F")))/(Su(zh(_m(t),Cu("B"),~~![][du]))||9)},qZ=function(){return typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},$k=!1,Dk={invalid:function(){return Rt(Ek||(Ek=Ds([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Rt(Tk||(Tk=Ds([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Rt(kk||(kk=Ds([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},xk={invalid:function(){return Rt(Ak||(Ak=Ds([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Rt(Ik||(Ik=Ds([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Rt(Pk||(Pk=Ds([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function ZH(e,t){var r=!or(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="11.1.0",i,a="invalid",s="invalid";e=_m(e||"");var l=QZ(e);if(r||n||l)if(l){var u=ve("13/01/2022","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=XZ(e);if(i=ve((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c){var h=ve().diff(u,"days");a=h<=1?"valid":"expired",s=h<=15?"valid":"expired"}else a="valid",s="valid"}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(qZ()&&(a="valid",s="valid"),!$k&&a!=="valid"){var d=Dk[a]({keyValidityDate:i,hotVersion:o});d&&console[a==="non_commercial"?"info":"warn"](Dk[a]({keyValidityDate:i,hotVersion:o})),$k=!0}if(s!=="valid"&&t.parentNode){var v=xk[s]({keyValidityDate:i,hotVersion:o});if(v){var p=document.createElement("div");p.id="hot-display-license-info",p.innerHTML=xk[s]({keyValidityDate:i,hotVersion:o}),t.parentNode.insertBefore(p,t.nextSibling)}}}function QZ(e){var t=[][du],r=t;if(e[du]!==Cu("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=Cu(o.shift());i;i=Cu(o.shift()||"A"))--i<""[du]?r=r|(Mk("".concat(Mk(Su(n)+(Su(zh(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=zh(e,i,i?o[du]===1?9:8:6);return r===t}var ZZ=Object.freeze(Object.defineProperty({__proto__:null,stringify:jt,isDefined:He,isUndefined:It,isEmpty:or,isRegExp:QH,_injectProductInfo:ZH},Symbol.toStringTag,{value:"Module"}));function an(e){return e[0].toUpperCase()+e.substr(1)}function JZ(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){o-=1;var i=jt(r[o]).toLowerCase();e.indexOf(i)===-1&&e.push(i)}return e.length===1}function yO(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function mO(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function bO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function Sm(e){return Iv("".concat(e),{ALLOWED_TAGS:[]})}function Iv(e,t){return V7.sanitize(e,t)}var eJ=Object.freeze(Object.defineProperty({__proto__:null,toUpperCaseFirst:an,equalsIgnoreCase:JZ,randomString:yO,isPercentValue:mO,substitute:bO,stripTags:Sm,sanitize:Iv},Symbol.toStringTag,{value:"Module"}));function Nk(e){return oJ(e)||nJ(e)||rJ(e)||tJ()}function tJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rJ(e,t){if(!!e){if(typeof e=="string")return Cm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cm(e,t)}}function nJ(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oJ(e){if(Array.isArray(e))return Cm(e)}function Cm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JH(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=e;o!==null;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function eL(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Pv(e){return eL(e)&&e.parent}function iJ(e){return!!Object.getPrototypeOf(e.parent)}function xo(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(t.includes(u)||t.includes(a)))return a;var f=a,c=f.host;c&&l===i?a=c:a=a.parentNode}return null}function vu(e,t,r){for(var n=[],o=e;o&&(o=xo(o,t,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function ui(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function tL(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Zo(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var Om,Rm,Em;function cc(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(PN()){var Hk=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};Om=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},Rm=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cc(o),o.length>0)if(Hk(n)){var i;(i=t.classList).add.apply(i,Nk(o))}else for(var a=0;o[a];)t.classList.add(o[a]),a+=1},Em=function(t,r){var n=t.ownerDocument,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cc(o),o.length>0)if(Hk(n)){var i;(i=t.classList).remove.apply(i,Nk(o))}else for(var a=0;o[a];)t.classList.remove(o[a]),a+=1}}else{var yg=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};Om=function(t,r){return t.className!==void 0&&yg(r).test(t.className)},Rm=function(t,r){var n=t.className,o=r;if(typeof o=="string"&&(o=o.split(" ")),o=cc(o),n==="")n=o.join(" ");else for(var i=0;i<o.length;i++)o[i]&&!yg(o[i]).test(n)&&(n+=" ".concat(o[i]));t.className=n},Em=function(t,r){var n=0,o=t.className,i=r;for(typeof i=="string"&&(i=i.split(" ")),i=cc(i);i[n];)o=o.replace(yg(i[n])," ").trim(),n+=1;t.className!==o&&(t.className=o)}}function Ve(e,t){return Om(e,t)}function le(e,t){Rm(e,t)}function Ge(e,t){Em(e,t)}function wO(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)wO(t[r])}function sn(e){for(var t;t=e.lastChild;)e.removeChild(t)}var rL=/(<(.*)>|&(.*);)/;function Mi(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;rL.test(t)?e.innerHTML=r?Iv(t):t:_i(e,t)}function _i(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?MN?r.textContent=t:r.data=t:(sn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function qs(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return qs(r.host.impl);if(r.host)return qs(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Dt(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,o=e,i,a,s,l;if(UC()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return l=o.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,s=o;(o=o.offsetParent)&&o!==t.body;)i+=o.offsetLeft,a+=o.offsetTop,s=o;return s&&s.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function $a(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Si(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Wu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?$a(t):e.scrollTop}function Yh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Si(t):e.scrollLeft}function Uu(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],o=$N(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return i;if(o){var f=r.getComputedStyle(i);if(s=f.overflow,l=f.overflowX,u=f.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(l)||n.includes(s)))return i;i=i.parentNode}return r}function Qs(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ya(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return n;n=n.parentNode}return r}function Gh(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var o=Ya(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function aJ(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ya(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function Ft(e){return e.offsetWidth}function Ut(e){return UC()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function uo(e){return e.clientHeight||e.innerHeight}function xs(e){return e.clientWidth||e.innerWidth}function sJ(e,t,r){e.addEventListener(t,r,!1)}function lJ(e,t,r){e.removeEventListener(t,r,!1)}function _O(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function nL(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function oL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function Tm(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function zu(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}var mg;function uJ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function fr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return mg===void 0&&(mg=uJ(e)),mg}function iL(e){return e.offsetWidth!==e.clientWidth}function aL(e){return e.offsetHeight!==e.clientHeight}function Mv(e,t,r){JN()?(e.style.top=r,e.style.left=t):qN()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function wn(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Ga(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Yu(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function SO(e){return Yu(e)&&e.hasAttribute("data-hot-input")===!1}function sL(e){var t=e.ownerDocument.activeElement;SO(t)||e.select()}function CO(e){return!e.parentNode}var fJ=Object.freeze(Object.defineProperty({__proto__:null,getParent:JH,getFrameElement:eL,getParentWindow:Pv,hasAccessToParentWindow:iJ,closest:xo,closestDown:vu,isChildOf:ui,index:tL,overlayContainsElement:Zo,hasClass:Ve,addClass:le,removeClass:Ge,removeTextNodes:wO,empty:sn,HTML_CHARACTERS:rL,fastInnerHTML:Mi,fastInnerText:_i,isVisible:qs,offset:Dt,getWindowScrollTop:$a,getWindowScrollLeft:Si,getScrollTop:Wu,getScrollLeft:Yh,getScrollableElement:Uu,getTrimmingContainer:Qs,getStyle:Gh,matchesCSSRules:aJ,getComputedStyle:Ya,outerWidth:Ft,outerHeight:Ut,innerHeight:uo,innerWidth:xs,addEvent:sJ,removeEvent:lJ,getCaretPosition:_O,getSelectionEndPosition:nL,getSelectionText:oL,clearTextSelection:Tm,setCaretPosition:zu,getScrollbarWidth:fr,hasVerticalScrollbar:iL,hasHorizontalScrollbar:aL,setOverlayPosition:Mv,getCssTransform:wn,resetCssTransform:Ga,isInput:Yu,isOutsideInput:SO,selectElementIfAllowed:sL,isDetached:CO},Symbol.toStringTag,{value:"Module"}));function Ct(e){return typeof e=="function"}function lL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var a=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout(function(){n.lastCallThrottled=!1,e.apply(a,l),r=0,o=void 0},h)),n}return i}function cJ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=lL(e,t),o=r;function i(){o=r}function a(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return o?(o-=1,e.apply(this,l)):n.apply(this,l)}return a.clearHits=i,a}function OO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(i,s)},t),n}return o}function hJ(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return zt(o,function(u,f){return f(u)},n.apply(this,s))}}function Gu(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return e.apply(this,r.concat(a))}}function uL(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var l=n.concat(a),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function dJ(e){var t=e.length;function r(n){return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var l=n.concat(a.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function Kh(e,t,r,n,o,i,a,s){return He(s)?e.call(t,r,n,o,i,a,s):He(a)?e.call(t,r,n,o,i,a):He(i)?e.call(t,r,n,o,i):He(o)?e.call(t,r,n,o):He(n)?e.call(t,r,n):He(r)?e.call(t,r):e.call(t)}var vJ=Object.freeze(Object.defineProperty({__proto__:null,isFunction:Ct,throttle:lL,throttleAfterHits:cJ,debounce:OO,pipe:hJ,partial:Gu,curry:uL,curryRight:dJ,fastCall:Kh},Symbol.toStringTag,{value:"Module"})),pJ=Ke,Lk=qC,hc=Rl.exports.getWeakData,gJ=Qt,bg=qt,yJ=XC,mJ=KC,fL=Wa,Fk=hr,cL=jo,bJ=cL.set,wJ=cL.getterFor,_J=fL.find,SJ=fL.findIndex,CJ=pJ([].splice),OJ=0,dc=function(e){return e.frozen||(e.frozen=new hL)},hL=function(){this.entries=[]},wg=function(e,t){return _J(e.entries,function(r){return r[0]===t})};hL.prototype={get:function(e){var t=wg(this,e);if(t)return t[1]},has:function(e){return!!wg(this,e)},set:function(e,t){var r=wg(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=SJ(this.entries,function(r){return r[0]===e});return~t&&CJ(this.entries,t,1),!!~t}};var dL={getConstructor:function(e,t,r,n){var o=e(function(l,u){yJ(l,i),bJ(l,{type:t,id:OJ++,frozen:void 0}),u!=null&&mJ(u,l[n],{that:l,AS_ENTRIES:r})}),i=o.prototype,a=wJ(t),s=function(l,u,f){var c=a(l),h=hc(gJ(u),!0);return h===!0?dc(c).set(u,f):h[c.id]=f,l};return Lk(i,{delete:function(l){var u=a(this);if(!bg(l))return!1;var f=hc(l);return f===!0?dc(u).delete(l):f&&Fk(f,u.id)&&delete f[u.id]},has:function(u){var f=a(this);if(!bg(u))return!1;var c=hc(u);return c===!0?dc(f).has(u):c&&Fk(c,f.id)}}),Lk(i,r?{get:function(u){var f=a(this);if(bg(u)){var c=hc(u);return c===!0?dc(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return s(this,u,f)}}:{add:function(u){return s(this,u,!0)}}),o}},jk=De,vc=Ke,RJ=qC,EJ=Rl.exports,TJ=pv,vL=dL,pc=qt,gc=NN,yc=jo.enforce,kJ=nx,AJ=!jk.ActiveXObject&&"ActiveXObject"in jk,Xl,pL=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},IJ=TJ("WeakMap",pL,vL);if(kJ&&AJ){Xl=vL.getConstructor(pL,"WeakMap",!0),EJ.enable();var ql=IJ.prototype,Bk=vc(ql.delete),mc=vc(ql.has),Vk=vc(ql.get),Wk=vc(ql.set);RJ(ql,{delete:function(e){if(pc(e)&&!gc(e)){var t=yc(this);return t.frozen||(t.frozen=new Xl),Bk(this,e)||t.frozen.delete(e)}return Bk(this,e)},has:function(t){if(pc(t)&&!gc(t)){var r=yc(this);return r.frozen||(r.frozen=new Xl),mc(this,t)||r.frozen.has(t)}return mc(this,t)},get:function(t){if(pc(t)&&!gc(t)){var r=yc(this);return r.frozen||(r.frozen=new Xl),mc(this,t)?Vk(this,t):r.frozen.get(t)}return Vk(this,t)},set:function(t,r){if(pc(t)&&!gc(t)){var n=yc(this);n.frozen||(n.frozen=new Xl),mc(this,t)?Wk(this,t,r):n.frozen.set(t,r)}else Wk(this,t,r);return this}})}var Zi=1,on=2;function PJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MJ(e,t,r){return t&&Uk(e.prototype,t),r&&Uk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ss=new WeakMap,$J=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(c){return c}:u;PJ(this,e),ss.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return MJ(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i,a=ss.get(this),s=a.calculationType,l=a.overrideFn,u=a.scrollOffset,f=a.totalColumns,c=a.viewportWidth,h=0;h<f;h++){i=this._getColumnWidth(h),r<=u&&s!==on&&(this.startColumn=h);var d=u>0?c+1:c;if(r>=u&&r+(s===on?i:0)<=u+d&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=h),this.endColumn=h),o.push(r),r+=i,s!==on&&(this.endColumn=h),r>=u+c){n=!1;break}}if(this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var v=o[this.endColumn]+i-o[this.startColumn-1];if((v<=c||s!==on)&&(this.startColumn-=1),v>c)break}s===Zi&&this.startColumn!==null&&l&&l(this),this.startPosition=o[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var o=ss.get(this),i=o.totalColumns,a=0,s=0;s<i;s++){var l=this._getColumnWidth(s),u=o.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var f=n-a;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(i-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var o=null;return this.stretch==="all"&&this.stretchAllRatio!==0?o=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(o=this._getStretchedLastColumnWidth(r)),o}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var o=0,i=ss.get(this),a=i.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=i.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)o+=this.stretchAllColumnsWidth[u];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=ss.get(this),o=n.totalColumns;return r===o-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=ss.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}(),RO=$J;function DJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xJ(e,t,r){return t&&zk(e.prototype,t),r&&zk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Yk=new WeakMap,NJ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;DJ(this,e),Yk.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return xJ(e,[{key:"calculate",value:function(){for(var r=0,n=!0,o=[],i=Yk.get(this),a=i.calculationType,s=i.overrideFn,l=i.rowHeightFn,u=i.scrollOffset,f=i.totalRows,c=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d,v=0;v<f;v++)if(d=l(v),isNaN(d)&&(d=e.DEFAULT_HEIGHT),r<=u&&a!==on&&(this.startRow=v),r>=u&&r+(a===on?d:0)<=u+c-h&&(this.startRow===null&&(this.startRow=v),this.endRow=v),o.push(r),r+=d,a!==on&&(this.endRow=v),r>=u+c-h){n=!1;break}if(this.endRow===f-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var p=o[this.endRow]+d-o[this.startRow-1];if((p<=c-h||a!==on)&&(this.startRow-=1),p>=c-h)break}a===Zi&&this.startRow!==null&&s&&s(this),this.startPosition=o[this.startRow],this.startPosition===void 0&&(this.startPosition=null),f<this.endRow&&(this.endRow=f-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}(),gL=NJ;function HJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function LJ(e,t,r){return t&&Gk(e.prototype,t),r&&Gk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var FJ=function(){function e(t,r){HJ(this,e),this.row=null,this.col=null,typeof t!="undefined"&&typeof r!="undefined"&&(this.row=t,this.col=r)}return LJ(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&this.col>=r.col}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&this.col<=r.col}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&this.col<=r.col}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&this.col>=r.col}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col)}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}(),J=FJ;function jJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BJ(e,t,r){return t&&Kk(e.prototype,t),r&&Kk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var VJ=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;jJ(this,e),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone()}return BJ(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"includes",value:function(r){var n=r.row,o=r.col,i=this.getOuterTopLeftCorner(),a=this.getOuterBottomRightCorner();return i.row<=n&&a.row>=n&&i.col<=o&&a.col>=o}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopLeftCorner())&&this.includes(r.getOuterBottomRightCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner();return r.row<n.row||r.col<n.col||r.row>o.row||r.col>o.col?(this.from=new J(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=new J(Math.max(o.row,r.row),Math.max(o.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner(),i=this.getDirection(),a=r.getOuterTopLeftCorner(),s=r.getOuterBottomRightCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),f=Math.max(o.row,s.row),c=Math.max(o.col,s.col),h=new J(l,u),d=new J(f,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var o=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=o[0],this.to=o[1];break;case"SE-NW":var i=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=i[0],this.to=i[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopLeftCorner",value:function(){return new J(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return new J(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return new J(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return new J(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getOuterTopLeftCorner",value:function(){return new J(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return new J(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return new J(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return new J(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(new J(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(new J(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(new J(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(new J(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof J))return!1;if(n&&n.includes(r)){if(this.getOuterTopLeftCorner().isEqual(new J(n.from.row,n.from.col)))return this.getOuterBottomRightCorner();if(this.getOuterTopRightCorner().isEqual(new J(n.from.row,n.to.col)))return this.getOuterBottomLeftCorner();if(this.getOuterBottomLeftCorner().isEqual(new J(n.to.row,n.from.col)))return this.getOuterTopRightCorner();if(this.getOuterBottomRightCorner().isEqual(new J(n.to.row,n.to.col)))return this.getOuterTopLeftCorner()}if(r.isEqual(this.getOuterBottomRightCorner()))return this.getOuterTopLeftCorner();if(r.isEqual(this.getOuterTopLeftCorner()))return this.getOuterBottomRightCorner();if(r.isEqual(this.getOuterTopRightCorner()))return this.getOuterBottomLeftCorner();if(r.isEqual(this.getOuterBottomLeftCorner()))return this.getOuterTopRightCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},i=[];return n.top===o.top&&i.push("top"),n.right===o.right&&i.push("right"),n.bottom===o.bottom&&i.push("bottom"),n.left===o.left&&i.push("left"),i}},{key:"getInner",value:function(){for(var r=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)!(this.from.row===i&&this.from.col===a)&&!(this.to.row===i&&this.to.col===a)&&o.push(new J(i,a));return o}},{key:"getAll",value:function(){for(var r=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),o=[],i=r.row;i<=n.row;i++)for(var a=r.col;a<=n.col;a++)r.row===i&&r.col===a?o.push(r):n.row===i&&n.col===a?o.push(n):o.push(new J(i,a));return o}},{key:"forAll",value:function(r){for(var n=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner(),i=n.row;i<=o.row;i++)for(var a=n.col;a<=o.col;a++){var s=r(i,a);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to)}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),e}(),Kt=VJ;function WJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UJ(e,t,r){return t&&Xk(e.prototype,t),r&&Xk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var zJ=function(){function e(t,r,n){WJ(this,e),this.offset=t,this.total=r,this.countTH=n}return UJ(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}(),YJ=zJ;function GJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qk(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function KJ(e,t,r){return t&&qk(e.prototype,t),r&&qk(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var XJ=function(){function e(t,r,n){GJ(this,e),this.offset=t,this.total=r,this.countTH=n}return KJ(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}(),qJ=XJ,QJ=qe,ZJ=dC;QJ({target:"Object",stat:!0},{setPrototypeOf:ZJ});var JJ=De,yL=Ke,eee=bl,tee=qt,ree=hr,Qk=pf,nee=rf,mL=JJ.Function,oee=yL([].concat),iee=yL([].join),_g={},aee=function(e,t,r){if(!ree(_g,t)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";_g[t]=mL("C,a","return new C("+iee(n,",")+")")}return _g[t](e,r)},see=nee?mL.bind:function(t){var r=eee(this),n=r.prototype,o=Qk(arguments,1),i=function(){var s=oee(o,Qk(arguments));return this instanceof i?aee(r,s.length,s):r.apply(t,s)};return tee(n)&&(i.prototype=n),i},lee=qe,uee=Ti,Sg=Ua,fee=see,Zk=CN,cee=Qt,Jk=qt,hee=Sl,bL=it,EO=uee("Reflect","construct"),dee=Object.prototype,vee=[].push,wL=bL(function(){function e(){}return!(EO(function(){},[],e)instanceof e)}),_L=!bL(function(){EO(function(){})}),eA=wL||_L;lee({target:"Reflect",stat:!0,forced:eA,sham:eA},{construct:function(t,r){Zk(t),cee(r);var n=arguments.length<3?t:Zk(arguments[2]);if(_L&&!wL)return EO(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var o=[null];return Sg(vee,o,r),new(Sg(fee,t,o))}var i=n.prototype,a=hee(Jk(i)?i:dee),s=Sg(t,a,r);return Jk(s)?s:a}});var pee=0,Xh=1,qh=2;function gee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yee(e,t,r){return t&&tA(e.prototype,t),r&&tA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var rA=function(){function e(){gee(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return yee(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function mee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bee(e,t,r){return t&&nA(e.prototype,t),r&&nA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var wee=function(){function e(){mee(this,e),this.size=new rA,this.workingSpace=pee,this.sharedSize=null}return bee(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof rA}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Xh,r.workingSpace=qh,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=qh,r.workingSpace=Xh,this.sharedSize=r.getViewSize()}}]),e}();function _ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function See(e,t,r){return t&&oA(e.prototype,t),r&&oA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var SL=function(){function e(t,r,n){_ee(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new wee,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return See(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,o=0;if(this.isSharedViewSet())for(var i=r.firstElementChild;i;){if(i.tagName===this.childNodeType)o+=1;else if(n.isPlaceOn(Xh))break;i=i.nextElementSibling}else o=r.childElementCount;return o}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,o=this.isSharedViewSet(),i=n.getViewSize(),a=i.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!o||o&&n.isPlaceOn(qh)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=o&&n.isPlaceOn(Xh);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,o=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(qh)&&(o+=n.sharedSize.nextSize);var i=r.childNodes[o];if(i.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,i),i=a}this.collectedNodes.push(i),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function km(e){return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},km(e)}function Cee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Oee(e,t,r){return t&&iA(e.prototype,t),r&&iA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ree(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Am(e,t)}function Am(e,t){return Am=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Am(e,t)}function Eee(e){var t=Aee();return function(){var n=Qh(e),o;if(t){var i=Qh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Tee(this,o)}}function Tee(e,t){if(t&&(km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kee(e)}function kee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qh(e){return Qh=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Qh(e)}var CL=function(e){Ree(r,e);var t=Eee(r);function r(){return Cee(this,r),t.apply(this,arguments)}return Oee(r,[{key:"prependView",value:function(o){return this.sizeSet.prepend(o.sizeSet),o.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(o){return this.sizeSet.append(o.sizeSet),o.sizeSet.prepend(this.sizeSet),this}}]),r}(SL);function Iee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pee(e,t,r){return t&&aA(e.prototype,t),r&&aA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Mee=function(){function e(t){Iee(this,e),this.nodeType=t.toUpperCase()}return Pee(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function $ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dee(e,t,r){return t&&sA(e.prototype,t),r&&sA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Tf=function(){function e(t,r){$ee(this,e),this.nodesPool=typeof t=="string"?new Mee(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Dee(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Im(e){return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Im(e)}function xee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nee(e,t,r){return t&&lA(e.prototype,t),r&&lA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pm(e,t)}function Pm(e,t){return Pm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Pm(e,t)}function Lee(e){var t=Bee();return function(){var n=Zh(e),o;if(t){var i=Zh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Fee(this,o)}}function Fee(e,t){if(t&&(Im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jee(e)}function jee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zh(e){return Zh=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Zh(e)}var Vee=function(e){Hee(r,e);var t=Lee(r);function r(){var n;return xee(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Nee(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new CL(o,function(s){return i.nodesPool.obtain(i.sourceRowIndex,s)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.rowHeaderFunctions,s=o.rowHeadersCount,l=o.rows,u=o.cells,f=0;f<i;f++){var c=this.table.renderedRowToSource(f),h=l.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<s;p++){d.render();var b=d.getCurrentNode();b.className="",b.removeAttribute("style"),a[p](c,b,p)}d.end()}}}]),r}(Tf);function Mm(e){return Mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mm(e)}function Wee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Uee(e,t,r){return t&&uA(e.prototype,t),r&&uA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$m(e,t)}function $m(e,t){return $m=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},$m(e,t)}function Yee(e){var t=Xee();return function(){var n=Jh(e),o;if(t){var i=Jh(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Gee(this,o)}}function Gee(e,t){if(t&&(Mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kee(e)}function Kee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jh(e){return Jh=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Jh(e)}var qee=function(e){zee(r,e);var t=Yee(r);function r(n){return Wee(this,r),t.call(this,null,n)}return Uee(r,[{key:"adjust",value:function(){var o=this.table,i=o.columnHeadersCount,a=o.rowHeadersCount,s=this.rootNode.firstChild;if(i){for(var l=this.table.columnsToRender,u=l+a,f=0,c=i;f<c;f++){for(s=this.rootNode.childNodes[f],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>i)for(var d=i;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&sn(s)}},{key:"render",value:function(){for(var o=this.table.columnHeadersCount,i=0;i<o;i+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,f=this.rootNode.childNodes[i],c=-1*u;c<l;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),s[i](h,d,i)}}}]),r}(Tf);function Dm(e){return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dm(e)}function Qee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zee(e,t,r){return t&&fA(e.prototype,t),r&&fA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xm(e,t)}function xm(e,t){return xm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},xm(e,t)}function ete(e){var t=nte();return function(){var n=ed(e),o;if(t){var i=ed(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tte(this,o)}}function tte(e,t){if(t&&(Dm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rte(e)}function rte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ed(e){return ed=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ed(e)}var ote=function(e){Jee(r,e);var t=ete(r);function r(n){return Qee(this,r),t.call(this,null,n)}return Zee(r,[{key:"adjust",value:function(){for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,s=i+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var o=this.table,i=o.columnsToRender,a=o.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var f=0;f<i;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&le(d,"rowHeader")}}]),r}(Tf);function kt(){if(He(console)){var e;(e=console).warn.apply(e,arguments)}}function TO(){if(He(console)){var e;(e=console).error.apply(e,arguments)}}function Nm(e){return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nm(e)}var cA;function ite(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ate(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ste(e,t,r){return t&&hA(e.prototype,t),r&&hA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hm(e,t)}function Hm(e,t){return Hm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Hm(e,t)}function ute(e){var t=hte();return function(){var n=td(e),o;if(t){var i=td(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fte(this,o)}}function fte(e,t){if(t&&(Nm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cte(e)}function cte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function td(e){return td=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},td(e)}var dA=!1,dte=function(e){lte(r,e);var t=ute(r);function r(n){var o;return ate(this,r),o=t.call(this,"TR",n),o.orderView=new SL(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return ste(r,[{key:"getRenderedNode",value:function(o){return this.orderView.getNode(o)}},{key:"render",value:function(){var o=this.table.rowsToRender;!dA&&o>1e3&&(dA=!0,kt(Rt(cA||(cA=ite([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(o).setOffset(this.table.renderedRowToSource(0)).start();for(var i=0;i<o;i++)this.orderView.render();this.orderView.end()}}]),r}(Tf);function Lm(e){return Lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lm(e)}function vte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pte(e,t,r){return t&&vA(e.prototype,t),r&&vA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fm(e,t)}function Fm(e,t){return Fm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Fm(e,t)}function yte(e){var t=wte();return function(){var n=rd(e),o;if(t){var i=rd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mte(this,o)}}function mte(e,t){if(t&&(Lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bte(e)}function bte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rd(e){return rd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},rd(e)}var _te=function(e){gte(r,e);var t=yte(r);function r(){var n;return vte(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return pte(r,[{key:"obtainOrderView",value:function(o){var i=this,a;return this.orderViews.has(o)?a=this.orderViews.get(o):(a=new CL(o,function(s){return i.nodesPool.obtain(i.sourceRowIndex,s)},this.nodeType),this.orderViews.set(o,a)),a}},{key:"render",value:function(){for(var o=this.table,i=o.rowsToRender,a=o.columnsToRender,s=o.rows,l=o.rowHeaders,u=0;u<i;u++){var f=this.table.renderedRowToSource(u),c=s.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=l.obtainOrderView(c);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<a;v++){h.render();var p=h.getCurrentNode(),b=this.table.renderedColumnToSource(v);Ve(p,"hide")||(p.className=""),p.removeAttribute("style"),this.table.cellRenderer(f,b,p)}h.end()}}}]),r}(Tf);function Ste(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cte(e,t,r){return t&&pA(e.prototype,t),r&&pA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ote=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Ste(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Cte(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,o=r.columnHeaders,i=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=o,this.colGroup=i,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,o=0;o<r;o++){var i=n.getRenderedNode(o);if(i.firstChild){var a=this.renderedRowToSource(o),s=this.rowUtils.getHeight(a);s?i.firstChild.style.height="".concat(s-1,"px"):i.firstChild.style.height=""}}}}]),e}();function Rte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ete(e,t,r){return t&&gA(e.prototype,t),r&&gA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Tte=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;Rte(this,e),this.renderer=new Ote(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new Vee,columnHeaders:new qee(n),colGroup:new ote(o),rows:new dte(i),cells:new _te}),this.renderer.setAxisUtils(a,s)}return Ete(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}(),kte=pv,Ate=jN;kte("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Ate);function jm(e){return jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jm(e)}function Ite(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pte(e,t,r){return t&&yA(e.prototype,t),r&&yA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Mte=function(){function e(t){Ite(this,e),this.wot=t,this.headerWidths=new Map}return Pte(e,[{key:"getWidth",value:function(r){var n=this.wot.wtSettings.settings.columnWidth;return typeof n=="function"?n=n(r):jm(n)==="object"&&(n=n[r]),n||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(r){var n=this.getWidth(r),o=this.wot.wtViewport.columnsRenderCalculator,i=n!=null?n:this.wot.wtSettings.settings.defaultColumnWidth;if(o){var a=o.getStretchedColumnWidth(r,i);a&&(i=a)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wot.wtSettings.settings.defaultRowHeight,o=this.wot.wtViewport.oversizedColumnHeaders[r];return o!==void 0&&(n=n?Math.max(n,o):o),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wot,n=r.wtTable,o=r.wtViewport,i=r.cloneSource,a=i?i.wtTable.holder:n.holder,s=a.offsetHeight<a.scrollHeight?fr():0,l=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-s),l=r.getSetting("onModifyRowHeaderWidth",l),l!=null)for(var u=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),c=0;c<u;c++){var h=Array.isArray(l)?l[c]:l;h=h==null?f:h,this.headerWidths.set(c,h)}}}]),e}();function $te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dte(e,t,r){return t&&mA(e.prototype,t),r&&mA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var xte=function(){function e(t){$te(this,e),this.wot=t}return Dte(e,[{key:"getHeight",value:function(r){var n=this.wot.wtSettings.settings.rowHeight(r),o=this.wot.wtViewport.oversizedRows[r];return o!==void 0&&(n=n===void 0?o:Math.max(n,o)),n}}]),e}(),Zs="top",Bn="bottom",Js="left",el="top_left_corner",fi="bottom_left_corner",OL=[Zs,Bn,Js,el,fi],Ku={};function kf(e){var t=e.OVERLAY_NAME;if(OL.indexOf(t)===-1)throw new Error("Unsupported overlay (".concat(t,")."));Bm(t)||(Ku[t]=e)}function Ql(e,t){return new Ku[e](t)}function Bm(e){return Ku[e]!==void 0}function Nte(e,t){return!e||!Ku[t]?!1:e instanceof Ku[t]}function Hte(e){return jte(e)||Fte(e)||RL(e)||Lte()}function Lte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fte(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jte(e){if(Array.isArray(e))return Vm(e)}function Bte(e,t){return Ute(e)||Wte(e,t)||RL(e,t)||Vte()}function Vte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RL(e,t){if(!!e){if(typeof e=="string")return Vm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vm(e,t)}}function Vm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wte(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Ute(e){if(Array.isArray(e))return e}function zte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yte(e,t,r){return t&&bA(e.prototype,t),r&&bA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gte=function(){function e(t,r){var n=this;zte(this,e),this.isMaster=!t.cloneOverlay,this.wot=t,this.instance=this.wot,this.TABLE=r,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,wO(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(o)},this.rowUtils=new xte(this.wot),this.columnUtils=new Mte(this.wot),this.tableRenderer=new Tte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}return Yte(e,[{key:"is",value:function(r){return Nte(this.wot.cloneOverlay,r)}},{key:"fixTableDomTree",value:function(){var r=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(r.createElement("TR"))}},{key:"createSpreader",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(o=this.wot.rootDocument.createElement("div"),o.className="wtSpreader",n&&n.insertBefore(o,r),o.appendChild(r)),o.style.position="relative",o}},{key:"createHider",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(o=this.wot.rootDocument.createElement("div"),o.className="wtHider",n&&n.insertBefore(o,r),o.appendChild(r)),o}},{key:"createHolder",value:function(r){var n=r.parentNode,o;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(o=this.wot.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",n&&n.insertBefore(o,r),this.isMaster&&(o.parentNode.className+="ht_master handsontable"),o.appendChild(r)),o}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot,o=n.wtOverlays,i=n.wtViewport,a=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),l=n.getSetting("rowHeaders"),u=l.length,f=n.getSetting("columnHeaders"),c=f.length,h=!1,d=r;if(this.isMaster&&(this.holderOffset=Dt(this.holder),d=i.createRenderCalculators(d),u&&!n.getSetting("fixedColumnsLeft"))){var v=o.leftOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=v>0,p!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=o.prepareOverlays()),d)this.isMaster&&i.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Dt(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var b=a>0?this.getFirstRenderedRow():0,_=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new qJ(b,a,c),this.columnFilter=new YJ(_,s,u);var S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var E={};this.wot.getSetting("beforeDraw",!0,E),S=E.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(l,f),(this.is(Bn)||this.is(fi))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var M;if(this.isMaster&&(M=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bn))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var k=Ft(this.hider),U=Ft(this.TABLE);k!==0&&U!==k&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),M!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is(Bn)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}}if(this.isMaster){var Y=o.topOverlay.resetFixedPosition();o.bottomOverlay.clone&&(Y=o.bottomOverlay.resetFixedPosition()||Y),Y=o.leftOverlay.resetFixedPosition()||Y,o.topLeftCornerOverlay&&o.topLeftCornerOverlay.resetFixedPosition(),o.bottomLeftCornerOverlay&&o.bottomLeftCornerOverlay.clone&&o.bottomLeftCornerOverlay.resetFixedPosition(),Y&&(o.refreshAll(),o.adjustElementsSize())}return this.refreshSelections(d),h&&o.syncScrollWithMaster(),n.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.wot.wtTable.columnFilter.renderedToSource(r),o=this.wot.getSetting("columnHeaders").length,i=this.wot.wtSettings.settings.defaultRowHeight,a,s,l,u=this.wot.getSetting("columnHeaderHeight")||[];o;)o-=1,a=this.wot.wtTable.getColumnHeaderHeight(o),s=this.wot.wtTable.getColumnHeader(n,o),s&&(l=uo(s),(!a&&i<l||a<l)&&(this.wot.wtViewport.oversizedColumnHeaders[o]=l),Array.isArray(u)?u[o]!==null&&u[o]!==void 0&&(this.wot.wtViewport.oversizedColumnHeaders[o]=u[o]):isNaN(u)||(this.wot.wtViewport.oversizedColumnHeaders[o]=u),this.wot.wtViewport.oversizedColumnHeaders[o]<(u[o]||u)&&(this.wot.wtViewport.oversizedColumnHeaders[o]=u[o]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wot,n=r.wtTable.THEAD.childNodes,o=r.wtViewport.oversizedColumnHeaders,i=r.getSetting("columnHeaders"),a=0,s=i.length;a<s;a++)if(o[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(o[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wot;if(!(!this.isMaster&&!this.is(Bn))&&!r.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),o=0;o<n;o++){var i=this.rowFilter.renderedToSource(o);r.wtViewport.oversizedRows&&r.wtViewport.oversizedRows[i]&&(r.wtViewport.oversizedRows[i]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),o=0,i=n.length;o<i;o++)Ge(n[o],r)}},{key:"refreshSelections",value:function(r){var n=this.wot;if(!!n.selections){var o=Array.from(n.selections),i=o.length;if(r){for(var a=[],s=0;s<i;s++){for(var l=o[s].settings,u=l.highlightHeaderClassName,f=l.highlightRowClassName,c=l.highlightColumnClassName,h=o[s].classNames,d=h.length,v=0;v<d;v++)a.includes(h[v])||a.push(h[v]);u&&!a.includes(u)&&a.push(u),f&&!a.includes(f)&&a.push(f),c&&!a.includes(c)&&a.push(c)}var p=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var b=0;b<p.length;b++)a.push(p[b]);for(var _=a.length,S=0;S<_;S++)this.removeClassFromCells(a[S])}for(var E=0;E<i;E++)o[E].draw(n,r)}}},{key:"getCell",value:function(r){var n=r.row,o=r.col,i=this.wot.getSetting("onModifyGetCellCoords",n,o);if(i&&Array.isArray(i)){var a=Bte(i,2);n=a[0],o=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;var s;if(n<0?s=this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)],!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!l&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=this.THEAD.childNodes[n];return o==null?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(i){var a=i.childNodes[o];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var o=this.wot.getSetting("rowHeaders").length;if(!(n>=o)){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return i==null?void 0:i.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],o=this.wot.getSetting("rowHeaders").length,i=0;i<o;i++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[i];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=xo(n,["TD","TH"])),n===null)return null;var o=n.parentNode,i=o.parentNode,a=tL(o),s=n.cellIndex;if(Zo(el,n,this.wtRootElement)||Zo(Zs,n,this.wtRootElement))i.nodeName==="THEAD"&&(a-=i.childNodes.length);else if(Zo(fi,n,this.wtRootElement)||Zo(Bn,n,this.wtRootElement)){var l=this.wot.getSetting("totalRows");a=l-i.childNodes.length+a}else i===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return Zo(el,n,this.wtRootElement)||Zo(Js,n,this.wtRootElement)||Zo(fi,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),new J(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wot.wtSettings.settings.defaultRowHeight,o=uo(this.TBODY)-1,i,a,s,l,u;if(!(n===o&&!this.wot.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),i=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=uo(u):a=uo(l)-1,(!i&&this.wot.wtSettings.settings.defaultRowHeight<a||i<a)&&(a+=1,this.wot.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wot.getSetting("rowHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wot.getSetting("columnHeaders"),o=n.length;return Math.abs(r)<=o}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return qs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=Ct(r)?r():null;return Array.isArray(n)?(n=Hte(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}(),Al=Gte,Kte="calculatedRows",EL={getFirstRenderedRow:function(){var t=this.wot.wtViewport.rowsRenderCalculator.startRow;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.wot.wtViewport.rowsVisibleCalculator.startRow;return t===null?-1:t},getLastRenderedRow:function(){var t=this.wot.wtViewport.rowsRenderCalculator.endRow;return t===null?-1:t},getLastVisibleRow:function(){var t=this.wot.wtViewport.rowsVisibleCalculator.endRow;return t===null?-1:t},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Kn(EL,"MIXIN_NAME",Kte,{writable:!1,enumerable:!1});var TL=EL,Xte="calculatedColumns",kL={getFirstRenderedColumn:function(){var t=this.wot.wtViewport.columnsRenderCalculator.startColumn;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.wot.wtViewport.columnsRenderCalculator.endColumn;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return t===null?-1:t},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Kn(kL,"MIXIN_NAME",Xte,{writable:!1,enumerable:!1});var kO=kL;function Wm(e){return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function qte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qte(e,t,r){return t&&wA(e.prototype,t),r&&wA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Um(e,t)}function Um(e,t){return Um=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Um(e,t)}function Jte(e){var t=rre();return function(){var n=nd(e),o;if(t){var i=nd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ere(this,o)}}function ere(e,t){if(t&&(Wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tre(e)}function tre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nd(e){return nd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},nd(e)}var AO=function(e){Zte(r,e);var t=Jte(r);function r(){return qte(this,r),t.apply(this,arguments)}return Qte(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var o=Qs(this.wtRootElement),i=this.wot.rootWindow;if(o===i){var a=this.wot.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=o.parentElement,l=Gh(o,"height",i),u=Gh(o,"overflow",i),f=this.holder.style,c=o.scrollWidth,h=o.scrollHeight,d=o.getBoundingClientRect(),v=d.width,p=d.height,b=["auto","hidden","scroll"];if(s&&b.includes(u)){var _=o.cloneNode(!1);_.style.overflow="auto",o.nextElementSibling?s.insertBefore(_,o.nextElementSibling):s.appendChild(_);var S=parseInt(Ya(_,i).height,10);s.removeChild(_),S===0&&(p=0)}p=Math.min(p,h),f.height=l==="auto"?"auto":"".concat(p,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:p>0,this.hasTableWidth=v>0}this.isTableVisible=qs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var o=this.wot,i=o.getOverlayName(),a=o.getSetting("columnHeaders"),s=a.length;if(s&&!o.wtViewport.hasOversizedColumnHeadersMarked[i]){for(var l=o.getSetting("rowHeaders"),u=l.length,f=this.getRenderedColumnsCount(),c=0;c<s;c++)for(var h=-1*u;h<f;h++)this.markIfOversizedColumnHeader(h);o.wtViewport.hasOversizedColumnHeadersMarked[i]=!0}}}]),r}(Al);wt(AO,TL);wt(AO,kO);var nre=AO,ore="stickyRowsBottom",AL={getFirstRenderedRow:function(){var t=this.wot.getSetting("totalRows"),r=this.wot.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(AL,"MIXIN_NAME",ore,{writable:!1,enumerable:!1});var IL=AL,ire="stickyColumnsLeft",PL={getFirstRenderedColumn:function(){var t=this.wot.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Kn(PL,"MIXIN_NAME",ire,{writable:!1,enumerable:!1});var IO=PL;function zm(e){return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(e)}function _A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function are(e,t,r){return t&&_A(e.prototype,t),r&&_A(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ym(e,t)}function Ym(e,t){return Ym=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Ym(e,t)}function ure(e){var t=hre();return function(){var n=od(e),o;if(t){var i=od(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fre(this,o)}}function fre(e,t){if(t&&(zm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cre(e)}function cre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function od(e){return od=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},od(e)}var PO=function(e){lre(r,e);var t=ure(r);function r(){return sre(this,r),t.apply(this,arguments)}return are(r)}(Al);wt(PO,IL);wt(PO,IO);var dre=PO;function At(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function _n(e){return e.isImmediatePropagationEnabled===!1}function Ci(e){return e.button===2}function $v(e){return e.button===0}var vre=Object.freeze(Object.defineProperty({__proto__:null,stopImmediatePropagation:At,isImmediatePropagationStopped:_n,isRightClick:Ci,isLeftClick:$v},Symbol.toStringTag,{value:"Module"}));function pre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gre(e,t,r){return t&&SA(e.prototype,t),r&&SA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var oh=0,yre=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pre(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return gre(e,[{key:"addEventListener",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){o.call(this,mre(l))}return typeof a!="boolean"&&!xN()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:o,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),oh+=1,function(){i.removeEventListener(r,n,o)}}},{key:"removeEventListener",value:function(r,n,o){for(var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(o&&o!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),oh-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!!this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var o=this.context.eventListeners[n];r&&o.eventManager!==this||(this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),oh-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var o=r.document,i=r;o||(o=r.ownerDocument?r.ownerDocument:r,i=o.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;o.createEvent?(s=o.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,o.body.parentNode)):s=o.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function mre(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),At(this)},e}var bt=yre;function bre(){return oh}function wre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _re(e,t,r){return t&&CA(e.prototype,t),r&&CA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Af=function(){function e(t){wre(this,e),Kn(this,"wot",t,{writable:!1});var r=this.wot.wtTable,n=r.TABLE,o=r.hider,i=r.spreader,a=r.holder,s=r.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=n,this.hider=o,this.spreader=i,this.holder=a,this.wtRootElement=s,this.trimmingContainer=Qs(this.hider.parentNode.parentNode),this.updateStateOfRendering()}return _re(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Qs(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot,n=r.wtTable,o=r.rootWindow;o.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Uu(n.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,o){if(this.clone.wtTable.holder.contains(r)===!1){kt("The provided element is not a child of the ".concat(this.type," overlay"));return}var i=this.mainTableScrollableElement===this.wot.rootWindow,a=o<this.wot.getSetting("fixedColumnsLeft"),s=n<this.wot.getSetting("fixedRowsTop"),l=n>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),u={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},f={left:r.offsetLeft,top:r.offsetTop},c=null;return i?c=this.getRelativeCellPositionWithinWindow(s,a,f,u):c=this.getRelativeCellPositionWithinHolder(s,l,a,f,u),c}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,o,i){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(n?s=a.left<=0?-1*a.left:0:s=i.left,r){var u=this.clone.wtTable.TABLE.getBoundingClientRect();l=u.top-a.top}else l=i.top;return{left:o.left+s,top:o.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,o,i,a){var s={horizontal:this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),vertical:this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(o||(l=s.horizontal-a.left),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=s.vertical-a.top);return{left:i.left-l,top:i.top-u}}},{key:"makeClone",value:function(r){if(OL.indexOf(r)===-1)throw new Error('Clone type "'.concat(r,'" is not supported.'));var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,s=i.createElement("DIV"),l=i.createElement("TABLE"),u=o.wtRootElement.parentNode;s.className="ht_clone_".concat(r," handsontable"),s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.overflow="visible",l.className=o.TABLE.className,s.appendChild(l),this.type=r,u.appendChild(s);var f=this.wot.getSetting("preventOverflow");return f===!0||f==="horizontal"&&this.type===Zs||f==="vertical"&&this.type===Js?this.mainTableScrollableElement=a:a.getComputedStyle(u).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=o.holder:this.mainTableScrollableElement=Uu(o.TABLE),new this.wot.constructor({cloneSource:this.wot,cloneOverlay:this,table:l})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(!!this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,o=r.style,i=n.style,a=r.parentNode.style;P([o,i,a],function(s){s.width="",s.height=""})}}},{key:"destroy",value:function(){new bt(this.clone).destroy()}}]),e}();function Gm(e){return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function ih(e,t,r){return ML()?ih=Reflect.construct:ih=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&id(u,a.prototype),u},ih.apply(null,arguments)}function Sre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cre(e,t,r){return t&&OA(e.prototype,t),r&&OA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ore(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&id(e,t)}function id(e,t){return id=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},id(e,t)}function Rre(e){var t=ML();return function(){var n=ad(e),o;if(t){var i=ad(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ere(this,o)}}function Ere(e,t){if(t&&(Gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tre(e)}function Tre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ML(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ad(e){return ad=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ad(e)}var kre=function(e){Ore(r,e);var t=Rre(r);function r(n){var o;return Sre(this,r),o=t.call(this,n),o.clone=o.makeClone(fi),o}return Cre(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ih(dre,i)}},{key:"shouldBeRendered",value:function(){var o=this.wot;return o.getSetting("shouldRenderBottomOverlay")&&o.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot;if(this.updateTrimmingContainer(),!!o.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode;if(i.style.top="",this.trimmingContainer===o.rootWindow){var a=this.wot,s=a.rootDocument,l=a.wtTable,u=l.hider.getBoundingClientRect(),f=Math.ceil(u.bottom),c=Math.ceil(u.left),h=s.documentElement.clientHeight,d,v;c<0?d=-c:d=0,f>h?v=f-h:v=0,v+="px",d+="px",i.style.left=d,i.style.bottom=v}else Ga(i),this.repositionOverlay();var p=Ut(this.clone.wtTable.TABLE),b=Ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(p=0),i.style.height="".concat(p,"px"),i.style.width="".concat(b,"px"),!1}}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.rootDocument,s=this.clone.wtTable.holder.parentNode,l=fr(a);i.holder.clientHeight===i.holder.offsetHeight&&(l=0),s.style.bottom="".concat(l,"px")}}],[{key:"OVERLAY_NAME",get:function(){return fi}}]),r}(Af);function Km(e){return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function RA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Are(e,t,r){return t&&RA(e.prototype,t),r&&RA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ire(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xm(e,t)}function Xm(e,t){return Xm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Xm(e,t)}function Mre(e){var t=xre();return function(){var n=sd(e),o;if(t){var i=sd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $re(this,o)}}function $re(e,t){if(t&&(Km(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dre(e)}function Dre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sd(e){return sd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},sd(e)}var MO=function(e){Pre(r,e);var t=Mre(r);function r(){return Ire(this,r),t.apply(this,arguments)}return Are(r)}(Al);wt(MO,IL);wt(MO,kO);var Nre=MO;function qm(e){return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function ah(e,t,r){return DL()?ah=Reflect.construct:ah=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&ld(u,a.prototype),u},ah.apply(null,arguments)}function Hre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lre(e,t,r){return t&&EA(e.prototype,t),r&&EA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ld(e,t)}function ld(e,t){return ld=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},ld(e,t)}function jre(e){var t=DL();return function(){var n=ud(e),o;if(t){var i=ud(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bre(this,o)}}function Bre(e,t){if(t&&(qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $L(e)}function $L(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ud(e){return ud=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ud(e)}function Vre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wre=function(e){Fre(r,e);var t=jre(r);function r(n){var o;return Hre(this,r),o=t.call(this,n),Vre($L(o),"cachedFixedRowsBottom",-1),o.clone=o.makeClone(Bn),o.cachedFixedRowsBottom=o.wot.getSetting("fixedRowsBottom"),o}return Lre(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return ah(Nre,i)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var o=this.clone.wtTable.holder.parentNode;o.style.top="";var i=0,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!a||a!=="vertical")){var s=this.wot,l=s.rootDocument,u=s.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=l.documentElement.clientHeight,d,v;d=u.hider.style.left,d=d===""?0:d,c>h?v=c-h:v=0,i=v,v+="px",o.style.left=d,o.style.bottom=v}else i=this.getScrollPosition(),this.repositionOverlay();var p=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),p}}},{key:"repositionOverlay",value:function(){var o=this.wot,i=o.wtTable,a=o.rootDocument,s=this.clone.wtTable.holder.parentNode,l=fr(a);i.holder.clientHeight===i.holder.offsetHeight&&(l=0),s.style.bottom="".concat(l,"px")}},{key:"setScrollPosition",value:function(o){var i=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===i?(i.scrollTo(Si(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.settings.defaultRowHeight,f=o,c=0;f<i;){var h=s.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.wtViewport,s=o.rootWindow,l=fr(this.wot.rootDocument),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Ut(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height=o.parentNode.style.height}},{key:"applyToDOM",value:function(){var o=this.wot.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;i&&l.offsetHeight!==l.clientHeight&&(u=fr(this.wot.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Wu(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==i,s=this.wot.getSetting("columnHeaders"),l=!1;if((a||i===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,f=Ve(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),o||this.wot.getSetting("totalRows")===0?(le(u,"innerBorderBottom"),l=!f):(Ge(u,"innerBorderBottom"),l=f)}return l}}],[{key:"OVERLAY_NAME",get:function(){return Bn}}]),r}(Af);function Qm(e){return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(e)}function TA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ure(e,t,r){return t&&TA(e.prototype,t),r&&TA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zm(e,t)}function Zm(e,t){return Zm=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Zm(e,t)}function Gre(e){var t=qre();return function(){var n=fd(e),o;if(t){var i=fd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Kre(this,o)}}function Kre(e,t){if(t&&(Qm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xre(e)}function Xre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fd(e){return fd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},fd(e)}var $O=function(e){Yre(r,e);var t=Gre(r);function r(){return zre(this,r),t.apply(this,arguments)}return Ure(r)}(Al);wt($O,TL);wt($O,IO);var Qre=$O;function Jm(e){return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function sh(e,t,r){return xL()?sh=Reflect.construct:sh=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&cd(u,a.prototype),u},sh.apply(null,arguments)}function Zre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jre(e,t,r){return t&&kA(e.prototype,t),r&&kA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ene(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cd(e,t)}function cd(e,t){return cd=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},cd(e,t)}function tne(e){var t=xL();return function(){var n=hd(e),o;if(t){var i=hd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rne(this,o)}}function rne(e,t){if(t&&(Jm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nne(e)}function nne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hd(e){return hd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},hd(e)}var one=function(e){ene(r,e);var t=tne(r);function r(n){var o;return Zre(this,r),o=t.call(this,n),o.clone=o.makeClone(Js),o}return Jre(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return sh(Qre,i)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var o=this.wot.wtTable;if(!(!this.needFullRender||!o.holder.parentNode)){var i=this.clone.wtTable.holder.parentNode,a=0,s=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!s||s!=="horizontal")){var l=o.hider.getBoundingClientRect(),u=Math.ceil(l.left),f=Math.ceil(l.right),c,h;h=o.hider.style.top,h=h===""?0:h,u<0&&f-i.offsetWidth>0?c=-u:c=0,a=c,c+="px",Mv(i,c,h)}else a=this.getScrollPosition(),Ga(i);var d=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),d}}},{key:"setScrollPosition",value:function(o){var i=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollX!==o?(i.scrollTo(o,$a(i)),a=!0):this.mainTableScrollableElement.scrollLeft!==o&&(this.mainTableScrollableElement.scrollLeft=o,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot.wtSettings.defaultColumnWidth,s=o,l=0;s<i;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.rootDocument,s=o.rootWindow,l=fr(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=Ft(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,s=Math.abs((o=a==null?void 0:a.getCell().getBorder(this.wot).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.height=this.hider.style.height,i.style.height=i.parentNode.style.height,i.style.width="".concat(parseInt(i.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wot.getSetting("totalColumns");if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(o,i){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;return i&&l.offsetWidth!==l.clientWidth&&(u=fr(this.wot.rootDocument)),i?(a+=this.sumCellSizes(0,o+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),o),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var o=this.wot.getSetting("preventOverflow"),i=0;return!o&&this.trimmingContainer===this.wot.rootWindow&&(i=this.wot.wtTable.holderOffset.left),i}},{key:"getScrollPosition",value:function(){return Yh(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(o){var i=this.wot.wtTable.holder.parentNode,a=this.wot.getSetting("rowHeaders"),s=this.wot.getSetting("fixedColumnsLeft"),l=this.wot.getSetting("totalRows");l?Ge(i,"emptyRows"):le(i,"emptyRows");var u=!1;if(s&&!a.length)le(i,"innerBorderLeft");else if(!s&&a.length){var f=Ve(i,"innerBorderLeft");o?(le(i,"innerBorderLeft"),u=!f):(Ge(i,"innerBorderLeft"),u=f)}return u}}],[{key:"OVERLAY_NAME",get:function(){return Js}}]),r}(Af),ine="stickyRowsTop",NL={getFirstRenderedRow:function(){var t=this.wot.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Kn(NL,"MIXIN_NAME",ine,{writable:!1,enumerable:!1});var HL=NL;function eb(e){return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function AA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ane(e,t,r){return t&&AA(e.prototype,t),r&&AA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tb(e,t)}function tb(e,t){return tb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},tb(e,t)}function une(e){var t=hne();return function(){var n=dd(e),o;if(t){var i=dd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return fne(this,o)}}function fne(e,t){if(t&&(eb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cne(e)}function cne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hne(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dd(e){return dd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},dd(e)}var DO=function(e){lne(r,e);var t=une(r);function r(){return sne(this,r),t.apply(this,arguments)}return ane(r)}(Al);wt(DO,HL);wt(DO,IO);var dne=DO;function rb(e){return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function lh(e,t,r){return LL()?lh=Reflect.construct:lh=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&vd(u,a.prototype),u},lh.apply(null,arguments)}function vne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pne(e,t,r){return t&&IA(e.prototype,t),r&&IA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vd(e,t)}function vd(e,t){return vd=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},vd(e,t)}function yne(e){var t=LL();return function(){var n=pd(e),o;if(t){var i=pd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mne(this,o)}}function mne(e,t){if(t&&(rb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bne(e)}function bne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pd(e){return pd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},pd(e)}var wne=function(e){gne(r,e);var t=yne(r);function r(n){var o;return vne(this,r),o=t.call(this,n),o.clone=o.makeClone(el),o}return pne(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return lh(dne,i)}},{key:"shouldBeRendered",value:function(){var o=this.wot;return o.getSetting("shouldRenderTopOverlay")&&o.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!!this.wot.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode,i=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var a=this.wot.wtTable,s=a.hider.getBoundingClientRect(),l=Math.ceil(s.top),u=Math.ceil(s.left),f=Math.ceil(s.bottom),c=Math.ceil(s.right),h="0",d="0";(!i||i==="vertical")&&u<0&&c-o.offsetWidth>0&&(h="".concat(-u,"px")),(!i||i==="horizontal")&&l<0&&f-o.offsetHeight>0&&(d="".concat(-l,"px")),Mv(o,h,d)}else Ga(o);var v=Ut(this.clone.wtTable.TABLE),p=Ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(v=0),o.style.height="".concat(v,"px"),o.style.width="".concat(p,"px"),!1}}}],[{key:"OVERLAY_NAME",get:function(){return el}}]),r}(Af);function nb(e){return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}function PA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _ne(e,t,r){return t&&PA(e.prototype,t),r&&PA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ob(e,t)}function ob(e,t){return ob=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},ob(e,t)}function One(e){var t=Tne();return function(){var n=gd(e),o;if(t){var i=gd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rne(this,o)}}function Rne(e,t){if(t&&(nb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ene(e)}function Ene(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tne(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gd(e){return gd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},gd(e)}var xO=function(e){Cne(r,e);var t=One(r);function r(){return Sne(this,r),t.apply(this,arguments)}return _ne(r)}(Al);wt(xO,HL);wt(xO,kO);var kne=xO;function ib(e){return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}function uh(e,t,r){return jL()?uh=Reflect.construct:uh=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&yd(u,a.prototype),u},uh.apply(null,arguments)}function Ane(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ine(e,t,r){return t&&MA(e.prototype,t),r&&MA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yd(e,t)}function yd(e,t){return yd=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},yd(e,t)}function Mne(e){var t=jL();return function(){var n=md(e),o;if(t){var i=md(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ne(this,o)}}function $ne(e,t){if(t&&(ib(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FL(e)}function FL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function md(e){return md=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},md(e)}function Dne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xne=function(e){Pne(r,e);var t=Mne(r);function r(n){var o;return Ane(this,r),o=t.call(this,n),Dne(FL(o),"cachedFixedRowsTop",-1),o.clone=o.makeClone(Zs),o.cachedFixedRowsTop=o.wot.getSetting("fixedRowsTop"),o}return Ine(r,[{key:"createTable",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return uh(kne,i)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var o=this.clone.wtTable.holder.parentNode,i=this.wot.getSetting("preventOverflow"),a=0,s=!1;if(this.trimmingContainer===this.wot.rootWindow&&(!i||i!=="vertical")){var l=this.wot.wtTable,u=l.hider.getBoundingClientRect(),f=Math.ceil(u.top),c=Math.ceil(u.bottom),h=o.offsetHeight;s=c===h;var d,v;d=l.hider.style.left,d=d===""?0:d,f<0&&c-h>0?v=-f:v=0,a=v,v+="px",Mv(o,d,v)}else a=this.getScrollPosition(),Ga(o);var p=this.adjustHeaderBordersPosition(a,s);return this.adjustElementsSize(),p}}},{key:"setScrollPosition",value:function(o){var i=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===i&&i.scrollY!==o?(i.scrollTo(Si(i),o),a=!0):this.mainTableScrollableElement.scrollTop!==o&&(this.mainTableScrollableElement.scrollTop=o,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(o,i){for(var a=this.wot.wtSettings.settings.defaultRowHeight,s=o,l=0;s<i;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||o)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var o=this.wot,i=o.wtTable,a=o.rootDocument,s=o.rootWindow,l=fr(a),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Ut(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var o,i=this.clone.wtTable.holder,a=this.wot.selections,s=Math.abs((o=a==null?void 0:a.getCell().getBorder(this.wot).cornerCenterPointOffset)!==null&&o!==void 0?o:0);this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height="".concat(parseInt(i.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var o=this.wot.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(o===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(o,i){var a=this.wot,s=a.cloneSource?a.cloneSource:a,l=s.wtTable.holder,u=this.getTableParentOffset(),f=0;if(i&&l.offsetHeight!==l.clientHeight&&(f=fr(a.rootDocument)),i){var c=a.getSetting("fixedRowsBottom"),h=a.getSetting("totalRows");u+=this.sumCellSizes(0,o+1),u-=a.wtViewport.getViewportHeight()-this.sumCellSizes(h-c,h),u+=1}else u+=this.sumCellSizes(a.getSetting("fixedRowsTop"),o);return u+=f,this.setScrollPosition(u)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Wu(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wot.getSetting("totalColumns");s?Ge(a,"emptyColumns"):le(a,"emptyColumns");var l=!1;if(!i){var u=this.wot.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wot.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=Ve(a,"innerBorderTop");this.cachedFixedRowsTop=this.wot.getSetting("fixedRowsTop"),o||this.wot.getSetting("totalRows")===0?(le(a,"innerBorderTop"),l=!h):(Ge(a,"innerBorderTop"),l=h)}}return l}}],[{key:"OVERLAY_NAME",get:function(){return Zs}}]),r}(Af);function Cg(e,t){return Fne(e)||Lne(e,t)||Hne(e,t)||Nne()}function Nne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hne(e,t){if(!!e){if(typeof e=="string")return $A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $A(e,t)}}function $A(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lne(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Fne(e){if(Array.isArray(e))return e}function jne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bne(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Vne=function(){function e(t,r){jne(this,e),r&&(this.eventManager=new bt(t),this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Bne(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var o=function(l,u){var f=r.main.childNodes[l];r.eventManager.addEventListener(f,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},i=0,a=this.main.childNodes.length;i<a;i++)o(i)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),At(r);var o=this,i=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(o.eventManager.removeEventListener(i,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var o=["top","left","bottom","right","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(var a=0;a<5;a++){var s=o[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),i=l.style,i.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,i.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),i.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Sn()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={topLeft:n.createElement("DIV"),topLeftHitArea:n.createElement("DIV"),bottomRight:n.createElement("DIV"),bottomRightHitArea:n.createElement("DIV")};var o=10,i=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var a={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px")};ot(a,function(l,u){r.selectionHandles.styles.bottomRightHitArea[u]=l,r.selectionHandles.styles.topLeftHitArea[u]=l});var s={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};ot(s,function(l,u){r.selectionHandles.styles.bottomRight[u]=l,r.selectionHandles.styles.topLeft[u]=l}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(r,n){var o=this.wot.selections.createOrGetArea();return!!(o.cellRange&&(r!==o.cellRange.to.row||n!==o.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,o,i,a,s){var l=parseInt(this.selectionHandles.styles.topLeft.width,10),u=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(o-l,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(i-l,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(o-u/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(i-u/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(o+s,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(i+a,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(o+s-u/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(i+a-u/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(r,n)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,o=n.wtTable,i=n.rootDocument,a=n.rootWindow,s,l,u,f,c,h,d=o.getRenderedRowsCount(),v=0;v<d;v+=1){var p=o.rowFilter.renderedToSource(v);if(p>=r[0]&&p<=r[2]){s=p,c=r[0];break}}for(var b=d-1;b>=0;b-=1){var _=o.rowFilter.renderedToSource(b);if(_>=r[0]&&_<=r[2]){l=_;break}}for(var S=o.getRenderedColumnsCount(),E=0;E<S;E+=1){var M=o.columnFilter.renderedToSource(E);if(M>=r[1]&&M<=r[3]){u=M,h=r[1];break}}for(var k=S-1;k>=0;k-=1){var U=o.columnFilter.renderedToSource(k);if(U>=r[1]&&U<=r[3]){f=U;break}}if(s===void 0||u===void 0){this.disappear();return}var Y=o.getCell(new J(s,u)),ne=s!==l||u!==f,Z=ne?o.getCell(new J(l,f)):Y,te=Dt(Y),se=ne?Dt(Z):te,he=Dt(o.TABLE),ae=te.top,Ce=te.left,y=Ce-he.left-1,w=se.left+Ft(Z)-Ce;if(this.isEntireColumnSelected(s,l)){var g=this.getDimensionsFromHeader("columns",u,f,c,he),m=null;if(g){var R=Cg(g,3);m=R[0],y=R[1],w=R[2]}m&&(Y=m)}var $=ae-he.top-1,I=se.top+Ut(Z)-ae;if(this.isEntireRowSelected(u,f)){var V=this.getDimensionsFromHeader("rows",s,l,h,he),q=null;if(V){var oe=Cg(V,3);q=oe[0],$=oe[1],I=oe[2]}q&&(Y=q)}var ee=Ya(Y,a);parseInt(ee.borderTopWidth,10)>0&&($+=1,I=I>0?I-1:0),parseInt(ee.borderLeftWidth,10)>0&&(y+=1,w=w>0?w-1:0),this.topStyle.top="".concat($,"px"),this.topStyle.left="".concat(y,"px"),this.topStyle.width="".concat(w,"px"),this.topStyle.display="block",this.leftStyle.top="".concat($,"px"),this.leftStyle.left="".concat(y,"px"),this.leftStyle.height="".concat(I,"px"),this.leftStyle.display="block";var de=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat($+I-de,"px"),this.bottomStyle.left="".concat(y,"px"),this.bottomStyle.width="".concat(w,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat($,"px"),this.rightStyle.left="".concat(y+w-de,"px"),this.rightStyle.height="".concat(I+1,"px"),this.rightStyle.display="block";var Te=this.settings.border.cornerVisible;Te=typeof Te=="function"?Te(this.settings.layerLevel):Te;var me=this.wot.getSetting("onModifyGetCellCoords",l,f),Pe=l,We=f;if(me&&Array.isArray(me)){var Le=Cg(me,4);Pe=Le[2],We=Le[3]}if(Sn()||!Te||this.isPartRange(Pe,We))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat($+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.left="".concat(y+w+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var je=Qs(o.TABLE),Fe=je===a;if(Fe&&(je=i.documentElement),f===this.wot.getSetting("totalColumns")-1){var re=Fe?Z.getBoundingClientRect().left:Z.offsetLeft,Ue=re+Ft(Z)+parseInt(this.cornerDefaultStyle.width,10)/2,Be=Ue>=xs(je);Be&&(this.cornerStyle.left="".concat(Math.floor(y+w+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}if(l===this.wot.getSetting("totalRows")-1){var pt=Fe?Z.getBoundingClientRect().top:Z.offsetTop,nt=pt+Ut(Z)+parseInt(this.cornerDefaultStyle.height,10)/2,ze=nt>=uo(je);ze&&(this.cornerStyle.top="".concat(Math.floor($+I+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Sn()&&this.updateMultipleSelectionHandlesPosition(l,f,$,y,w,I)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,o,i,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,p=null,b=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},f=function(){return Ut.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},f=function(){return Ft.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(l.classList.contains(c)){var _=this.wot.getSetting("columnHeaders").length;if(p=u(n,_-i),b=u(o,_-i),!p||!b)return!1;var S=Dt(p),E=Dt(b);return p&&b&&(h=S[v]-a[v]-1,d=E[v]+f(b)-S[v]),[p,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var o=this[r].style,i=n[r];!i||i.hide?le(this[r],"hidden"):(Ve(this[r],"hidden")&&Ge(this[r],"hidden"),o.backgroundColor=i.color,(r==="top"||r==="bottom")&&(o.height="".concat(i.width,"px")),(r==="right"||r==="left")&&(o.width="".concat(i.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},o=this[r].style;o.backgroundColor=n.color,o.width="".concat(n.width,"px"),o.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?le(this[r],"hidden"):Ge(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Sn()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}(),Wne=Vne;function Une(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zne(e,t,r){return t&&xA(e.prototype,t),r&&xA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ls=new WeakMap,Yne=function(){function e(t){Une(this,e),this.instance=t,this.eventManager=new bt(t),ls.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return zne(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(i){return r.onContextMenu(i)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(i){return r.onMouseOver(i)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(i){return r.onMouseOut(i)});var n=function(){r.eventManager.addEventListener(r.instance.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.instance.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.instance.momentumScrolling||(r.instance.momentumScrolling={}),r.eventManager.addEventListener(r.instance.wtTable.holder,"scroll",function(){clearTimeout(r.instance.momentumScrolling._timeout),r.instance.momentumScrolling.ongoing||r.instance.getSetting("onBeforeTouchScroll"),r.instance.momentumScrolling.ongoing=!0,r.instance.momentumScrolling._timeout=setTimeout(function(){r.instance.touchApplied||(r.instance.momentumScrolling.ongoing=!1,r.instance.getSetting("onAfterMomentumScroll"))},200)})},o=function(){r.eventManager.addEventListener(r.instance.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.instance.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};Sn()?n():(WC()&&n(),o())}},{key:"selectedCellWasTouched",value:function(r){var n=ls.get(this),o=this.parentCell(r),i=o.coords;if(n.selectedCellBeforeTouchEnd&&i){var a=[i.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[i.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},o=this.instance.wtTable.TABLE,i=vu(r,["TD","TH"],o);return i?(n.coords=this.instance.wtTable.getCoords(i),n.TD=i):Ve(r,"wtBorder")&&Ve(r,"current")?(n.coords=this.instance.selections.getCell().cellRange.highlight,n.TD=this.instance.wtTable.getCell(n.coords)):Ve(r,"wtBorder")&&Ve(r,"area")&&this.instance.selections.createOrGetArea().cellRange&&(n.coords=this.instance.selections.createOrGetArea().cellRange.to,n.TD=this.instance.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=ls.get(this),o=this.instance.rootDocument.activeElement,i=Gu(JH,r.target),a=r.target;if(!(a===o||i(0)===o||i(1)===o)){var s=this.parentCell(a);Ve(a,"corner")?this.instance.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",r,s.coords,s.TD,this.instance),(r.button===0||this.instance.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.instance.hasSetting("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.instance.getSetting("onCellContextMenu",r,n.coords,n.TD,this.instance)}}},{key:"onMouseOver",value:function(r){if(!!this.instance.hasSetting("onCellMouseOver")){var n=this.instance.wtTable.TABLE,o=vu(r.target,["TD","TH"],n),i=this.instance.cloneSource||this.instance;o&&o!==i.lastMouseOver&&ui(o,n)&&(i.lastMouseOver=o,this.instance.getSetting("onCellMouseOver",r,this.instance.wtTable.getCoords(o),o,this.instance))}}},{key:"onMouseOut",value:function(r){if(!!this.instance.hasSetting("onCellMouseOut")){var n=this.instance.wtTable.TABLE,o=vu(r.target,["TD","TH"],n),i=vu(r.relatedTarget,["TD","TH"],n);o&&o!==i&&ui(o,n)&&this.instance.getSetting("onCellMouseOut",r,this.instance.wtTable.getCoords(o),o,this.instance)}}},{key:"onMouseUp",value:function(r){var n=ls.get(this),o=this.parentCell(r.target);o.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",r,o.coords,o.TD,this.instance),!(r.button!==0&&!this.instance.touchApplied)&&(o.TD===n.dblClickOrigin[0]&&o.TD===n.dblClickOrigin[1]?(Ve(r.target,"corner")?this.instance.getSetting("onCellCornerDblClick",r,o.coords,o.TD,this.instance):this.instance.getSetting("onCellDblClick",r,o.coords,o.TD,this.instance),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):o.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=o.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=ls.get(this);n.selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,o=r.target,i=(n=this.parentCell(o))===null||n===void 0?void 0:n.coords,a=He(i)&&i.row>=0&&i.col>=0,s=r.cancelable&&a&&this.instance.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];JC()&&(KN()||XN())&&this.selectedCellWasTouched(o)&&!l.includes(o.tagName)?r.preventDefault():this.selectedCellWasTouched(o)||r.preventDefault()}this.onMouseUp(r),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var r=ls.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),NA=Yne,ue={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:th()?182:174,AUDIO_MUTE:th()?181:173,AUDIO_UP:th()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Gne=[ue.ALT,ue.ARROW_DOWN,ue.ARROW_LEFT,ue.ARROW_RIGHT,ue.ARROW_UP,ue.AUDIO_DOWN,ue.AUDIO_MUTE,ue.AUDIO_UP,ue.BACKSPACE,ue.CAPS_LOCK,ue.DELETE,ue.END,ue.ENTER,ue.ESCAPE,ue.F1,ue.F2,ue.F3,ue.F4,ue.F5,ue.F6,ue.F7,ue.F8,ue.F9,ue.F10,ue.F11,ue.F12,ue.F13,ue.F14,ue.F15,ue.F16,ue.F17,ue.F18,ue.F19,ue.HOME,ue.INSERT,ue.MEDIA_NEXT,ue.MEDIA_PLAY_PAUSE,ue.MEDIA_PREV,ue.MEDIA_STOP,ue.NULL,ue.NUM_LOCK,ue.PAGE_DOWN,ue.PAGE_UP,ue.PAUSE,ue.SCROLL_LOCK,ue.SHIFT,ue.TAB];function BL(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function NO(e){return Gne.includes(e)}function Kne(e){var t=[];return eH()?t.push(ue.COMMAND_LEFT,ue.COMMAND_RIGHT,ue.COMMAND_FIREFOX):t.push(ue.CONTROL),t.includes(e)}function HO(e){return[ue.CONTROL,ue.COMMAND_LEFT,ue.COMMAND_RIGHT,ue.COMMAND_FIREFOX].includes(e)}function Oi(e,t){var r=t.split("|"),n=!1;return P(r,function(o){if(e===ue[o])return n=!0,!1}),n}var Xne=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ue,isPrintableChar:BL,isFunctionKey:NO,isCtrlKey:Kne,isCtrlMetaKey:HO,isKey:Oi},Symbol.toStringTag,{value:"Module"}));function qne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qne(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}kf(kre);kf(Wre);kf(one);kf(wne);kf(xne);var Zne=function(){function e(t){qne(this,e),this.wot=t;var r=this.wot,n=r.rootDocument,o=r.rootWindow,i=r.wtTable,a=parseInt(o.getComputedStyle(n.body).lineHeight,10),s=parseInt(o.getComputedStyle(n.body).fontSize,10)*1.2;this.instance=this.wot,this.eventManager=new bt(this.wot),this.scrollbarSize=fr(n),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var l=o.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=l?i.holder:Uu(i.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}return Qne(e,[{key:"prepareOverlays",value:function(){var r=!1;return this.topOverlay?r=this.topOverlay.updateStateOfRendering()||r:this.topOverlay=Ql(Zs,this.wot),Bm(Bn)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),Bm(fi)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?r=this.bottomOverlay.updateStateOfRendering()||r:this.bottomOverlay=Ql(Bn,this.wot),this.leftOverlay?r=this.leftOverlay.updateStateOfRendering()||r:this.leftOverlay=Ql(Js,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?r=this.topLeftCornerOverlay.updateStateOfRendering()||r:this.topLeftCornerOverlay=Ql(el,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?r=this.bottomLeftCornerOverlay.updateStateOfRendering()||r:this.bottomLeftCornerOverlay=Ql(fi,this.wot)),r}},{key:"refreshAll",value:function(){if(!!this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.wot,o=n.rootDocument,i=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(o.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(o.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=i.devicePixelRatio&&i.devicePixelRatio>1,u=this.scrollableElement===i,f=this.wot.wtSettings.getSetting("preventWheel"),c={passive:u};(f||l||!GN())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var p=v.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(b){return r.onCloneWheel(b,f)},c)}});var d;this.eventManager.addEventListener(i,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wot.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.wot.rootWindow,o=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(i!==n&&a!==n&&!r.target.contains(i)||o!==n&&a!==n&&!r.target.contains(o))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var o=this.wot.rootWindow,i=this.leftOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==o&&s!==o&&!s.contains(a),u=i!==o&&s!==o&&!s.contains(i);if(!(this.keyPressed&&(l||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==o&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Oi(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=this.browserLineHeight,o=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*n,o+=o*n);var a=this.scrollVertically(o),s=this.scrollHorizontally(i);return a||s}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.wot.rootWindow,n=this.topOverlay.clone.wtTable.holder,o=this.leftOverlay.clone.wtTable.holder,i=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=i[0],s=i[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=o.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(o.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,o=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=o)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wot,n=r.rootWindow,o=r.wtTable;n.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=o.holder:this.scrollableElement=Uu(o.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtTable.spreader,o=n.clientWidth,i=n.clientHeight;(o!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=o,this.spreaderLastSize.height=i,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.leftOverlay.refresh(r),this.topOverlay.refresh(r),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(r),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(r)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot,o=n.wtViewport,i=n.wtTable,a=this.wot.getSetting("totalColumns"),s=this.wot.getSetting("totalRows"),l=o.getRowHeaderWidth(),u=o.getColumnHeaderHeight(),f=i.hider.style;if(f.width="".concat(l+this.leftOverlay.sumCellSizes(0,a),"px"),f.height="".concat(u+this.topOverlay.sumCellSizes(0,s)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,h=c.scrollHeight,d=c.scrollWidth,v=i.holder,p=v.scrollHeight,b=v.scrollWidth;this.hasScrollbarRight=h<p,this.hasScrollbarBottom=d<b,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>d?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.leftOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){var r=this.wot.wtTable;!r.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],o=null;return P(n,function(i){!i||i.clone&&i.clone.wtTable.TABLE.contains(r)&&(o=i.clone)}),o}},{key:"syncOverlayTableClassNames",value:function(){var r=this.instance.wtTable.TABLE,n=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];P(n,function(o){!o||(o.clone.wtTable.TABLE.className=r.className)})}}]),e}(),Jne=Zne;function eoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function toe(e,t,r){return t&&LA(e.prototype,t),r&&LA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var roe=function(){function e(t){eoe(this,e),this.wot=t}return toe(e,[{key:"scrollViewport",value:function(r,n,o,i,a){if(r.col<0||r.row<0)return!1;var s=this.scrollViewportHorizontally(r.col,o,a),l=this.scrollViewportVertically(r.row,n,i);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,o){if(!this.wot.drawn)return!1;var i=this._getVariables(),a=i.fixedColumnsLeft,s=i.leftOverlay,l=i.totalColumns,u=!1;if(r>=0&&r<=Math.max(l-1,0)){var f=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();r>=a&&f>-1&&(r<f||o)?u=s.scrollTo(r):(c===-1||c>-1&&(r>c||n))&&(u=s.scrollTo(r,!0))}return u}},{key:"scrollViewportVertically",value:function(r,n,o){if(!this.wot.drawn)return!1;var i=this._getVariables(),a=i.fixedRowsBottom,s=i.fixedRowsTop,l=i.topOverlay,u=i.totalRows,f=!1;if(r>=0&&r<=Math.max(u-1,0)){var c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();r>=s&&c>-1&&(r<c||n)?f=l.scrollTo(r):(h===-1||h>-1&&(r>h&&r<u-a||o))&&(f=l.scrollTo(r,!0))}return f}},{key:"getFirstVisibleRow",value:function(){var r=this._getVariables(),n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=this.wot.rootWindow,u=o.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var f=Dt(o.wtRootElement),c=uo(o.hider),h=uo(l),d=Wu(l,l);if(f.top+c-h<=d){var v=i.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var p=a;p>0;p--)if(v+=n.sumCellSizes(p-1,p),f.top+c-v<=d){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this._getVariables(),n=r.topOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalRows,s=this.wot.rootWindow,l=o.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=Dt(o.wtRootElement),f=Wu(s,s);if(u.top>f){for(var c=uo(s),h=i.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this._getVariables(),n=r.leftOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,s=this.wot.rootWindow,l=o.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=Dt(o.wtRootElement),f=xs(o.hider),c=xs(s),h=Yh(s,s);if(u.left+f-c<=h){for(var d=i.getRowHeaderWidth(),v=a;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this._getVariables(),n=r.leftOverlay,o=r.wtTable,i=r.wtViewport,a=r.totalColumns,s=this.wot.rootWindow,l=o.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var u=Dt(o.wtRootElement),f=Yh(s,s);if(u.left>f){for(var c=xs(s),h=i.getRowHeaderWidth(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.left+h-f>=c){l=d-2;break}}}return l}},{key:"_getVariables",value:function(){var r=this.wot,n=r.wtOverlays.topOverlay,o=r.wtOverlays.leftOverlay,i=r.wtTable,a=r.wtViewport,s=r.getSetting("totalRows"),l=r.getSetting("totalColumns"),u=r.getSetting("fixedRowsTop"),f=r.getSetting("fixedRowsBottom"),c=r.getSetting("fixedColumnsLeft");return{topOverlay:n,leftOverlay:o,wtTable:i,wtViewport:a,totalRows:s,totalColumns:l,fixedRowsTop:u,fixedRowsBottom:f,fixedColumnsLeft:c}}}]),e}(),FA=roe;function noe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ooe(e,t,r){return t&&jA(e.prototype,t),r&&jA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ioe=function(){function e(t,r){var n=this;noe(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderLeftOverlay:function(){return n.getSetting("fixedColumnsLeft")>0||n.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return n.getSetting("fixedRowsTop")>0||n.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return n.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,a,s){var l=n.getSetting("data",i,a);_i(s,l==null?"":l)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},ot(this.defaults,function(o,i){if(r[i]!==void 0)n.settings[i]=r[i];else{if(o===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));n.settings[i]=o}})}return ooe(e,[{key:"update",value:function(r,n){var o=this;return n===void 0?ot(r,function(i,a){o.settings[a]=i}):this.settings[r]=n,this.wot}},{key:"getSetting",value:function(r,n,o,i,a){return typeof this.settings[r]=="function"?this.settings[r](n,o,i,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}(),aoe=ioe;function soe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function loe(e,t,r){return t&&BA(e.prototype,t),r&&BA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var uoe=function(){function e(t){var r=this;soe(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new bt(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",function(){r.clientHeight=r.getWorkspaceHeight()})}return loe(e,[{key:"getWorkspaceHeight",value:function(){var r=this.wot.rootDocument,n=this.instance.wtOverlays.topOverlay.trimmingContainer,o=0;if(n===this.wot.rootWindow)o=r.documentElement.clientHeight;else{var i=Ut(n);o=i>0&&n.clientHeight>0?n.clientHeight:1/0}return o}},{key:"getWorkspaceWidth",value:function(){var r=this.wot,n=r.rootDocument,o=r.rootWindow,i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=n.documentElement.offsetWidth,s=r.getSetting("totalColumns"),l=r.getSetting("preventOverflow"),u,f;if(l)return Ft(this.instance.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?u=Math.min(a-this.getWorkspaceOffset().left,a):u=Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>u)return n.documentElement.clientWidth;if(i!==o&&(f=Gh(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",o),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(u,i.clientWidth);var c=r.getSetting("stretchH");return c==="none"||!c?Math.max(u,Ft(this.instance.wtTable.TABLE)):u}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var o=this.wot.wtTable,i=0,a=r;a<n;)i+=o.getColumnWidth(a),a+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.instance.wtTable.holder,n=this.wot.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var o=n.offsetWidth;return this.containerWidth=o,r.removeChild(n),o}},{key:"getWorkspaceOffset",value:function(){return Dt(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Ut(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var r=this.wot.wtTable;return Ft(r.TABLE)||Ft(r.TBODY)||Ft(r.THEAD)}},{key:"getColumnHeaderHeight",value:function(){var r=this.instance.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ut(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.instance.getSetting("rowHeaderWidth"),n=this.instance.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var o=0,i=n.length;o<i;o++)this.rowHeaderWidth+=r[o]||r}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=Ft(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi,n=this.wot,o=n.wtSettings,i=n.wtOverlays,a=n.wtTable,s=n.rootDocument,l,u,f;this.rowHeaderWidth=NaN,o.settings.renderAllRows&&r===Zi?l=1/0:l=this.getViewportHeight();var c=i.topOverlay.getScrollPosition()-i.topOverlay.getTableParentOffset();c<0&&(c=0);var h=n.getSetting("fixedRowsTop"),d=n.getSetting("fixedRowsBottom"),v=n.getSetting("totalRows");return h&&(f=i.topOverlay.sumCellSizes(0,h),c+=f,l-=f),d&&i.bottomOverlay.clone&&(f=i.bottomOverlay.sumCellSizes(v-d,v),l-=f),a.holder.clientHeight===a.holder.offsetHeight?u=0:u=fr(s),new gL({viewportSize:l,scrollOffset:c,totalItems:n.getSetting("totalRows"),itemSizeFn:function(b){return a.getRowHeight(b)},overrideFn:o.settings.viewportRowCalculatorOverride,calculationType:r,scrollbarHeight:u})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi,n=this.wot,o=n.wtSettings,i=n.wtOverlays,a=n.wtTable,s=n.rootDocument,l=this.getViewportWidth(),u=i.leftOverlay.getScrollPosition()-i.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,u<0&&(u=0);var f=n.getSetting("fixedColumnsLeft");if(f){var c=i.leftOverlay.sumCellSizes(0,f);u+=c,l-=c}return a.holder.clientWidth!==a.holder.offsetWidth&&(l-=fr(s)),new RO({viewportSize:l,scrollOffset:u,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(d){return n.wtTable.getColumnWidth(d)},overrideFn:o.settings.viewportColumnCalculatorOverride,calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(d,v){return n.getSetting("onBeforeStretchingColumnWidth",d,v)}})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var o=this.createRowsCalculator(on),i=this.createColumnsCalculator(on);this.areAllProposedVisibleRowsAlreadyRendered(o)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Zi),this.columnsRenderCalculator=this.createColumnsCalculator(Zi)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(on),this.columnsVisibleCalculator=this.createColumnsCalculator(on)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,o=r.endRow,i=this.rowsRenderCalculator,a=i.startRow,s=i.endRow;return n<a||n===a&&n>0?!1:!(o>s||o===s&&o<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,o=r.endColumn,i=this.columnsRenderCalculator,a=i.startColumn,s=i.endColumn;return n<a||n===a&&n>0?!1:!(o>s||o===s&&o<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){ot(this.hasOversizedColumnHeadersMarked,function(r,n,o){o[n]=void 0})}}]),e}(),foe=uoe;function coe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hoe(e,t,r){return t&&VA(e.prototype,t),r&&VA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var doe=function(){function e(t){coe(this,e);var r=[];if(this.guid="wt_".concat(yO()),this.rootDocument=t.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,t.table),this.wtScroll=new FA(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new NA(this),this.selections=this.cloneSource.selections):(this.wtSettings=new aoe(this,t),this.wtTable=new nre(this,t.table),this.wtScroll=new FA(this),this.wtViewport=new foe(this),this.wtEvent=new NA(this),this.selections=this.getSetting("selections"),this.wtOverlays=new Jne(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(i,a){_i(a,r[i])}])}this.drawn=!1,this.drawInterrupted=!1}return hoe(e,[{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsLeft");if(r.row<i&&r.col<s)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(r);if(r.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=o-a){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(r);if(r.row<o&&r.row>=o-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"update",value:function(r,n){return this.wtSettings.update(r,n)}},{key:"scrollViewport",value:function(r,n,o,i,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,o)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var r=this,n={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},o=[],i=[];ot(n,function(a,s){r.getSetting(s).length&&i.push(a),o.push(a)}),Ge(this.wtTable.wtRootElement.parentNode,o),le(this.wtTable.wtRootElement.parentNode,i)}},{key:"getSetting",value:function(r,n,o,i,a){return this.wtSettings.getSetting(r,n,o,i,a)}},{key:"hasSetting",value:function(r){return this.wtSettings.has(r)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),e}(),voe=doe,poe=cr,VL=Ke,goe=gf,yoe=Xr,moe=nf.f,boe=VL(moe),woe=VL([].push),WA=function(e){return function(t){for(var r=yoe(t),n=goe(r),o=n.length,i=0,a=[],s;o>i;)s=n[i++],(!poe||boe(r,s))&&woe(a,e?[s,r[s]]:r[s]);return a}},_oe={entries:WA(!0),values:WA(!1)},Soe=qe,Coe=_oe.values;Soe({target:"Object",stat:!0},{values:function(t){return Coe(t)}});function Ooe(e,t){return koe(e)||Toe(e,t)||Eoe(e,t)||Roe()}function Roe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eoe(e,t){if(!!e){if(typeof e=="string")return UA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UA(e,t)}}function UA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Toe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function koe(e){if(Array.isArray(e))return e}function ab(e){return ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ab(e)}function Aoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ioe(e,t,r){return t&&zA(e.prototype,t),r&&zA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Poe=function(){function e(t,r){Aoe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Ioe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new Wne(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=new Kt(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopLeftCorner(),n=this.cellRange.getOuterBottomRightCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,o,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(new J(n,o));if(ab(s)==="object"){var l=i;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),le(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function o(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(Ve(i,u)){var f=s+1;l="".concat(r,"-").concat(f)}else l=o(i,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),o=r.wtTable.getRenderedColumnsCount(),i=this.getCorners(),a=Ooe(i,4),s=a[0],l=a[1],u=a[2],f=a[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,p=c.highlightOnlyClosestHeader,b=c.selectionType,_=b===void 0||["active-header","header"].includes(b);if(_&&l!==null&&f!==null)for(var S=0,E=0;E<o;E+=1){var M=r.wtTable.columnFilter.renderedToSource(E);if(M>=l&&M<=f){var k=r.wtTable.getColumnHeaders(M),U=k.length-1;p&&k.length>1&&(k=[k[U]]);for(var Y=0;Y<k.length;Y+=1){var ne=[],Z=k[Y];h&&ne.push(h),d&&ne.push(d),Y=p?U:Y;var te=r.getSetting("onBeforeHighlightingColumnHeader",M,Y,{selectionType:b,columnCursor:S,selectionWidth:f-l+1,classNames:ne});te!==M&&(Z=r.wtTable.getColumnHeader(te,Y)),le(Z,ne)}S+=1}}if(s!==null&&u!==null)for(var se=0,he=0;he<n;he+=1){var ae=r.wtTable.rowFilter.renderedToSource(he);if(_&&ae>=s&&ae<=u){var Ce=r.wtTable.getRowHeaders(ae),y=Ce.length-1;p&&Ce.length>1&&(Ce=[Ce[y]]);for(var w=0;w<Ce.length;w+=1){var g=[],m=Ce[w];h&&g.push(h),v&&g.push(v),w=p?y:w;var R=r.getSetting("onBeforeHighlightingRowHeader",ae,w,{selectionType:b,rowCursor:se,selectionHeight:u-s+1,classNames:g});R!==ae&&(m=r.wtTable.getRowHeader(R,w)),le(m,g)}se+=1}if(l!==null&&f!==null)for(var $=0;$<o;$+=1){var I=r.wtTable.columnFilter.renderedToSource($);ae>=s&&ae<=u&&I>=l&&I<=f?this.settings.className&&this.addClassAtCoords(r,ae,I,this.settings.className,this.settings.markIntersections):ae>=s&&ae<=u?v&&this.addClassAtCoords(r,ae,I,v):I>=l&&I<=f&&d&&this.addClassAtCoords(r,ae,I,d);var V=r.getSetting("onAfterDrawSelection",ae,I,this.settings.layerLevel);typeof V=="string"&&this.addClassAtCoords(r,ae,I,V)}}r.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(r).appear(i)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}(),Moe=Poe,YA;function $oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Doe(e,t,r){return t&&GA(e.prototype,t),r&&GA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xoe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var us=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Noe=Rt(YA||(YA=xoe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),Og=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Rg=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),WL=function(){function e(){$oe(this,e),this.globalBucket=this.createEmptyBucket()}return Doe(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return P(us,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))P(n,function(l){return o.add(r,l,i)});else{Og.has(r)&&kt(bO(Noe,{hookName:r,removedInVersion:Og.get(r)})),Rg.has(r)&&kt(Rg.get(r));var a=this.getBucket(i);if(typeof a[r]=="undefined"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&P(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var o=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?P(n,function(a){return o.once(r,a,i)}):(n.runOnce=!0,this.add(r,n,i))}},{key:"remove",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(o);return typeof i[r]!="undefined"&&i[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=this.getBucket(n);return!!(o[r]!==void 0&&o[r].length)}},{key:"run",value:function(r,n,o,i,a,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=Kh(f[h],r,o,i,a,s,l,u);d!==void 0&&(o=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],p=v?v.length:0,b=0;if(p)for(;b<p;){if(!v[b]||v[b].skip){b+=1;continue}var _=Kh(v[b],r,o,i,a,s,l,u);_!==void 0&&(o=_),v[b]&&v[b].runOnce&&this.remove(n,v[b],r),b+=1}}return o}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ot(this.getBucket(r),function(n,o,i){return i[o].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||us.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&us.splice(us.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return Rg.has(r)||Og.has(r)}},{key:"isRegistered",value:function(r){return us.indexOf(r)>=0}},{key:"getRegistered",value:function(){return us}}],[{key:"getSingleton",value:function(){return Loe()}}]),e}(),Hoe=new WL;function Loe(){return Hoe}var Ae=WL;function KA(e){return Voe(e)||Boe(e)||joe(e)||Foe()}function Foe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function joe(e,t){if(!!e){if(typeof e=="string")return sb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sb(e,t)}}function Boe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Voe(e){if(Array.isArray(e))return sb(e)}function sb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Eg=new Map;function hn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Eg.has(e)||Eg.set(e,new Map);var t=Eg.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function o(s){return t.has(s)}function i(){return KA(t.keys())}function a(){return KA(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var lb=new WeakMap,If=hn("editors"),Woe=If.register,UL=If.getItem,zL=If.hasItem,Uoe=If.getNames;If.getValues;function zoe(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Ae.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function YL(e,t){var r;if(typeof e=="function")lb.get(e)||Wr(null,e),r=lb.get(e);else if(typeof e=="string")r=UL(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function GL(e){if(!zL(e))throw Error('No registered editor found under "'.concat(e,'" name'));return UL(e).getConstructor()}function Wr(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new zoe(t);typeof e=="string"&&Woe(e,r),lb.set(t,r)}var Yoe="hooksRefRegisterer",KL={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;P(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;ot(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Kn(KL,"MIXIN_NAME",Yoe,{writable:!1,enumerable:!1});var Goe=KL;function ub(e){return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function Koe(e,t){return Zoe(e)||Qoe(e,t)||qoe(e,t)||Xoe()}function Xoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qoe(e,t){if(!!e){if(typeof e=="string")return XA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XA(e,t)}}function XA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qoe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Zoe(e){if(Array.isArray(e))return e}function Joe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fb(e,t)}function fb(e,t){return fb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},fb(e,t)}function eie(e){var t=nie();return function(){var n=bd(e),o;if(t){var i=bd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tie(this,o)}}function tie(e,t){if(t&&(ub(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rie(e)}function rie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bd(e){return bd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},bd(e)}function qA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ZA(e,t,r){return t&&QA(e.prototype,t),r&&QA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var oie="base",sr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Il=function(){function e(t){qA(this,e),this.hot=t,this.instance=t,this.state=sr.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return ZA(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,o,i,a,s){this.TD=i,this.row=r,this.col=n,this.prop=o,this.originalValue=a,this.cellProperties=s,this.state=sr.VIRGIN}},{key:"extend",value:function(){return function(r){Joe(o,r);var n=eie(o);function o(){return qA(this,o),n.apply(this,arguments)}return ZA(o)}(this.constructor)}},{key:"saveValue",value:function(r,n){var o,i,a,s;if(n){var l=this.hot.getSelectedLast();o=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),a=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else{var u=[this.row,this.col,null,null];o=u[0],i=u[1],a=u[2],s=u[3]}var f=this.hot.runHooks("modifyGetCellCoords",o,i);if(Array.isArray(f)){var c=Koe(f,2);o=c[0],i=c[1]}this.hot.populateFromArray(o,i,r,a,s,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===sr.VIRGIN){var o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(new J(i,a)),this.state=sr.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:jt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,o){var i=this,a;if(o){var s=this._closeCallback;this._closeCallback=function(u){s&&s(u),o(u),i.hot.view.render()}}if(!this.isWaiting()){if(this.state===sr.VIRGIN){this.hot._registerTimeout(function(){i._fireCallbacks(!0)});return}if(this.state===sr.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var l=this.getValue();this.hot.getSettings().trimWhitespace?a=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:a=[[l]],this.state=sr.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(u){i.state=sr.FINISHED,i.discardEditor(u)}):(this.state=sr.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=sr.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){this.state===sr.FINISHED&&(r===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=sr.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=sr.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===sr.WAITING}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsLeft?n="top-left-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsLeft?n="bottom-left-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(n="left"),n}}],[{key:"EDITOR_TYPE",get:function(){return oie}}]),e}();wt(Il,Goe);function iie(e,t){return uie(e)||lie(e,t)||sie(e,t)||aie()}function aie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sie(e,t){if(!!e){if(typeof e=="string")return JA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JA(e,t)}}function JA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lie(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function uie(e){if(Array.isArray(e))return e}function fie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cie(e,t,r){return t&&eI(e.prototype,t),r&&eI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var cb=function(){function e(t,r,n){var o=this;fie(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new bt(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)});for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",function(a){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",a)}),i=Pv(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view.wt.update("onCellDblClick",function(a,s,l){return o.onCellDblClick(a,s,l)})}return cie(e,[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.selection.selectedRange.current().highlight,o=n.row,i=n.col,a=this.instance.runHooks("modifyGetCellCoords",o,i),s=o,l=i;if(Array.isArray(a)){var u=iie(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var f=this.instance.rootDocument.activeElement;if(f&&f.blur(),this.cellProperties.readOnly){this.clearActiveEditor();return}var c=this.instance.getCellEditor(this.cellProperties),h=this.instance.getCell(o,i,!0);if(c&&h){var d=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=YL(c,this.instance),this.activeEditor.prepare(o,i,d,h,v,this.cellProperties)}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){!this.activeEditor||this.activeEditor.beginEditing(r,n)}},{key:"closeEditor",value:function(r,n,o){this.activeEditor?this.activeEditor.finishEditing(r,n,o):o&&o(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"moveSelectionUp",value:function(r){r?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(r){r?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(r){r?this.selection.transformEnd(0,this.instance.getDirectionFactor()):this.selection.transformStart(0,this.instance.getDirectionFactor())}},{key:"moveSelectionLeft",value:function(r){r?this.selection.transformEnd(0,-1*this.instance.getDirectionFactor()):this.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{key:"onAfterDocumentKeyDown",value:function(r){if(!!this.instance.isListening()){this.instance.runHooks("beforeKeyDown",r);var n=r.keyCode;if(!(this.destroyed||n===229)&&!_n(r)&&(this.lastKeyCode=n,!!this.selection.isSelected())){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()&&!NO(n)&&!HO(n)&&!o&&!this.isEditorOpened()){this.openEditor("",r);return}var i=r.shiftKey,a=i?this.selection.setRangeEnd:this.selection.setRangeStart,s;switch(n){case ue.A:!this.isEditorOpened()&&o&&(this.instance.selectAll(),r.preventDefault(),r.stopPropagation());break;case ue.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionUp(i),r.preventDefault(),r.stopPropagation();break;case ue.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionDown(i),r.preventDefault(),r.stopPropagation();break;case ue.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionRight(i),r.preventDefault(),r.stopPropagation();break;case ue.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(o),this.moveSelectionLeft(i),r.preventDefault(),r.stopPropagation();break;case ue.TAB:s=typeof this.tableMeta.tabMoves=="function"?this.tableMeta.tabMoves(r):this.tableMeta.tabMoves,i?this.selection.transformStart(-s.row,-s.col):this.selection.transformStart(s.row,s.col,!0),r.preventDefault(),r.stopPropagation();break;case ue.BACKSPACE:case ue.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),r.preventDefault();break;case ue.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,r),r.preventDefault();break;case ue.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==sr.WAITING&&this.closeEditorAndSaveChanges(o),this.moveSelectionAfterEnter(i)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,r)):this.moveSelectionAfterEnter(i),r.preventDefault(),At(r);break;case ue.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(o),this.activeEditor.focus()),r.preventDefault();break;case ue.HOME:r.ctrlKey||r.metaKey?a.call(this.selection,new J(this.instance.rowIndexMapper.getFirstNotHiddenIndex(0,1),this.selection.selectedRange.current().from.col)):a.call(this.selection,new J(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(0,1))),r.preventDefault(),r.stopPropagation();break;case ue.END:r.ctrlKey||r.metaKey?a.call(this.selection,new J(this.instance.rowIndexMapper.getFirstNotHiddenIndex(this.instance.countRows()-1,-1),this.selection.selectedRange.current().from.col)):a.call(this.selection,new J(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(this.instance.countCols()-1,-1))),r.preventDefault(),r.stopPropagation();break;case ue.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),r.preventDefault(),r.stopPropagation();break;case ue.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),r.preventDefault(),r.stopPropagation();break}}}}},{key:"onCellDblClick",value:function(r,n,o){o.nodeName==="TD"&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,r))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),tI=new WeakMap;cb.getInstance=function(e,t,r){var n=tI.get(e);return n||(n=new cb(e,t,r),tI.set(e,n)),n};var hie=cb,die=qe,vie=Lr,XL=gf,pie=it,gie=pie(function(){XL(1)});die({target:"Object",stat:!0,forced:gie},{keys:function(t){return XL(vie(t))}});var yie=mr,mie=av,bie=Qt,wie=Va,Tg=dr,_ie=Hr,Sie=ja,Cie=OC,rI=sv;mie("match",function(e,t,r){return[function(o){var i=_ie(this),a=o==null?void 0:Sie(o,e);return a?yie(a,o,i):new RegExp(o)[e](Tg(i))},function(n){var o=bie(this),i=Tg(n),a=r(t,o,i);if(a.done)return a.value;if(!o.global)return rI(o,i);var s=o.unicode;o.lastIndex=0;for(var l=[],u=0,f;(f=rI(o,i))!==null;){var c=Tg(f[0]);l[u]=c,c===""&&(o.lastIndex=Cie(i,wie(o.lastIndex),s)),u++}return u===0?null:l}]});var Oie=Ua,Rie=Xr,Eie=Ii,Tie=un,kie=_l,Aie=Math.min,hb=[].lastIndexOf,qL=!!hb&&1/[1].lastIndexOf(1,-0)<0,Iie=kie("lastIndexOf"),Pie=qL||!Iie,Mie=Pie?function(t){if(qL)return Oie(hb,this,arguments)||0;var r=Rie(this),n=Tie(r),o=n-1;for(arguments.length>1&&(o=Aie(o,Eie(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in r&&r[o]===t)return o||0;return-1}:hb,$ie=qe,nI=Mie;$ie({target:"Array",proto:!0,forced:nI!==[].lastIndexOf},{lastIndexOf:nI});var Die=De,xie=bl,Nie=Lr,Hie=af,Lie=un,Fie=Die.TypeError,oI=function(e){return function(t,r,n,o){xie(r);var i=Nie(t),a=Hie(i),s=Lie(i),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw Fie("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(o=r(o,a[l],l,i));return o}},jie={left:oI(!1),right:oI(!0)},Bie=qe,Vie=jie.left,Wie=_l,iI=sf,Uie=Qx,zie=Wie("reduce"),Yie=!Uie&&iI>79&&iI<83;Bie({target:"Array",proto:!0,forced:!zie||Yie},{reduce:function(t){var r=arguments.length;return Vie(this,t,r,r>1?arguments[1]:void 0)}});var Gie=qe,Kie=Wa.findIndex,Xie=yf,db="findIndex",QL=!0;db in[]&&Array(1)[db](function(){QL=!1});Gie({target:"Array",proto:!0,forced:QL},{findIndex:function(t){return Kie(this,t,arguments.length>1?arguments[1]:void 0)}});Xie(db);function kg(e){return Jie(e)||Zie(e)||Qie(e)||qie()}function qie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qie(e,t){if(!!e){if(typeof e=="string")return vb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vb(e,t)}}function Zie(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jie(e){if(Array.isArray(e))return vb(e)}function vb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ZL={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},eae=new RegExp(Object.keys(ZL).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function tae(e){return(e&&e.nodeName||"")==="TABLE"}function pb(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<i;h+=1){for(var d=t&&h===0,v=[],p=0;p<a;p+=1){var b=!d&&r&&p===0,_="";if(d)_="<th>".concat(e.getColHeader(p-f),"</th>");else if(b)_="<th>".concat(e.getRowHeader(h-c),"</th>");else{var S=o[h][p],E=e.getCellMeta(h-c,p-f),M=E.hidden,k=E.rowspan,U=E.colspan;if(!M){var Y=[];if(k&&Y.push('rowspan="'.concat(k,'"')),U&&Y.push('colspan="'.concat(U,'"')),or(S))_="<td ".concat(Y.join(" "),"></td>");else{var ne=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_="<td ".concat(Y.join(" "),">").concat(ne,"</td>")}}}v.push(_)}var Z=["<tr>"].concat(v,["</tr>"]).join("");d?l.splice(1,0,Z):u.splice(-1,0,Z)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function gb(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<i;s+=1){var l=o[s],u=or(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function JL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(V){var q=V.match(/<td\b[^>]*?>/g)[0],oe=V.substring(q.length,V.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),ee="</td>";return"".concat(q).concat(oe).concat(ee)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!tae(i))){var s=o.querySelector('meta[name$="enerator"]'),l=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(V,q){return V+q.colSpan},0)-(l?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,v=0,p=0;if(i.tHead){var b=Array.from(i.tHead.rows).filter(function(V){var q=V.querySelector("td")!==null;return q&&h.push(V),!q});v=b.length,d=v>0,v>1?r.nestedHeaders=Array.from(b).reduce(function(V,q){var oe=Array.from(q.cells).reduce(function(ee,de,Te){if(l&&Te===0)return ee;var me=de.colSpan,Pe=de.innerHTML,We=me>1?{label:Pe,colspan:me}:Pe;return ee.push(We),ee},[]);return V.push(oe),V},[]):d&&(r.colHeaders=Array.from(b[0].children).reduce(function(V,q,oe){return l&&oe===0||V.push(q.innerHTML),V},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var _=[].concat(h,kg(Array.from(i.tBodies).reduce(function(V,q){return V.push.apply(V,kg(Array.from(q.rows))),V},[])),kg(c));p=_.length;for(var S=new Array(p),E=0;E<p;E++)S[E]=new Array(f);for(var M=[],k=[],U=0;U<p;U++)for(var Y=_[U],ne=Array.from(Y.cells),Z=ne.length,te=0;te<Z;te++){var se=ne[te],he=se.nodeName,ae=se.innerHTML,Ce=se.rowSpan,y=se.colSpan,w=S[U].findIndex(function(V){return V===void 0});if(he==="TD"){if(Ce>1||y>1){for(var g=U;g<U+Ce;g++)if(g<p)for(var m=w;m<w+y;m++)S[g][m]=null;var R=se.getAttribute("style"),$=R&&R.includes("mso-ignore:colspan");$||M.push({col:w,row:U,rowspan:Ce,colspan:y})}var I="";s&&/excel/gi.test(s.content)?I=ae.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):I=ae.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[U][w]=I.replace(eae,function(V){return ZL[V]})}else k.push(ae)}return M.length&&(r.mergeCells=M),k.length&&(r.rowHeaders=k),S.length&&(r.data=S),r}}var rae=Object.freeze(Object.defineProperty({__proto__:null,instanceToHTML:pb,_dataToHTML:gb,htmlToGridSettings:JL},Symbol.toStringTag,{value:"Module"}));function nae(e){return sae(e)||aae(e)||iae(e)||oae()}function oae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iae(e,t){if(!!e){if(typeof e=="string")return yb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yb(e,t)}}function aae(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sae(e){if(Array.isArray(e))return yb(e)}function yb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mb(e){return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function zr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=mb(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(nae(t)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function eF(e){return zr(e,[","])}function Ie(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function wd(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function LO(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}var lae=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:zr,isNumericLike:eF,rangeEach:Ie,rangeEachReverse:wd,valueAccordingPercent:LO},Symbol.toStringTag,{value:"Module"}));function uae(e){return hae(e)||cae(e)||tF(e)||fae()}function fae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cae(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hae(e){if(Array.isArray(e))return bb(e)}function dae(e,t){return gae(e)||pae(e,t)||tF(e,t)||vae()}function vae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tF(e,t){if(!!e){if(typeof e=="string")return bb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bb(e,t)}}function bb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pae(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function gae(e){if(Array.isArray(e))return e}var wb="asc",yae="desc",aI=new Map([[wb,[-1,1]],[yae,[1,-1]]]),mae=function(t){return"The priority '".concat(t,"' is already declared in a map.")},bae=function(t){return"The priority '".concat(t,"' is not a number.")};function wae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=Ct(t)?t:mae,r=Ct(r)?r:bae;function o(a,s){if(!zr(a))throw new Error(r(a));if(n.has(a))throw new Error(t(a));n.set(a,s)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wb,s=aI.get(a)||aI.get(wb),l=dae(s,2),u=l[0],f=l[1];return uae(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:o,getItems:i}}var _ae=qe,Sae=Wa.find,Cae=yf,_b="find",rF=!0;_b in[]&&Array(1)[_b](function(){rF=!1});_ae({target:"Array",proto:!0,forced:rF},{find:function(t){return Sae(this,t,arguments.length>1?arguments[1]:void 0)}});Cae(_b);function Oae(e){return Tae(e)||Eae(e)||nF(e)||Rae()}function Rae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eae(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tae(e){if(Array.isArray(e))return Sb(e)}function sI(e,t){return Iae(e)||Aae(e,t)||nF(e,t)||kae()}function kae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nF(e,t){if(!!e){if(typeof e=="string")return Sb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sb(e,t)}}function Sb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Aae(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Iae(e){if(Array.isArray(e))return e}var Pae=function(t){return"The id '".concat(t,"' is already declared in a map.")};function oF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=Ct(t)?t:Pae;function n(u,f){if(l(u))throw new Error(t(u));r.set(u,f)}function o(){r.clear()}function i(u){var f=s().find(function(d){var v=sI(d,2),p=v[0],b=v[1];return u===b?p:!1})||[null],c=sI(f,1),h=c[0];return h}function a(u){return r.get(u)}function s(){return Oae(r)}function l(u){return r.has(u)}return{addItem:n,clear:o,getId:i,getItem:a,getItems:s,hasItem:l}}function Mae(e){return Nae(e)||xae(e)||Dae(e)||$ae()}function $ae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dae(e,t){if(!!e){if(typeof e=="string")return Cb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cb(e,t)}}function xae(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nae(e){if(Array.isArray(e))return Cb(e)}function Cb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Hae=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Lae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=Ct(t)?t:Hae;function n(i){if(r.has(i))throw new Error(t(i));r.add(i)}function o(){return Mae(r)}return{addItem:n,getItems:o}}function Fae(e,t){return Vae(e)||Bae(e,t)||iF(e,t)||jae()}function jae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bae(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Vae(e){if(Array.isArray(e))return e}function lI(e){return zae(e)||Uae(e)||iF(e)||Wae()}function Wae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iF(e,t){if(!!e){if(typeof e=="string")return Ob(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ob(e,t)}}function Uae(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zae(e){if(Array.isArray(e))return Ob(e)}function Ob(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var FO=function(t){return'There is already registered "'.concat(t,'" plugin.')},Yae=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Gae=function(t){return'The priority "'.concat(t,'" is not a number.')},aF=wae({errorPriorityExists:Yae,errorPriorityNaN:Gae}),sF=Lae({errorItemExists:FO}),Rb=oF({errorIdExists:FO});function jO(){return[].concat(lI(aF.getItems()),lI(sF.getItems()))}function Pf(e){var t=an(e);return Rb.getItem(t)}function Kae(e){return!!Pf(e)}function ht(e,t,r){var n=qae(e,t,r),o=Fae(n,3);e=o[0],t=o[1],r=o[2],Pf(e)===void 0&&Xae(e,t,r)}function Xae(e,t,r){var n=an(e);if(Rb.hasItem(n))throw new Error(FO(n));r===void 0?sF.addItem(n):aF.addItem(r,n),Rb.addItem(n,t)}function qae(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var Mf=hn("renderers"),Qae=Mf.register,Zae=Mf.getItem,lF=Mf.hasItem,Jae=Mf.getNames;Mf.getValues;function BO(e){if(typeof e=="function")return e;if(!lF(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Zae(e)}function ro(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),Qae(e,t)}var $f=hn("validators"),ese=$f.register,tse=$f.getItem,uF=$f.hasItem,rse=$f.getNames;$f.getValues;function VO(e){if(typeof e=="function")return e;if(!uF(e))throw Error('No registered validator found under "'.concat(e,'" name'));return tse(e)}function As(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),ese(e,t)}function uI(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,s=i.isSelected()?i.getSelectedRange().current():null,l=i.isSelectedByCorner(),u=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(l||u)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(new J(o.row,o.col)):l&&o.row<0&&!a.column?i.setRangeEnd(new J(s.to.row,o.col)):u&&o.col<0&&!a.row?i.setRangeEnd(new J(o.row,s.to.col)):(!l&&!u&&o.col<0||l&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!l&&!u&&o.row<0||u&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),c=r||n&&f;o.row<0&&o.col>=0&&!a.column?c&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?c&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?c&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function nse(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller;if(!!t){var i=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),l=n.tableProps.countRows();a&&!o.column?n.setRangeEnd(new J(l-1,r.col)):i&&!o.row?n.setRangeEnd(new J(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var ose=new Map([["mousedown",uI],["mouseover",nse],["touchstart",uI]]);function fI(e,t){var r=t.coords,n=t.selection,o=t.controller;ose.get(e.type)({coords:r,selection:n,controller:o,isShiftKey:e.shiftKey,isLeftClick:$v(e)||e.type==="touchstart",isRightClick:Ci(e)})}var fF=new WeakMap,WO=Symbol("rootInstance");function ise(e){fF.set(e,!0)}function ase(e){return e===WO}function Eb(e){return fF.has(e)}function Zl(e,t){return use(e)||lse(e,t)||cF(e,t)||sse()}function sse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lse(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function use(e){if(Array.isArray(e))return e}function fh(e,t,r){return fse()?fh=Reflect.construct:fh=function(o,i,a){var s=[null];s.push.apply(s,i);var l=Function.bind.apply(o,s),u=new l;return a&&Tb(u,a.prototype),u},fh.apply(null,arguments)}function fse(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tb(e,t){return Tb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Tb(e,t)}function cI(e){return dse(e)||hse(e)||cF(e)||cse()}function cse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cF(e,t){if(!!e){if(typeof e=="string")return kb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kb(e,t)}}function hse(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dse(e){if(Array.isArray(e))return kb(e)}function kb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pse(e,t,r){return t&&hI(e.prototype,t),r&&hI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Bi=new WeakMap,gse=function(){function e(t){vse(this,e),this.instance=t,this.eventManager=new bt(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,Bi.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return pse(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this.wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var o=this.wt.getCell(r,n);return o<0?null:o}},{key:"scrollViewport",value:function(r,n,o,i,a){return this.wt.scrollViewport(r,n,o,i,a)}},{key:"scrollViewportHorizontally",value:function(r,n,o){return this.wt.scrollViewportHorizontally(r,n,o)}},{key:"scrollViewportVertically",value:function(r,n,o){return this.wt.scrollViewportVertically(r,n,o)}},{key:"createElements",value:function(){var r=Bi.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=o.getAttribute("style");a&&o.setAttribute("data-originalstyle",a),le(o,"handsontable"),r.table=i.createElement("TABLE"),le(r.table,"htCore"),this.instance.getSettings().tableClassName&&le(r.table,this.instance.getSettings().tableClassName),this.THEAD=i.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=i.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Bi.get(this),o=this.instance,i=o.rootElement,a=o.rootDocument,s=o.selection,l=a.documentElement;this.eventManager.addEventListener(i,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;Tm(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(i,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(i,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&Tm(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&$v(u)&&s.finish(),n.mouseDown=!1,(SO(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!i.contains(u.target)&&!Ci(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&Ci(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!i||!r.instance.view)){var v=r.instance.view.wt.wtTable.holder;if(d===v){var p=fr(a);if(a.elementFromPoint(c+p,h)!==v||a.elementFromPoint(c,h+p)!==v)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===i)return;d=d.parentNode}var b=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;b?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Yu(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n=r.row,o=r.col;return fh(J,cI(this.translateFromRenderableToVisualIndex(n,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var o=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,i=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return o===null&&(o=r),i===null&&(i=n),[o,i]}},{key:"countRenderableIndexes",value:function(r,n){var o=Math.min(r.getNotTrimmedIndexesLength(),n),i=r.getFirstNotHiddenIndex(o-1,-1);return i===null?0:r.getRenderableFromVisualIndex(i)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,o,i){if(isNaN(r)||r<0)return 0;var a=o.getFirstNotHiddenIndex(r,n),s=o.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=i-s),l}},{key:"initializeWalkontable",value:function(){var r=this,n=Bi.get(this),o={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return Eb(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,cI(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsLeft:function(){var f=r.instance.countCols(),c=Math.min(parseInt(r.settings.fixedColumnsLeft,10),f)-1;return r.countNotHiddenColumnIndexes(c,-1)},fixedRowsTop:function(){var f=r.instance.countRows(),c=Math.min(parseInt(r.settings.fixedRowsTop,10),f)-1;return r.countNotHiddenRowIndexes(c,-1)},fixedRowsBottom:function(){var f=r.instance.countRows(),c=Math.max(f-parseInt(r.settings.fixedRowsBottom,10),0);return r.countNotHiddenRowIndexes(c,1)},shouldRenderLeftOverlay:function(){return r.settings.fixedColumnsLeft>0||o.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||o.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=Zl(d,2),p=v[0],b=v[1],_=r.instance.runHooks("modifyGetCellCoords",p,b),S=p,E=b;if(Array.isArray(_)){var M=Zl(_,2);S=M[0],E=M[1]}var k=r.instance.getCellMeta(S,E),U=r.instance.colToProp(E),Y=r.instance.getDataAtRowProp(S,U);r.instance.hasHook("beforeValueRender")&&(Y=r.instance.runHooks("beforeValueRender",Y,k)),r.instance.runHooks("beforeRenderer",h,p,b,U,Y,k),r.instance.getCellRenderer(k)(r.instance,h,p,b,U,Y,k),r.instance.runHooks("afterRenderer",h,p,b,U,Y,k)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){!r.instance||r.instance.isDestroyed||r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,p),!_n(f)&&(fI(f,{coords:v,selection:r.instance.selection,controller:p}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r.wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!_n(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r.wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!_n(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r.wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,p),!_n(f)&&(n.mouseDown&&fI(f,{coords:v,selection:r.instance.selection,controller:p}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r.wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(_n(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r.wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getFirstNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getFirstNotHiddenIndex(p,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),p=Zl(v,2),b=p[0],_=p[1],S=r.instance.selection.getSelectedRange(),E=S.size();if(E>0){var M=(h!=null?h:0)+1-E,k=S.peekByIndex(M);d=[k.from.row,k.from.col,k.to.row,k.to.col]}return r.instance.runHooks("afterDrawSelection",b,_,d,h)},onBeforeDrawBorders:function(f,c){var h=Zl(f,4),d=h[0],v=h[1],p=h[2],b=h[3],_=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(b)];return r.instance.runHooks("beforeDrawBorders",_,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,p=c>=0?v.getVisualFromRenderableIndex(c):c,b=f>=0?d.getVisualFromRenderableIndex(f):f,_=r.instance.runHooks("modifyGetCellCoords",b,p,h);if(Array.isArray(_)){var S=Zl(_,4),E=S[0],M=S[1],k=S[2],U=S[3];return[E>=0?d.getRenderableFromVisualIndex(d.getFirstNotHiddenIndex(E,1)):E,M>=0?v.getRenderableFromVisualIndex(v.getFirstNotHiddenIndex(M,1)):M,k>=0?d.getRenderableFromVisualIndex(d.getFirstNotHiddenIndex(k,-1)):k,U>=0?v.getRenderableFromVisualIndex(v.getFirstNotHiddenIndex(U,-1)):U]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var p=Math.ceil(v/h*12);f.startRow=Math.max(d-p,0),f.endRow=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsLeft&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var p=Math.ceil(v/h*6);f.startColumn=Math.max(d-p,0),f.endColumn=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",o),this.wt=new voe(o),this.activeWt=this.wt;var i=this.wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(i,"mousedown",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(i,"contextmenu",function(u){u.target===i&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r.wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Yu(r))return!0;var n=ui(r,this.instance.view.wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Bi.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;if(!Ve(o,"relative")){sn(n),this.appendRowHeader(r,n);return}this.updateCellHeader(o.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var i=this.instance,a=i.rootDocument,s=i.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){if(n.firstChild){var o=n.firstChild;Ve(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,this.instance.getColHeader):(sn(n),this.appendColHeader(r,n))}else{var i=this.instance.rootDocument,a=i.createElement("div"),s=i.createElement("span");a.className="relative",s.className="colHeader",this.updateCellHeader(s,r,this.instance.getColHeader),a.appendChild(s),n.appendChild(a)}this.instance.runHooks("afterGetColHeader",r,n)}},{key:"updateCellHeader",value:function(r,n,o){var i=n,a=this.wt.wtOverlays.getParentOverlay(r)||this.wt;r.parentNode&&(Ve(r,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(n):Ve(r,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(n))),i>-1?Mi(r,o(n)):(_i(r,String.fromCharCode(160)),le(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this.wt.wtViewport.getWorkspaceWidth(),o=n-r;return o>0?o:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this.wt.wtViewport.getWorkspaceHeight(),o=n-r;return o>0?o:0}},{key:"setLastSize",value:function(r,n){var o=Bi.get(this),i=[r,n];o.lastWidth=i[0],o.lastHeight=i[1]}},{key:"getLastSize",value:function(){var r=Bi.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}]),e}(),yse=gse,Df=hn("cellTypes"),mse=Df.register,bse=Df.getItem,hF=Df.hasItem,wse=Df.getNames;Df.getValues;function Dv(e){if(!hF(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return bse(e)}function gn(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,o=r.renderer,i=r.validator;n&&Wr(e,n),o&&ro(e,o),i&&As(e,i),mse(e,t)}function Ab(e){return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}var dF="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ib=dF.length;function xv(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%Ib,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/Ib,10);return r}function _se(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(Ib,n)*(dF.indexOf(e[r])+1);return t-=1,t}function Sse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i=[];for(o=0;o<t;o++)i.push(xv(o)+(n+1));r.push(i)}return r}function Cse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,o;for(n=0;n<e;n++){var i={};for(o=0;o<t;o++)i["prop".concat(o)]=xv(o)+(n+1);r.push(i)}return r}function Ose(e,t){for(var r=[],n,o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function Ou(e,t){var r=typeof t=="undefined"?!0:t;return function(o,i){return function a(s){if(!!s){if(Ot(s,e)&&s[e]!==void 0)return s[e];if(Ot(s,"type")&&s.type){if(typeof s.type!="string")throw new Error('Cell "type" must be a string');var l=Dv(s.type);if(Ot(l,e))return l[e];if(r)return}return a(Object.getPrototypeOf(s))}}(typeof o=="number"?this.getCellMeta(o,i):o)}}function Pb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,s){n.push([i+t,s,a])}):Object.keys(o).forEach(function(a){n.push([i+t,a,o[a]])})}),n}function UO(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ze(e[0])&&(t=gv(e[0]))),t}function vF(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function pF(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Ab(t)==="object"&&!Array.isArray(t)&&t!==null}))}var Rse=Object.freeze(Object.defineProperty({__proto__:null,spreadsheetColumnLabel:xv,spreadsheetColumnIndex:_se,createSpreadsheetData:Sse,createSpreadsheetObjectData:Cse,createEmptySpreadsheetData:Ose,cellMethodLookupFactory:Ou,dataRowToChangesArray:Pb,countFirstRowKeys:UO,isArrayOfArrays:vF,isArrayOfObjects:pF},Symbol.toStringTag,{value:"Module"}));function Ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tse(e,t,r){return t&&dI(e.prototype,t),r&&dI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var kse=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ese(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Tse(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,o=[];return P(this.data,function(i,a){var s=n.getAtCell(a,r);o.push(s)}),o}},{key:"getAtRow",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&o===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=i.getAtPhysicalCell(r,d,l)}):Ie(n,o,function(h){u[h-n]=i.getAtPhysicalCell(r,h,l)});else if(Ze(l)||Ct(l))if(a?u=[]:u={},!s||a){var f=0,c=this.countFirstRowKeys()-1;Ie(f,c,function(h){var d=i.colToProp(h);if(h>=(n||f)&&h<=(o||c)&&!Number.isInteger(d)){var v=i.getAtPhysicalCell(r,d,l);a?u.push(v):eh(u,d,v)}})}else ot(l,function(h,d){eh(u,d,i.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,o){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var i=Pa(o);this.hot.runHooks("modifySourceData",r,this.propToCol(n),i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(n)?this.data[r][n]=o:eh(this.data[r],n,o)}}},{key:"getAtPhysicalCell",value:function(r,n,o){var i=null;if(o&&(typeof n=="string"?i=UN(o,n):typeof n=="function"?i=n(o):i=o[n]),this.hot.hasHook("modifySourceData")){var a=Pa(i);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(i=a.value)}return i}},{key:"getAtCell",value:function(r,n){var o=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),o)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,f=null;n===null||o===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(n.row,o.row),f=Math.max(n.col,o.col));var c=[];return Ie(s,u,function(h){c.push(a?r.getAtRow(h,void 0,void 0,i):r.getAtRow(h,l,f,i))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return UO(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),Ase=kse,vI=hr,Ise=function(e){return e!==void 0&&(vI(e,"value")||vI(e,"writable"))},Pse=qe,Mse=mr,$se=qt,Dse=Qt,xse=Ise,Nse=Gn,Hse=uv;function gF(e,t){var r=arguments.length<3?e:arguments[2],n,o;if(Dse(e)===r)return e[t];if(n=Nse.f(e,t),n)return xse(n)?n.value:n.get===void 0?void 0:Mse(n.get,r);if($se(o=Hse(e)))return gF(o,t,r)}Pse({target:"Reflect",stat:!0},{get:gF});var Lse=qe,Fse=it,jse=Xr,yF=Gn.f,mF=cr,Bse=Fse(function(){yF(1)}),Vse=!mF||Bse;Lse({target:"Object",stat:!0,forced:Vse,sham:!mF},{getOwnPropertyDescriptor:function(t,r){return yF(jse(t),r)}});var Wse="localHooks",bF={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,o,i,a,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)Kh(this._localHooks[t][u],this,r,n,o,i,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Kn(bF,"MIXIN_NAME",Wse,{writable:!1,enumerable:!1});var Fr=bF;function Use(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zse(e,t,r){return t&&pI(e.prototype,t),r&&pI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ka=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Use(this,e),this.indexedValues=[],this.initValueOrFn=t}return zse(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ct(this.initValueOrFn)?Ie(n-1,function(o){return r.indexedValues.push(r.initValueOrFn(o))}):Ie(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();wt(Ka,Fr);function Ag(e){return Xse(e)||Kse(e)||Gse(e)||Yse()}function Yse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gse(e,t){if(!!e){if(typeof e=="string")return Mb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mb(e,t)}}function Kse(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xse(e){if(Array.isArray(e))return Mb(e)}function Mb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zO(e,t,r,n){var o=r.length?r[0]:void 0;return[].concat(Ag(e.slice(0,o)),Ag(r.map(function(i,a){return Ct(n)?n(i,a):n})),Ag(o===void 0?[]:e.slice(o)))}function YO(e,t){return Gr(e,function(r,n){return t.includes(n)===!1})}function $b(e){return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function qse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qse(e,t,r){return t&&gI(e.prototype,t),r&&gI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ru(){return typeof Reflect!="undefined"&&Reflect.get?Ru=Reflect.get:Ru=function(t,r,n){var o=Zse(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ru.apply(this,arguments)}function Zse(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Da(e),e!==null););return e}function Jse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Db(e,t)}function Db(e,t){return Db=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Db(e,t)}function ele(e){var t=nle();return function(){var n=Da(e),o;if(t){var i=Da(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tle(this,o)}}function tle(e,t){if(t&&($b(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rle(e)}function rle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Da(e){return Da=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Da(e)}var $i=function(e){Jse(r,e);var t=ele(r);function r(){return qse(this,r),t.apply(this,arguments)}return Qse(r,[{key:"insert",value:function(o,i){this.indexedValues=zO(this.indexedValues,o,i,this.initValueOrFn),Ru(Da(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=YO(this.indexedValues,o),Ru(Da(r.prototype),"remove",this).call(this,o)}}]),r}(Ka);function xb(e){return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function ole(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ile(e,t,r){return t&&yI(e.prototype,t),r&&yI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ale(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nb(e,t)}function Nb(e,t){return Nb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Nb(e,t)}function sle(e){var t=fle();return function(){var n=_d(e),o;if(t){var i=_d(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lle(this,o)}}function lle(e,t){if(t&&(xb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ule(e)}function ule(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _d(e){return _d=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_d(e)}var Nv=function(e){ale(r,e);var t=sle(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return ole(this,r),t.call(this,n)}return ile(r,[{key:"getHiddenIndexes",value:function(){return zt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}($i);function Ig(e){return vle(e)||dle(e)||hle(e)||cle()}function cle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hle(e,t){if(!!e){if(typeof e=="string")return Hb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hb(e,t)}}function dle(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vle(e){if(Array.isArray(e))return Hb(e)}function Hb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GO(e,t,r){return[].concat(Ig(e.slice(0,t)),Ig(r),Ig(e.slice(t)))}function Xu(e,t){return Gr(e,function(r){return t.includes(r)===!1})}function KO(e,t){return et(e,function(r){return r-t.filter(function(n){return n<r}).length})}function XO(e,t){var r=t[0],n=t.length;return et(e,function(o){return o>=r?o+n:o})}function Lb(e){return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function ple(e){return ble(e)||mle(e)||yle(e)||gle()}function gle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yle(e,t){if(!!e){if(typeof e=="string")return Fb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fb(e,t)}}function mle(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ble(e){if(Array.isArray(e))return Fb(e)}function Fb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _le(e,t,r){return t&&mI(e.prototype,t),r&&mI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oo(){return typeof Reflect!="undefined"&&Reflect.get?oo=Reflect.get:oo=function(t,r,n){var o=Sle(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oo.apply(this,arguments)}function Sle(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mn(e),e!==null););return e}function Cle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jb(e,t)}function jb(e,t){return jb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},jb(e,t)}function Ole(e){var t=Ele();return function(){var n=mn(e),o;if(t){var i=mn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Rle(this,o)}}function Rle(e,t){if(t&&(Lb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wF(e)}function wF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ele(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},mn(e)}function Tle(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Hv=function(e){Cle(r,e);var t=Ole(r);function r(){var n;wle(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Tle(wF(n),"orderOfIndexes",[]),n}return _le(r,[{key:"getValues",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return o.indexedValues[i]})}},{key:"setValues",value:function(o){this.orderOfIndexes=ple(Array(o.length).keys()),oo(mn(r.prototype),"setValues",this).call(this,o)}},{key:"setValueAtIndex",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return o<this.indexedValues.length?(this.indexedValues[o]=i,this.orderOfIndexes.includes(o)===!1&&this.orderOfIndexes.splice(a,0,o),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(o){this.orderOfIndexes=Xu(this.orderOfIndexes,[o]),Ct(this.initValueOrFn)?oo(mn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn(o)):oo(mn(r.prototype),"setValueAtIndex",this).call(this,o,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,oo(mn(r.prototype),"setDefaultValues",this).call(this,o)}},{key:"insert",value:function(o,i){this.indexedValues=zO(this.indexedValues,o,i,this.initValueOrFn),this.orderOfIndexes=XO(this.orderOfIndexes,i),oo(mn(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=YO(this.indexedValues,o),this.orderOfIndexes=Xu(this.orderOfIndexes,o),this.orderOfIndexes=KO(this.orderOfIndexes,o),oo(mn(r.prototype),"remove",this).call(this,o)}},{key:"getEntries",value:function(){var o=this;return this.orderOfIndexes.map(function(i){return[i,o.getValueAtIndex(i)]})}}]),r}(Ka);function Bb(e){return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function kle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ale(e,t,r){return t&&bI(e.prototype,t),r&&bI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ile(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vb(e,t)}function Vb(e,t){return Vb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Vb(e,t)}function Ple(e){var t=Dle();return function(){var n=Sd(e),o;if(t){var i=Sd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Mle(this,o)}}function Mle(e,t){if(t&&(Bb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $le(e)}function $le(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sd(e){return Sd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Sd(e)}var xf=function(e){Ile(r,e);var t=Ple(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return kle(this,r),t.call(this,n)}return Ale(r,[{key:"getTrimmedIndexes",value:function(){return zt(this.getValues(),function(o,i,a){return i&&o.push(a),o},[])}}]),r}($i),wI=new Map([["indexesSequence",{getListWithInsertedItems:GO,getListWithRemovedItems:Xu}],["physicallyIndexed",{getListWithInsertedItems:zO,getListWithRemovedItems:YO}]]),_F=function(t){if(wI.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return wI.get(t)};function Wb(e){return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function xle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nle(e,t,r){return t&&_I(e.prototype,t),r&&_I(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eu(){return typeof Reflect!="undefined"&&Reflect.get?Eu=Reflect.get:Eu=function(t,r,n){var o=Hle(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eu.apply(this,arguments)}function Hle(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xa(e),e!==null););return e}function Lle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ub(e,t)}function Ub(e,t){return Ub=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Ub(e,t)}function Fle(e){var t=Vle();return function(){var n=xa(e),o;if(t){var i=xa(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return jle(this,o)}}function jle(e,t){if(t&&(Wb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ble(e)}function Ble(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xa(e){return xa=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},xa(e)}var SF=function(e){Lle(r,e);var t=Fle(r);function r(){return xle(this,r),t.call(this,function(n){return n})}return Nle(r,[{key:"insert",value:function(o,i){var a=XO(this.indexedValues,i);this.indexedValues=GO(a,o,i),Eu(xa(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=Xu(this.indexedValues,o);this.indexedValues=KO(i,o),Eu(xa(r.prototype),"remove",this).call(this,o)}}]),r}(Ka),SI=new Map([["hiding",Nv],["index",Ka],["linkedPhysicalIndexToValue",Hv],["physicalIndexToValue",$i],["trimming",xf]]);function Wle(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!SI.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(SI.get(e))(t)}function Ule(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zle(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var zb=0,qO=function(){function e(){Ule(this,e),this.collection=new Map}return zle(e,[{key:"register",value:function(r,n){var o=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return o.runLocalHooks("change",n)}),zb+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);He(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),zb-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,o){return r.unregister(o)}),this.collection.clear()}},{key:"get",value:function(r){return It(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(o){o.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();wt(qO,Fr);function Yle(){return zb}function Yb(e){return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(e)}function Gle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kle(e,t,r){return t&&OI(e.prototype,t),r&&OI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gb(e,t)}function Gb(e,t){return Gb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Gb(e,t)}function qle(e){var t=Jle();return function(){var n=Cd(e),o;if(t){var i=Cd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Qle(this,o)}}function Qle(e,t){if(t&&(Yb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zle(e)}function Zle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cd(e){return Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Cd(e)}var RI=function(e){Xle(r,e);var t=qle(r);function r(n,o){var i;return Gle(this,r),i=t.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Kle(r,[{key:"getMergedValues",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var i=et(this.get(),function(c){return c.getValues()}),a=[],s=He(i[0])&&i[0].length||0,l=0;l<s;l+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(i[f][l]);a.push(u)}return et(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(o,i){var a=this.getMergedValues(i)[o];return He(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(qO);function eue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tue(e,t,r){return t&&EI(e.prototype,t),r&&EI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rue(e,t,r){nue(e,t),t.set(e,r)}function nue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oue(e,t,r){var n=CF(e,t,"set");return iue(e,n,r),r}function iue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function aue(e,t){var r=CF(e,t,"get");return sue(e,r)}function CF(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function sue(e,t){return t.get?t.get.call(e):t.value}var Pg=new WeakMap,OF=function(){function e(){eue(this,e),rue(this,Pg,{writable:!0,value:[]})}return tue(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(aue(this,Pg)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){oue(this,Pg,r)}}]),e}();wt(OF,Fr);function TI(e,t){for(var r=[],n=0,o=0;n<e.length&&o<t.length;n++,o++)e[n]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[n],newValue:t[o]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function lue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uue(e,t,r){return t&&kI(e.prototype,t),r&&kI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jl(e,t,r){fue(e,t),t.set(e,r)}function fue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zr(e,t){var r=RF(e,t,"get");return cue(e,r)}function cue(e,t){return t.get?t.get.call(e):t.value}function bc(e,t,r){var n=RF(e,t,"set");return hue(e,n,r),r}function RF(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hue(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var wc=new WeakMap,eu=new WeakMap,_c=new WeakMap,Sc=new WeakMap,Cc=new WeakMap,due=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;lue(this,e),Jl(this,wc,{writable:!0,value:new Set}),Jl(this,eu,{writable:!0,value:[]}),Jl(this,_c,{writable:!0,value:[]}),Jl(this,Sc,{writable:!0,value:!1}),Jl(this,Cc,{writable:!0,value:!1}),bc(this,Cc,r!=null?r:!1)}return uue(e,[{key:"createObserver",value:function(){var r=this,n=new OF;return Zr(this,wc).add(n),n.addLocalHook("unsubscribe",function(){Zr(r,wc).delete(n)}),n._writeInitialChanges(TI(Zr(this,eu),Zr(this,_c))),n}},{key:"emit",value:function(r){var n=Zr(this,_c);(!Zr(this,Sc)||Zr(this,eu).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Zr(this,Cc)):bc(this,eu,new Array(r.length).fill(Zr(this,Cc))),Zr(this,Sc)||(bc(this,Sc,!0),n=Zr(this,eu)));var o=TI(n,r);Zr(this,wc).forEach(function(i){return i._write(o)}),bc(this,_c,r)}}]),e}();function Mg(e){return yue(e)||gue(e)||pue(e)||vue()}function vue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pue(e,t){if(!!e){if(typeof e=="string")return Kb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kb(e,t)}}function gue(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yue(e){if(Array.isArray(e))return Kb(e)}function Kb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bue(e,t,r){return t&&AI(e.prototype,t),r&&AI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Xb=function(){function e(){var t=this;mue(this,e),this.indexesSequence=new SF,this.trimmingMapsCollection=new RI(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new RI(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new qO,this.hidingChangesObservable=new due({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return bue(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,o){return this.registerMap(r,Wle(n,o))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof xf?this.trimmingMapsCollection.register(r,n):n instanceof Nv?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var o=this.getNumberOfIndexes();return o>0&&n.init(o),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return He(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return He(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return He(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return He(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n,a=this.getPhysicalFromVisualIndex(r);return a===null?o===!0&&i!==r-n?this.getFirstNotHiddenIndex(i,-n,!1,i):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,o,i)}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Mg(new Array(r).keys()),this.notHiddenIndexesCache=Mg(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var o=Mg(Array(this.getNumberOfIndexes()-r).keys()).map(function(i){return i+r});this.removeIndexes(o)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isTrimmed(i)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var o=this.getIndexesSequence();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var o=this.getNotTrimmedIndexes();return o.filter(function(i){return r.isHidden(i)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var o=this;typeof r=="number"&&(r=[r]);var i=et(r,function(c){return o.getPhysicalFromVisualIndex(c)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=Xu(this.getIndexesSequence(),i),u=a-s;if(n+s<a){var f=l.filter(function(c){return o.isTrimmed(c)===!1})[n];u=l.indexOf(f)}this.setIndexesSequence(GO(l,u,i))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var o=this.getNotTrimmedIndexes()[r],i=He(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),s=et(new Array(n).fill(i),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(a,s),this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(o,n)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var o=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,n)}}}]),e}();wt(Xb,Fr);var II;function wue(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _ue(e,t){return ot(t,function(r,n){It(e[n])&&(e[n]=r)}),e}function EF(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function TF(e){He(e)&&TO(Rt(II||(II=wue(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function Sue(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var kF=hn("phraseFormatters"),Cue=kF.register,Oue=kF.getValues;function Rue(e,t){Cue(e,t)}function Eue(){return Oue()}Rue("pluralize",Sue);var tt="ContextMenu:items",QO="".concat(tt,".noItems"),ZO="".concat(tt,".insertRowAbove"),JO="".concat(tt,".insertRowBelow"),eR="".concat(tt,".insertColumnOnTheLeft"),tR="".concat(tt,".insertColumnOnTheRight"),rR="".concat(tt,".removeRow"),nR="".concat(tt,".removeColumn"),oR="".concat(tt,".undo"),iR="".concat(tt,".redo"),aR="".concat(tt,".readOnly"),sR="".concat(tt,".clearColumn"),lR="".concat(tt,".copy"),uR="".concat(tt,".cut"),fR="".concat(tt,".freezeColumn"),cR="".concat(tt,".unfreezeColumn"),hR="".concat(tt,".mergeCells"),dR="".concat(tt,".unmergeCells"),vR="".concat(tt,".addComment"),pR="".concat(tt,".editComment"),gR="".concat(tt,".removeComment"),yR="".concat(tt,".readOnlyComment"),mR="".concat(tt,".align"),bR="".concat(tt,".align.left"),wR="".concat(tt,".align.center"),_R="".concat(tt,".align.right"),SR="".concat(tt,".align.justify"),CR="".concat(tt,".align.top"),OR="".concat(tt,".align.middle"),RR="".concat(tt,".align.bottom"),ER="".concat(tt,".borders"),TR="".concat(tt,".borders.top"),kR="".concat(tt,".borders.right"),AR="".concat(tt,".borders.bottom"),IR="".concat(tt,".borders.left"),PR="".concat(tt,".borders.remove"),MR="".concat(tt,".nestedHeaders.insertChildRow"),$R="".concat(tt,".nestedHeaders.detachFromParent"),DR="".concat(tt,".hideColumn"),xR="".concat(tt,".showColumn"),NR="".concat(tt,".hideRow"),HR="".concat(tt,".showRow"),Ir="Filters:",Vt="".concat(Ir,"conditions"),Lv="".concat(Vt,".none"),LR="".concat(Vt,".isEmpty"),FR="".concat(Vt,".isNotEmpty"),jR="".concat(Vt,".isEqualTo"),BR="".concat(Vt,".isNotEqualTo"),VR="".concat(Vt,".beginsWith"),WR="".concat(Vt,".endsWith"),UR="".concat(Vt,".contains"),zR="".concat(Vt,".doesNotContain"),Tue="".concat(Vt,".byValue"),YR="".concat(Vt,".greaterThan"),GR="".concat(Vt,".greaterThanOrEqualTo"),KR="".concat(Vt,".lessThan"),XR="".concat(Vt,".lessThanOrEqualTo"),qR="".concat(Vt,".isBetween"),QR="".concat(Vt,".isNotBetween"),ZR="".concat(Vt,".after"),JR="".concat(Vt,".before"),eE="".concat(Vt,".today"),tE="".concat(Vt,".tomorrow"),rE="".concat(Vt,".yesterday"),nE="".concat(Ir,"labels.filterByCondition"),oE="".concat(Ir,"labels.filterByValue"),iE="".concat(Ir,"labels.conjunction"),Fv="".concat(Ir,"labels.disjunction"),Od="".concat(Ir,"values.blankCells"),aE="".concat(Ir,"buttons.selectAll"),sE="".concat(Ir,"buttons.clear"),lE="".concat(Ir,"buttons.ok"),uE="".concat(Ir,"buttons.cancel"),fE="".concat(Ir,"buttons.placeholder.search"),cE="".concat(Ir,"buttons.placeholder.value"),hE="".concat(Ir,"buttons.placeholder.secondValue"),kue=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:tt,CONTEXTMENU_ITEMS_NO_ITEMS:QO,CONTEXTMENU_ITEMS_ROW_ABOVE:ZO,CONTEXTMENU_ITEMS_ROW_BELOW:JO,CONTEXTMENU_ITEMS_INSERT_LEFT:eR,CONTEXTMENU_ITEMS_INSERT_RIGHT:tR,CONTEXTMENU_ITEMS_REMOVE_ROW:rR,CONTEXTMENU_ITEMS_REMOVE_COLUMN:nR,CONTEXTMENU_ITEMS_UNDO:oR,CONTEXTMENU_ITEMS_REDO:iR,CONTEXTMENU_ITEMS_READ_ONLY:aR,CONTEXTMENU_ITEMS_CLEAR_COLUMN:sR,CONTEXTMENU_ITEMS_COPY:lR,CONTEXTMENU_ITEMS_CUT:uR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:fR,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:cR,CONTEXTMENU_ITEMS_MERGE_CELLS:hR,CONTEXTMENU_ITEMS_UNMERGE_CELLS:dR,CONTEXTMENU_ITEMS_ADD_COMMENT:vR,CONTEXTMENU_ITEMS_EDIT_COMMENT:pR,CONTEXTMENU_ITEMS_REMOVE_COMMENT:gR,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:yR,CONTEXTMENU_ITEMS_ALIGNMENT:mR,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:bR,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:wR,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:_R,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:SR,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:CR,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:OR,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:RR,CONTEXTMENU_ITEMS_BORDERS:ER,CONTEXTMENU_ITEMS_BORDERS_TOP:TR,CONTEXTMENU_ITEMS_BORDERS_RIGHT:kR,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:AR,CONTEXTMENU_ITEMS_BORDERS_LEFT:IR,CONTEXTMENU_ITEMS_REMOVE_BORDERS:PR,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:MR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:$R,CONTEXTMENU_ITEMS_HIDE_COLUMN:DR,CONTEXTMENU_ITEMS_SHOW_COLUMN:xR,CONTEXTMENU_ITEMS_HIDE_ROW:NR,CONTEXTMENU_ITEMS_SHOW_ROW:HR,FILTERS_NAMESPACE:Ir,FILTERS_CONDITIONS_NAMESPACE:Vt,FILTERS_CONDITIONS_NONE:Lv,FILTERS_CONDITIONS_EMPTY:LR,FILTERS_CONDITIONS_NOT_EMPTY:FR,FILTERS_CONDITIONS_EQUAL:jR,FILTERS_CONDITIONS_NOT_EQUAL:BR,FILTERS_CONDITIONS_BEGINS_WITH:VR,FILTERS_CONDITIONS_ENDS_WITH:WR,FILTERS_CONDITIONS_CONTAINS:UR,FILTERS_CONDITIONS_NOT_CONTAIN:zR,FILTERS_CONDITIONS_BY_VALUE:Tue,FILTERS_CONDITIONS_GREATER_THAN:YR,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:GR,FILTERS_CONDITIONS_LESS_THAN:KR,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:XR,FILTERS_CONDITIONS_BETWEEN:qR,FILTERS_CONDITIONS_NOT_BETWEEN:QR,FILTERS_CONDITIONS_AFTER:ZR,FILTERS_CONDITIONS_BEFORE:JR,FILTERS_CONDITIONS_TODAY:eE,FILTERS_CONDITIONS_TOMORROW:tE,FILTERS_CONDITIONS_YESTERDAY:rE,FILTERS_DIVS_FILTER_BY_CONDITION:nE,FILTERS_DIVS_FILTER_BY_VALUE:oE,FILTERS_LABELS_CONJUNCTION:iE,FILTERS_LABELS_DISJUNCTION:Fv,FILTERS_VALUES_BLANK_CELLS:Od,FILTERS_BUTTONS_SELECT_ALL:aE,FILTERS_BUTTONS_CLEAR:sE,FILTERS_BUTTONS_OK:lE,FILTERS_BUTTONS_CANCEL:uE,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:fE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:cE,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:hE},Symbol.toStringTag,{value:"Module"})),_e;function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Aue=(_e={languageCode:"en-US"},Oe(_e,QO,"No available options"),Oe(_e,ZO,"Insert row above"),Oe(_e,JO,"Insert row below"),Oe(_e,eR,"Insert column left"),Oe(_e,tR,"Insert column right"),Oe(_e,rR,["Remove row","Remove rows"]),Oe(_e,nR,["Remove column","Remove columns"]),Oe(_e,oR,"Undo"),Oe(_e,iR,"Redo"),Oe(_e,aR,"Read only"),Oe(_e,sR,"Clear column"),Oe(_e,mR,"Alignment"),Oe(_e,bR,"Left"),Oe(_e,wR,"Center"),Oe(_e,_R,"Right"),Oe(_e,SR,"Justify"),Oe(_e,CR,"Top"),Oe(_e,OR,"Middle"),Oe(_e,RR,"Bottom"),Oe(_e,fR,"Freeze column"),Oe(_e,cR,"Unfreeze column"),Oe(_e,ER,"Borders"),Oe(_e,TR,"Top"),Oe(_e,kR,"Right"),Oe(_e,AR,"Bottom"),Oe(_e,IR,"Left"),Oe(_e,PR,"Remove border(s)"),Oe(_e,vR,"Add comment"),Oe(_e,pR,"Edit comment"),Oe(_e,gR,"Delete comment"),Oe(_e,yR,"Read-only comment"),Oe(_e,hR,"Merge cells"),Oe(_e,dR,"Unmerge cells"),Oe(_e,lR,"Copy"),Oe(_e,uR,"Cut"),Oe(_e,MR,"Insert child row"),Oe(_e,$R,"Detach from parent"),Oe(_e,DR,["Hide column","Hide columns"]),Oe(_e,xR,["Show column","Show columns"]),Oe(_e,NR,["Hide row","Hide rows"]),Oe(_e,HR,["Show row","Show rows"]),Oe(_e,Lv,"None"),Oe(_e,LR,"Is empty"),Oe(_e,FR,"Is not empty"),Oe(_e,jR,"Is equal to"),Oe(_e,BR,"Is not equal to"),Oe(_e,VR,"Begins with"),Oe(_e,WR,"Ends with"),Oe(_e,UR,"Contains"),Oe(_e,zR,"Does not contain"),Oe(_e,YR,"Greater than"),Oe(_e,GR,"Greater than or equal to"),Oe(_e,KR,"Less than"),Oe(_e,XR,"Less than or equal to"),Oe(_e,qR,"Is between"),Oe(_e,QR,"Is not between"),Oe(_e,ZR,"After"),Oe(_e,JR,"Before"),Oe(_e,eE,"Today"),Oe(_e,tE,"Tomorrow"),Oe(_e,rE,"Yesterday"),Oe(_e,Od,"Blank cells"),Oe(_e,nE,"Filter by condition"),Oe(_e,oE,"Filter by value"),Oe(_e,iE,"And"),Oe(_e,Fv,"Or"),Oe(_e,aE,"Select all"),Oe(_e,sE,"Clear"),Oe(_e,lE,"OK"),Oe(_e,uE,"Cancel"),Oe(_e,fE,"Search"),Oe(_e,cE,"Value"),Oe(_e,hE,"Second value"),_e),AF=Aue,qb=AF.languageCode,jv=hn("languagesDictionaries"),Iue=jv.register,IF=jv.getItem,Pue=jv.hasItem,Mue=jv.getValues;PF(AF);function PF(e,t){var r=e,n=t;return Ze(e)&&(n=e,r=n.languageCode),$ue(r,n),Iue(r,kr(n)),kr(n)}function $ue(e,t){e!==qb&&_ue(t,IF(qb))}function MF(e){return dE(e)?kr(IF(e)):null}function dE(e){return Pue(e)}function Due(){return Mue()}function $F(e,t,r){var n=MF(e);if(n===null)return null;var o=n[t];if(It(o))return null;var i=xue(o,r);return Array.isArray(i)?i[0]:i}function xue(e,t){var r=e;return P(Eue(),function(n){r=n(e,t)}),r}function Nue(e){var t=EF(e);return dE(t)||(t=qb,TF(e)),t}var pu=new bt,ti=new Set,Ns=0;function Hue(e){Ns===0&&(pu.addEventListener(e,"keydown",function(t){ti.has(t.keyCode)||ti.add(t.keyCode)}),pu.addEventListener(e,"keyup",function(t){ti.has(t.keyCode)&&ti.delete(t.keyCode)}),pu.addEventListener(e,"visibilitychange",function(){e.hidden&&ti.clear()}),pu.addEventListener(e.defaultView,"blur",function(){ti.clear()})),Ns+=1}function Lue(){Ns>0&&(Ns-=1),Ns===0&&Fue()}function Fue(){pu.clearEvents(),ti.clear(),Ns=0}function Rd(){var e=Array.from(ti.values());return e.some(function(t){return HO(t)})}var jue=qe,Bue=cr,Vue=lx,Wue=Xr,Uue=Gn,zue=wl;jue({target:"Object",stat:!0,sham:!Bue},{getOwnPropertyDescriptors:function(t){for(var r=Wue(t),n=Uue.f,o=Vue(r),i={},a=0,s,l;o.length>a;)l=n(r,s=o[a++]),l!==void 0&&zue(i,s,l);return i}});var Bv="active-header",Vv="area",qu="cell",vE="fill",Nf="header",pE="custom-selection";function Qb(e){return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function Yue(e,t){return que(e)||Xue(e,t)||Kue(e,t)||Gue()}function Gue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kue(e,t){if(!!e){if(typeof e=="string")return PI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PI(e,t)}}function PI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xue(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function que(e){if(Array.isArray(e))return e}function Que(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zue(e,t,r){return t&&MI(e.prototype,t),r&&MI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ch(){return typeof Reflect!="undefined"&&Reflect.get?ch=Reflect.get:ch=function(t,r,n){var o=Jue(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ch.apply(this,arguments)}function Jue(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tl(e),e!==null););return e}function efe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zb(e,t)}function Zb(e,t){return Zb=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Zb(e,t)}function tfe(e){var t=ofe();return function(){var n=tl(e),o;if(t){var i=tl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rfe(this,o)}}function rfe(e,t){if(t&&(Qb(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nfe(e)}function nfe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ofe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(e){return tl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},tl(e)}var ife=function(e){efe(r,e);var t=tfe(r);function r(n,o){var i;return Que(this,r),i=t.call(this,n,null),i.visualCellRange=o||null,i.commit(),i}return Zue(r,[{key:"add",value:function(o){return this.visualCellRange===null?this.visualCellRange=new Kt(o):this.visualCellRange.expand(o),this}},{key:"clear",value:function(){return this.visualCellRange=null,ch(tl(r.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(o,i,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:a,l=this.findVisibleCoordsInRowsRange(o.row,i.row,a);if(l===null)return null;var u=this.findVisibleCoordsInColumnsRange(o.col,i.col,s);return u===null?null:new J(l,u)}},{key:"findVisibleCoordsInRowsRange",value:function(o,i,a){var s=this.settings.visualToRenderableCoords({row:o,col:-1}),l=s.row;return i===o&&l===null?null:l===null?this.findVisibleCoordsInRowsRange(o+a,i,a):o}},{key:"findVisibleCoordsInColumnsRange",value:function(o,i,a){var s=this.settings.visualToRenderableCoords({row:-1,col:o}),l=s.col;return i===o&&l===null?null:l===null?this.findVisibleCoordsInColumnsRange(o+a,i,a):o}},{key:"findVisibleHeaderRange",value:function(o,i,a,s){var l=this.findVisibleCoordsInRowsRange(o.row,i.row,a),u=this.findVisibleCoordsInRowsRange(i.row,o.row,-a),f=this.findVisibleCoordsInColumnsRange(o.col,i.col,s),c=this.findVisibleCoordsInColumnsRange(i.col,o.col,-s);return l===null&&u===null&&f===null&&c===null?null:[new J(l,f),new J(u,c)]}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var o=this.visualCellRange,i=o.from,a=o.to,s=this.getRowSearchDirection(this.visualCellRange),l=this.getColumnSearchDirection(this.visualCellRange),u=this.findVisibleCoordsInRange(i,a,s,l),f=this.findVisibleCoordsInRange(a,i,-s,-l);if(u===null||f===null){var c=this.settings.type==="header",h=null;if(c){var d=this.findVisibleHeaderRange(i,a,s,l),v=Yue(d,2),p=v[0],b=v[1];h=this.createRenderableCellRange(p,b)}this.cellRange=h}else this.cellRange=this.createRenderableCellRange(u,f);return this}},{key:"adjustCoordinates",value:function(o){var i=this.getRowSearchDirection(o),a=this.getColumnSearchDirection(o),s=o.from.clone().normalize(),l=o.to.clone().normalize(),u=this.findVisibleCoordsInRange(s,l,i,a);if(u!==null){if(this.cellRange===null){var f=this.settings.visualToRenderableCoords(u);this.cellRange=new Kt(f)}return o.setHighlight(u),this}return o.setHighlight(o.from),this}},{key:"getCorners",value:function(){var o=this.cellRange,i=o.from,a=o.to,s=i.row===null||a.row===null,l=i.col===null||a.col===null,u=new J(s?null:Math.min(i.row,a.row),l?null:Math.min(i.col,a.col)),f=new J(s?null:Math.max(i.row,a.row),l?null:Math.max(i.col,a.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var o=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),i=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[o.row,o.col,i.row,i.col]}},{key:"createRenderableCellRange",value:function(o,i){var a=this.settings.visualToRenderableCoords(o),s=this.settings.visualToRenderableCoords(i);return new Kt(a,a,s)}},{key:"getRowSearchDirection",value:function(o){return o.from.row<o.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(o){return o.from.col<o.to.col?1:-1}}]),r}(Moe),Pl=ife,afe=["activeHeaderClassName"];function $I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function DI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$I(Object(r),!0).forEach(function(n){sfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$I(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lfe(e,t){if(e==null)return{};var r=ufe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function ufe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function ffe(e){var t=e.activeHeaderClassName,r=lfe(e,afe),n=new Pl(DI(DI({highlightHeaderClassName:t},r),{},{selectionType:Bv}));return n}var cfe=["layerLevel","areaCornerVisible"];function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function NI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){hfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dfe(e,t){if(e==null)return{};var r=vfe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function vfe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function pfe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=dfe(e,cfe),o=new Pl(NI(NI({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:Vv}));return o}var gfe=["cellCornerVisible"];function HI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function LI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HI(Object(r),!0).forEach(function(n){yfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mfe(e,t){if(e==null)return{};var r=bfe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function bfe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function wfe(e){var t=e.cellCornerVisible,r=mfe(e,gfe),n=new Pl(LI(LI({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:qu}));return n}var _fe=["border","visualCellRange"];function FI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $g(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(r),!0).forEach(function(n){Sfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cfe(e,t){if(e==null)return{};var r=Ofe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function Ofe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Rfe(e){var t=e.border,r=e.visualCellRange,n=Cfe(e,_fe),o=new Pl($g($g($g({},t),n),{},{selectionType:pE}),r);return o}var jI=cr,Efe=Ke,Tfe=mr,kfe=it,Dg=gf,Afe=Jd,Ife=nf,Pfe=Lr,Mfe=af,fs=Object.assign,BI=Object.defineProperty,$fe=Efe([].concat),Dfe=!fs||kfe(function(){if(jI&&fs({b:1},fs(BI({},"a",{enumerable:!0,get:function(){BI(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(o){t[o]=o}),fs({},e)[r]!=7||Dg(fs({},t)).join("")!=n})?function(t,r){for(var n=Pfe(t),o=arguments.length,i=1,a=Afe.f,s=Ife.f;o>i;)for(var l=Mfe(arguments[i++]),u=a?$fe(Dg(l),a(l)):Dg(l),f=u.length,c=0,h;f>c;)h=u[c++],(!jI||Tfe(s,l,h))&&(n[h]=l[h]);return n}:fs,xfe=qe,VI=Dfe;xfe({target:"Object",stat:!0,forced:Object.assign!==VI},{assign:VI});function WI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function UI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WI(Object(r),!0).forEach(function(n){Nfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hfe(e){var t=Object.assign({},e),r=new Pl(UI(UI({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:vE}));return r}var Lfe=["headerClassName","rowClassName","columnClassName"];function zI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function YI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zI(Object(r),!0).forEach(function(n){Ffe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ffe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jfe(e,t){if(e==null)return{};var r=Bfe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function Bfe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Vfe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=jfe(e,Lfe),i=new Pl(YI(YI({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:Nf}));return i}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Wfe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(n){Ufe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ufe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var DF=hn("highlight/types"),Ml=DF.register,zfe=DF.getItem;Ml(Bv,ffe);Ml(Vv,pfe);Ml(qu,wfe);Ml(pE,Rfe);Ml(vE,Hfe);Ml(Nf,Vfe);function cs(e,t){return zfe(e)(Wfe({type:e},t))}function Yo(e){return Xfe(e)||Kfe(e)||Gfe(e)||Yfe()}function Yfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gfe(e,t){if(!!e){if(typeof e=="string")return Jb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jb(e,t)}}function Kfe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xfe(e){if(Array.isArray(e))return Jb(e)}function Jb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KI(Object(r),!0).forEach(function(n){qfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qfe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qfe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zfe(e,t,r){return t&&XI(e.prototype,t),r&&XI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Jfe=function(e){function t(r){Qfe(this,t),this.options=r,this.layerLevel=0,this.cell=cs(qu,r),this.fill=cs(vE,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Zfe(t,[{key:"isEnabledFor",value:function(n,o){var i=n;n===qu&&(i="current");var a=this.options.disabledCellSelection(o.row,o.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(i)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,o;return this.areas.has(n)?o=this.areas.get(n):(o=cs(Vv,tu({layerLevel:n},this.options)),this.areas.set(n,o)),o}},{key:"getAreas",value:function(){return Yo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,o;return this.headers.has(n)?o=this.headers.get(n):(o=cs(Nf,tu({},this.options)),this.headers.set(n,o)),o}},{key:"getHeaders",value:function(){return Yo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,o;return this.activeHeaders.has(n)?o=this.activeHeaders.get(n):(o=cs(Bv,tu({},this.options)),this.activeHeaders.set(n,o)),o}},{key:"getActiveHeaders",value:function(){return Yo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Yo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(cs(pE,tu(tu({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),P(this.areas.values(),function(n){return void n.clear()}),P(this.headers.values(),function(n){return void n.clear()}),P(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Yo(this.areas.values()),Yo(this.headers.values()),Yo(this.activeHeaders.values()),Yo(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator),ece=Jfe;function tce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rce(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var nce=function(e){function t(){tce(this,t),this.ranges=[]}return rce(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(new Kt(n)),this}},{key:"add",value:function(n){return this.ranges.push(new Kt(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(o){return o.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,o=this.size()+n-1,i;return o>=0&&(i=this.ranges[o]),i}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator),oce=nce;function ice(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ace(e,t,r){return t&&QI(e.prototype,t),r&&QI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var xF=function(){function e(t,r){ice(this,e),this.range=t,this.options=r}return ace(e,[{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new J(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,f=a,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",i),l!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),p=this.options.fixedRowsBottom(),b=this.options.minSpareRows(),_=this.options.minSpareCols(),S=this.options.autoWrapRow(),E=this.options.autoWrapCol();l+r>d-1?o&&b>0&&!(p&&l>=d-p-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):E&&(i.row=1-d,i.col=u+i.col===v-1?1-v:1):E&&l+i.row<0&&u+i.col>=0&&(i.row=d-1,i.col=u+i.col===0?v-1:-1),u+i.col>v-1?o&&_>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):S&&(i.row=l+i.row===d-1?1-d:1,i.col=1-v):S&&u+i.col<0&&l+i.row>=0&&(i.row=l+i.row===0?d-1:-1,i.col=v-1);var M=new J(l+i.row,u+i.col);c=0,h=0,M.row<0?(c=-1,M.row=0):M.row>0&&M.row>=d&&(c=1,M.row=d-1),M.col<0?(h=-1,M.col=0):M.col>0&&M.col>=v&&(h=1,M.col=v-1),f=this.options.renderableToVisualCoords(M)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var o=new J(r,n),i=this.range.current(),a=i.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",o);var u=this.options.visualToRenderableCoords(i.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(i.to),p=v.row,b=v.col,_=new J(p+o.row,b+o.col);s=0,l=0,_.row<0?(s=-1,_.row=0):_.row>0&&_.row>=h&&(s=1,_.row=h-1),_.col<0?(l=-1,_.col=0):_.col>0&&_.col>=d&&(l=1,_.col=d-1),a=this.options.renderableToVisualCoords(_)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),e}();wt(xF,Fr);var sce=xF;function NF(e,t){return cce(e)||fce(e,t)||uce(e,t)||lce()}function lce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uce(e,t){if(!!e){if(typeof e=="string")return ZI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZI(e,t)}}function ZI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fce(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function cce(e){if(Array.isArray(e))return e}function ew(e){return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}var Wv=0,Uv=1,HF=2,gE=3,hce=[gE,HF],dce=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],xg=Symbol("root"),JI=Symbol("child");function rl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xg;if(t!==xg&&t!==JI)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===xg,o=Wv;if(r){var i=e[0];if(e.length===0)o=Uv;else if(n&&i instanceof Kt)o=gE;else if(n&&Array.isArray(i))o=rl(i,JI);else if(e.length>=2&&e.length<=4){var a=!e.some(function(s,l){return!dce[l].includes(ew(s))});a&&(o=HF)}}return o}function Qu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,o=t.propToCol;if(!hce.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=e===gE,s=a?i.from.row:i[0],l=a?i.from.col:i[1],u=a?i.to.row:i[2],f=a?i.to.col:i[3];if(typeof o=="function"&&(typeof l=="string"&&(l=o(l)),typeof f=="string"&&(f=o(f))),It(u)&&(u=s),It(f)&&(f=l),!n){var c=s,h=l,d=u,v=f;s=Math.min(c,d),l=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[s,l,u,f]}}function vce(e){var t=rl(e);if(t===Wv||t===Uv)return[];var r=Qu(t),n=new Set;P(e,function(a){var s=r(a),l=NF(s,4),u=l[1],f=l[3],c=Math.max(u,0),h=f-c+1;P(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=zt(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function pce(e){var t=rl(e);if(t===Wv||t===Uv)return[];var r=Qu(t),n=new Set;P(e,function(a){var s=r(a),l=NF(s,3),u=l[0],f=l[2],c=Math.max(u,0),h=f-c+1;P(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=zt(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function Go(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}var eP;function tP(e,t){return bce(e)||mce(e,t)||yce(e,t)||gce()}function gce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yce(e,t){if(!!e){if(typeof e=="string")return rP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rP(e,t)}}function rP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mce(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function bce(e){if(Array.isArray(e))return e}function wce(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sce(e,t,r){return t&&nP(e.prototype,t),r&&nP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var LF=function(){function e(t,r){var n=this;_ce(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new oce,this.highlight=new ece({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(i,a){return n.tableProps.isDisabledCellSelection(i,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)}}),this.transformation=new sce(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(i){return n.tableProps.visualToRenderableCoords(i)},renderableToVisualCoords:function(i){return n.tableProps.renderableToVisualCoords(i)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Sce(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.settings.selectionMode==="multiple",a=It(n)?Rd():n,s=r.row<0,l=r.col<0,u=s&&l,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(o?"Only":""),f),(!i||i&&!a&&It(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var o=this.selectedRange.current();this.settings.selectionMode!=="single"&&o.setTo(new J(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(qu,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(o);var i=this.getLayerLevel();i<this.highlight.layerLevel&&(P(this.highlight.getAreas(),function(p){return void p.clear()}),P(this.highlight.getHeaders(),function(p){return void p.clear()}),P(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(Vv,o.highlight)&&(this.isMultiple()||i>=1)&&(a.add(o.from).add(o.to).commit(),i===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(u.from).commit().adjustCoordinates(u),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Nf,o.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=o;if((f||c)&&(h=o.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===o.getWidth();d&&l.add(new J(o.from.row,-1)).add(new J(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===o.getHeight();v&&l.add(new J(-1,o.from.col)).add(new J(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Pa(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,o))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.tableProps.countRows(),i=this.tableProps.countCols();if(!(!r&&!n&&(o===0||i===0))){var a=new J(n?-1:0,r?-1:0);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new J(o-1,i-1)),this.finish()}}},{key:"selectCells",value:function(r){var n=this,o=rl(r);if(o===Uv)return!1;if(o===Wv)throw new Error(Rt(eP||(eP=wce([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var i=Qu(o,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var f=i(u),c=tP(f,4),h=c[0],d=c[1],v=c[2],p=c[3],b=Go(h,a)&&Go(d,s)&&Go(v,a)&&Go(p,s);return!b});return l&&(this.clear(),P(r,function(u){var f=i(u),c=tP(f,4),h=c[0],d=c[1],v=c[2],p=c[3];n.setRangeStartOnly(new J(h,d),!1),n.setRangeEnd(new J(v,p)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Go(i,s)&&Go(a,s);return u&&(this.setRangeStartOnly(new J(o,i)),this.setRangeEnd(new J(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=Go(r,i)&&Go(n,i);return s&&(this.setRangeStartOnly(new J(r,o)),this.setRangeEnd(new J(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),o=this.getLayerLevel();n.commit().adjustCoordinates(this.selectedRange.current());for(var i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(o)}}}]),e}();wt(LF,Fr);var Cce=LF,Oce=qe,FF=Ke,Rce=Gn.f,Ece=Va,oP=dr,Tce=HC,kce=Hr,Ace=LC,iP=FF("".startsWith),Ice=FF("".slice),Pce=Math.min,jF=Ace("startsWith"),Mce=!jF&&!!function(){var e=Rce(String.prototype,"startsWith");return e&&!e.writable}();Oce({target:"String",proto:!0,forced:!Mce&&!jF},{startsWith:function(t){var r=oP(kce(this));Tce(t);var n=Ece(Pce(arguments.length>1?arguments[1]:void 0,r.length)),o=oP(t);return iP?iP(r,o,n):Ice(r,n,n+o.length)===o}});var aP=/^(\r\n|\n\r|\r|\n)/,$ce=/^[^\t\r\n]+/,sP=/^\t/;function Dce(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,o;e.length>0&&o!==e.length;)if(o=e.length,e.match(sP))e=e.replace(sP,""),r+=1,t[n][r]="";else if(e.match(aP))e=e.replace(aP,""),r=0,n+=1,t[n]=[""];else{var i="";if(e.startsWith('"')){for(var a=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(a+=1),i+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match($ce);i=u?u[0]:"",e=e.slice(i.length)}t[n][r]=i}return t}function Tu(e){var t,r,n,o,i="",a;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=e[t][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;t!==r-1&&(i+=`
`)}return i}function tw(e){return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function xce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nce(e,t,r){return t&&lP(e.prototype,t),r&&lP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Hce=Ou("copyable",!1),Lce=function(){function e(t,r,n){xce(this,e),this.instance=t,this.tableMeta=n,this.dataSource=r,this.duckSchema=this.dataSource&&this.dataSource[0]?Xs(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return Nce(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,o;if(this.colToPropCache=[],this.propToColCache=new Map,n){var i=0,a=0,s=!1;if(typeof n=="function"){var l=gv(r);i=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;i=Math.min(u,n.length)}for(o=0;o<i;o++){var f=s?n(o):n[o];if(Ze(f)){if(typeof f.data!="undefined"){var c=s?a:o;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return UO(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,o){var i=this,a=n,s=o,l;return typeof a=="undefined"&&(a=0,s=""),tw(r)==="object"&&!Array.isArray(r)&&ot(r,function(u,f){u===null?(l=s+f,i.colToPropCache.push(l),i.propToColCache.set(l,a),a+=1):a=i.recursiveDuckColumns(u,a,"".concat(f,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&He(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(He(n))return this.instance.toVisualColumn(n);var o=this.instance.toVisualColumn(r);return o===null?r:o}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createRow",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=this.instance.countSourceRows(),s=a,l=0,u=r;(typeof u!="number"||u>=a)&&(u=a),u<this.instance.countRows()&&(s=this.instance.toPhysicalRow(u));var f=this.instance.runHooks("beforeCreateRow",u,o,i);if(f===!1||s===null)return 0;for(var c=this.tableMeta.maxRows,h=this.instance.countCols(),d=[],v=function(){var b=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?b=kr(n.getSchema()):(b=[],Ie(h-1,function(){return b.push(null)})):n.instance.dataType==="function"?b=n.tableMeta.dataSchema(u+l):(b={},Cf(b,n.getSchema())),d.push(b),l+=1};l<o&&a+l<c;)v();return this.instance.rowIndexMapper.insertIndexes(u,l),this.spliceData.apply(this,[s,0].concat(d)),this.instance.runHooks("afterCreateRow",u,l,i),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,a=this.tableMeta.maxCols,s=r;(typeof s!="number"||s>=this.instance.countSourceCols())&&(s=this.instance.countSourceCols());var l=this.instance.runHooks("beforeCreateCol",s,n,o);if(l===!1)return 0;var u=this.instance.countSourceCols();s<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(s));for(var f=this.instance.countSourceRows(),c=this.instance.countCols(),h=0,d=u;h<n&&c<a;){if(typeof s!="number"||s>=c)if(f>0)for(var v=0;v<f;v+=1)typeof i[v]=="undefined"&&(i[v]=[]),i[v].push(null);else i.push([null]);else for(var p=0;p<f;p++)i[p].splice(d,0,null);h+=1,d+=1,c+=1}return this.instance.columnIndexMapper.insertIndexes(s,h),this.instance.runHooks("afterCreateCol",s,h,o),this.instance.forceFullRender=!0,h}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(r)?r:-n,a=this.visualRowsToPhysical(i,n),s=this.instance.countSourceRows();i=(s+i)%s;var l=this.instance.runHooks("beforeRemoveRow",i,a.length,a,o);if(l===!1)return!1;var u=a.length;if(this.filterData(i,u,a),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var f=He(this.tableMeta.columns)||He(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",i,u,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var i=typeof r!="number"?-n:r;i=(this.instance.countCols()+i)%this.instance.countCols();var a=this.visualColumnsToPhysical(i,n),s=a.slice(0).sort(function(S,E){return E-S}),l=this.instance.runHooks("beforeRemoveCol",i,n,a,o);if(l===!1)return!1;for(var u=!0,f=s.length,c=this.dataSource,h=0;h<f;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(a[0],n);else for(var p=0,b=this.instance.countSourceRows();p<b;p++)for(var _=0;_<f;_++)c[p].splice(s[_],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,n,a,o),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(r,n,o){for(var i=this.instance.getDataAtCol(r),a=i.slice(n,n+o),s=i.slice(n+o),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];am(u,s);for(var c=0;c<o;)u.push(null),c+=1;return BN(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,o){for(var i=this.instance.getSourceDataAtRow(r),a=i.slice(n,n+o),s=i.slice(n+o),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];am(u,s);for(var c=0;c<o;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n){for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];var s=this.instance.runHooks("beforeDataSplice",r,n,i);if(s!==!1){var l;(l=this.dataSource).splice.apply(l,[r,n].concat(i))}}},{key:"filterData",value:function(r,n,o){var i=this.instance.runHooks("filterData",r,n,o);Array.isArray(i)===!1&&(i=this.dataSource.filter(function(a,s){return o.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}},{key:"get",value:function(r,n){var o=this.instance.toPhysicalRow(r),i=this.dataSource[o],a=this.instance.runHooks("modifyRowData",o);i=isNaN(a)?a:i;var s=null;if(i&&i.hasOwnProperty&&Ot(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=i;if(!u)return null;for(var f=0,c=l.length;f<c;f++)if(u=u[l[f]],typeof u=="undefined")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){var h=Pa(s);this.instance.runHooks("modifyData",o,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return Hce.call(this.instance,r,this.propToCol(n))?this.get(r,n):""}},{key:"set",value:function(r,n,o){var i=this.instance.toPhysicalRow(r),a=o,s=this.dataSource[i],l=this.instance.runHooks("modifyRowData",i);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=Pa(a);this.instance.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&Ot(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=s,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]=="undefined"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=a}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var o=this.instance.countSourceRows(),i=[],a=(o+r)%o,s=n,l;a<o&&s;)l=this.instance.toPhysicalRow(a),i.push(l),s-=1,a+=1;return i}},{key:"visualColumnsToPhysical",value:function(r,n){for(var o=this.instance.countCols(),i=[],a=(o+r)%o,s=n;a<o&&s;){var l=this.instance.toPhysicalColumn(a);i.push(l),s-=1,a+=1}return i}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,o){var i=[],a,s,l,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){l=[];var v=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=d&&v!==null;s++)l.push(c.call(this,a,this.colToProp(s)));v!==null&&i.push(l)}return i}},{key:"getText",value:function(r,n){return Tu(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Tu(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}(),Fce=Lce;function zv(e,t){var r=typeof e=="string"?Dv(e):e;if(!!Ze(r)){var n=Ze(t),o={};return ot(r,function(i,a){a!=="CELL_TYPE"&&(!n||n&&!Ot(t,a))&&(o[a]=i)}),o}}function jce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Bo(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function hh(e){return Number.isInteger(e)&&e>=0}function dh(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Oc(e){return e==null}function rw(e){return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}var BF=function(){return{activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,o;for(r=0,n=this.countRows();r<n;r++)if(o=this.getDataAtCell(r,t),or(o)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,o,i;for(r=0,n=this.countCols();r<n;r++)if(o=this.getDataAtCell(t,r),or(o)===!1)return rw(o)==="object"?(i=this.getCellMeta(t,r),ZC(this.getSchema()[i.prop],o)):!1;return!0},label:void 0,language:"en-US",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function uP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VF(e,t,r){return t&&uP(e.prototype,t),r&&uP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bce(){return VF(function e(){WF(this,e)})}var Vce=function(){function e(t){WF(this,e),this.metaCtor=Bce(),this.meta=this.metaCtor.prototype,xt(this.meta,BF()),this.meta.instance=t}return VF(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){xt(this.meta,r),xt(this.meta,zv(r.type,r))}}]),e}();function Wce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Uce(e,t,r){return t&&fP(e.prototype,t),r&&fP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var zce=function(){function e(t){Wce(this,e);var r=t.getMetaConstructor();this.meta=new r}return Uce(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){xt(this.meta,r),xt(this.meta,zv(r.type,r))}}]),e}();function Yce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gce(e,t,r){return t&&cP(e.prototype,t),r&&cP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var nw=function(e){function t(r){Yce(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return Gce(t,[{key:"obtain",value:function(n){dh(function(){return hh(n)},"Expecting an unsigned number.");var o=this._getStorageIndexByKey(n),i;if(o>=0)i=this.data[o],i===void 0&&(i=this.valueFactory(n),this.data[o]=i);else if(i=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=i,this.index[n]=a}else this.data.push(i),this.index[n]=this.data.length-1;return i}},{key:"insert",value:function(n){var o,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dh(function(){return hh(n)||Oc(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],s=this.data.length,l=0;l<i;l++)a.push(s+l),this.data.push(void 0);(o=this.index).splice.apply(o,[Oc(n)?this.index.length:n,0].concat(a))}},{key:"remove",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dh(function(){return hh(n)||Oc(n)},"Expecting an unsigned number or null/undefined argument.");for(var i=this.index.splice(Oc(n)?this.index.length-o:n,o),a=0;a<i.length;a++){var s=i[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Gr(this.data,function(o,i){return!n.holes.has(i)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],o=0;o<this.data.length;o++){var i=this._getKeyByStorageIndex(o);i!==-1&&n.push([i,this.data[o]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function Kce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xce(e,t,r){return t&&hP(e.prototype,t),r&&hP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var qce=["data","width"],Qce=function(){function e(t){var r=this;Kce(this,e),this.globalMeta=t,this.metas=new nw(function(){return r._createMeta()})}return Xce(e,[{key:"updateMeta",value:function(r,n){var o=this.getMeta(r);xt(o,n),xt(o,zv(n.type,o))}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return jce(this.globalMeta.getMetaConstructor(),qce).prototype}}]),e}();function Zce(e){return rhe(e)||the(e)||ehe(e)||Jce()}function Jce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ehe(e,t){if(!!e){if(typeof e=="string")return ow(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ow(e,t)}}function the(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rhe(e){if(Array.isArray(e))return ow(e)}function ow(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ohe(e,t,r){return t&&dP(e.prototype,t),r&&dP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ihe=function(){function e(t){var r=this;nhe(this,e),this.columnMeta=t,this.metas=new nw(function(){return r._createRow()})}return ohe(e,[{key:"updateMeta",value:function(r,n,o){var i=this.getMeta(r,n);xt(i,o),xt(i,zv(o.type,i))}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(r,n)}},{key:"getMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);return o===void 0?i:i[o]}},{key:"setMeta",value:function(r,n,o,i){var a=this.metas.obtain(r).obtain(n);a[o]=i}},{key:"removeMeta",value:function(r,n,o){var i=this.metas.obtain(r).obtain(n);delete i[o]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),o=0;o<n.length;o++)r.push.apply(r,Zce(n[o].values()));return r}},{key:"getMetasAtRow",value:function(r){dh(function(){return hh(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new nw(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function ahe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function she(e,t,r){return t&&vP(e.prototype,t),r&&vP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var UF=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];ahe(this,e),this.hot=t,this.globalMeta=new Vce(t),this.globalMeta.updateMeta(n),this.tableMeta=new zce(this.globalMeta),this.columnMeta=new Qce(this.globalMeta),this.cellMeta=new ihe(this.columnMeta),o.forEach(function(i){return new i(r)})}return she(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,o){var i=o.visualRow,a=o.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=i,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,o){if(typeof o!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,o)}},{key:"setCellMeta",value:function(r,n,o,i){this.cellMeta.setMeta(r,n,o,i)}},{key:"updateCellMeta",value:function(r,n,o){this.cellMeta.updateMeta(r,n,o)}},{key:"removeCellMeta",value:function(r,n,o){this.cellMeta.removeMeta(r,n,o)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();wt(UF,Fr);function Ed(e){return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function pP(e,t,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.firstRun,f=an(s),c=o.getSettings();Array.isArray(c.dataSchema)?o.dataType="array":Ct(c.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(f),e,u,l),s!=="loadData"&&l==="updateSettings"&&(e=o.runHooks("beforeLoadData",e,u,l));var h=new Fce(o,e,c);if(t(h),Ed(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var d=h.getSchema();e=[];var v,p=0,b=0;for(p=0,b=c.startRows;p<b;p++)if((o.dataType==="object"||o.dataType==="function")&&c.dataSchema)v=kr(d),e.push(v);else if(o.dataType==="array")v=kr(d[0]),e.push(v);else{v=[];for(var _=0,S=c.startCols;_<S;_++)v.push(null);e.push(v)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(Ed(e)," given)"));Array.isArray(e[0])&&(o.dataType="array"),c.data=e,h.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=h.colToProp.bind(h),a.propToCol=h.propToCol.bind(h),a.countCachedColumns=h.countCachedColumns.bind(h),r(h),o.runHooks("after".concat(f),e,u,l),s!=="loadData"&&l==="updateSettings"&&o.runHooks("afterLoadData",e,u,l),u||(o.runHooks("afterChange",null,l==="updateSettings"?"loadData":s),o.render())}function lhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uhe(e,t,r){return t&&gP(e.prototype,t),r&&gP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var fhe=function(){function e(t){var r=this;lhe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Ae.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return uhe(e,[{key:"extendCellMeta",value:function(r){var n,o=r.row,i=r.col;if(!((n=this.metaSyncMemo.get(o))!==null&&n!==void 0&&n.has(i))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var f=Ot(r,"type")?r.type:null,c=Ct(r.cells)?r.cells(o,i,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(o,i,c),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}}]),e}();function $r(e){return $r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(e)}function An(e,t){return dhe(e)||hhe(e,t)||zF(e,t)||che()}function che(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hhe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function dhe(e){if(Array.isArray(e))return e}function Rc(e){return ghe(e)||phe(e)||zF(e)||vhe()}function vhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zF(e,t){if(!!e){if(typeof e=="string")return iw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iw(e,t)}}function phe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ghe(e){if(Array.isArray(e))return iw(e)}function iw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ng=null;function yE(e,t){var r=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,i=this,a=new bt(i),s,l,u,f,c=!0;t.language=Nue(t.language);var h=new UF(i,t,[fhe]),d=h.getTableMeta(),v=h.getGlobalMeta(),p=oF();ase(n)&&ise(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0,Hue(this.rootDocument),this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Eb(this)&&ZH(t.licenseKey,e),this.guid="ht_".concat(yO()),this.columnIndexMapper=new Xb,this.rowIndexMapper=new Xb,l=new Ase(i),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var b=function(w){var g=w.row,m=w.col;return new J(g>=0?i.rowIndexMapper.getRenderableFromVisualIndex(g):g,m>=0?i.columnIndexMapper.getRenderableFromVisualIndex(m):m)},_=function(w){var g=w.row,m=w.col;return new J(g>=0?i.rowIndexMapper.getVisualFromRenderableIndex(g):g,m>=0?i.columnIndexMapper.getVisualFromRenderableIndex(m):m)},S=new Cce(d,{countCols:function(){return i.countCols()},countRows:function(){return i.countRows()},propToCol:function(w){return s.propToCol(w)},isEditorOpened:function(){return i.getActiveEditor()?i.getActiveEditor().isOpened():!1},countColsTranslated:function(){return r.view.countRenderableColumns()},countRowsTranslated:function(){return r.view.countRenderableRows()},visualToRenderableCoords:b,renderableToVisualCoords:_,isDisabledCellSelection:function(w,g){return i.getCellMeta(w,g).disableVisualSelection}});this.selection=S;var E=function(w){var g=w.hiddenIndexesChanged;g&&r.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",E),this.rowIndexMapper.addLocalHook("cacheUpdated",E),this.selection.addLocalHook("beforeSetRangeStart",function(y){r.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){r.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){r.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=r.view.wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=r.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var w=Pa(!1),g=r.selection.getSelectedRange(),m=g.current(),R=m.from,$=m.to,I=g.size()-1;r.runHooks("afterSelection",R.row,R.col,$.row,$.col,w,I),r.runHooks("afterSelectionByProp",R.row,i.colToProp(R.col),$.row,i.colToProp($.col),w,I);var V=r.selection.isSelectedByAnyHeader(),q=r.selection.selectedRange.current(),oe=!0;o&&(oe=!1),w.isTouched()&&(oe=!w.value);var ee=r.selection.isSelectedByRowHeader(),de=r.selection.isSelectedByColumnHeader();oe!==!1&&(V?ee?r.view.scrollViewportVertically(i.rowIndexMapper.getRenderableFromVisualIndex(y.row)):de&&r.view.scrollViewportHorizontally(i.columnIndexMapper.getRenderableFromVisualIndex(y.col)):q&&!r.selection.isMultiple()?r.view.scrollViewport(b(q.from)):r.view.scrollViewport(b(y))),ee&&de?le(r.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(Ge(r.rootElement,"ht__selection--columns"),le(r.rootElement,"ht__selection--rows")):de?(Ge(r.rootElement,"ht__selection--rows"),le(r.rootElement,"ht__selection--columns")):Ge(r.rootElement,["ht__selection--rows","ht__selection--columns"]),r._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var w=y.length-1,g=y[w],m=g.from,R=g.to;r.runHooks("afterSelectionEnd",m.row,m.col,R.row,R.col,w),r.runHooks("afterSelectionEndByProp",m.row,i.colToProp(m.col),R.row,i.colToProp(R.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var w=r.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=w)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){r.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,w,g){r.runHooks("afterModifyTransformStart",y,w,g)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){r.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,w,g){r.runHooks("afterModifyTransformEnd",y,w,g)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),r._refreshBorders(),Ge(r.rootElement,["ht__selection--rows","ht__selection--columns"]),r.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){r.alter("insert_row",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){r.alter("insert_col",y,1,"auto")}),u={alter:function(w,g){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=arguments.length>3?arguments[3]:void 0,$=arguments.length>4?arguments[4]:void 0,I,V=function(D){if(D.length===0)return[];var z=Rc(D);z.sort(function(K,L){var N=An(K,1),W=N[0],j=An(L,1),Q=j[0];return W===Q?0:W>Q?1:-1});var H=zt(z,function(K,L){var N=An(L,2),W=N[0],j=N[1],Q=K[K.length-1],fe=An(Q,2),Se=fe[0],ke=fe[1],Qe=Se+ke;if(W<=Qe){var ct=Math.max(j-(Qe-W),0);Q[1]+=ct}else K.push([W,j]);return K},[z[0]]);return H};switch(w){case"insert_row":var q=i.countSourceRows();if(d.maxRows===q)return;if(g=He(g)?g:q,I=s.createRow(g,m,R),I){h.createRow(i.toPhysicalRow(g),m);var oe=S.selectedRange.current(),ee=oe==null?void 0:oe.from,de=ee==null?void 0:ee.row;if(He(de)&&de>=g){var Te=oe.to,me=Te.row,Pe=Te.col,We=ee.col;S.isSelectedByRowHeader()&&(We=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(new J(de+I,We),!0),S.setRangeEnd(new J(me+I,Pe))}else i._refreshBorders()}break;case"insert_col":if(I=s.createCol(g,m,R),I){if(h.createColumn(i.toPhysicalColumn(g),m),Array.isArray(d.colHeaders)){var Le=[g,0];Le.length+=I,Array.prototype.splice.apply(d.colHeaders,Le)}var je=S.selectedRange.current(),Fe=je==null?void 0:je.from,re=Fe==null?void 0:Fe.col;if(He(re)&&re>=g){var Ue=je.to,Be=Ue.row,pt=Ue.col,nt=Fe.row;S.isSelectedByColumnHeader()&&(nt=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(new J(nt,re+I),!0),S.setRangeEnd(new J(Be,pt+I))}else i._refreshBorders()}break;case"remove_row":var ze=function(D){var z=0;P(D,function(H){var K=An(H,2),L=K[0],N=K[1],W=or(L)?i.countRows()-1:Math.max(L-z,0);Number.isInteger(L)&&(L=Math.max(L-z,0));var j=s.removeRow(L,N,R);if(!!j){h.removeRow(i.toPhysicalRow(W),N);var Q=i.countRows(),fe=d.fixedRowsTop;fe>=W+1&&(d.fixedRowsTop-=Math.min(N,fe-W));var Se=d.fixedRowsBottom;Se&&W>=Q-Se&&(d.fixedRowsBottom-=Math.min(N,Se)),z+=N}})};Array.isArray(g)?ze(V(g)):ze([[g,m]]),u.adjustRowsAndCols(),i._refreshBorders();break;case"remove_col":var O=function(D){var z=0;P(D,function(H){var K=An(H,2),L=K[0],N=K[1],W=or(L)?i.countCols()-1:Math.max(L-z,0),j=i.toPhysicalColumn(W);Number.isInteger(L)&&(L=Math.max(L-z,0));var Q=s.removeCol(L,N,R);if(!!Q){h.removeColumn(j,N);var fe=d.fixedColumnsLeft;fe>=W+1&&(d.fixedColumnsLeft-=Math.min(N,fe-W)),Array.isArray(d.colHeaders)&&(typeof j=="undefined"&&(j=-1),d.colHeaders.splice(j,N)),z+=N}})};Array.isArray(g)?O(V(g)):O([[g,m]]),u.adjustRowsAndCols(),i._refreshBorders();break;default:throw new Error('There is no such action "'.concat(w,'"'))}$||u.adjustRowsAndCols()},adjustRowsAndCols:function(){var w=d.minRows,g=d.minSpareRows,m=d.minCols,R=d.minSpareCols;if(w){var $=i.countRows();$<w&&s.createRow($,w-$,"auto")}if(g){var I=i.countEmptyRows(!0);if(I<g){var V=g-I,q=Math.min(V,d.maxRows-i.countSourceRows());s.createRow(i.countRows(),q,"auto")}}{var oe;(m||R)&&(oe=i.countEmptyCols(!0));var ee=i.countCols();if(m&&!d.columns&&ee<m){var de=m-ee;oe+=de,s.createCol(ee,de,"auto")}if(R&&!d.columns&&i.dataType==="array"&&oe<R){ee=i.countCols();var Te=R-oe,me=Math.min(Te,d.maxCols-ee);s.createCol(ee,me,"auto")}}var Pe=i.countRows(),We=i.countCols();(Pe===0||We===0)&&S.deselect(),S.isSelected()&&P(S.selectedRange,function(Le){var je=!1,Fe=Le.from.row,re=Le.from.col,Ue=Le.to.row,Be=Le.to.col;Fe>Pe-1?(Fe=Pe-1,je=!0,Ue>Fe&&(Ue=Fe)):Ue>Pe-1&&(Ue=Pe-1,je=!0,Fe>Ue&&(Fe=Ue)),re>We-1?(re=We-1,je=!0,Be>re&&(Be=re)):Be>We-1&&(Be=We-1,je=!0,re>Be&&(re=Be)),je&&i.selectCell(Fe,re,Ue,Be)}),i.view&&i.view.adjustElementsSize()},populateFromArray:function(w,g,m,R,$,I,V){var q,oe,ee,de,Te=[],me={},Pe=[],We=w.row,Le=w.col;if(oe=g.length,oe===0)return!1;var je=0,Fe=0;switch(Ze(m)&&(je=m.col-Le+1,Fe=m.row-We+1),$){case"shift_down":var re=mu(g),Ue=re.length,Be=Math.max(Ue,je),pt=i.getData().slice(We),nt=mu(pt).slice(Le,Le+Be);for(ee=0;ee<Be;ee+=1)if(ee<Ue){for(q=0,oe=re[ee].length;q<Fe-oe;q+=1)re[ee].push(re[ee][q%oe]);ee<nt.length?Pe.push(re[ee].concat(nt[ee])):Pe.push(re[ee].concat(new Array(pt.length).fill(null)))}else Pe.push(re[ee%Ue].concat(nt[ee]));i.populateFromArray(We,Le,mu(Pe));break;case"shift_right":var ze=g.length,O=Math.max(ze,Fe),T=i.getData().slice(We).map(function(dn){return dn.slice(Le)});for(q=0;q<O;q+=1)if(q<ze){for(ee=0,de=g[q].length;ee<je-de;ee+=1)g[q].push(g[q][ee%de]);if(q<T.length)for(var D=0;D<T[q].length;D+=1)g[q].push(T[q][D]);else{var z;(z=g[q]).push.apply(z,Rc(new Array(T[0].length).fill(null)))}}else g.push(g[q%oe].slice(0,O).concat(T[q]));i.populateFromArray(We,Le,g);break;case"overwrite":default:me.row=w.row,me.col=w.col;var H={row:m&&w?m.row-w.row+1:1,col:m&&w?m.col-w.col+1:1},K=0,L=0,N=!0,W,j=function(Jt){var Pr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,er=g[Jt%g.length];return Pr!==null?er[Pr%er.length]:er},Q=g.length,fe=m?m.row-w.row+1:0;for(m?oe=fe:oe=Math.max(Q,fe),q=0;q<oe&&!(m&&me.row>m.row&&fe>Q||!d.allowInsertRow&&me.row>i.countRows()-1||me.row>=d.maxRows);q++){var Se=q-K,ke=j(Se).length,Qe=m?m.col-w.col+1:0;if(m?de=Qe:de=Math.max(ke,Qe),me.col=w.col,W=i.getCellMeta(me.row,me.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&W.skipRowOnPaste){K+=1,me.row+=1,oe+=1;continue}for(L=0,ee=0;ee<de&&!(m&&me.col>m.col&&Qe>ke||!d.allowInsertColumn&&me.col>i.countCols()-1||me.col>=d.maxCols);ee++){if(W=i.getCellMeta(me.row,me.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&W.skipColumnOnPaste){L+=1,me.col+=1,de+=1;continue}if(W.readOnly&&R!=="UndoRedo.undo"){me.col+=1;continue}var ct=ee-L,Je=j(Se,ct),Ne=i.getDataAtCell(me.row,me.col),ft={row:Se,col:ct};if(R==="Autofill.fill"){var Tt=i.runHooks("beforeAutofillInsidePopulate",ft,I,g,V,{},H);Tt&&(Je=It(Tt.value)?Je:Tt.value)}if(Je!==null&&$r(Je)==="object")if(Array.isArray(Je)&&Ne===null&&(Ne=[]),Ne===null||$r(Ne)!=="object")N=!1;else{var ir=Xs(Array.isArray(Ne)?Ne:Ne[0]||Ne),Tn=Xs(Array.isArray(Je)?Je:Je[0]||Je);ZC(ir,Tn)?Je=kr(Je):N=!1}else Ne!==null&&$r(Ne)==="object"&&(N=!1);N&&Te.push([me.row,me.col,Je]),N=!0,me.col+=1}me.row+=1}i.setDataAtCell(Te,null,null,R||"populateFromArray");break}}};function M(y){var w=EF(y);dE(w)?(i.runHooks("beforeLanguageChange",w),v.language=w,i.runHooks("afterLanguageChange",w)):TF(y)}function k(y,w){var g=y==="className"?i.rootElement:i.table;if(c)le(g,w);else{var m=[],R=[];v[y]&&(m=Array.isArray(v[y])?v[y]:lm(v[y])),w&&(R=Array.isArray(w)?w:lm(w));var $=sm(m,R),I=sm(R,m);$.length&&Ge(g,$),I.length&&le(g,I)}v[y]=w}this.init=function(){l.setData(d.data),i.runHooks("beforeInit"),(Sn()||eO())&&le(i.rootElement,"mobile"),this.updateSettings(d,!0),this.view=new yse(this),f=hie.getInstance(i,d,S),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),$r(c)==="object"&&(i.runHooks("afterChange",c[0],c[1]),c=!1),i.runHooks("afterInit")};function U(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function Y(y){var w=y.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):y}function ne(y,w,g){if(!!y.length){var m=i.getActiveEditor(),R=i.runHooks("beforeChange",y,w||"edit"),$=!0;if(R===!1){m&&m.cancelChanges();return}var I=new U;I.onQueueEmpty=function(Pe){m&&$&&m.cancelChanges(),g(Pe)};for(var V=y.length-1;V>=0;V--)if(y[V]===null)y.splice(V,1);else{var q=An(y[V],4),oe=q[0],ee=q[1],de=q[3],Te=s.propToCol(ee),me=i.getCellMeta(oe,Te);me.type==="numeric"&&typeof de=="string"&&eF(de)&&(y[V][3]=Y(de)),i.getCellValidator(me)&&(I.addValidatorToQueue(),i.validateCell(y[V][3],me,function(Pe,We){return function(Le){if(typeof Le!="boolean")throw new Error("Validation error: result is not boolean");if(Le===!1&&We.allowInvalid===!1){$=!1,y.splice(Pe,1),We.valid=!0;var je=i.getCell(We.visualRow,We.visualCol);je!==null&&Ge(je,d.invalidCellClassName)}I.removeValidatorFormQueue()}}(V,me),w))}I.checkIfQueueIsEmpty()}}function Z(y,w){var g=y.length-1;if(!(g<0)){for(;g>=0;g--){var m=!1;if(y[g]===null){y.splice(g,1);continue}if(!((y[g][2]===null||y[g][2]===void 0)&&(y[g][3]===null||y[g][3]===void 0))){if(d.allowInsertRow)for(;y[g][0]>i.countRows()-1;){var R=s.createRow(void 0,void 0,w);if(R>=1)h.createRow(null,R);else{m=!0;break}}if(i.dataType==="array"&&(!d.columns||d.columns.length===0)&&d.allowInsertColumn)for(;s.propToCol(y[g][1])>i.countCols()-1;){var $=s.createCol(void 0,void 0,w);if($>=1)h.createColumn(null,$);else{m=!0;break}}m||s.set(y[g][0],y[g][1],y[g][3])}}i.forceFullRender=!0,u.adjustRowsAndCols(),i.runHooks("beforeChangeRender",y,w),f.lockEditor(),i._refreshBorders(null),f.unlockEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",y,w||"edit");var I=i.getActiveEditor();I&&He(I.refreshValue)&&I.refreshValue()}}this.validateCell=function(y,w,g,m){var R=i.getCellValidator(w);function $(I){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!V||w.hidden===!0){g(I);return}var q=w.visualCol,oe=w.visualRow,ee=i.getCell(oe,q,!0);if(ee&&ee.nodeName!=="TH"){var de=i.rowIndexMapper.getRenderableFromVisualIndex(oe),Te=i.columnIndexMapper.getRenderableFromVisualIndex(q);i.view.wt.wtSettings.settings.cellRenderer(de,Te,ee)}g(I)}QH(R)&&(R=function(I){return function(V,q){q(I.test(V))}}(R)),Ct(R)?(y=i.runHooks("beforeValidate",y,w.visualRow,w.prop,m),i._registerImmediate(function(){R.call(w,y,function(I){!i||(I=i.runHooks("afterValidate",I,y,w.visualRow,w.prop,m),w.valid=I,$(I),i.runHooks("postAfterValidate",I,y,w.visualRow,w.prop,m))})})):i._registerImmediate(function(){w.valid=!0,$(w.valid,!1)})};function te(y,w,g){return Array.isArray(y)?y:[[y,w,g]]}this.setDataAtCell=function(y,w,g,m){var R=te(y,w,g),$=[],I=m,V,q,oe;for(V=0,q=R.length;V<q;V++){if($r(R[V])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[V][1]>=this.countCols()?oe=R[V][1]:oe=s.colToProp(R[V][1]),$.push([R[V][0],oe,l.getAtCell(this.toPhysicalRow(R[V][0]),R[V][1]),R[V][2]])}!I&&$r(y)==="object"&&(I=w),i.runHooks("afterSetDataAtCell",$,I),ne($,I,function(){Z($,I)})},this.setDataAtRowProp=function(y,w,g,m){var R=te(y,w,g),$=[],I=m,V,q;for(V=0,q=R.length;V<q;V++)$.push([R[V][0],R[V][1],l.getAtCell(this.toPhysicalRow(R[V][0]),R[V][1]),R[V][2]]);!I&&$r(y)==="object"&&(I=w),i.runHooks("afterSetDataAtRowProp",$,I),ne($,I,function(){Z($,I)})},this.listen=function(){i&&!i.isListening()&&(Ng=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ng=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return Ng===i.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i._refreshBorders(y,w)},this.populateFromArray=function(y,w,g,m,R,$,I,V,q){if(!($r(g)==="object"&&$r(g[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var oe=typeof m=="number"?new J(m,R):null;return u.populateFromArray(new J(y,w),g,oe,$,I,V,q)},this.spliceCol=function(y,w,g){for(var m,R=arguments.length,$=new Array(R>3?R-3:0),I=3;I<R;I++)$[I-3]=arguments[I];return(m=s).spliceCol.apply(m,[y,w,g].concat($))},this.spliceRow=function(y,w,g){for(var m,R=arguments.length,$=new Array(R>3?R-3:0),I=3;I<R;I++)$[I-3]=arguments[I];return(m=s).spliceRow.apply(m,[y,w,g].concat($))},this.getSelected=function(){if(S.isSelected())return et(S.getSelectedRange(),function(y){var w=y.from,g=y.to;return[w.row,w.col,g.row,g.col]})},this.getSelectedLast=function(){var y=this.getSelected(),w;return y&&y.length>0&&(w=y[y.length-1]),w},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),w;return y&&y.length>0&&(w=y[y.length-1]),w},this.emptySelectedCells=function(y){var w=this;if(!(!S.isSelected()||this.countRows()===0||this.countCols()===0)){var g=[];P(S.getSelectedRange(),function(m){var R=m.getTopLeftCorner(),$=m.getBottomRightCorner();Ie(R.row,$.row,function(I){Ie(R.col,$.col,function(V){w.getCellMeta(I,V).readOnly||g.push([I,V,null])})})}),g.length>0&&this.setDataAtCell(g,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var w=y();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var g=y();return this.resumeExecution(w),g},this.batch=function(y){this.suspendRender(),this.suspendExecution();var w=y();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!!i.view){var y=i.view.getLastSize(),w=y.width,g=y.height,m=i.rootElement.getBoundingClientRect(),R=m.width,$=m.height,I=R!==w||$!==g,V=i.runHooks("beforeRefreshDimensions",{width:w,height:g},{width:R,height:$},I)===!1;V||((I||i.view.wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(R,$),i.render()),i.runHooks("afterRefreshDimensions",{width:w,height:g},{width:R,height:$},I))}},this.updateData=function(y,w){var g=this;pP(y,function(m){s=m},function(m){s=m,i.columnIndexMapper.fitToLength(g.getInitialColumnCount()),i.rowIndexMapper.fitToLength(g.countSourceRows()),u.adjustRowsAndCols()},{hotInstance:i,dataMap:s,dataSource:l,internalSource:"updateData",source:w,firstRun:c})},this.loadData=function(y,w){pP(y,function(g){s=g},function(){h.clearCellsCache(),i.initIndexMappers(),u.adjustRowsAndCols(),c&&(c=[null,"loadData"])},{hotInstance:i,dataMap:s,dataSource:l,internalSource:"loadData",source:w,firstRun:c})},this.getInitialColumnCount=function(){var y=d.columns,w=0;if(Array.isArray(y))w=y.length;else if(Ct(y))if(i.dataType==="array")for(var g=this.countSourceCols(),m=0;m<g;m+=1)y(m)&&(w+=1);else(i.dataType==="object"||i.dataType==="function")&&(w=s.colToPropCache.length);else if(He(d.dataSchema)){var R=s.getSchema();w=Array.isArray(R)?R.length:gv(R)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,w,g,m){return It(y)?s.getAll():s.getRange(new J(y,w),new J(g,m),s.DESTINATION_RENDERER)},this.getCopyableText=function(y,w,g,m){return s.getCopyableText(new J(y,w),new J(g,m))},this.getCopyableData=function(y,w){return s.getCopyable(y,s.colToProp(w))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=i.loadData.bind(this),m=!1,R,$;if(He(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(He(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(He(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in y)if(R!=="data")if(R==="language"){M(y.language);continue}else R==="className"?k("className",y.className):R==="tableClassName"&&i.table?(k("tableClassName",y.tableClassName),i.view.wt.wtOverlays.syncOverlayTableClassNames()):Ae.getSingleton().isRegistered(R)||Ae.getSingleton().isDeprecated(R)?(Ct(y[R])||Array.isArray(y[R]))&&(y[R].initialHook=!0,i.addHook(R,y[R])):!w&&Ot(y,R)&&(v[R]=y[R]);y.data===void 0&&d.data===void 0?g(null,"updateSettings"):y.data!==void 0?g(y.data,"updateSettings"):y.columns!==void 0&&(s.createMap(),i.initIndexMappers());var I=i.countCols(),V=d.columns;if(V&&Ct(V)&&(m=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&h.clearCache(),I>0)for(R=0,$=0;R<I;R++){if(V){var q=m?V(R):V[$];q&&h.updateColumnMeta($,q)}$+=1}He(y.cell)&&ot(y.cell,function(Pe){i.setCellMetaObject(Pe.row,Pe.col,Pe)}),i.runHooks("afterCellMetaReset");var oe=i.rootElement.style.height;oe!==""&&(oe=parseInt(i.rootElement.style.height,10));var ee=y.height;if(Ct(ee)&&(ee=ee()),w){var de=i.rootElement.getAttribute("style");de&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style"))}if(ee===null){var Te=i.rootElement.getAttribute("data-initialstyle");Te&&(Te.indexOf("height")>-1||Te.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",Te):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else ee!==void 0&&(i.rootElement.style.height=isNaN(ee)?"".concat(ee):"".concat(ee,"px"),i.rootElement.style.overflow="hidden");if(typeof y.width!="undefined"){var me=y.width;Ct(me)&&(me=me()),i.rootElement.style.width=isNaN(me)?"".concat(me):"".concat(me,"px")}w||(i.view&&(i.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view.wt.exportSettingsAsClassNames()),i.runHooks("afterUpdateSettings",y)),u.adjustRowsAndCols(),i.view&&!c&&(i.forceFullRender=!0,f.lockEditor(),i._refreshBorders(null),i.view.wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!w&&i.view&&(oe===""||ee===""||ee===void 0)&&oe!==ee&&i.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=i.getSelectedLast();if(d.getValue){if(Ct(d.getValue))return d.getValue.call(i);if(y)return i.getData()[y[0][0]][d.getValue]}else if(y)return i.getDataAtCell(y[0],y[1])},this.getSettings=function(){return d},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,w,g,m,R){u.alter(y,w,g,m,R)},this.getCell=function(y,w){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=w,R=y;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;m=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return R===null||m===null?null:i.view.getCellAtCoords(new J(R,m),g)},this.getCoords=function(y){var w=this.view.wt.wtTable.getCoords(y);if(w===null)return null;var g=w.row,m=w.col,R=g,$=m;return g>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(g)),m>=0&&($=this.columnIndexMapper.getVisualFromRenderableIndex(m)),new J(R,$)},this.colToProp=function(y){return s.colToProp(y)},this.propToCol=function(y){return s.propToCol(y)},this.toVisualRow=function(y){return r.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return r.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return r.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return r.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,w){return s.get(y,s.colToProp(w))},this.getDataAtRowProp=function(y,w){return s.get(y,w)},this.getDataAtCol=function(y){var w;return(w=[]).concat.apply(w,Rc(s.getRange(new J(0,y),new J(d.data.length-1,y),s.DESTINATION_RENDERER)))},this.getDataAtProp=function(y){var w,g=s.getRange(new J(0,s.propToCol(y)),new J(d.data.length-1,s.propToCol(y)),s.DESTINATION_RENDERER);return(w=[]).concat.apply(w,Rc(g))},this.getSourceData=function(y,w,g,m){var R;return y===void 0?R=l.getData():R=l.getByRange(new J(y,w),new J(g,m)),R},this.getSourceDataArray=function(y,w,g,m){var R;return y===void 0?R=l.getData(!0):R=l.getByRange(new J(y,w),new J(g,m),!0),R},this.getSourceDataAtCol=function(y){return l.getAtColumn(y)},this.setSourceDataAtCell=function(y,w,g,m){var R=te(y,w,g),$=this.hasHook("afterSetSourceDataAtCell"),I=[];$&&P(R,function(q){var oe=An(q,3),ee=oe[0],de=oe[1],Te=oe[2];I.push([ee,de,l.getAtCell(ee,de),Te])}),P(R,function(q){var oe=An(q,3),ee=oe[0],de=oe[1],Te=oe[2];l.setAtCell(ee,de,Te)}),$&&this.runHooks("afterSetSourceDataAtCell",I,m),this.render();var V=i.getActiveEditor();V&&He(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(y){return l.getAtRow(y)},this.getSourceDataAtCell=function(y,w){return l.getAtCell(y,w)},this.getDataAtRow=function(y){var w=s.getRange(new J(y,0),new J(y,this.countCols()-1),s.DESTINATION_RENDERER);return w[0]||[]},this.getDataType=function(y,w,g,m){var R=this,$=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,w,g,m],I=$[0],V=$[1],q=$[2],oe=$[3],ee=null,de=null;q===void 0&&(q=I),oe===void 0&&(oe=V);var Te="mixed";return Ie(Math.max(Math.min(I,q),0),Math.max(I,q),function(me){var Pe=!0;return Ie(Math.max(Math.min(V,oe),0),Math.max(V,oe),function(We){var Le=R.getCellMeta(me,We);return de=Le.type,ee?Pe=ee===de:ee=de,Pe}),Te=Pe?de:"mixed",Pe}),Te},this.removeCellMeta=function(y,w,g){var m=[this.toPhysicalRow(y),this.toPhysicalColumn(w)],R=m[0],$=m[1],I=h.getCellMetaKeyValue(R,$,g),V=i.runHooks("beforeRemoveCellMeta",y,w,g,I);V!==!1&&(h.removeCellMeta(R,$,g),i.runHooks("afterRemoveCellMeta",y,w,g,I)),I=null},this.spliceCellsMeta=function(y){for(var w=this,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=arguments.length,R=new Array(m>2?m-2:0),$=2;$<m;$++)R[$-2]=arguments[$];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&h.removeRow(this.toPhysicalRow(y),g),R.length>0&&P(R.reverse(),function(I){h.createRow(w.toPhysicalRow(y)),P(I,function(V,q){return w.setCellMetaObject(y,q,V)})}),i.render()},this.setCellMetaObject=function(y,w,g){var m=this;$r(g)==="object"&&ot(g,function(R,$){m.setCellMeta(y,w,$,R)})},this.setCellMeta=function(y,w,g,m){var R=i.runHooks("beforeSetCellMeta",y,w,g,m);if(R!==!1){var $=y,I=w;y<this.countRows()&&($=this.toPhysicalRow(y)),w<this.countCols()&&(I=this.toPhysicalColumn(w)),h.setCellMeta($,I,g,m),i.runHooks("afterSetCellMeta",y,w,g,m)}},this.getCellsMeta=function(){return h.getCellsMeta()},this.getCellMeta=function(y,w){var g=this.toPhysicalRow(y),m=this.toPhysicalColumn(w);return g===null&&(g=y),m===null&&(m=w),h.getCellMeta(g,m,{visualRow:y,visualColumn:w})},this.getCellMetaAtRow=function(y){return h.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||d.columns)};var se=Ou("renderer");this.getCellRenderer=function(y,w){return BO(se.call(this,y,w))},this.getCellEditor=Ou("editor");var he=Ou("validator");this.getCellValidator=function(y,w){var g=he.call(this,y,w);return typeof g=="string"&&(g=VO(g)),g},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,w){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,y)},this.validateColumns=function(y,w){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,y)},this._validateCells=function(y,w,g){var m=new U;y&&(m.onQueueEmpty=y);for(var R=i.countRows()-1;R>=0;){if(w!==void 0&&w.indexOf(R)===-1){R-=1;continue}for(var $=i.countCols()-1;$>=0;){if(g!==void 0&&g.indexOf($)===-1){$-=1;continue}m.addValidatorToQueue(),i.validateCell(i.getDataAtCell(R,$),i.getCellMeta(R,$),function(I){if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(m.valid=!1),m.removeValidatorFormQueue()},"validateCells"),$-=1}R-=1}m.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var w=d.rowHeaders,g=y;return g!==void 0&&(g=i.runHooks("modifyRowHeader",g)),g===void 0?(w=[],Ie(i.countRows()-1,function(m){w.push(i.getRowHeader(m))})):Array.isArray(w)&&w[g]!==void 0?w=w[g]:Ct(w)?w=w(g):w&&typeof w!="string"&&typeof w!="number"&&(w=g+1),w},this.hasRowHeaders=function(){return!!d.rowHeaders},this.hasColHeaders=function(){if(d.colHeaders!==void 0&&d.colHeaders!==null)return!!d.colHeaders;for(var y=0,w=i.countCols();y<w;y++)if(i.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var w=i.runHooks("modifyColHeader",y),g=d.colHeaders;if(w===void 0){for(var m=[],R=i.countCols(),$=0;$<R;$++)m.push(i.getColHeader($));g=m}else{var I=function(ee){for(var de=[],Te=i.countCols(),me=0;me<Te;me++)Ct(d.columns)&&d.columns(me)&&de.push(me);return de[ee]},V=i.toPhysicalColumn(w),q=I(V);d.colHeaders===!1?g=null:d.columns&&Ct(d.columns)&&d.columns(q)&&d.columns(q).title?g=d.columns(q).title:d.columns&&d.columns[V]&&d.columns[V].title?g=d.columns[V].title:Array.isArray(d.colHeaders)&&d.colHeaders[V]!==void 0?g=d.colHeaders[V]:Ct(d.colHeaders)?g=d.colHeaders(V):d.colHeaders&&typeof d.colHeaders!="string"&&typeof d.colHeaders!="number"&&(g=xv(w))}return g},this._getColWidthFromSettings=function(y){var w;if(y>=0){var g=i.getCellMeta(0,y);w=g.width}if((w===void 0||w===d.width)&&(w=d.colWidths),w!=null){switch($r(w)){case"object":w=w[y];break;case"function":w=w(y);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(y){var w=i._getColWidthFromSettings(y);return w=i.runHooks("modifyColWidth",w,y),w===void 0&&(w=RO.DEFAULT_WIDTH),w},this._getRowHeightFromSettings=function(y){var w=d.rowHeights;if(w!=null){switch($r(w)){case"object":w=w[y];break;case"function":w=w(y);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getRowHeight=function(y){var w=i._getRowHeightFromSettings(y);return w=i.runHooks("modifyRowHeight",w,y),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var y=d.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,w)},this.countRenderedRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view.wt.drawn?i.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return wd(i.countRows()-1,function(g){if(i.isEmptyRow(g))w+=1;else if(y===!0)return!1}),w},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(i.countRows()<1)return 0;var w=0;return wd(i.countCols()-1,function(g){if(i.isEmptyCol(g))w+=1;else if(y===!0)return!1}),w},this.isEmptyRow=function(y){return d.isEmptyRow.call(i,y)},this.isEmptyCol=function(y){return d.isEmptyCol.call(i,y)},this.selectCell=function(y,w,g,m){var R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,$=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return It(y)||It(w)?!1:this.selectCells([[y,w,g,m]],R,$)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&(o=!0);var m=S.selectCells(y);return m&&g&&i.listen(),o=!1,m},this.selectColumns=function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return S.selectColumns(y,w)},this.selectRows=function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return S.selectRows(y,w)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=y&&this.hasRowHeaders(),g=y&&this.hasColHeaders();o=!0,S.selectAll(w,g),o=!1};var ae=function(w,g){return w.getFirstNotHiddenIndex(g,1,!0)};this.scrollViewportTo=function(y,w){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,$=!g,I=!m,V=y,q=w;if(R){var oe=Number.isInteger(y),ee=Number.isInteger(w),de=oe?ae(this.rowIndexMapper,y):void 0,Te=ee?ae(this.columnIndexMapper,w):void 0;if(de===null||Te===null)return!1;V=oe?i.rowIndexMapper.getRenderableFromVisualIndex(de):void 0,q=ee?i.columnIndexMapper.getRenderableFromVisualIndex(Te):void 0}var me=Number.isInteger(V),Pe=Number.isInteger(q);return me&&Pe?i.view.scrollViewport(new J(V,q),$,m,g,I):me&&Pe===!1?i.view.scrollViewportVertically(V,$,g):Pe&&me===!1?i.view.scrollViewportHorizontally(q,m,I):!1},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),l&&l.destroy(),l=null,h.clearCache(),Lue(),Eb(i)){var y=this.rootDocument.querySelector("#hot-display-license-info");y&&y.parentNode.removeChild(y)}sn(i.rootElement),a.destroy(),f&&f.destroy(),i.batchExecution(function(){i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),p.getItems().forEach(function(w){var g=An(w,2),m=g[1];m.destroy()}),p.clear(),i.runHooks("afterDestroy")},!0),Ae.getSingleton().destroy(i),ot(i,function(w,g,m){Ct(w)?m[g]=Ce(g):g!=="guid"&&(m[g]=null)}),i.isDestroyed=!0,s&&s.destroy(),i.rowIndexMapper=null,i.columnIndexMapper=null,s=null,u=null,S=null,f=null,i=null};function Ce(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(y){var w=an(y);return w==="UndoRedo"?this.undoRedo:p.getItem(w)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:p.getId(y)},this.getInstance=function(){return i},this.addHook=function(y,w){Ae.getSingleton().add(y,w,i)},this.hasHook=function(y){return Ae.getSingleton().has(y,i)},this.addHookOnce=function(y,w){Ae.getSingleton().once(y,w,i)},this.removeHook=function(y,w){Ae.getSingleton().remove(y,w,i)},this.runHooks=function(y,w,g,m,R,$,I){return Ae.getSingleton().run(i,y,w,g,m,R,$,I)},this.getTranslatedPhrase=function(y,w){return $F(d.language,y,w)},this.toHTML=function(){return pb(r)},this.toTableElement=function(){var y=r.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",pb(r)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=y;typeof g=="function"&&(g=setTimeout(g,w)),this.timeouts.push(g)},this._clearTimeouts=function(){P(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){P(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(y),i.view.render(),w&&S.isSelected()&&f.prepareEditor()},this.isRtl=function(){return i.rootWindow.getComputedStyle(i.rootElement).direction==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},jO().forEach(function(y){var w=Pf(y);p.addItem(y,new w(r))}),Ae.getSingleton().run(i,"construct")}function yhe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(d,v,p){d.addEventListener(v,p,!1)},a=function(d,v,p){d.removeEventListener(v,p,!1)},s=function(d){var v,p;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),v=o.clientWidth+2,r.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(d.maxHeight);isNaN(p)||(e.maxHeight=p)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var b=parseInt(d.minWidth);isNaN(b)||(e.minWidth=b)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var _=parseInt(d.maxWidth);isNaN(_)||(e.maxWidth=_)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},f=function(d,v,p){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(i(t,"change",s),i(t,"cut",l),i(t,"paste",l),i(t,"drop",l),i(t,"keydown",l),i(t,"focus",s),i(t,"compositionstart",l),i(t,"compositionupdate",l),i(t,"compositionend",l)),s()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,p){f(d,v,p)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}function aw(e){return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function mhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bhe(e,t,r){return t&&yP(e.prototype,t),r&&yP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ku(){return typeof Reflect!="undefined"&&Reflect.get?ku=Reflect.get:ku=function(t,r,n){var o=whe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ku.apply(this,arguments)}function whe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Na(e),e!==null););return e}function _he(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sw(e,t)}function sw(e,t){return sw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},sw(e,t)}function She(e){var t=Ohe();return function(){var n=Na(e),o;if(t){var i=Na(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Che(this,o)}}function Che(e,t){if(t&&(aw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YF(e)}function YF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ohe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Na(e){return Na=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Na(e)}var Rhe="ht_editor_visible",Ec="ht_editor_hidden",Ehe="text",Xa=function(e){_he(r,e);var t=She(r);function r(n){var o;return mhe(this,r),o=t.call(this,n),o.eventManager=new bt(YF(o)),o.autoResize=yhe(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return bhe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(o){this.TEXTAREA.value=o}},{key:"open",value:function(){var o=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",function(i){return o.onBeforeKeyDown(i)})}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(o,i,a,s,l,u){var f=this.state;if(ku(Na(r.prototype),"prepare",this).call(this,o,i,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==sr.FINISHED&&this.hideEditableElement();var d=!h;d&&!Sn()&&this.focus()}}},{key:"beginEditing",value:function(o,i){this.state===sr.VIRGIN&&(this.TEXTAREA.value="",ku(Na(r.prototype),"beginEditing",this).call(this,o,i))}},{key:"focus",value:function(){this.TEXTAREA.select(),zu(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var o=this.hot.rootDocument;this.TEXTAREA=o.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,le(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=o.createElement("DIV"),le(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ve(this.TEXTAREA_PARENT,this.layerClass)&&Ge(this.TEXTAREA_PARENT,this.layerClass),le(this.TEXTAREA_PARENT,Ec),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(ZN()||QN())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ve(this.TEXTAREA_PARENT,this.layerClass)&&Ge(this.TEXTAREA_PARENT,this.layerClass),le(this.TEXTAREA_PARENT,Ec)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var o=this.TEXTAREA_PARENT.childNodes,i=!1;Ie(o.length-1,function(a){var s=o[a];if(Ve(s,"handsontableEditor"))return i=!0,!1}),Ve(this.TEXTAREA_PARENT,Ec)&&Ge(this.TEXTAREA_PARENT,Ec),i?(this.layerClass=Rhe,le(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),le(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var o=this.hot.toPhysicalRow(this.row),i=this.hot.getSourceDataAtCell(o,this.col);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==sr.EDITING&&!o)){if(this.TD=this.getEditedCell(),!this.TD){o||this.close();return}var i=this.hot.view.wt,a=i.wtOverlays,s=i.wtViewport,l=Dt(this.TD),u=Dt(this.hot.rootElement),f=a.topOverlay.holder,c=a.leftOverlay.holder,h=f!==this.hot.rootWindow?f.scrollTop:0,d=c!==this.hot.rootWindow?c.scrollLeft:0,v=this.checkEditorSection(),p=["","left"].includes(v)?h:0,b=["","top","bottom"].includes(v)?d:0,_=l.top===u.top?0:1,S=this.TD.style.backgroundColor,E=l.top-u.top-_-p,M=l.left-u.left-1-b,k;switch(v){case"top":k=wn(a.topOverlay.clone.wtTable.holder.parentNode);break;case"left":k=wn(a.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":k=wn(a.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":k=wn(a.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":k=wn(a.bottomOverlay.clone.wtTable.holder.parentNode);break}var U=this.hot.hasColHeaders(),Y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ne=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Z=this.hot.rowIndexMapper.getRenderableIndexesLength(),te=Z-this.hot.view.wt.getSetting("fixedRowsBottom");(U&&Y<=0||Y===te)&&(E+=1),ne<=0&&(M+=1),k&&k!==-1?this.textareaParentStyle[k[0]]=k[1]:Ga(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(E,"px"),this.textareaParentStyle.left="".concat(M,"px"),this.showEditableElement();var se=s.rowsRenderCalculator.startPosition,he=s.columnsRenderCalculator.startPosition,ae=a.leftOverlay.getScrollPosition(),Ce=a.topOverlay.getScrollPosition(),y=fr(this.hot.rootDocument),w=this.TD.offsetTop+se-Ce,g=this.TD.offsetLeft+he-ae,m=xs(this.TD)-8,R=iL(f)?y:0,$=aL(c)?y:0,I=this.hot.view.maximumVisibleElementWidth(g)-9-R,V=this.TD.scrollHeight+1,q=Math.max(this.hot.view.maximumVisibleElementHeight(w)-$,23),oe=Ya(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=oe.fontSize,this.TEXTAREA.style.fontFamily=oe.fontFamily,this.TEXTAREA.style.backgroundColor=S,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(V,q),maxHeight:q,minWidth:Math.min(m,I),maxWidth:I},!0)}}},{key:"bindEvents",value:function(){var o=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(i){return i.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(i){return i.stopPropagation()}),JC()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return o.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){o.refreshDimensions(),o.focus()}),this.addHook("afterRowResize",function(){o.refreshDimensions(),o.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(o){var i=(o.ctrlKey||o.metaKey)&&!o.altKey;if(!(o.target!==this.TEXTAREA||_n(o))){switch(o.keyCode){case ue.ARROW_RIGHT:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(o.keyCode)&&At(o);break;case ue.ARROW_LEFT:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(o.keyCode)&&At(o);break;case ue.ARROW_UP:case ue.ARROW_DOWN:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(o.keyCode)&&At(o);break;case ue.ENTER:{var a=this.hot.selection.isMultiple();if(i&&!a||o.altKey){if(this.isOpened()){var s=_O(this.TEXTAREA),l=this.getValue(),u="".concat(l.slice(0,s),`
`).concat(l.slice(s));this.setValue(u),zu(this.TEXTAREA,s+1)}else this.beginEditing("".concat(this.originalValue,`
`));At(o)}o.preventDefault();break}case ue.BACKSPACE:case ue.DELETE:case ue.HOME:case ue.END:At(o);break}var f=[ue.ARROW_UP,ue.ARROW_RIGHT,ue.ARROW_DOWN,ue.ARROW_LEFT];f.indexOf(o.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(o.keyCode))}}}],[{key:"EDITOR_TYPE",get:function(){return Ehe}}]),r}(Il),The="base";function Hf(e,t,r,n,o,i,a){var s=[],l=[];a.className&&le(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),Ge(t,l),le(t,s)}Hf.RENDERER_TYPE=The;var khe="text";function Di(e,t,r,n,o,i,a){Hf.apply(this,[e,t,r,n,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=jt(s),e.getSettings().trimWhitespace&&(s=s.trim()),a.rendererTemplate){sn(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else _i(t,s)}Di.RENDERER_TYPE=khe;var Ahe="text",GF={CELL_TYPE:Ahe,editor:Xa,renderer:Di};gn(GF);Xe.editors={BaseEditor:Il};function Xe(e,t){var r=new yE(e,t||{},WO);return r.init(),r}Xe.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yE(e,t,WO)};Xe.DefaultSettings=BF();Xe.hooks=Ae.getSingleton();Xe.packageName="handsontable";Xe.buildDate="13/01/2022 12:30:03";Xe.version="11.1.0";Xe.languages={dictionaryKeys:kue,getLanguageDictionary:MF,getLanguagesDictionaries:Due,registerLanguageDictionary:PF,getTranslatedPhrase:$F};function lw(e){return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}function Ihe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Phe(e,t,r){return t&&mP(e.prototype,t),r&&mP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hn(){return typeof Reflect!="undefined"&&Reflect.get?Hn=Reflect.get:Hn=function(t,r,n){var o=Mhe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hn.apply(this,arguments)}function Mhe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tn(e),e!==null););return e}function $he(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uw(e,t)}function uw(e,t){return uw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},uw(e,t)}function Dhe(e){var t=Hhe();return function(){var n=tn(e),o;if(t){var i=tn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xhe(this,o)}}function xhe(e,t){if(t&&(lw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nhe(e)}function Nhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},tn(e)}var Lhe="handsontable",mE=function(e){$he(r,e);var t=Dhe(r);function r(){return Ihe(this,r),t.apply(this,arguments)}return Phe(r,[{key:"open",value:function(){Hn(tn(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),zu(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Hn(tn(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(o,i,a,s,l,u){Hn(tn(r.prototype),"prepare",this).call(this,o,i,a,s,l,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var p=this.getSourceData(v.row,v.col);p!==void 0&&f.setValue(p),f.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&xt(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(o,i){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||Hn(tn(r.prototype),"beginEditing",this).call(this,o,i)}},{key:"createElements",value:function(){Hn(tn(r.prototype),"createElements",this).call(this);var o=this.hot.rootDocument.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.htContainer=o,this.assignHooks()}},{key:"finishEditing",value:function(o,i,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}Hn(tn(r.prototype),"finishEditing",this).call(this,o,i,a)}},{key:"assignHooks",value:function(){var o=this;this.hot.addHook("afterDestroy",function(){o.htEditor&&o.htEditor.destroy()})}},{key:"onBeforeKeyDown",value:function(o){if(!_n(o)){var i=this.htEditor.getInstance(),a,s;if(o.keyCode===ue.ARROW_DOWN){if(!i.getSelectedLast()&&!i.flipped)a=0;else if(i.getSelectedLast()){if(i.flipped)a=i.getSelectedLast()[0]+1;else if(!i.flipped){var l=i.countRows()-1;s=i.getSelectedLast()[0],a=Math.min(l,s+1)}}}else o.keyCode===ue.ARROW_UP&&(!i.getSelectedLast()&&i.flipped?a=i.countRows()-1:i.getSelectedLast()&&(i.flipped?(s=i.getSelectedLast()[0],a=Math.max(0,s-1)):(s=i.getSelectedLast()[0],a=s-1)));a!==void 0&&(a<0||i.flipped&&a>i.countRows()-1?i.deselectCell():i.selectCell(a,0),i.getData().length&&(o.preventDefault(),At(o),this.hot.listen(),this.TEXTAREA.focus())),Hn(tn(r.prototype),"onBeforeKeyDown",this).call(this,o)}}}],[{key:"EDITOR_TYPE",get:function(){return Lhe}}]),r}(Xa);function fw(e){return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function Fhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jhe(e,t,r){return t&&bP(e.prototype,t),r&&bP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ni(){return typeof Reflect!="undefined"&&Reflect.get?ni=Reflect.get:ni=function(t,r,n){var o=Bhe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ni.apply(this,arguments)}function Bhe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vn(e),e!==null););return e}function Vhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cw(e,t)}function cw(e,t){return cw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},cw(e,t)}function Whe(e){var t=zhe();return function(){var n=Vn(e),o;if(t){var i=Vn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Uhe(this,o)}}function Uhe(e,t){if(t&&(fw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hw(e)}function hw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vn(e){return Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Vn(e)}function Yhe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Hg=new WeakMap,Ghe="autocomplete",bE=function(e){Vhe(r,e);var t=Whe(r);function r(n){var o;return Fhe(this,r),o=t.call(this,n),Yhe(hw(o),"sortByRelevance",function(i,a,s){var l=[],u=[],f=i.length,c=a.length,h,d,v,p;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=Sm(jt(a[v])),s)p=d.indexOf(i);else{var b=this.cellProperties.locale;p=d.toLocaleLowerCase(b).indexOf(i.toLocaleLowerCase(b))}p!==-1&&(h=d.length-p-f,l.push({baseIndex:v,index:p,charsLeft:h,value:d}))}for(l.sort(function(_,S){if(S.index===-1)return-1;if(_.index===-1)return 1;if(_.index<S.index)return-1;if(S.index<_.index)return 1;if(_.index===S.index){if(_.charsLeft<S.charsLeft)return-1;if(_.charsLeft>S.charsLeft)return 1}return 0}),v=0,c=l.length;v<c;v++)u.push(l[v].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Hg.set(hw(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return jhe(r,[{key:"getValue",value:function(){var o=this,i=this.rawChoices.find(function(a){var s=o.stripValueIfNeeded(a);return s===o.TEXTAREA.value});return He(i)?i:this.TEXTAREA.value}},{key:"createElements",value:function(){ni(Vn(r.prototype),"createElements",this).call(this),le(this.htContainer,"autocompleteEditor"),le(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var o=this,i=Hg.get(this);ni(Vn(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=fr();l===0&&i.isMacOS&&(l+=15),a.updateSettings({colWidths:s?[Ft(this.TEXTAREA)-2]:void 0,width:s?Ft(this.TEXTAREA)+l:void 0,renderer:function(f,c,h,d,v,p,b){Di(f,c,h,d,v,p,b);var _=o.cellProperties,S=_.filteringCaseSensitive,E=_.allowHtml,M=_.locale,k=o.query,U=jt(p),Y,ne;U&&!E&&(Y=S===!0?U.indexOf(k):U.toLocaleLowerCase(M).indexOf(k.toLocaleLowerCase(M)),Y!==-1&&(ne=U.substr(Y,k.length),U=U.replace(ne,"<strong>".concat(ne,"</strong>")))),c.innerHTML=U},autoColumnSize:!0}),i.skipOne&&(i.skipOne=!1),this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),ni(Vn(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(o){ni(Vn(r.prototype),"discardEditor",this).call(this,o),this.hot.view.render()}},{key:"queryChoices",value:function(o){var i=this,a=this.cellProperties.source;this.query=o,typeof a=="function"?a.call(this.cellProperties,o,function(s){i.rawChoices=s,i.updateChoicesList(i.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(o){var i=_O(this.TEXTAREA),a=nL(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,f=null,c=o;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(f=u[0]);else{for(var d=[],v=0,p=c.length;v<p&&!(s&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(mu([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),zu(this.TEXTAREA,i,i===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var o=Dt(this.TEXTAREA),i=Ut(this.TEXTAREA),a=this.getDropdownHeight(),s=Qs(this.hot.view.wt.wtTable.TABLE),l=s.scrollTop,u=Ut(this.hot.view.wt.wtTable.THEAD),f={row:0,col:0};s!==this.hot.rootWindow&&(f=Dt(s));var c=o.top-f.top-u+l,h=s.scrollHeight-c-u-i,d=a>h&&c>h;return d?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,a),d}},{key:"limitDropdownIfNeeded",value:function(o,i){if(i>o){var a=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,a+=l,s+=1;while(a<o);u=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+i-u,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(o){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="".concat(-o,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var o=this.htEditor.rootElement.style;o.position==="absolute"&&(o.position="",o.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var o=this.htEditor.getColWidth(0)+fr(this.hot.rootDocument)+2,i=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:i?void 0:o}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(o){this.htEditor.updateSettings({height:o})}},{key:"highlightBestMatchingChoice",value:function(o){typeof o=="number"?this.htEditor.selectCell(o,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var o=this.htEditor.getInstance().getRowHeight(0)||23,i=this.cellProperties.visibleRows;return this.strippedChoices.length>=i?i*o:this.strippedChoices.length*o+8}},{key:"stripValueIfNeeded",value:function(o){return this.stripValuesIfNeeded([o])[0]}},{key:"stripValuesIfNeeded",value:function(o){var i=this.cellProperties.allowHtml,a=et(o,function(l){return jt(l)}),s=et(a,function(l){return i?l:Sm(l)});return s}},{key:"allowKeyEventPropagation",value:function(o){var i=this.htEditor.getSelectedRangeLast(),a={row:i?i.from.row:-1},s=!1;return o===ue.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),o===ue.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(o){var i=this,a=Hg.get(this);if(a.skipOne=!1,BL(o.keyCode)||o.keyCode===ue.BACKSPACE||o.keyCode===ue.DELETE||o.keyCode===ue.INSERT){var s=10;if(o.keyCode===ue.C&&(o.ctrlKey||o.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value),a.skipOne=!0},s)}ni(Vn(r.prototype),"onBeforeKeyDown",this).call(this,o)}}],[{key:"EDITOR_TYPE",get:function(){return Ghe}}]),r}(mE);function dw(e){return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(e)}function Khe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xhe(e,t,r){return t&&wP(e.prototype,t),r&&wP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vw(e,t)}function vw(e,t){return vw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},vw(e,t)}function Qhe(e){var t=ede();return function(){var n=Td(e),o;if(t){var i=Td(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zhe(this,o)}}function Zhe(e,t){if(t&&(dw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jhe(e)}function Jhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ede(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Td(e){return Td=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Td(e)}var tde="checkbox",KF=function(e){qhe(r,e);var t=Qhe(r);function r(){return Khe(this,r),t.apply(this,arguments)}return Xhe(r,[{key:"beginEditing",value:function(o,i){if(i&&i.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');Ve(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return tde}}]),r}(Il),XF={exports:{}};/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var o;{try{o=require("moment")}catch{}e.exports=n(o)}})(Ji,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,s=function(g,m,R,$){o?g.addEventListener(m,R,!!$):g.attachEvent("on"+m,R)},l=function(g,m,R,$){o?g.removeEventListener(m,R,!!$):g.detachEvent("on"+m,R)},u=function(g){return g.trim?g.trim():g.replace(/^\s+|\s+$/g,"")},f=function(g,m){return(" "+g.className+" ").indexOf(" "+m+" ")!==-1},c=function(g,m){f(g,m)||(g.className=g.className===""?m:g.className+" "+m)},h=function(g,m){g.className=u((" "+g.className+" ").replace(" "+m+" "," "))},d=function(g){return/Array/.test(Object.prototype.toString.call(g))},v=function(g){return/Date/.test(Object.prototype.toString.call(g))&&!isNaN(g.getTime())},p=function(g){var m=g.getDay();return m===0||m===6},b=function(g){return g%4===0&&g%100!==0||g%400===0},_=function(g,m){return[31,b(g)?29:28,31,30,31,30,31,31,30,31,30,31][m]},S=function(g){v(g)&&g.setHours(0,0,0,0)},E=function(g,m){return g.getTime()===m.getTime()},M=function(g,m,R){var $,I;for($ in m)I=g[$]!==void 0,I&&typeof m[$]=="object"&&m[$]!==null&&m[$].nodeName===void 0?v(m[$])?R&&(g[$]=new Date(m[$].getTime())):d(m[$])?R&&(g[$]=m[$].slice(0)):g[$]=M({},m[$],R):(R||!I)&&(g[$]=m[$]);return g},k=function(g,m,R){var $;i.createEvent?($=i.createEvent("HTMLEvents"),$.initEvent(m,!0,!1),$=M($,R),g.dispatchEvent($)):i.createEventObject&&($=i.createEventObject(),$=M($,R),g.fireEvent("on"+m,$))},U=function(g){return g.month<0&&(g.year-=Math.ceil(Math.abs(g.month)/12),g.month+=12),g.month>11&&(g.year+=Math.floor(Math.abs(g.month)/12),g.month-=12),g},Y={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ne=function(g,m,R){for(m+=g.firstDay;m>=7;)m-=7;return R?g.i18n.weekdaysShort[m]:g.i18n.weekdays[m]},Z=function(g){var m=[],R="false";if(g.isEmpty)if(g.showDaysInNextAndPreviousMonths)m.push("is-outside-current-month"),g.enableSelectionDaysInNextAndPreviousMonths||m.push("is-selection-disabled");else return'<td class="is-empty"></td>';return g.isDisabled&&m.push("is-disabled"),g.isToday&&m.push("is-today"),g.isSelected&&(m.push("is-selected"),R="true"),g.hasEvent&&m.push("has-event"),g.isInRange&&m.push("is-inrange"),g.isStartRange&&m.push("is-startrange"),g.isEndRange&&m.push("is-endrange"),'<td data-day="'+g.day+'" class="'+m.join(" ")+'" aria-selected="'+R+'"><button class="pika-button pika-day" type="button" data-pika-year="'+g.year+'" data-pika-month="'+g.month+'" data-pika-day="'+g.day+'">'+g.day+"</button></td>"},te=function(g,m,R){var $=new Date(R,0,1),I=Math.ceil(((new Date(R,m,g)-$)/864e5+$.getDay()+1)/7);return'<td class="pika-week">'+I+"</td>"},se=function(g,m,R,$){return'<tr class="pika-row'+(R?" pick-whole-week":"")+($?" is-selected":"")+'">'+(m?g.reverse():g).join("")+"</tr>"},he=function(g){return"<tbody>"+g.join("")+"</tbody>"},ae=function(g){var m,R=[];for(g.showWeekNumber&&R.push("<th></th>"),m=0;m<7;m++)R.push('<th scope="col"><abbr title="'+ne(g,m)+'">'+ne(g,m,!0)+"</abbr></th>");return"<thead><tr>"+(g.isRTL?R.reverse():R).join("")+"</tr></thead>"},Ce=function(g,m,R,$,I,V){var q,oe,ee,de=g._o,Te=R===de.minYear,me=R===de.maxYear,Pe='<div id="'+V+'" class="pika-title" role="heading" aria-live="assertive">',We,Le,je=!0,Fe=!0;for(ee=[],q=0;q<12;q++)ee.push('<option value="'+(R===I?q-m:12+q-m)+'"'+(q===$?' selected="selected"':"")+(Te&&q<de.minMonth||me&&q>de.maxMonth?'disabled="disabled"':"")+">"+de.i18n.months[q]+"</option>");for(We='<div class="pika-label">'+de.i18n.months[$]+'<select class="pika-select pika-select-month" tabindex="-1">'+ee.join("")+"</select></div>",d(de.yearRange)?(q=de.yearRange[0],oe=de.yearRange[1]+1):(q=R-de.yearRange,oe=1+R+de.yearRange),ee=[];q<oe&&q<=de.maxYear;q++)q>=de.minYear&&ee.push('<option value="'+q+'"'+(q===R?' selected="selected"':"")+">"+q+"</option>");return Le='<div class="pika-label">'+R+de.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+ee.join("")+"</select></div>",de.showMonthAfterYear?Pe+=Le+We:Pe+=We+Le,Te&&($===0||de.minMonth>=$)&&(je=!1),me&&($===11||de.maxMonth<=$)&&(Fe=!1),m===0&&(Pe+='<button class="pika-prev'+(je?"":" is-disabled")+'" type="button">'+de.i18n.previousMonth+"</button>"),m===g._o.numberOfMonths-1&&(Pe+='<button class="pika-next'+(Fe?"":" is-disabled")+'" type="button">'+de.i18n.nextMonth+"</button>"),Pe+="</div>"},y=function(g,m,R){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+R+'">'+ae(g)+he(m)+"</table>"},w=function(g){var m=this,R=m.config(g);m._onMouseDown=function(I){if(!!m._v){I=I||window.event;var V=I.target||I.srcElement;if(!!V)if(f(V,"is-disabled")||(f(V,"pika-button")&&!f(V,"is-empty")&&!f(V.parentNode,"is-disabled")?(m.setDate(new Date(V.getAttribute("data-pika-year"),V.getAttribute("data-pika-month"),V.getAttribute("data-pika-day"))),R.bound&&a(function(){m.hide(),R.blurFieldOnSelect&&R.field&&R.field.blur()},100)):f(V,"pika-prev")?m.prevMonth():f(V,"pika-next")&&m.nextMonth()),f(V,"pika-select"))m._c=!0;else if(I.preventDefault)I.preventDefault();else return I.returnValue=!1,!1}},m._onChange=function(I){I=I||window.event;var V=I.target||I.srcElement;!V||(f(V,"pika-select-month")?m.gotoMonth(V.value):f(V,"pika-select-year")&&m.gotoYear(V.value))},m._onKeyChange=function(I){if(I=I||window.event,m.isVisible())switch(I.keyCode){case 13:case 27:R.field&&R.field.blur();break;case 37:I.preventDefault(),m.adjustDate("subtract",1);break;case 38:m.adjustDate("subtract",7);break;case 39:m.adjustDate("add",1);break;case 40:m.adjustDate("add",7);break}},m._onInputChange=function(I){var V;I.firedBy!==m&&(R.parse?V=R.parse(R.field.value,R.format):n?(V=r(R.field.value,R.format,R.formatStrict),V=V&&V.isValid()?V.toDate():null):V=new Date(Date.parse(R.field.value)),v(V)&&m.setDate(V),m._v||m.show())},m._onInputFocus=function(){m.show()},m._onInputClick=function(){m.show()},m._onInputBlur=function(){var I=i.activeElement;do if(f(I,"pika-single"))return;while(I=I.parentNode);m._c||(m._b=a(function(){m.hide()},50)),m._c=!1},m._onClick=function(I){I=I||window.event;var V=I.target||I.srcElement,q=V;if(!!V){!o&&f(V,"pika-select")&&(V.onchange||(V.setAttribute("onchange","return;"),s(V,"change",m._onChange)));do if(f(q,"pika-single")||q===R.trigger)return;while(q=q.parentNode);m._v&&V!==R.trigger&&q!==R.trigger&&m.hide()}},m.el=i.createElement("div"),m.el.className="pika-single"+(R.isRTL?" is-rtl":"")+(R.theme?" "+R.theme:""),s(m.el,"mousedown",m._onMouseDown,!0),s(m.el,"touchend",m._onMouseDown,!0),s(m.el,"change",m._onChange),R.keyboardInput&&s(i,"keydown",m._onKeyChange),R.field&&(R.container?R.container.appendChild(m.el):R.bound?i.body.appendChild(m.el):R.field.parentNode.insertBefore(m.el,R.field.nextSibling),s(R.field,"change",m._onInputChange),R.defaultDate||(n&&R.field.value?R.defaultDate=r(R.field.value,R.format).toDate():R.defaultDate=new Date(Date.parse(R.field.value)),R.setDefaultDate=!0));var $=R.defaultDate;v($)?R.setDefaultDate?m.setDate($,!0):m.gotoDate($):m.gotoDate(new Date),R.bound?(this.hide(),m.el.className+=" is-bound",s(R.trigger,"click",m._onInputClick),s(R.trigger,"focus",m._onInputFocus),s(R.trigger,"blur",m._onInputBlur)):this.show()};return w.prototype={config:function(g){this._o||(this._o=M({},Y,!0));var m=M(this._o,g,!0);m.isRTL=!!m.isRTL,m.field=m.field&&m.field.nodeName?m.field:null,m.theme=typeof m.theme=="string"&&m.theme?m.theme:null,m.bound=!!(m.bound!==void 0?m.field&&m.bound:m.field),m.trigger=m.trigger&&m.trigger.nodeName?m.trigger:m.field,m.disableWeekends=!!m.disableWeekends,m.disableDayFn=typeof m.disableDayFn=="function"?m.disableDayFn:null;var R=parseInt(m.numberOfMonths,10)||1;if(m.numberOfMonths=R>4?4:R,v(m.minDate)||(m.minDate=!1),v(m.maxDate)||(m.maxDate=!1),m.minDate&&m.maxDate&&m.maxDate<m.minDate&&(m.maxDate=m.minDate=!1),m.minDate&&this.setMinDate(m.minDate),m.maxDate&&this.setMaxDate(m.maxDate),d(m.yearRange)){var $=new Date().getFullYear()-10;m.yearRange[0]=parseInt(m.yearRange[0],10)||$,m.yearRange[1]=parseInt(m.yearRange[1],10)||$}else m.yearRange=Math.abs(parseInt(m.yearRange,10))||Y.yearRange,m.yearRange>100&&(m.yearRange=100);return m},toString:function(g){return g=g||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,g):n?r(this._d).format(g):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(g,m){n&&r.isMoment(g)&&this.setDate(g.toDate(),m)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(g,m){if(!g)return this._d=null,this._o.field&&(this._o.field.value="",k(this._o.field,"change",{firedBy:this})),this.draw();if(typeof g=="string"&&(g=new Date(Date.parse(g))),!!v(g)){var R=this._o.minDate,$=this._o.maxDate;v(R)&&g<R?g=R:v($)&&g>$&&(g=$),this._d=new Date(g.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),k(this._o.field,"change",{firedBy:this})),!m&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(g){var m=!0;if(!!v(g)){if(this.calendars){var R=new Date(this.calendars[0].year,this.calendars[0].month,1),$=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),I=g.getTime();$.setMonth($.getMonth()+1),$.setDate($.getDate()-1),m=I<R.getTime()||$.getTime()<I}m&&(this.calendars=[{month:g.getMonth(),year:g.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(g,m){var R=this.getDate()||new Date,$=parseInt(m)*24*60*60*1e3,I;g==="add"?I=new Date(R.valueOf()+$):g==="subtract"&&(I=new Date(R.valueOf()-$)),this.setDate(I)},adjustCalendars:function(){this.calendars[0]=U(this.calendars[0]);for(var g=1;g<this._o.numberOfMonths;g++)this.calendars[g]=U({month:this.calendars[0].month+g,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(g){isNaN(g)||(this.calendars[0].month=parseInt(g,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(g){isNaN(g)||(this.calendars[0].year=parseInt(g,10),this.adjustCalendars())},setMinDate:function(g){g instanceof Date?(S(g),this._o.minDate=g,this._o.minYear=g.getFullYear(),this._o.minMonth=g.getMonth()):(this._o.minDate=Y.minDate,this._o.minYear=Y.minYear,this._o.minMonth=Y.minMonth,this._o.startRange=Y.startRange),this.draw()},setMaxDate:function(g){g instanceof Date?(S(g),this._o.maxDate=g,this._o.maxYear=g.getFullYear(),this._o.maxMonth=g.getMonth()):(this._o.maxDate=Y.maxDate,this._o.maxYear=Y.maxYear,this._o.maxMonth=Y.maxMonth,this._o.endRange=Y.endRange),this.draw()},setStartRange:function(g){this._o.startRange=g},setEndRange:function(g){this._o.endRange=g},draw:function(g){if(!(!this._v&&!g)){var m=this._o,R=m.minYear,$=m.maxYear,I=m.minMonth,V=m.maxMonth,q="",oe;this._y<=R&&(this._y=R,!isNaN(I)&&this._m<I&&(this._m=I)),this._y>=$&&(this._y=$,!isNaN(V)&&this._m>V&&(this._m=V)),oe="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var ee=0;ee<m.numberOfMonths;ee++)q+='<div class="pika-lendar">'+Ce(this,ee,this.calendars[ee].year,this.calendars[ee].month,this.calendars[0].year,oe)+this.render(this.calendars[ee].year,this.calendars[ee].month,oe)+"</div>";this.el.innerHTML=q,m.bound&&m.field.type!=="hidden"&&a(function(){m.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),m.bound&&m.field.setAttribute("aria-label",m.ariaLabel)}},adjustPosition:function(){var g,m,R,$,I,V,q,oe,ee,de,Te,me;if(!this._o.container){if(this.el.style.position="absolute",g=this._o.trigger,m=g,R=this.el.offsetWidth,$=this.el.offsetHeight,I=window.innerWidth||i.documentElement.clientWidth,V=window.innerHeight||i.documentElement.clientHeight,q=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Te=!0,me=!0,typeof g.getBoundingClientRect=="function")de=g.getBoundingClientRect(),oe=de.left+window.pageXOffset,ee=de.bottom+window.pageYOffset;else for(oe=m.offsetLeft,ee=m.offsetTop+m.offsetHeight;m=m.offsetParent;)oe+=m.offsetLeft,ee+=m.offsetTop;(this._o.reposition&&oe+R>I||this._o.position.indexOf("right")>-1&&oe-R+g.offsetWidth>0)&&(oe=oe-R+g.offsetWidth,Te=!1),(this._o.reposition&&ee+$>V+q||this._o.position.indexOf("top")>-1&&ee-$-g.offsetHeight>0)&&(ee=ee-$-g.offsetHeight,me=!1),this.el.style.left=oe+"px",this.el.style.top=ee+"px",c(this.el,Te?"left-aligned":"right-aligned"),c(this.el,me?"bottom-aligned":"top-aligned"),h(this.el,Te?"right-aligned":"left-aligned"),h(this.el,me?"top-aligned":"bottom-aligned")}},render:function(g,m,R){var $=this._o,I=new Date,V=_(g,m),q=new Date(g,m,1).getDay(),oe=[],ee=[];S(I),$.firstDay>0&&(q-=$.firstDay,q<0&&(q+=7));for(var de=m===0?11:m-1,Te=m===11?0:m+1,me=m===0?g-1:g,Pe=m===11?g+1:g,We=_(me,de),Le=V+q,je=Le;je>7;)je-=7;Le+=7-je;for(var Fe=!1,re=0,Ue=0;re<Le;re++){var Be=new Date(g,m,1+(re-q)),pt=v(this._d)?E(Be,this._d):!1,nt=E(Be,I),ze=$.events.indexOf(Be.toDateString())!==-1,O=re<q||re>=V+q,T=1+(re-q),D=m,z=g,H=$.startRange&&E($.startRange,Be),K=$.endRange&&E($.endRange,Be),L=$.startRange&&$.endRange&&$.startRange<Be&&Be<$.endRange,N=$.minDate&&Be<$.minDate||$.maxDate&&Be>$.maxDate||$.disableWeekends&&p(Be)||$.disableDayFn&&$.disableDayFn(Be);O&&(re<q?(T=We+T,D=de,z=me):(T=T-V,D=Te,z=Pe));var W={day:T,month:D,year:z,hasEvent:ze,isSelected:pt,isToday:nt,isDisabled:N,isEmpty:O,isStartRange:H,isEndRange:K,isInRange:L,showDaysInNextAndPreviousMonths:$.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:$.enableSelectionDaysInNextAndPreviousMonths};$.pickWholeWeek&&pt&&(Fe=!0),ee.push(Z(W)),++Ue===7&&($.showWeekNumber&&ee.unshift(te(re-q,m,g)),oe.push(se(ee,$.isRTL,$.pickWholeWeek,Fe)),ee=[],Ue=0,Fe=!1)}return y($,oe,R)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var g=this._v;g!==!1&&(this._o.bound&&l(i,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",c(this.el,"is-hidden"),this._v=!1,g!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var g=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),g.keyboardInput&&l(i,"keydown",this._onKeyChange),g.field&&(l(g.field,"change",this._onInputChange),g.bound&&(l(g.trigger,"click",this._onInputClick),l(g.trigger,"focus",this._onInputFocus),l(g.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},w})})(XF);var _P=XF.exports;function pw(e){return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function rde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nde(e,t,r){return t&&SP(e.prototype,t),r&&SP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function io(){return typeof Reflect!="undefined"&&Reflect.get?io=Reflect.get:io=function(t,r,n){var o=ode(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},io.apply(this,arguments)}function ode(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bn(e),e!==null););return e}function ide(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gw(e,t)}function gw(e,t){return gw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},gw(e,t)}function ade(e){var t=ude();return function(){var n=bn(e),o;if(t){var i=bn(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sde(this,o)}}function sde(e,t){if(t&&(pw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lde(e)}function lde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ude(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bn(e){return bn=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},bn(e)}var qF="date",QF=function(e){ide(r,e);var t=ade(r);function r(n){var o;return rde(this,r),o=t.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return nde(r,[{key:"init",value:function(){var o=this;if(typeof ve!="function")throw new Error("You need to include moment.js to your project.");if(typeof _P!="function")throw new Error("You need to include Pikaday to your project.");io(bn(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){o.parentDestroyed=!0,o.destroyElements()})}},{key:"createElements",value:function(){io(bn(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,le(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var o=new bt(this);o.addEventListener(this.datePicker,"mousedown",function(i){return i.stopPropagation()})}},{key:"destroyElements",value:function(){var o=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),o&&o.removeChild(this.datePicker)}},{key:"prepare",value:function(o,i,a,s,l,u){io(bn(r.prototype),"prepare",this).call(this,o,i,a,s,l,u)}},{key:"open",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;io(bn(r.prototype),"open",this).call(this),this.showDatepicker(o)}},{key:"close",value:function(){var o,i=this;this._opened=!1,(o=this.$datePicker)!==null&&o!==void 0&&o.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){i.instance._refreshBorders()}),io(bn(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(o){var a=this.originalValue;a!==void 0&&this.setValue(a)}io(bn(r.prototype),"finishEditing",this).call(this,o,i)}},{key:"showDatepicker",value:function(o){var i=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=o?NO(o.keyCode):!1,u;this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+i.top+Ut(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+i.left,"px"),this.$datePicker=new _P(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.originalValue?(u=this.originalValue,ve(u,a,!0).isValid()&&this.$datePicker.setMoment(ve(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ve(u,a,!0).isValid()&&this.$datePicker.setMoment(ve(u,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block"}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var o=this,i=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Cf(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=i,a.trigger=i,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ve(f).format(o.cellProperties.dateFormat||o.defaultDateFormat)),o.setValue(f),o.hideDatepicker(),s&&s()},a.onClose=function(){o.parentDestroyed||o.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return qF}}]),r}(Xa);function yw(e){return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function fde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cde(e,t,r){return t&&CP(e.prototype,t),r&&CP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vh(){return typeof Reflect!="undefined"&&Reflect.get?vh=Reflect.get:vh=function(t,r,n){var o=hde(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},vh.apply(this,arguments)}function hde(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nl(e),e!==null););return e}function dde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mw(e,t)}function mw(e,t){return mw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},mw(e,t)}function vde(e){var t=yde();return function(){var n=nl(e),o;if(t){var i=nl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return pde(this,o)}}function pde(e,t){if(t&&(yw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gde(e)}function gde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nl(e){return nl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},nl(e)}var mde="dropdown",wE=function(e){dde(r,e);var t=vde(r);function r(){return fde(this,r),t.apply(this,arguments)}return cde(r,[{key:"prepare",value:function(o,i,a,s,l,u){vh(nl(r.prototype),"prepare",this).call(this,o,i,a,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return mde}}]),r}(bE);Ae.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===wE&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function bw(e){return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function bde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wde(e,t,r){return t&&OP(e.prototype,t),r&&OP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _de(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ww(e,t)}function ww(e,t){return ww=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},ww(e,t)}function Sde(e){var t=Rde();return function(){var n=kd(e),o;if(t){var i=kd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Cde(this,o)}}function Cde(e,t){if(t&&(bw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ode(e)}function Ode(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kd(e){return kd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},kd(e)}var Ede="numeric",ZF=function(e){_de(r,e);var t=Sde(r);function r(){return bde(this,r),t.apply(this,arguments)}return wde(r,null,[{key:"EDITOR_TYPE",get:function(){return Ede}}]),r}(Xa);function _w(e){return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function Tde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kde(e,t,r){return t&&RP(e.prototype,t),r&&RP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ph(){return typeof Reflect!="undefined"&&Reflect.get?ph=Reflect.get:ph=function(t,r,n){var o=Ade(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ph.apply(this,arguments)}function Ade(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ol(e),e!==null););return e}function Ide(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sw(e,t)}function Sw(e,t){return Sw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Sw(e,t)}function Pde(e){var t=Dde();return function(){var n=ol(e),o;if(t){var i=ol(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Mde(this,o)}}function Mde(e,t){if(t&&(_w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $de(e)}function $de(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ol(e){return ol=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ol(e)}var xde="password",JF=function(e){Ide(r,e);var t=Pde(r);function r(){return Tde(this,r),t.apply(this,arguments)}return kde(r,[{key:"createElements",value:function(){ph(ol(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,sn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return xde}}]),r}(Xa);function Ad(e){return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function Nde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hde(e,t,r){return t&&EP(e.prototype,t),r&&EP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gh(){return typeof Reflect!="undefined"&&Reflect.get?gh=Reflect.get:gh=function(t,r,n){var o=Lde(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},gh.apply(this,arguments)}function Lde(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=il(e),e!==null););return e}function Fde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cw(e,t)}function Cw(e,t){return Cw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Cw(e,t)}function jde(e){var t=Wde();return function(){var n=il(e),o;if(t){var i=il(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Bde(this,o)}}function Bde(e,t){if(t&&(Ad(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vde(e)}function Vde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function il(e){return il=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},il(e)}var Lg="ht_editor_visible",Ude="select",zde=function(e){Fde(r,e);var t=jde(r);function r(){return Nde(this,r),t.apply(this,arguments)}return Hde(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),le(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(o){this.select.value=o}},{key:"open",value:function(){var o=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()})}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Ve(this.select,Lg)&&Ge(this.select,Lg),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var o=this;this.addHook("afterScrollHorizontally",function(){return o.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return o.refreshDimensions()}),this.addHook("afterColumnResize",function(){return o.refreshDimensions()}),this.addHook("afterRowResize",function(){return o.refreshDimensions()})}},{key:"prepare",value:function(o,i,a,s,l,u){var f=this;gh(il(r.prototype),"prepare",this).call(this,o,i,a,s,l,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),sn(this.select),ot(h,function(d,v){var p=f.hot.rootDocument.createElement("OPTION");p.value=v,Mi(p,d),f.select.appendChild(p)})}},{key:"prepareOptions",value:function(o){var i={};if(Array.isArray(o))for(var a=0,s=o.length;a<s;a++)i[o[a]]=o[a];else Ad(o)==="object"&&(i=o);return i}},{key:"refreshValue",value:function(){var o=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===sr.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var o=this.hot.view.wt.wtOverlays,i=Dt(this.TD),a=Dt(this.hot.rootElement),s=o.scrollableElement,l=this.checkEditorSection(),u=Ft(this.TD)+1,f=Ut(this.TD)+1,c=i.top-a.top-1-(s.scrollTop||0),h=i.left-a.left-1-(s.scrollLeft||0),d;switch(l){case"top":d=wn(o.topOverlay.clone.wtTable.holder.parentNode);break;case"left":d=wn(o.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":d=wn(o.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":d=wn(o.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":d=wn(o.bottomOverlay.clone.wtTable.holder.parentNode);break}var v=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),p=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),b=this.hot.rowIndexMapper.getRenderableIndexesLength(),_=b-this.hot.view.wt.getSetting("fixedRowsBottom");(v<=0||v===_)&&(c+=1),p<=0&&(h+=1);var S=this.select.style;d&&d!==-1?S[d[0]]=d[1]:Ga(this.select);var E=Ya(this.TD,this.hot.rootWindow);parseInt(E.borderTopWidth,10)>0&&(f-=1),parseInt(E.borderLeftWidth,10)>0&&(u-=1),S.height="".concat(f,"px"),S.minWidth="".concat(u,"px"),S.top="".concat(c,"px"),S.left="".concat(h,"px"),S.margin="0px",le(this.select,Lg)}}},{key:"onBeforeKeyDown",value:function(){var o=this.select.selectedIndex-1,i=this.select.selectedIndex+1;switch(event.keyCode){case ue.ARROW_UP:o>=0&&(this.select[o].selected=!0),At(event),event.preventDefault();break;case ue.ARROW_DOWN:i<=this.select.length-1&&(this.select[i].selected=!0),At(event),event.preventDefault();break}}}],[{key:"EDITOR_TYPE",get:function(){return Ude}}]),r}(Il);function Yde(){Wr(Il),Wr(bE),Wr(KF),Wr(QF),Wr(wE),Wr(mE),Wr(ZF),Wr(JF),Wr(zde),Wr(Xa)}var Gde="html";function _E(e,t,r,n,o,i,a){Hf.apply(this,[e,t,r,n,o,i,a]),Mi(t,i==null?"":i,!1)}_E.RENDERER_TYPE=Gde;var Kde="autocomplete";function $l(e,t,r,n,o,i,a){var s=e.rootDocument,l=a.allowHtml?_E:Di,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),le(t,"htAutocomplete"),!e.acArrowListener){var f=new bt(e);e.acArrowListener=function(c){Ve(c.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new J(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}$l.RENDERER_TYPE=Kde;var TP=new WeakMap,kP=new WeakMap,Xde="htBadValue",al="data-row",sl="data-col",ej="checkbox";Ae.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,o=t.type,i=t.row,a=t.column,s=t.prop;if(o===ej){if(n){var l=n.value,u=n.property,f=r;if(l)f=typeof l=="function"?l(i,a,s,r):l;else if(u){var c=this.getDataAtRowProp(i,u);f=c!==null?c:r}e=f}return e}});function SE(e,t,r,n,o,i,a){var s=e.rootDocument;Hf.apply(this,[e,t,r,n,o,i,a]),qde(e);var l=Qde(s),u=a.label,f=!1;if(typeof a.checkedTemplate=="undefined"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate=="undefined"&&(a.uncheckedTemplate=!1),sn(t),i===a.checkedTemplate||jt(i).toLocaleLowerCase(a.locale)===jt(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:i===a.uncheckedTemplate||jt(i).toLocaleLowerCase(a.locale)===jt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:or(i)?le(l,"noValue"):(l.style.display="none",le(l,Xde),f=!0),l.setAttribute(al,r),l.setAttribute(sl,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Zde(s,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&t.appendChild(l),f&&t.appendChild(s.createTextNode("#bad-value#")),TP.has(e)||(TP.set(e,!0),e.addHook("beforeKeyDown",v));function v(_){var S="SPACE|ENTER",E="DELETE|BACKSPACE",M=Gu(Oi,_.keyCode);!e.getSettings().enterBeginsEditing&&M("ENTER")||(M("".concat(S,"|").concat(E))&&!_n(_)&&b(function(){At(_),_.preventDefault()}),M(S)&&p(),M(E)&&p(!0))}function p(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=e.getSelectedRange();if(!!S)for(var E=0;E<S.length;E++){for(var M=S[E].getTopLeftCorner(),k=M.row,U=M.col,Y=S[E].getBottomRightCorner(),ne=Y.row,Z=Y.col,te=[],se=k;se<=ne;se+=1)for(var he=U;he<=Z;he+=1){var ae=e.getCellMeta(se,he);if(ae.type!=="checkbox")return;if(ae.readOnly!==!0){typeof ae.checkedTemplate=="undefined"&&(ae.checkedTemplate=!0),typeof ae.uncheckedTemplate=="undefined"&&(ae.uncheckedTemplate=!1);var Ce=e.getDataAtCell(se,he);_===!1?[ae.checkedTemplate,ae.checkedTemplate.toString()].includes(Ce)?te.push([se,he,ae.uncheckedTemplate]):[ae.uncheckedTemplate,ae.uncheckedTemplate.toString(),null,void 0].includes(Ce)&&te.push([se,he,ae.checkedTemplate]):te.push([se,he,ae.uncheckedTemplate])}}te.length>0&&e.setDataAtCell(te)}}function b(_){var S=e.getSelectedRange();if(!!S)for(var E=0;E<S.length;E++)for(var M=S[E].getTopLeftCorner(),k=S[E].getBottomRightCorner(),U=M.row;U<=k.row;U++)for(var Y=M.col;Y<=k.col;Y++){var ne=e.getCellMeta(U,Y);if(ne.type!=="checkbox")return;var Z=e.getCell(U,Y);if(Z==null)_(U,Y,ne);else{var te=Z.querySelectorAll("input[type=checkbox]");te.length>0&&!ne.readOnly&&_(te)}}}}SE.RENDERER_TYPE=ej;function qde(e){var t=kP.get(e);if(!t){var r=e.rootElement;t=new bt(e),t.addEventListener(r,"click",function(n){return eve(n,e)}),t.addEventListener(r,"mouseup",function(n){return Jde(n,e)}),t.addEventListener(r,"change",function(n){return tve(n,e)}),kP.set(e,t)}return t}function Qde(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Zde(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Jde(e,t){var r=e.target;!CE(r)||!r.hasAttribute(al)||!r.hasAttribute(sl)||setTimeout(t.listen,10)}function eve(e,t){var r=e.target;if(!!CE(r)&&!(!r.hasAttribute(al)||!r.hasAttribute(sl))){var n=parseInt(r.getAttribute(al),10),o=parseInt(r.getAttribute(sl),10),i=t.getCellMeta(n,o);i.readOnly&&e.preventDefault()}}function tve(e,t){var r=e.target;if(!!CE(r)&&!(!r.hasAttribute(al)||!r.hasAttribute(sl))){var n=parseInt(r.getAttribute(al),10),o=parseInt(r.getAttribute(sl),10),i=t.getCellMeta(n,o);if(!i.readOnly){var a=null;e.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,t.setDataAtCell(n,o,a)}}}function CE(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var tj={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof oi=="function"&&oi;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){return a(n[u][1][v]||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var s=typeof oi=="function"&&oi,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(r,n,o){(function(i){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],b=1e7,_=1e9;function S(Z){var te=0|Z;return 0<Z||Z===te?te:te-1}function E(Z){for(var te,se,he=1,ae=Z.length,Ce=Z[0]+"";he<ae;){for(te=Z[he++]+"",se=d-te.length;se--;te="0"+te);Ce+=te}for(ae=Ce.length;Ce.charCodeAt(--ae)===48;);return Ce.slice(0,ae+1||1)}function M(Z,te){var se,he,ae=Z.c,Ce=te.c,y=Z.s,w=te.s,g=Z.e,m=te.e;if(!y||!w)return null;if(se=ae&&!ae[0],he=Ce&&!Ce[0],se||he)return se?he?0:-w:y;if(y!=w)return y;if(se=y<0,he=g==m,!ae||!Ce)return he?0:!ae^se?1:-1;if(!he)return m<g^se?1:-1;for(w=(g=ae.length)<(m=Ce.length)?g:m,y=0;y<w;y++)if(ae[y]!=Ce[y])return ae[y]>Ce[y]^se?1:-1;return g==m?0:m<g^se?1:-1}function k(Z,te,se,he){if(Z<te||se<Z||Z!==(Z<0?l(Z):u(Z)))throw Error(f+(he||"Argument")+(typeof Z=="number"?Z<te||se<Z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Z))}function U(Z){var te=Z.c.length-1;return S(Z.e/d)==te&&Z.c[te]%2!=0}function Y(Z,te){return(1<Z.length?Z.charAt(0)+"."+Z.slice(1):Z)+(te<0?"e":"e+")+te}function ne(Z,te,se){var he,ae;if(te<0){for(ae=se+".";++te;ae+=se);Z=ae+Z}else if(++te>(he=Z.length)){for(ae=se,te-=he;--te;ae+=se);Z+=ae}else te<he&&(Z=Z.slice(0,te)+"."+Z.slice(te));return Z}(a=function Z(te){var se,he,ae,Ce,y,w,g,m,R,$,I=re.prototype={constructor:re,toString:null,valueOf:null},V=new re(1),q=20,oe=4,ee=-7,de=21,Te=-1e7,me=1e7,Pe=!1,We=1,Le=0,je={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Fe="0123456789abcdefghijklmnopqrstuvwxyz";function re(O,T){var D,z,H,K,L,N,W,j,Q=this;if(!(Q instanceof re))return new re(O,T);if(T==null){if(O instanceof re)return Q.s=O.s,Q.e=O.e,void(Q.c=(O=O.c)?O.slice():O);if((N=typeof O=="number")&&0*O==0){if(Q.s=1/O<0?(O=-O,-1):1,O===~~O){for(K=0,L=O;10<=L;L/=10,K++);return Q.e=K,void(Q.c=[O])}j=String(O)}else{if(j=String(O),!s.test(j))return ae(Q,j,N);Q.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(K=j.indexOf("."))&&(j=j.replace(".","")),0<(L=j.search(/e/i))?(K<0&&(K=L),K+=+j.slice(L+1),j=j.substring(0,L)):K<0&&(K=j.length)}else{if(k(T,2,Fe.length,"Base"),j=String(O),T==10)return nt(Q=new re(O instanceof re?O:j),q+Q.e+1,oe);if(N=typeof O=="number"){if(0*O!=0)return ae(Q,j,N,T);if(Q.s=1/O<0?(j=j.slice(1),-1):1,re.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(c+O);N=!1}else Q.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(D=Fe.slice(0,T),K=L=0,W=j.length;L<W;L++)if(D.indexOf(z=j.charAt(L))<0){if(z=="."){if(K<L){K=W;continue}}else if(!H&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){H=!0,L=-1,K=0;continue}return ae(Q,String(O),N,T)}-1<(K=(j=he(j,T,10,Q.s)).indexOf("."))?j=j.replace(".",""):K=j.length}for(L=0;j.charCodeAt(L)===48;L++);for(W=j.length;j.charCodeAt(--W)===48;);if(j=j.slice(L,++W)){if(W-=L,N&&re.DEBUG&&15<W&&(v<O||O!==u(O)))throw Error(c+Q.s*O);if(me<(K=K-L-1))Q.c=Q.e=null;else if(K<Te)Q.c=[Q.e=0];else{if(Q.e=K,Q.c=[],L=(K+1)%d,K<0&&(L+=d),L<W){for(L&&Q.c.push(+j.slice(0,L)),W-=d;L<W;)Q.c.push(+j.slice(L,L+=d));j=j.slice(L),L=d-j.length}else L-=W;for(;L--;j+="0");Q.c.push(+j)}}else Q.c=[Q.e=0]}function Ue(O,T,D,z){var H,K,L,N,W;if(D==null?D=oe:k(D,0,8),!O.c)return O.toString();if(H=O.c[0],L=O.e,T==null)W=E(O.c),W=z==1||z==2&&(L<=ee||de<=L)?Y(W,L):ne(W,L,"0");else if(K=(O=nt(new re(O),T,D)).e,N=(W=E(O.c)).length,z==1||z==2&&(T<=K||K<=ee)){for(;N<T;W+="0",N++);W=Y(W,K)}else if(T-=L,W=ne(W,K,"0"),N<K+1){if(0<--T)for(W+=".";T--;W+="0");}else if(0<(T+=K-N))for(K+1==N&&(W+=".");T--;W+="0");return O.s<0&&H?"-"+W:W}function Be(O,T){for(var D,z=1,H=new re(O[0]);z<O.length;z++){if(!(D=new re(O[z])).s){H=D;break}T.call(H,D)&&(H=D)}return H}function pt(O,T,D){for(var z=1,H=T.length;!T[--H];T.pop());for(H=T[0];10<=H;H/=10,z++);return(D=z+D*d-1)>me?O.c=O.e=null:O.c=D<Te?[O.e=0]:(O.e=D,T),O}function nt(O,T,D,z){var H,K,L,N,W,j,Q,fe=O.c,Se=p;if(fe){e:{for(H=1,N=fe[0];10<=N;N/=10,H++);if((K=T-H)<0)K+=d,L=T,Q=(W=fe[j=0])/Se[H-L-1]%10|0;else if((j=l((K+1)/d))>=fe.length){if(!z)break e;for(;fe.length<=j;fe.push(0));W=Q=0,L=(K%=d)-d+(H=1)}else{for(W=N=fe[j],H=1;10<=N;N/=10,H++);Q=(L=(K%=d)-d+H)<0?0:W/Se[H-L-1]%10|0}if(z=z||T<0||fe[j+1]!=null||(L<0?W:W%Se[H-L-1]),z=D<4?(Q||z)&&(D==0||D==(O.s<0?3:2)):5<Q||Q==5&&(D==4||z||D==6&&(0<K?0<L?W/Se[H-L]:0:fe[j-1])%10&1||D==(O.s<0?8:7)),T<1||!fe[0])return fe.length=0,z?(T-=O.e+1,fe[0]=Se[(d-T%d)%d],O.e=-T||0):fe[0]=O.e=0,O;if(K==0?(fe.length=j,N=1,j--):(fe.length=j+1,N=Se[d-K],fe[j]=0<L?u(W/Se[H-L]%Se[L])*N:0),z)for(;;){if(j==0){for(K=1,L=fe[0];10<=L;L/=10,K++);for(L=fe[0]+=N,N=1;10<=L;L/=10,N++);K!=N&&(O.e++,fe[0]==h&&(fe[0]=1));break}if(fe[j]+=N,fe[j]!=h)break;fe[j--]=0,N=1}for(K=fe.length;fe[--K]===0;fe.pop());}O.e>me?O.c=O.e=null:O.e<Te&&(O.c=[O.e=0])}return O}function ze(O){var T,D=O.e;return D===null?O.toString():(T=E(O.c),T=D<=ee||de<=D?Y(T,D):ne(T,D,"0"),O.s<0?"-"+T:T)}return re.clone=Z,re.ROUND_UP=0,re.ROUND_DOWN=1,re.ROUND_CEIL=2,re.ROUND_FLOOR=3,re.ROUND_HALF_UP=4,re.ROUND_HALF_DOWN=5,re.ROUND_HALF_EVEN=6,re.ROUND_HALF_CEIL=7,re.ROUND_HALF_FLOOR=8,re.EUCLID=9,re.config=re.set=function(O){var T,D;if(O!=null){if(typeof O!="object")throw Error(f+"Object expected: "+O);if(O.hasOwnProperty(T="DECIMAL_PLACES")&&(k(D=O[T],0,_,T),q=D),O.hasOwnProperty(T="ROUNDING_MODE")&&(k(D=O[T],0,8,T),oe=D),O.hasOwnProperty(T="EXPONENTIAL_AT")&&((D=O[T])&&D.pop?(k(D[0],-_,0,T),k(D[1],0,_,T),ee=D[0],de=D[1]):(k(D,-_,_,T),ee=-(de=D<0?-D:D))),O.hasOwnProperty(T="RANGE"))if((D=O[T])&&D.pop)k(D[0],-_,-1,T),k(D[1],1,_,T),Te=D[0],me=D[1];else{if(k(D,-_,_,T),!D)throw Error(f+T+" cannot be zero: "+D);Te=-(me=D<0?-D:D)}if(O.hasOwnProperty(T="CRYPTO")){if((D=O[T])!==!!D)throw Error(f+T+" not true or false: "+D);if(D){if(typeof crypto=="undefined"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Pe=!D,Error(f+"crypto unavailable");Pe=D}else Pe=D}if(O.hasOwnProperty(T="MODULO_MODE")&&(k(D=O[T],0,9,T),We=D),O.hasOwnProperty(T="POW_PRECISION")&&(k(D=O[T],0,_,T),Le=D),O.hasOwnProperty(T="FORMAT")){if(typeof(D=O[T])!="object")throw Error(f+T+" not an object: "+D);je=D}if(O.hasOwnProperty(T="ALPHABET")){if(typeof(D=O[T])!="string"||/^.$|[+-.\s]|(.).*\1/.test(D))throw Error(f+T+" invalid: "+D);Fe=D}}return{DECIMAL_PLACES:q,ROUNDING_MODE:oe,EXPONENTIAL_AT:[ee,de],RANGE:[Te,me],CRYPTO:Pe,MODULO_MODE:We,POW_PRECISION:Le,FORMAT:je,ALPHABET:Fe}},re.isBigNumber=function(O){return O instanceof re||O&&O._isBigNumber===!0||!1},re.maximum=re.max=function(){return Be(arguments,I.lt)},re.minimum=re.min=function(){return Be(arguments,I.gt)},re.random=(Ce=9007199254740992,y=Math.random()*Ce&2097151?function(){return u(Math.random()*Ce)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(O){var T,D,z,H,K,L=0,N=[],W=new re(V);if(O==null?O=q:k(O,0,_),H=l(O/d),Pe)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(H*=2));L<H;)9e15<=(K=131072*T[L]+(T[L+1]>>>11))?(D=crypto.getRandomValues(new Uint32Array(2)),T[L]=D[0],T[L+1]=D[1]):(N.push(K%1e14),L+=2);L=H/2}else{if(!crypto.randomBytes)throw Pe=!1,Error(f+"crypto unavailable");for(T=crypto.randomBytes(H*=7);L<H;)9e15<=(K=281474976710656*(31&T[L])+1099511627776*T[L+1]+4294967296*T[L+2]+16777216*T[L+3]+(T[L+4]<<16)+(T[L+5]<<8)+T[L+6])?crypto.randomBytes(7).copy(T,L):(N.push(K%1e14),L+=7);L=H/7}if(!Pe)for(;L<H;)(K=y())<9e15&&(N[L++]=K%1e14);for(H=N[--L],O%=d,H&&O&&(K=p[d-O],N[L]=u(H/K)*K);N[L]===0;N.pop(),L--);if(L<0)N=[z=0];else{for(z=-1;N[0]===0;N.splice(0,1),z-=d);for(L=1,K=N[0];10<=K;K/=10,L++);L<d&&(z-=d-L)}return W.e=z,W.c=N,W}),re.sum=function(){for(var O=1,T=arguments,D=new re(T[0]);O<T.length;)D=D.plus(T[O++]);return D},he=function(){var O="0123456789";function T(D,z,H,K){for(var L,N,W=[0],j=0,Q=D.length;j<Q;){for(N=W.length;N--;W[N]*=z);for(W[0]+=K.indexOf(D.charAt(j++)),L=0;L<W.length;L++)W[L]>H-1&&(W[L+1]==null&&(W[L+1]=0),W[L+1]+=W[L]/H|0,W[L]%=H)}return W.reverse()}return function(D,z,H,K,L){var N,W,j,Q,fe,Se,ke,Qe,ct=D.indexOf("."),Je=q,Ne=oe;for(0<=ct&&(Q=Le,Le=0,D=D.replace(".",""),Se=(Qe=new re(z)).pow(D.length-ct),Le=Q,Qe.c=T(ne(E(Se.c),Se.e,"0"),10,H,O),Qe.e=Qe.c.length),j=Q=(ke=T(D,z,H,L?(N=Fe,O):(N=O,Fe))).length;ke[--Q]==0;ke.pop());if(!ke[0])return N.charAt(0);if(ct<0?--j:(Se.c=ke,Se.e=j,Se.s=K,ke=(Se=se(Se,Qe,Je,Ne,H)).c,fe=Se.r,j=Se.e),ct=ke[W=j+Je+1],Q=H/2,fe=fe||W<0||ke[W+1]!=null,fe=Ne<4?(ct!=null||fe)&&(Ne==0||Ne==(Se.s<0?3:2)):Q<ct||ct==Q&&(Ne==4||fe||Ne==6&&1&ke[W-1]||Ne==(Se.s<0?8:7)),W<1||!ke[0])D=fe?ne(N.charAt(1),-Je,N.charAt(0)):N.charAt(0);else{if(ke.length=W,fe)for(--H;++ke[--W]>H;)ke[W]=0,W||(++j,ke=[1].concat(ke));for(Q=ke.length;!ke[--Q];);for(ct=0,D="";ct<=Q;D+=N.charAt(ke[ct++]));D=ne(D,j,N.charAt(0))}return D}}(),se=function(){function O(z,H,K){var L,N,W,j,Q=0,fe=z.length,Se=H%b,ke=H/b|0;for(z=z.slice();fe--;)Q=((N=Se*(W=z[fe]%b)+(L=ke*W+(j=z[fe]/b|0)*Se)%b*b+Q)/K|0)+(L/b|0)+ke*j,z[fe]=N%K;return Q&&(z=[Q].concat(z)),z}function T(z,H,K,L){var N,W;if(K!=L)W=L<K?1:-1;else for(N=W=0;N<K;N++)if(z[N]!=H[N]){W=z[N]>H[N]?1:-1;break}return W}function D(z,H,K,L){for(var N=0;K--;)z[K]-=N,N=z[K]<H[K]?1:0,z[K]=N*L+z[K]-H[K];for(;!z[0]&&1<z.length;z.splice(0,1));}return function(z,H,K,L,N){var W,j,Q,fe,Se,ke,Qe,ct,Je,Ne,ft,Tt,ir,Tn,dn,Jt,Pr,er=z.s==H.s?1:-1,_t=z.c,St=H.c;if(!(_t&&_t[0]&&St&&St[0]))return new re(z.s&&H.s&&(_t?!St||_t[0]!=St[0]:St)?_t&&_t[0]==0||!St?0*er:er/0:NaN);for(Je=(ct=new re(er)).c=[],er=K+(j=z.e-H.e)+1,N||(N=h,j=S(z.e/d)-S(H.e/d),er=er/d|0),Q=0;St[Q]==(_t[Q]||0);Q++);if(St[Q]>(_t[Q]||0)&&j--,er<0)Je.push(1),fe=!0;else{for(Tn=_t.length,Jt=St.length,er+=2,1<(Se=u(N/(St[Q=0]+1)))&&(St=O(St,Se,N),_t=O(_t,Se,N),Jt=St.length,Tn=_t.length),ir=Jt,ft=(Ne=_t.slice(0,Jt)).length;ft<Jt;Ne[ft++]=0);Pr=St.slice(),Pr=[0].concat(Pr),dn=St[0],St[1]>=N/2&&dn++;do{if(Se=0,(W=T(St,Ne,Jt,ft))<0){if(Tt=Ne[0],Jt!=ft&&(Tt=Tt*N+(Ne[1]||0)),1<(Se=u(Tt/dn)))for(N<=Se&&(Se=N-1),Qe=(ke=O(St,Se,N)).length,ft=Ne.length;T(ke,Ne,Qe,ft)==1;)Se--,D(ke,Jt<Qe?Pr:St,Qe,N),Qe=ke.length,W=1;else Se==0&&(W=Se=1),Qe=(ke=St.slice()).length;if(Qe<ft&&(ke=[0].concat(ke)),D(Ne,ke,ft,N),ft=Ne.length,W==-1)for(;T(St,Ne,Jt,ft)<1;)Se++,D(Ne,Jt<ft?Pr:St,ft,N),ft=Ne.length}else W===0&&(Se++,Ne=[0]);Je[Q++]=Se,Ne[0]?Ne[ft++]=_t[ir]||0:(Ne=[_t[ir]],ft=1)}while((ir++<Tn||Ne[0]!=null)&&er--);fe=Ne[0]!=null,Je[0]||Je.splice(0,1)}if(N==h){for(Q=1,er=Je[0];10<=er;er/=10,Q++);nt(ct,K+(ct.e=Q+j*d-1)+1,L,fe)}else ct.e=j,ct.r=+fe;return ct}}(),w=/^(-?)0([xbo])(?=\w[\w.]*$)/i,g=/^([^.]+)\.$/,m=/^\.([^.]+)$/,R=/^-?(Infinity|NaN)$/,$=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ae=function(O,T,D,z){var H,K=D?T:T.replace($,"");if(R.test(K))O.s=isNaN(K)?null:K<0?-1:1,O.c=O.e=null;else{if(!D&&(K=K.replace(w,function(L,N,W){return H=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,z&&z!=H?L:N}),z&&(H=z,K=K.replace(g,"$1").replace(m,"0.$1")),T!=K))return new re(K,H);if(re.DEBUG)throw Error(f+"Not a"+(z?" base "+z:"")+" number: "+T);O.c=O.e=O.s=null}},I.absoluteValue=I.abs=function(){var O=new re(this);return O.s<0&&(O.s=1),O},I.comparedTo=function(O,T){return M(this,new re(O,T))},I.decimalPlaces=I.dp=function(O,T){var D,z,H;if(O!=null)return k(O,0,_),T==null?T=oe:k(T,0,8),nt(new re(this),O+this.e+1,T);if(!(D=this.c))return null;if(z=((H=D.length-1)-S(this.e/d))*d,H=D[H])for(;H%10==0;H/=10,z--);return z<0&&(z=0),z},I.dividedBy=I.div=function(O,T){return se(this,new re(O,T),q,oe)},I.dividedToIntegerBy=I.idiv=function(O,T){return se(this,new re(O,T),0,1)},I.exponentiatedBy=I.pow=function(O,T){var D,z,H,K,L,N,W,j,Q=this;if((O=new re(O)).c&&!O.isInteger())throw Error(f+"Exponent not an integer: "+ze(O));if(T!=null&&(T=new re(T)),L=14<O.e,!Q.c||!Q.c[0]||Q.c[0]==1&&!Q.e&&Q.c.length==1||!O.c||!O.c[0])return j=new re(Math.pow(+ze(Q),L?2-U(O):+ze(O))),T?j.mod(T):j;if(N=O.s<0,T){if(T.c?!T.c[0]:!T.s)return new re(NaN);(z=!N&&Q.isInteger()&&T.isInteger())&&(Q=Q.mod(T))}else{if(9<O.e&&(0<Q.e||Q.e<-1||(Q.e==0?1<Q.c[0]||L&&24e7<=Q.c[1]:Q.c[0]<8e13||L&&Q.c[0]<=9999975e7)))return K=Q.s<0&&U(O)?-0:0,-1<Q.e&&(K=1/K),new re(N?1/K:K);Le&&(K=l(Le/d+2))}for(W=L?(D=new re(.5),N&&(O.s=1),U(O)):(H=Math.abs(+ze(O)))%2,j=new re(V);;){if(W){if(!(j=j.times(Q)).c)break;K?j.c.length>K&&(j.c.length=K):z&&(j=j.mod(T))}if(H){if((H=u(H/2))===0)break;W=H%2}else if(nt(O=O.times(D),O.e+1,1),14<O.e)W=U(O);else{if((H=+ze(O))==0)break;W=H%2}Q=Q.times(Q),K?Q.c&&Q.c.length>K&&(Q.c.length=K):z&&(Q=Q.mod(T))}return z?j:(N&&(j=V.div(j)),T?j.mod(T):K?nt(j,Le,oe,void 0):j)},I.integerValue=function(O){var T=new re(this);return O==null?O=oe:k(O,0,8),nt(T,T.e+1,O)},I.isEqualTo=I.eq=function(O,T){return M(this,new re(O,T))===0},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(O,T){return 0<M(this,new re(O,T))},I.isGreaterThanOrEqualTo=I.gte=function(O,T){return(T=M(this,new re(O,T)))===1||T===0},I.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},I.isLessThan=I.lt=function(O,T){return M(this,new re(O,T))<0},I.isLessThanOrEqualTo=I.lte=function(O,T){return(T=M(this,new re(O,T)))===-1||T===0},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return 0<this.s},I.isZero=function(){return!!this.c&&this.c[0]==0},I.minus=function(O,T){var D,z,H,K,L=this,N=L.s;if(T=(O=new re(O,T)).s,!N||!T)return new re(NaN);if(N!=T)return O.s=-T,L.plus(O);var W=L.e/d,j=O.e/d,Q=L.c,fe=O.c;if(!W||!j){if(!Q||!fe)return Q?(O.s=-T,O):new re(fe?L:NaN);if(!Q[0]||!fe[0])return fe[0]?(O.s=-T,O):new re(Q[0]?L:oe==3?-0:0)}if(W=S(W),j=S(j),Q=Q.slice(),N=W-j){for((H=(K=N<0)?(N=-N,Q):(j=W,fe)).reverse(),T=N;T--;H.push(0));H.reverse()}else for(z=(K=(N=Q.length)<(T=fe.length))?N:T,N=T=0;T<z;T++)if(Q[T]!=fe[T]){K=Q[T]<fe[T];break}if(K&&(H=Q,Q=fe,fe=H,O.s=-O.s),0<(T=(z=fe.length)-(D=Q.length)))for(;T--;Q[D++]=0);for(T=h-1;N<z;){if(Q[--z]<fe[z]){for(D=z;D&&!Q[--D];Q[D]=T);--Q[D],Q[z]+=h}Q[z]-=fe[z]}for(;Q[0]==0;Q.splice(0,1),--j);return Q[0]?pt(O,Q,j):(O.s=oe==3?-1:1,O.c=[O.e=0],O)},I.modulo=I.mod=function(O,T){var D,z,H=this;return O=new re(O,T),!H.c||!O.s||O.c&&!O.c[0]?new re(NaN):!O.c||H.c&&!H.c[0]?new re(H):(We==9?(z=O.s,O.s=1,D=se(H,O,0,3),O.s=z,D.s*=z):D=se(H,O,0,We),(O=H.minus(D.times(O))).c[0]||We!=1||(O.s=H.s),O)},I.multipliedBy=I.times=function(O,T){var D,z,H,K,L,N,W,j,Q,fe,Se,ke,Qe,ct,Je,Ne=this,ft=Ne.c,Tt=(O=new re(O,T)).c;if(!(ft&&Tt&&ft[0]&&Tt[0]))return!Ne.s||!O.s||ft&&!ft[0]&&!Tt||Tt&&!Tt[0]&&!ft?O.c=O.e=O.s=null:(O.s*=Ne.s,ft&&Tt?(O.c=[0],O.e=0):O.c=O.e=null),O;for(z=S(Ne.e/d)+S(O.e/d),O.s*=Ne.s,(W=ft.length)<(fe=Tt.length)&&(Qe=ft,ft=Tt,Tt=Qe,H=W,W=fe,fe=H),H=W+fe,Qe=[];H--;Qe.push(0));for(ct=h,Je=b,H=fe;0<=--H;){for(D=0,Se=Tt[H]%Je,ke=Tt[H]/Je|0,K=H+(L=W);H<K;)D=((j=Se*(j=ft[--L]%Je)+(N=ke*j+(Q=ft[L]/Je|0)*Se)%Je*Je+Qe[K]+D)/ct|0)+(N/Je|0)+ke*Q,Qe[K--]=j%ct;Qe[K]=D}return D?++z:Qe.splice(0,1),pt(O,Qe,z)},I.negated=function(){var O=new re(this);return O.s=-O.s||null,O},I.plus=function(O,T){var D,z=this,H=z.s;if(T=(O=new re(O,T)).s,!H||!T)return new re(NaN);if(H!=T)return O.s=-T,z.minus(O);var K=z.e/d,L=O.e/d,N=z.c,W=O.c;if(!K||!L){if(!N||!W)return new re(H/0);if(!N[0]||!W[0])return W[0]?O:new re(N[0]?z:0*H)}if(K=S(K),L=S(L),N=N.slice(),H=K-L){for((D=0<H?(L=K,W):(H=-H,N)).reverse();H--;D.push(0));D.reverse()}for((H=N.length)-(T=W.length)<0&&(D=W,W=N,N=D,T=H),H=0;T;)H=(N[--T]=N[T]+W[T]+H)/h|0,N[T]=h===N[T]?0:N[T]%h;return H&&(N=[H].concat(N),++L),pt(O,N,L)},I.precision=I.sd=function(O,T){var D,z,H;if(O!=null&&O!==!!O)return k(O,1,_),T==null?T=oe:k(T,0,8),nt(new re(this),O,T);if(!(D=this.c))return null;if(z=(H=D.length-1)*d+1,H=D[H]){for(;H%10==0;H/=10,z--);for(H=D[0];10<=H;H/=10,z++);}return O&&this.e+1>z&&(z=this.e+1),z},I.shiftedBy=function(O){return k(O,-v,v),this.times("1e"+O)},I.squareRoot=I.sqrt=function(){var O,T,D,z,H,K=this,L=K.c,N=K.s,W=K.e,j=q+4,Q=new re("0.5");if(N!==1||!L||!L[0])return new re(!N||N<0&&(!L||L[0])?NaN:L?K:1/0);if((D=(N=Math.sqrt(+ze(K)))==0||N==1/0?(((T=E(L)).length+W)%2==0&&(T+="0"),N=Math.sqrt(+T),W=S((W+1)/2)-(W<0||W%2),new re(T=N==1/0?"1e"+W:(T=N.toExponential()).slice(0,T.indexOf("e")+1)+W)):new re(N+"")).c[0]){for((N=(W=D.e)+j)<3&&(N=0);;)if(H=D,D=Q.times(H.plus(se(K,H,j,1))),E(H.c).slice(0,N)===(T=E(D.c)).slice(0,N)){if(D.e<W&&--N,(T=T.slice(N-3,N+1))!="9999"&&(z||T!="4999")){+T&&(+T.slice(1)||T.charAt(0)!="5")||(nt(D,D.e+q+2,1),O=!D.times(D).eq(K));break}if(!z&&(nt(H,H.e+q+2,0),H.times(H).eq(K))){D=H;break}j+=4,N+=4,z=1}}return nt(D,D.e+q+1,oe,O)},I.toExponential=function(O,T){return O!=null&&(k(O,0,_),O++),Ue(this,O,T,1)},I.toFixed=function(O,T){return O!=null&&(k(O,0,_),O=O+this.e+1),Ue(this,O,T)},I.toFormat=function(O,T,D){var z;if(D==null)O!=null&&T&&typeof T=="object"?(D=T,T=null):O&&typeof O=="object"?(D=O,O=T=null):D=je;else if(typeof D!="object")throw Error(f+"Argument not an object: "+D);if(z=this.toFixed(O,T),this.c){var H,K=z.split("."),L=+D.groupSize,N=+D.secondaryGroupSize,W=D.groupSeparator||"",j=K[0],Q=K[1],fe=this.s<0,Se=fe?j.slice(1):j,ke=Se.length;if(N&&(H=L,L=N,ke-=N=H),0<L&&0<ke){for(H=ke%L||L,j=Se.substr(0,H);H<ke;H+=L)j+=W+Se.substr(H,L);0<N&&(j+=W+Se.slice(H)),fe&&(j="-"+j)}z=Q?j+(D.decimalSeparator||"")+((N=+D.fractionGroupSize)?Q.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(D.fractionGroupSeparator||"")):Q):j}return(D.prefix||"")+z+(D.suffix||"")},I.toFraction=function(O){var T,D,z,H,K,L,N,W,j,Q,fe,Se,ke=this,Qe=ke.c;if(O!=null&&(!(N=new re(O)).isInteger()&&(N.c||N.s!==1)||N.lt(V)))throw Error(f+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+ze(N));if(!Qe)return new re(ke);for(T=new re(V),j=D=new re(V),z=W=new re(V),Se=E(Qe),K=T.e=Se.length-ke.e-1,T.c[0]=p[(L=K%d)<0?d+L:L],O=!O||0<N.comparedTo(T)?0<K?T:j:N,L=me,me=1/0,N=new re(Se),W.c[0]=0;Q=se(N,T,0,1),(H=D.plus(Q.times(z))).comparedTo(O)!=1;)D=z,z=H,j=W.plus(Q.times(H=j)),W=H,T=N.minus(Q.times(H=T)),N=H;return H=se(O.minus(D),z,0,1),W=W.plus(H.times(j)),D=D.plus(H.times(z)),W.s=j.s=ke.s,fe=se(j,z,K*=2,oe).minus(ke).abs().comparedTo(se(W,D,K,oe).minus(ke).abs())<1?[j,z]:[W,D],me=L,fe},I.toNumber=function(){return+ze(this)},I.toPrecision=function(O,T){return O!=null&&k(O,1,_),Ue(this,O,T,2)},I.toString=function(O){var T,D=this,z=D.s,H=D.e;return H===null?z?(T="Infinity",z<0&&(T="-"+T)):T="NaN":(T=O==null?H<=ee||de<=H?Y(E(D.c),H):ne(E(D.c),H,"0"):O===10?ne(E((D=nt(new re(D),q+H+1,oe)).c),D.e,"0"):(k(O,2,Fe.length,"Base"),he(ne(E(D.c),H,"0"),10,O,z,!0)),z<0&&D.c[0]&&(T="-"+T)),T},I.valueOf=I.toJSON=function(){return ze(this)},I._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(I[Symbol.toStringTag]="BigNumber",I[Symbol.for("nodejs.util.inspect.custom")]=I.valueOf),te!=null&&re.set(te),re}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self!="undefined"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(S,E){return function(M){if(Array.isArray(M))return M}(S)||function(M,k){var U=[],Y=!0,ne=!1,Z=void 0;try{for(var te,se=M[Symbol.iterator]();!(Y=(te=se.next()).done)&&(U.push(te.value),!k||U.length!==k);Y=!0);}catch(he){ne=!0,Z=he}finally{try{Y||se.return==null||se.return()}finally{if(ne)throw Z}}return U}(S,E)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},M=2<arguments.length?arguments[2]:void 0;if(typeof E=="string"&&(E=l.parseFormat(E)),!s.validateFormat(E))return"ERROR: invalid format";var k=E.prefix||"",U=E.postfix||"",Y=function(ne,Z,te){switch(Z.output){case"currency":return Z=_(Z,a.currentCurrencyDefaultFormat()),function(Fe,re,Ue){var Be=Ue.currentCurrency(),pt=Object.assign({},c,re),nt=void 0,ze="",O=!!pt.totalLength||!!pt.forceAverage||pt.average,T=re.currencyPosition||Be.position,D=re.currencySymbol||Be.symbol;pt.spaceSeparated&&(ze=" "),T==="infix"&&(nt=ze+D+ze);var z=b({instance:Fe,providedFormat:re,state:Ue,decimalSeparator:nt});return T==="prefix"&&(z=Fe._value<0&&pt.negative==="sign"?"-".concat(ze).concat(D).concat(z.slice(1)):D+ze+z),T&&T!=="postfix"||(z=z+(ze=O?"":ze)+D),z}(ne,Z,a);case"percent":return Z=_(Z,a.currentPercentageDefaultFormat()),function(Fe,re,Ue,Be){var pt=re.prefixSymbol,nt=b({instance:Be(100*Fe._value),providedFormat:re,state:Ue}),ze=Object.assign({},c,re);return pt?"%".concat(ze.spaceSeparated?" ":"").concat(nt):"".concat(nt).concat(ze.spaceSeparated?" ":"","%")}(ne,Z,a,te);case"byte":return Z=_(Z,a.currentByteDefaultFormat()),V=ne,oe=a,ee=te,de=(q=Z).base||"binary",Te=f[de],me=d(V._value,Te.suffixes,Te.scale),Pe=me.value,We=me.suffix,Le=b({instance:ee(Pe),providedFormat:q,state:oe,defaults:oe.currentByteDefaultFormat()}),je=oe.currentAbbreviations(),"".concat(Le).concat(je.spaced?" ":"").concat(We);case"time":return Z=_(Z,a.currentTimeDefaultFormat()),m=ne,R=Math.floor(m._value/60/60),$=Math.floor((m._value-60*R*60)/60),I=Math.round(m._value-60*R*60-60*$),"".concat(R,":").concat($<10?"0":"").concat($,":").concat(I<10?"0":"").concat(I);case"ordinal":return Z=_(Z,a.currentOrdinalDefaultFormat()),se=ne,he=Z,Ce=(ae=a).currentOrdinal(),y=Object.assign({},c,he),w=b({instance:se,providedFormat:he,state:ae}),g=Ce(se._value),"".concat(w).concat(y.spaceSeparated?" ":"").concat(g);case"number":default:return b({instance:ne,providedFormat:Z,numbro:te})}var se,he,ae,Ce,y,w,g,m,R,$,I,V,q,oe,ee,de,Te,me,Pe,We,Le,je}(S,E,M);return Y=(Y=k+Y)+U}function d(S,E,M){var k=E[0],U=Math.abs(S);if(M<=U){for(var Y=1;Y<E.length;++Y){var ne=Math.pow(M,Y),Z=Math.pow(M,Y+1);if(ne<=U&&U<Z){k=E[Y],S/=ne;break}}k===E[0]&&(S/=Math.pow(M,E.length-1),k=E[E.length-1])}return{value:S,suffix:k}}function v(S){for(var E="",M=0;M<S;M++)E+="0";return E}function p(S,E){return S.toString().indexOf("e")!==-1?function(M,k){var U=M.toString(),Y=i(U.split("e"),2),ne=Y[0],Z=Y[1],te=i(ne.split("."),2),se=te[0],he=te[1],ae=he===void 0?"":he;if(0<+Z)U=se+ae+v(Z-ae.length);else{var Ce=".";Ce=+se<0?"-0".concat(Ce):"0".concat(Ce);var y=(v(-Z-1)+Math.abs(se)+ae).substr(0,k);y.length<k&&(y+=v(k-y.length)),U=Ce+y}return 0<+Z&&0<k&&(U+=".".concat(v(k))),U}(S,E):(Math.round(+"".concat(S,"e+").concat(E))/Math.pow(10,E)).toFixed(E)}function b(S){var E=S.instance,M=S.providedFormat,k=S.state,U=k===void 0?a:k,Y=S.decimalSeparator,ne=S.defaults,Z=ne===void 0?U.currentDefaults():ne,te=E._value;if(te===0&&U.hasZeroFormat())return U.getZeroFormat();if(!isFinite(te))return te.toString();var se,he,ae,Ce,y,w,g,m,R=Object.assign({},c,Z,M),$=R.totalLength,I=$?0:R.characteristic,V=R.optionalCharacteristic,q=R.forceAverage,oe=!!$||!!q||R.average,ee=$?-1:oe&&M.mantissa===void 0?0:R.mantissa,de=!$&&(M.optionalMantissa===void 0?ee===-1:R.optionalMantissa),Te=R.trimMantissa,me=R.thousandSeparated,Pe=R.spaceSeparated,We=R.negative,Le=R.forceSign,je=R.exponential,Fe="";if(oe){var re=function(O){var T=O.value,D=O.forceAverage,z=O.abbreviations,H=O.spaceSeparated,K=H!==void 0&&H,L=O.totalLength,N=L===void 0?0:L,W="",j=Math.abs(T),Q=-1;if(j>=Math.pow(10,12)&&!D||D==="trillion"?(W=z.trillion,T/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!D||D==="billion"?(W=z.billion,T/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!D||D==="million"?(W=z.million,T/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!D||D==="thousand")&&(W=z.thousand,T/=Math.pow(10,3)),W&&(W=(K?" ":"")+W),N){var fe=T.toString().split(".")[0];Q=Math.max(N-fe.length,0)}return{value:T,abbreviation:W,mantissaPrecision:Q}}({value:te,forceAverage:q,abbreviations:U.currentAbbreviations(),spaceSeparated:Pe,totalLength:$});te=re.value,Fe+=re.abbreviation,$&&(ee=re.mantissaPrecision)}if(je){var Ue=(he=(se={value:te,characteristicPrecision:I}).value,ae=se.characteristicPrecision,Ce=ae===void 0?0:ae,y=i(he.toExponential().split("e"),2),w=y[0],g=y[1],m=+w,Ce&&1<Ce&&(m*=Math.pow(10,Ce-1),g=0<=(g=+g-(Ce-1))?"+".concat(g):g),{value:m,abbreviation:"e".concat(g)});te=Ue.value,Fe=Ue.abbreviation+Fe}var Be,pt,nt,ze=function(O,T,D,z,H){if(z===-1)return O;var K=p(T,z),L=i(K.toString().split("."),2),N=L[0],W=L[1],j=W===void 0?"":W;if(j.match(/^0+$/)&&(D||H))return N;var Q=j.match(/0+$/);return H&&Q?"".concat(N,".").concat(j.toString().slice(0,Q.index)):K.toString()}(te.toString(),te,de,ee,Te);return ze=function(O,T,D,z,H){var K=z.currentDelimiters(),L=K.thousands;H=H||K.decimal;var N=K.thousandsSize||3,W=O.toString(),j=W.split(".")[0],Q=W.split(".")[1];return D&&(T<0&&(j=j.slice(1)),function(fe,Se){for(var ke=[],Qe=0,ct=fe;0<ct;ct--)Qe===Se&&(ke.unshift(ct),Qe=0),Qe++;return ke}(j.length,N).forEach(function(fe,Se){j=j.slice(0,fe+Se)+L+j.slice(fe+Se)}),T<0&&(j="-".concat(j))),W=Q?j+H+Q:j}(ze=function(O,T,D,z){var H=O,K=i(H.toString().split("."),2),L=K[0],N=K[1];if(L.match(/^-?0$/)&&D)return N?"".concat(L.replace("0",""),".").concat(N):L.replace("0","");if(L.length<z)for(var W=z-L.length,j=0;j<W;j++)H="0".concat(H);return H.toString()}(ze,0,V,I),te,me,U,Y),(oe||je)&&(ze=ze+Fe),(Le||te<0)&&(Be=ze,nt=We,ze=(pt=te)===0?Be:+Be==0?Be.replace("-",""):0<pt?"+".concat(Be):nt==="sign"?Be:"(".concat(Be.replace("-",""),")")),ze}function _(S,E){if(!S)return E;var M=Object.keys(S);return M.length===1&&M[0]==="output"?E:S}n.exports=function(S){return{format:function(){for(var E=arguments.length,M=new Array(E),k=0;k<E;k++)M[k]=arguments[k];return h.apply(void 0,M.concat([S]))},getByteUnit:function(){for(var E=arguments.length,M=new Array(E),k=0;k<E;k++)M[k]=arguments[k];return function(U){var Y=f.general;return d(U._value,Y.suffixes,Y.scale).suffix}.apply(void 0,M.concat([S]))},getBinaryByteUnit:function(){for(var E=arguments.length,M=new Array(E),k=0;k<E;k++)M[k]=arguments[k];return function(U){var Y=f.binary;return d(U._value,Y.suffixes,Y.scale).suffix}.apply(void 0,M.concat([S]))},getDecimalByteUnit:function(){for(var E=arguments.length,M=new Array(E),k=0;k<E;k++)M[k]=arguments[k];return function(U){var Y=f.decimal;return d(U._value,Y.suffixes,Y.scale).suffix}.apply(void 0,M.concat([S]))},formatOrDefault:_}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,f={},c=null,h={};function d(p){u=p}function v(){return f[u]}l.languages=function(){return Object.assign({},f)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return v().currency},l.currentAbbreviations=function(){return v().abbreviations},l.currentDelimiters=function(){return v().delimiters},l.currentOrdinal=function(){return v().ordinal},l.currentDefaults=function(){return Object.assign({},v().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().timeFormat)},l.setDefaults=function(p){p=s.parseFormat(p),a.validateFormat(p)&&(h=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(f[p])return f[p];throw new Error('Unknown tag "'.concat(p,'"'))}return v()},l.registerLanguage=function(p){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(p))throw new Error("Invalid language data");f[p.languageTag]=p,b&&d(p.languageTag)},l.setLanguage=function(p){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!f[p]){var _=p.split("-")[0],S=Object.keys(f).find(function(E){return E.split("-")[0]===_});return f[S]?void d(S):void d(b)}d(p)},l.registerLanguage(i),u=i.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return s=i,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(s,l,u){var f=new i(s._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new i(c),s._value=f.minus(c).toNumber(),s}n.exports=function(s){return{add:function(l,u){return c=u,h=s,d=new i((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return c=u,h=s,d=new i((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(l,u){return c=u,h=s,d=new i((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new i(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(l,u){return f=l,h=c=u,s.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(l,u){return f=u,a(h=(c=s)(l._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(b,_){for(var S=0;S<_.length;S++){var E=_[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(b,E.key,E)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(p),u=r("./unformatting"),f=r("./formatting")(p),c=r("./manipulating")(p),h=r("./parsing"),d=function(){function b(E){(function(M,k){if(!(M instanceof k))throw new TypeError("Cannot call a class as a function")})(this,b),this._value=E}var _,S;return _=b,(S=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,E)}},{key:"formatCurrency",value:function(E){return typeof E=="string"&&(E=h.parseFormat(E)),(E=f.formatOrDefault(E,a.currentCurrencyDefaultFormat())).output="currency",f.format(this,E)}},{key:"formatTime",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return E.output="time",f.format(this,E)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(E){return c.difference(this,E)}},{key:"add",value:function(E){return c.add(this,E)}},{key:"subtract",value:function(E){return c.subtract(this,E)}},{key:"multiply",value:function(E){return c.multiply(this,E)}},{key:"divide",value:function(E){return c.divide(this,E)}},{key:"set",value:function(E){return c.set(this,v(E))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(_.prototype,S),b}();function v(b){var _=b;return p.isNumbro(b)?_=b._value:typeof b=="string"?_=p.unformat(b):isNaN(b)&&(_=NaN),_}function p(b){return new d(v(b))}p.version="2.1.2",p.isNumbro=function(b){return b instanceof d},p.language=a.currentLanguage,p.registerLanguage=a.registerLanguage,p.setLanguage=a.setLanguage,p.languages=a.languages,p.languageData=a.languageData,p.zeroFormat=a.setZeroFormat,p.defaultFormat=a.currentDefaults,p.setDefaults=a.setDefaults,p.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,p.validate=s.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,n.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,s,l,u,f,c,h,d,v,p,b,_,S,E,M,k,U,Y,ne,Z,te=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(s=te,i=(l=(a=i).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,f=te,function(se,he){if(se.indexOf("$")===-1){if(se.indexOf("%")===-1)return se.indexOf("bd")!==-1?(he.output="byte",he.base="general"):se.indexOf("b")!==-1?(he.output="byte",he.base="binary"):se.indexOf("d")!==-1?(he.output="byte",he.base="decimal"):se.indexOf(":")===-1?se.indexOf("o")!==-1&&(he.output="ordinal"):he.output="time";he.output="percent"}else he.output="currency"}(i=(c=(u=i).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,te),h=te,(d=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=te,(p=i.split(".")[0].match(/0+/))&&(v.characteristic=p[0].length),function(se,he){if(se.indexOf(".")!==-1){var ae=se.split(".")[0];he.optionalCharacteristic=ae.indexOf("0")===-1}}(i,te),b=te,i.indexOf("a")!==-1&&(b.average=!0),S=te,(_=i).indexOf("K")!==-1?S.forceAverage="thousand":_.indexOf("M")!==-1?S.forceAverage="million":_.indexOf("B")!==-1?S.forceAverage="billion":_.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(se,he){var ae=se.split(".")[1];if(ae){var Ce=ae.match(/0+/);Ce&&(he.mantissa=Ce[0].length)}}(i,te),M=te,(E=i).match(/\[\.]/)?M.optionalMantissa=!0:E.match(/\./)&&(M.optionalMantissa=!1),k=te,i.indexOf(",")!==-1&&(k.thousandSeparated=!0),U=te,i.indexOf(" ")!==-1&&(U.spaceSeparated=!0),ne=te,(Y=i).match(/^\+?\([^)]*\)$/)&&(ne.negative="parenthesis"),Y.match(/^\+?-/)&&(ne.negative="sign"),Z=te,i.match(/^\+/)&&(Z.forceSign=!0),te)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function p(b,_){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",E=3<arguments.length?arguments[3]:void 0,M=4<arguments.length?arguments[4]:void 0,k=5<arguments.length?arguments[5]:void 0,U=6<arguments.length?arguments[6]:void 0;if(!isNaN(+b))return+b;var Y="",ne=b.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ne!==b)return-1*p(ne,_,S,E,M,k,U);for(var Z=0;Z<i.length;Z++){var te=i[Z];if((Y=b.replace(te.key,""))!==b)return p(Y,_,S,E,M,k,U)*te.factor}if((Y=b.replace("%",""))!==b)return p(Y,_,S,E,M,k,U)/100;var se=parseFloat(b);if(!isNaN(se)){var he=E(se);if(he&&he!=="."&&(Y=b.replace(new RegExp("".concat(a(he),"$")),""))!==b)return p(Y,_,S,E,M,k,U);var ae={};Object.keys(k).forEach(function($){ae[k[$]]=$});for(var Ce=Object.keys(ae).sort().reverse(),y=Ce.length,w=0;w<y;w++){var g=Ce[w],m=ae[g];if((Y=b.replace(g,""))!==b){var R=void 0;switch(m){case"thousand":R=Math.pow(10,3);break;case"million":R=Math.pow(10,6);break;case"billion":R=Math.pow(10,9);break;case"trillion":R=Math.pow(10,12)}return p(Y,_,S,E,M,k,U)*R}}}}(function(p,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=p.replace(_,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(b.thousands),"([0-9])"),"g"),"$1$2")).replace(b.decimal,".")}(l,u,f),u,f,c,h,d,v)}n.exports={unformat:function(l,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),p=d.currentCurrency().symbol,b=d.currentOrdinal(),_=d.getZeroFormat(),S=d.currentAbbreviations(),E=void 0;if(typeof l=="string")E=function(M,k){if(!M.indexOf(":")||k.thousands===":")return!1;var U=M.split(":");if(U.length!==3)return!1;var Y=+U[0],ne=+U[1],Z=+U[2];return!isNaN(Y)&&!isNaN(ne)&&!isNaN(Z)}(l,v)?(f=l.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):s(l,v,p,b,_,S,u);else{if(typeof l!="number")return;E=l}if(E!==void 0)return E}}},{"./globalState":4}],10:[function(r,n,o){function i(v){return function(p){if(Array.isArray(p)){for(var b=0,_=new Array(p.length);b<p.length;b++)_[b]=p[b];return _}}(v)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(v)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!s.unformat(v)}function h(v,p,b){var _=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(v).map(function(E){if(!p[E])return console.error("".concat(b," Invalid key: ").concat(E)),!1;var M=v[E],k=p[E];if(typeof k=="string"&&(k={type:k}),k.type==="format"){if(!h(M,u,"[Validate ".concat(E,"]"),!0))return!1}else if(a(M)!==k.type)return console.error("".concat(b," ").concat(E,' type mismatched: "').concat(k.type,'" expected, "').concat(a(M),'" provided')),!1;if(k.restrictions&&k.restrictions.length)for(var U=k.restrictions.length,Y=0;Y<U;Y++){var ne=k.restrictions[Y],Z=ne.restriction,te=ne.message;if(!Z(M,v))return console.error("".concat(b," ").concat(E," invalid value: ").concat(te)),!1}return k.restriction&&!k.restriction(M,v)?(console.error("".concat(b," ").concat(E," invalid value: ").concat(k.message)),!1):k.validValues&&k.validValues.indexOf(M)===-1?(console.error("".concat(b," ").concat(E," invalid value: must be among ").concat(JSON.stringify(k.validValues),', "').concat(M,'" provided')),!1):!(k.children&&!h(M,k.children,"[Validate ".concat(E,"]")))});return _||S.push.apply(S,i(Object.keys(p).map(function(E){var M=p[E];if(typeof M=="string"&&(M={type:M}),M.mandatory){var k=M.mandatory;if(typeof k=="function"&&(k=k(v)),k&&v[E]===void 0)return console.error("".concat(b,' Missing mandatory key "').concat(E,'"')),!1}return!0}))),S.reduce(function(E,M){return E&&M},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,p){var b=c(v),_=d(p);return b&&_},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(tj);var Vi=tj.exports,rve="numeric";function OE(e,t,r,n,o,i,a){var s=i;if(zr(s)){var l=a.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=a.className||"",h=c.length?c.split(" "):[];if(typeof u!="undefined"&&!Vi.languages()[u]){var d=u.replace("-",""),v=Vi.allLanguages?Vi.allLanguages[u]:Vi[d];v&&Vi.registerLanguage(v)}Vi.setLanguage(u),s=Vi(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" ")}Di(e,t,r,n,o,s,a)}OE.RENDERER_TYPE=rve;var nve="password";function RE(e,t,r,n,o,i,a){Di.apply(this,[e,t,r,n,o,i,a]);var s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*",u="";Ie(s-1,function(){u+=l}),Mi(t,u)}RE.RENDERER_TYPE=nve;function ove(){ro($l),ro(Hf),ro(SE),ro(_E),ro(OE),ro(RE),ro(Di)}var ive="autocomplete";function Yv(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,AP(r,t)):AP(r,t)(this.source):t(!0)}Yv.VALIDATOR_TYPE=ive;function AP(e,t){var r=e;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}t(o)}}var ave=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},sve=mr,lve=av,uve=Qt,fve=Hr,IP=ave,PP=dr,cve=ja,hve=sv;lve("search",function(e,t,r){return[function(o){var i=fve(this),a=o==null?void 0:cve(o,e);return a?sve(a,o,i):new RegExp(o)[e](PP(i))},function(n){var o=uve(this),i=PP(n),a=r(t,o,i);if(a.done)return a.value;var s=o.lastIndex;IP(s,0)||(o.lastIndex=0);var l=hve(o,i);return IP(o.lastIndex,s)||(o.lastIndex=s),l===null?-1:l.index}]});function rj(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var dve=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:rj},Symbol.toStringTag,{value:"Module"})),vve="date";function EE(e,t){var r=YL(qF,this.instance),n=e,o=!0;n==null&&(n="");var i=ve(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=ve(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var s=pve(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),o=!0}else o=!1;t(o)}EE.VALIDATOR_TYPE=vve;function pve(e,t){var r=ve(rj(e)),n=ve(e,t),o=e.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(t)}var gve="numeric";function TE(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:zr(e))}TE.VALIDATOR_TYPE=gve;var yve=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],mve="time";function kE(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=ve(o,yve,!0).isValid()?ve(o):ve(o,r),s=a.isValid(),l=ve(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}kE.VALIDATOR_TYPE=mve;function bve(){As(Yv),As(EE),As(TE),As(kE)}var wve="autocomplete",_ve={CELL_TYPE:wve,editor:bE,renderer:$l,validator:Yv},Sve="checkbox",Cve={CELL_TYPE:Sve,editor:KF,renderer:SE},Ove="date",Rve={CELL_TYPE:Ove,editor:QF,renderer:$l,validator:EE},Eve="dropdown",Tve={CELL_TYPE:Eve,editor:wE,renderer:$l,validator:Yv},kve="handsontable",Ave={CELL_TYPE:kve,editor:mE,renderer:$l},Ive="numeric",Pve={CELL_TYPE:Ive,editor:ZF,renderer:OE,validator:TE,dataType:"number"},Mve="password",$ve={CELL_TYPE:Mve,editor:JF,renderer:RE,copyable:!1},Dve="time",xve={CELL_TYPE:Dve,editor:Xa,renderer:Di,validator:kE};function Nve(){gn(_ve),gn(Cve),gn(Rve),gn(Tve),gn(Ave),gn(Pve),gn($ve),gn(GF),gn(xve)}function Hve(e,t){return Bve(e)||jve(e,t)||Fve(e,t)||Lve()}function Lve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fve(e,t){if(!!e){if(typeof e=="string")return MP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MP(e,t)}}function MP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jve(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Bve(e){if(Array.isArray(e))return e}function Vve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wve(e,t,r){return t&&$P(e.prototype,t),r&&$P(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var DP=new Map([["plugin",Kae],["cell-type",hF],["editor",zL],["renderer",lF],["validator",uF]]),Uve="base",Wi=new WeakMap,Fg=[],In=null,vt=function(){function e(t){var r=this;Vve(this,e),Kn(this,"hot",t,{writable:!1}),Wi.set(this,{hooks:{}}),In=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Wve(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,o=Array.isArray(n)?n:[];if(o.length>0){var i=[];if(o.forEach(function(u){var f=u.split(":"),c=Hve(f,2),h=c[0],d=c[1];if(!DP.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));DP.get(h)(d)||i.push(" - ".concat(d," (").concat(h,")"))}),i.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(i.join(`
`),`
`)].join("");Fg.push(a)}}In||(In=jO()),In.indexOf("UndoRedo")>=0&&In.splice(In.indexOf("UndoRedo"),1),In.indexOf(this.pluginName)>=0&&In.splice(In.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=In.length===0;if(s){if(Fg.length>0){var l=["".concat(Fg.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Wi.get(this).hooks[r]=Wi.get(this).hooks[r]||[];var o=Wi.get(this).hooks[r];this.hot.addHook(r,n),o.push(n),Wi.get(this).hooks[r]=o}},{key:"removeHooks",value:function(r){var n=this;P(Wi.get(this).hooks[r]||[],function(o){n.hot.removeHook(r,o)})}},{key:"clearHooks",value:function(){var r=this,n=Wi.get(this).hooks;ot(n,function(o,i){return r.removeHooks(i)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){P(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ot(this,function(n,o){o!=="hot"&&(r[o]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Uve}}]),e}();function zve(e,t){return Xve(e)||Kve(e,t)||Gve(e,t)||Yve()}function Yve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gve(e,t){if(!!e){if(typeof e=="string")return xP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xP(e,t)}}function xP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kve(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Xve(e){if(Array.isArray(e))return e}function qve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qve(e,t,r){return t&&NP(e.prototype,t),r&&NP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Zve=function(){function e(t){qve(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Qve(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={row:r};this.rows.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var o={col:r};this.columns.push(o),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),P(this.rows,function(n){r(n.row,Ut(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),P(this.columns,function(n){var o=n.table.getBoundingClientRect(),i=o.width;r(n.col,Math.ceil(i))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(o){P(o.strings,function(i){n.appendChild(r.createColElement(i.col))})}),n}},{key:"createRow",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment(),a=o.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),i.appendChild(a)),this.samples.forEach(function(s){P(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=o.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),l.value,f),i.appendChild(h)})}),i}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");i.push([-1,a]),o.appendChild(a)}this.samples.forEach(function(s){P(s.strings,function(l){var u=l.col,f=n.createElement("th");i.push([u,f]),o.appendChild(f)})}),this.table.tHead.appendChild(o),P(i,function(s){var l=zve(s,2),u=l[0],f=l[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,o=this.hot.rootDocument,i=o.createDocumentFragment();return this.samples.forEach(function(a){P(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var f=n.hot.getCellRenderer(u),c=o.createElement("td"),h=o.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(c),i.appendChild(h)})}),i}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&i.appendChild(l),this.isHorizontal()&&(u.appendChild(f),a.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(a),this.isVertical()&&s.appendChild(u),i.appendChild(s),le(i,r),o.appendChild(i),{fragment:o,table:i,tHead:a,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return le(i,a),o.appendChild(i),{fragment:o,container:i}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}(),AE=Zve;function Jve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function epe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tpe(e,t,r){return t&&HP(e.prototype,t),r&&HP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var rpe=function(){function e(t){epe(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return tpe(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,o){var i=this,a=new Map,s=typeof o=="number"?{from:o,to:o}:o,l=s.from,u=s.to;return Ie(l,u,function(f){var c=i.generateSample(r,n,f);a.set(f,c)}),a}},{key:"generateSample",value:function(r,n,o){var i=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return Ie(n.from,n.to,function(u){var f=r==="row"?i.dataFactory(o,u):i.dataFactory(u,o),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Ze(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(jt(c).length),a.has(v)||a.set(v,{needed:i.getSampleCount(),strings:[]});var p=a.get(v);if(p.needed){var b=l.indexOf(c)>-1;(!b||i.allowDuplicates||d)&&(p.strings.push(Jve({value:c},s,u)),l.push(c),p.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}(),nj=rpe;function Ow(e){return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function LP(e,t){return ape(e)||ipe(e,t)||ope(e,t)||npe()}function npe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ope(e,t){if(!!e){if(typeof e=="string")return FP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FP(e,t)}}function FP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ipe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function ape(e){if(Array.isArray(e))return e}function spe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lpe(e,t,r){return t&&jP(e.prototype,t),r&&jP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ta(){return typeof Reflect!="undefined"&&Reflect.get?ta=Reflect.get:ta=function(t,r,n){var o=upe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ta.apply(this,arguments)}function upe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fo(e),e!==null););return e}function fpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rw(e,t)}function Rw(e,t){return Rw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Rw(e,t)}function cpe(e){var t=dpe();return function(){var n=fo(e),o;if(t){var i=fo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hpe(this,o)}}function hpe(e,t){if(t&&(Ow(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oj(e)}function oj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dpe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(e){return fo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},fo(e)}Ae.getSingleton().register("modifyAutoColumnSizeSeed");var ru="autoColumnSize",vpe=10,jg=new WeakMap,ppe="autoColumnSize",gpe=function(e){fpe(r,e);var t=cpe(r);function r(n){var o;return spe(this,r),o=t.call(this,n),jg.set(oj(o),{cachedColumnHeaders:[]}),o.ghostTable=new AE(o.hot),o.samplesGenerator=new nj(function(i,a){var s=o.hot.getCellMeta(i,a),l="";s.spanned||(l=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new $i,o.hot.columnIndexMapper.registerMap(ppe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),o}return lpe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[ru]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ru];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChange",function(a){return o.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return o.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return o.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return o.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return o.onAfterInit()}),ta(fo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var o=this.findColumnsWhereHeaderWasChanged();o.length&&(this.clearCache(o),this.calculateVisibleColumnsWidth()),ta(fo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=this;ta(fo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var o=this.hot.countRows();if(!!o){var i=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,i)}}},{key:"calculateColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;Ie(l.from,l.to,function(f){var c=o.hot.toPhysicalColumn(f);if(c===null&&(c=f),s||o.columnWidthsMap.getValueAtIndex(c)===null&&!o.hot._getColWidthFromSettings(c)){var h=o.samplesGenerator.generateColumnSamples(f,u);P(h,function(d){var v=LP(d,2),p=v[0],b=v[1];return o.ghostTable.addColumn(p,b)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){o.ghostTable.getWidths(function(f,c){var h=o.hot.toPhysicalColumn(f);o.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function c(){if(!o.hot){Fu(l),o.inProgress=!1;return}o.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},i),a=a+r.CALCULATION_STEP+1,a<s?l=VC(c):(Fu(l),o.inProgress=!1,o.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[ru],i=o&&Ot(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Ot(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[ru],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return Ze(o)&&(i=o.syncLimit,mO(i)?i=LO(a,i):i>>=0),Math.min(i,a)}},{key:"getColumnWidth",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=i;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(o)),a&&typeof s=="number"&&(s=Math.max(s,RO.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var o=this.hot.view.wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getFirstVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var o=this.hot.view.wt;if(o.wtViewport.columnsVisibleCalculator){var i=o.wtTable.getLastVisibleColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}if(o.wtViewport.columnsRenderCalculator){var a=o.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var o=this.hot.getColHeader(),i=jg.get(this),a=i.cachedColumnHeaders,s=zt(o,function(l,u,f){var c=a.length;return(c-1<f||a[f]!==u)&&l.push(f),c-1<f?a.push(u):a[f]=u,l},[]);return s}},{key:"clearCache",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];i.length?this.hot.batchExecution(function(){P(i,function(a){o.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Gr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){o.hot&&o.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(o){var i=this,a=et(o,function(s){var l=LP(s,2),u=l[1];return i.hot.toPhysicalColumn(i.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(o,i,a){var s=o;return a&&(this.calculateColumnsWidth(i,void 0,!0),s=this.getColumnWidth(i,void 0,!1)),s}},{key:"onAfterInit",value:function(){jg.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(o){var i=Gr(o,function(s){var l;return He((l=s.address)===null||l===void 0?void 0:l.col)}),a=et(i,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ta(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ru}},{key:"PLUGIN_PRIORITY",get:function(){return vpe}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(vt),ra={horizontal:"horizontal",vertical:"vertical"};function ype(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<l;f++){var c=parseInt(r[0][f],10),h=parseInt(r[o-1][f],10),d=(n==="down"?h-c:c-h)/(o-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<s;v++){var p=parseInt(r[v][0],10),b=parseInt(r[v][i-1],10),_=(n==="right"?b-p:p-b)/(i-1)||0;a.push([_])}return a}function mpe(e,t){var r,n,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=new J(t[0],t[1]),n=new J(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=new J(t[0],e[3]+1),n=new J(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=new J(t[0],t[1]),n=new J(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=new J(e[2]+1,t[1]),n=new J(t[2],t[3])),r&&r.normalize(),n&&n.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:n}}function bpe(e){var t={};return e===!0?(t.directions=Object.keys(ra),t.autoInsertRow=!0):Ze(e)?(He(e.autoInsertRow)?e.direction===ra.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,He(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(ra)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function Ew(e){return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function wpe(e){return Cpe(e)||Spe(e)||ij(e)||_pe()}function _pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Spe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cpe(e){if(Array.isArray(e))return Tw(e)}function Ope(e,t){return Tpe(e)||Epe(e,t)||ij(e,t)||Rpe()}function Rpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ij(e,t){if(!!e){if(typeof e=="string")return Tw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tw(e,t)}}function Tw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Epe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Tpe(e){if(Array.isArray(e))return e}function kpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ape(e,t,r){return t&&BP(e.prototype,t),r&&BP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function na(){return typeof Reflect!="undefined"&&Reflect.get?na=Reflect.get:na=function(t,r,n){var o=Ipe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},na.apply(this,arguments)}function Ipe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=co(e),e!==null););return e}function Ppe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kw(e,t)}function kw(e,t){return kw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},kw(e,t)}function Mpe(e){var t=Dpe();return function(){var n=co(e),o;if(t){var i=co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $pe(this,o)}}function $pe(e,t){if(t&&(Ew(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aj(e)}function aj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dpe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(e){return co=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},co(e)}Ae.getSingleton().register("modifyAutofillRange");Ae.getSingleton().register("beforeAutofill");Ae.getSingleton().register("afterAutofill");var xpe="autofill",Npe=20,Hpe="insert_row",Lpe=200,Fpe=function(e){Ppe(r,e);var t=Mpe(r);function r(n){var o;return kpe(this,r),o=t.call(this,n),o.eventManager=new bt(aj(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return Ape(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(i){return o.onAfterCellCornerMouseDown(i)}),this.addHook("afterOnCellCornerDblClick",function(i){return o.onCellCornerDblClick(i)}),this.addHook("beforeOnCellMouseOver",function(i,a){return o.onBeforeCellMouseOver(a)}),na(co(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),na(co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),na(co(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var o=this,i=this.hot.getSelectedRangeLast(),a=i.getTopLeftCorner(),s=a.row,l=a.col,u=i.getBottomRightCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:f,endCol:c}]),d=[],v=[],p=[];return P(h,function(b){for(var _=b.startRow;_<=b.endRow;_+=1)d.indexOf(_)===-1&&d.push(_);for(var S=b.startCol;S<=b.endCol;S+=1)v.indexOf(S)===-1&&v.push(S)}),P(d,function(b){var _=[];P(v,function(S){_.push(o.hot.getCopyableData(b,S))}),p.push(_)}),p}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),i=Ope(o,4),a=i[0],s=i[1],l=i[2],u=i[3],f=this.hot.getSelectedRangeLast(),c=f.getTopLeftCorner(),h=f.getBottomRightCorner();this.resetSelectionOfDraggedArea();var d=[c.row,c.col,h.row,h.col],v=this.hot.runHooks("modifyAutofillRange",[Math.min(c.row,a),Math.min(c.col,s),Math.max(h.row,l),Math.max(h.col,u)],d),p=mpe(d,v),b=p.directionOfDrag,_=p.startOfDragCoords,S=p.endOfDragCoords;if(_&&_.row>-1&&_.col>-1){var E=this.getSelectionData(),M=f.clone(),k=new Kt(_,_,S),U=this.hot.runHooks("beforeAutofill",E,M,k,b);if(U===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var Y=ype(_,S,E,b),ne=U,Z=U;if(["up","left"].indexOf(b)>-1&&!(Z.length===1&&Z[0].length===0))if(ne=[],b==="up")for(var te=S.row-_.row+1,se=te%Z.length,he=0;he<te;he++)ne.push(Z[(he+(Z.length-se))%Z.length]);else for(var ae=S.col-_.col+1,Ce=ae%Z[0].length,y=0;y<Z.length;y++){ne.push([]);for(var w=0;w<ae;w++)ne[y].push(Z[y][(w+(Z[y].length-Ce))%Z[y].length])}this.hot.populateFromArray(_.row,_.col,ne,S.row,S.col,"".concat(this.pluginName,".fill"),null,b,Y),this.setSelection(v),this.hot.runHooks("afterAutofill",ne,M,k,b),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(o){return o.row<0&&(o.row=0),o.col<0&&(o.col=0),o}},{key:"getCoordsOfDragAndDropBorders",value:function(o){var i=this.hot.getSelectedRangeLast(),a=i.getBottomRightCorner(),s=o;if(this.directions.includes(ra.vertical)&&this.directions.includes(ra.horizontal)){var l=i.getTopLeftCorner();(a.col<=o.col||l.col>=o.col)&&(s=new J(a.row,o.col)),(a.row<o.row||l.row>o.row)&&(s=new J(o.row,a.col))}else if(this.directions.includes(ra.vertical))s=new J(o.row,a.col);else if(this.directions.includes(ra.horizontal))s=new J(a.row,o.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(o){var i=this.getCoordsOfDragAndDropBorders(o);i&&this.redrawBorders(i)}},{key:"addRow",value:function(){var o=this;this.hot._registerTimeout(function(){o.hot.alter(Hpe,void 0,1,"".concat(o.pluginName,".fill")),o.addingStarted=!1},Lpe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var o=this.hot.getSelectedLast(),i=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();o[2]<a-1&&i[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(o){for(var i=this.hot.getData(),a=this.hot.countRows(),s,l=o[2]+1;l<a;l++){for(var u=o[1];u<=o[3];u++){var f=i[l][u];if(f)return-1}var c=i[l][o[1]-1],h=i[l][o[3]+1];(!!c||!!h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(o,i){this.hot.selection.highlight.getFill().clear().add(new J(o[0],o[1])).add(new J(i,o[3])).commit()}},{key:"setSelection",value:function(o){var i;(i=this.hot).selectCell.apply(i,wpe(et(o,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var o=this.hot.getSelectedLast(),i=this.getIndexOfLastAdjacentFilledInRow(o);return i===-1||i===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(o,i),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(o){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(o).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(o){var i=this.hot.rootDocument.documentElement,a=Dt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||i.scrollTop)+Ut(this.hot.table),s=Dt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||i.scrollLeft)+Ft(this.hot.table);return o.clientY>a&&o.clientX<=s}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var o=this.selectAdjacent();o&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(o){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(o),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(o){var i=this.getIfMouseWasDraggedOutside(o);this.addingStarted===!1&&this.handleDraggedCells>0&&i?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var o=bpe(this.hot.getSettings().fillHandle);this.directions=o.directions,this.autoInsertRow=o.autoInsertRow}},{key:"destroy",value:function(){na(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xpe}},{key:"PLUGIN_PRIORITY",get:function(){return Npe}}]),r}(vt);function Aw(e){return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function jpe(e,t){return Upe(e)||Wpe(e,t)||Vpe(e,t)||Bpe()}function Bpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vpe(e,t){if(!!e){if(typeof e=="string")return VP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VP(e,t)}}function VP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wpe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Upe(e){if(Array.isArray(e))return e}function zpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ype(e,t,r){return t&&WP(e.prototype,t),r&&WP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hs(){return typeof Reflect!="undefined"&&Reflect.get?Hs=Reflect.get:Hs=function(t,r,n){var o=Gpe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hs.apply(this,arguments)}function Gpe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ci(e),e!==null););return e}function Kpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Iw(e,t)}function Iw(e,t){return Iw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Iw(e,t)}function Xpe(e){var t=Zpe();return function(){var n=ci(e),o;if(t){var i=ci(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return qpe(this,o)}}function qpe(e,t){if(t&&(Aw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qpe(e)}function Qpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zpe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ci(e)}var Tc="autoRowSize",Jpe=40,ege="autoRowSize",tge=function(e){Kpe(r,e);var t=Xpe(r);function r(n){var o;return zpe(this,r),o=t.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new AE(o.hot),o.samplesGenerator=new nj(function(i,a){var s;return i>=0?s=o.hot.getDataAtCell(i,a):i===-1&&(s=o.hot.getColHeader(a)),{value:s}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new $i,o.hot.rowIndexMapper.registerMap(ege,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)}),o}return Ype(r,[{key:"isEnabled",value:function(){var o=this.hot.getSettings()[Tc];return o===!0||Ze(o)}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeChange",function(i){return o.onBeforeChange(i)}),this.addHook("beforeColumnResize",function(){return o.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(i){return o.onBeforeViewRender(i)}),this.addHook("modifyRowHeight",function(i,a){return o.getRowHeight(a,i)}),this.addHook("modifyColumnHeaderHeight",function(){return o.getColumnHeaderHeight()}),Hs(ci(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this;this.headerHeight=null,Hs(ci(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)})}},{key:"calculateRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof i=="number"?{from:i,to:i}:i,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}Ie(l.from,l.to,function(c){if(s||o.rowHeightsMap.getValueAtIndex(c)===null){var h=o.samplesGenerator.generateRowSamples(c,u);P(h,function(d){var v=jpe(d,2),p=v[0],b=v[1];return o.ghostTable.addRow(p,b)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){o.ghostTable.getHeights(function(c,h){c<0?o.headerHeight=h:o.rowHeightsMap.setValueAtIndex(o.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function c(){if(!o.hot){Fu(l),o.inProgress=!1;return}o.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},i),a=a+r.CALCULATION_STEP+1,a<s?l=VC(c):(Fu(l),o.inProgress=!1,o.hot.view.adjustElementsSize(!0),o.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&o.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},i),this.firstCalculation=!1,a=f+1),a<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var o=this.hot.getSettings()[Tc],i=o&&Ot(o,"samplingRatio")?o.samplingRatio:void 0,a=o&&Ot(o,"allowSampleDuplicates")?o.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){qs(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var o=this.hot.getSettings()[Tc],i=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return Ze(o)&&(i=o.syncLimit,mO(i)?i=LO(a,i):i>>=0),Math.min(i,a)}},{key:"getRowHeight",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=o<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(o)),s=i;return a!==null&&a>(i||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var o=this.hot.view.wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getFirstVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var o=this.hot.view.wt;return o.wtViewport.rowsVisibleCalculator?o.wtTable.getLastVisibleRow():o.wtViewport.rowsRenderCalculator?o.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(o){var i=this,a=typeof o=="number"?{from:o,to:o}:o,s=a.from,l=a.to;this.hot.batchExecution(function(){Ie(Math.min(s,l),Math.max(s,l),function(u){i.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Gr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(o){return o===null}).length}},{key:"onBeforeViewRender",value:function(){var o=this.hot.renderCall,i=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,o),i){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-i,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(o,i){this.clearCacheByRange({from:o,to:i}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(o,i,a){var s=o;return a&&(this.calculateRowsHeight(i,void 0,!0),s=this.getRowHeight(i)),s}},{key:"onAfterLoadData",value:function(){var o=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){o.hot&&o.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(o){var i=null;o.length===1?i=o[0][0]:o.length>1&&(i={from:o[0][0],to:o[o.length-1][0]}),i!==null&&this.clearCacheByRange(i)}},{key:"destroy",value:function(){this.ghostTable.clean(),Hs(ci(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Tc}},{key:"PLUGIN_PRIORITY",get:function(){return Jpe}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(vt);function Pw(e){return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function rge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nge(e,t,r){return t&&UP(e.prototype,t),r&&UP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Au(){return typeof Reflect!="undefined"&&Reflect.get?Au=Reflect.get:Au=function(t,r,n){var o=oge(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Au.apply(this,arguments)}function oge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ha(e),e!==null););return e}function ige(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mw(e,t)}function Mw(e,t){return Mw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Mw(e,t)}function age(e){var t=uge();return function(){var n=Ha(e),o;if(t){var i=Ha(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sge(this,o)}}function sge(e,t){if(t&&(Pw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lge(e)}function lge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ha(e){return Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ha(e)}var sj=_F("physicallyIndexed"),fge=sj.getListWithInsertedItems,cge=sj.getListWithRemovedItems,hge=function(e){ige(r,e);var t=age(r);function r(){return rge(this,r),t.call(this,function(n){return n})}return nge(r,[{key:"insert",value:function(o,i){var a=XO(this.indexedValues,i);this.indexedValues=fge(a,o,i,this.initValueOrFn),Au(Ha(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){var i=cge(this.indexedValues,o);this.indexedValues=KO(i,o),Au(Ha(r.prototype),"remove",this).call(this,o)}}]),r}(Ka),dge=hge;function $w(e){return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(e)}function vge(e){return mge(e)||yge(e)||gge(e)||pge()}function pge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gge(e,t){if(!!e){if(typeof e=="string")return Dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dw(e,t)}}function yge(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mge(e){if(Array.isArray(e))return Dw(e)}function Dw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wge(e,t,r){return t&&zP(e.prototype,t),r&&zP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iu(){return typeof Reflect!="undefined"&&Reflect.get?Iu=Reflect.get:Iu=function(t,r,n){var o=_ge(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Iu.apply(this,arguments)}function _ge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=La(e),e!==null););return e}function Sge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xw(e,t)}function xw(e,t){return xw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},xw(e,t)}function Cge(e){var t=Ege();return function(){var n=La(e),o;if(t){var i=La(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Oge(this,o)}}function Oge(e,t){if(t&&($w(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rge(e)}function Rge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ege(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(e){return La=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},La(e)}var lj=_F("physicallyIndexed"),Tge=lj.getListWithInsertedItems,kge=lj.getListWithRemovedItems,Age=function(e){Sge(r,e);var t=Cge(r);function r(){return bge(this,r),t.call(this,function(n){return n})}return wge(r,[{key:"insert",value:function(o,i){var a=this;this.indexedValues=Tge(this.indexedValues,o,i,function(s,l){return a.getNextValue(l)}),Iu(La(r.prototype),"insert",this).call(this,o,i)}},{key:"remove",value:function(o){this.indexedValues=kge(this.indexedValues,o),Iu(La(r.prototype),"remove",this).call(this,o)}},{key:"getNextValue",value:function(o){return Math.max.apply(Math,vge(this.getValues()))+1+o}}]),r}(Ka),Ige=Age;function Nw(e){return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function Pge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mge(e,t,r){return t&&YP(e.prototype,t),r&&YP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ls(){return typeof Reflect!="undefined"&&Reflect.get?Ls=Reflect.get:Ls=function(t,r,n){var o=$ge(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ls.apply(this,arguments)}function $ge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hi(e),e!==null););return e}function Dge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hw(e,t)}function Hw(e,t){return Hw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Hw(e,t)}function xge(e){var t=Lge();return function(){var n=hi(e),o;if(t){var i=hi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Nge(this,o)}}function Nge(e,t){if(t&&(Nw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hge(e)}function Hge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hi(e){return hi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},hi(e)}var Bg="bindRowsWithHeaders",Fge=210,jge="loose",Bge=new Map([["loose",dge],["strict",Ige]]),Vge=function(e){Dge(r,e);var t=xge(r);function r(n){var o;return Pge(this,r),o=t.call(this,n),o.headerIndexes=null,o}return Mge(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Bg]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Bg];typeof i!="string"&&(i=jge);var a=Bge.get(i);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return o.onModifyRowHeader(s)}),Ls(hi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Ls(hi(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(o){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(o))}},{key:"destroy",value:function(){Ls(hi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bg}},{key:"PLUGIN_PRIORITY",get:function(){return Fge}}]),r}(vt);function Lw(e){return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(e)}function GP(e){return Yge(e)||zge(e)||Uge(e)||Wge()}function Wge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uge(e,t){if(!!e){if(typeof e=="string")return Fw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fw(e,t)}}function zge(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yge(e){if(Array.isArray(e))return Fw(e)}function Fw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KP(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kge(e,t,r){return t&&KP(e.prototype,t),r&&KP(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oa(){return typeof Reflect!="undefined"&&Reflect.get?oa=Reflect.get:oa=function(t,r,n){var o=Xge(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},oa.apply(this,arguments)}function Xge(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ho(e),e!==null););return e}function qge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jw(e,t)}function jw(e,t){return jw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},jw(e,t)}function Qge(e){var t=Jge();return function(){var n=ho(e),o;if(t){var i=ho(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zge(this,o)}}function Zge(e,t){if(t&&(Lw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Es(e)}function Es(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ho(e)}function eye(e,t,r){tye(e,t),t.set(e,r)}function tye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XP(e,t){var r=uj(e,t,"get");return rye(e,r)}function rye(e,t){return t.get?t.get.call(e):t.value}function Wg(e,t,r){var n=uj(e,t,"set");return nye(e,n,r),r}function uj(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function nye(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var qP="collapsibleColumns",oye=290,QP=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),hs=new WeakMap,iye=function(e){qge(r,e);var t=Qge(r);function r(){var n;Gge(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),Vg(Es(n),"nestedHeadersPlugin",null),Vg(Es(n),"eventManager",new bt(Es(n))),Vg(Es(n),"headerStateManager",null),eye(Es(n),hs,{writable:!0,value:null}),n}return Kge(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qP]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;a||kt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Wg(this,hs,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("afterGetColHeader",function(s,l){return o.onAfterGetColHeader(s,l)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return o.onBeforeOnCellMouseDown(s,l,u)}),oa(ho(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var o=this.hot.getSettings(),i=o.collapsibleColumns;typeof i=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(i)&&this.headerStateManager.mergeStateWith(i)}oa(ho(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Wg(this,hs,null),this.nestedHeadersPlugin=null,this.clearButtons(),oa(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(!!this.hot.view){var o=this.hot.view.wt.getSetting("columnHeaders").length,i=this.hot.view.wt.wtTable.THEAD,a=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,l=function(f){f&&f.parentNode.removeChild(f)};Ie(0,o-1,function(u){var f=i.childNodes[u],c=a.childNodes[u],h=s?s.childNodes[u]:null;Ie(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".collapsibleIndicator");l(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".collapsibleIndicator"),l(v)),s&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".collapsibleIndicator"),l(v))})})}}},{key:"expandSection",value:function(o){this.toggleCollapsibleSection([o],"expand")}},{key:"collapseSection",value:function(o){this.toggleCollapsibleSection([o],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(o){var i=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,f=s.headerLevel,c=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&o==="expand"||!h&&o==="collapse"))return{row:i.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(a,o)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(o,i){var a=this;if(!QP.has(i))throw new Error("Unsupported action is passed (".concat(i,")."));if(!!Array.isArray(o)){var s=Gr(o,function(b){var _=b.row;return _<0}),l=s.length>0;P(s,function(b){var _,S=b.row,E=b.col,M=(_=a.headerStateManager.getHeaderSettings(S,E))!==null&&_!==void 0?_:{},k=M.collapsible,U=M.isCollapsed;if(!k||U&&i==="collapse"||!U&&i==="expand")return l=!1,!1});var u=[],f=[];l&&P(s,function(b){var _=b.row,S=b.col,E=a.headerStateManager.triggerNodeModification(i,_,S),M=E.colspanCompensation,k=E.affectedColumns,U=E.rollbackModification;M>0&&(f.push.apply(f,GP(k)),u.push(U))});var c=this.getCollapsedColumns(),h=[];i==="collapse"?h=QC([].concat(GP(c),f)):i==="expand"&&(h=Gr(c,function(b){return!f.includes(b)}));var d=QP.get(i),v=this.hot.runHooks(d.beforeHook,c,h,l);if(v===!1){P(u,function(b){b()});return}this.hot.batchExecution(function(){P(f,function(b){XP(a,hs).setValueAtIndex(a.hot.toPhysicalColumn(b),d.hideColumn)})},!0);var p=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,l,p),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return XP(this,hs).getHiddenIndexes()}},{key:"generateIndicator",value:function(o,i){var a=this.hot.rootDocument.createElement("div"),s=this.headerStateManager.getHeaderSettings(o,i);return le(a,"collapsibleIndicator"),s.isCollapsed?(le(a,"collapsed"),_i(a,"+")):(le(a,"expanded"),_i(a,"-")),a}},{key:"onAfterGetColHeader",value:function(o,i){var a,s=i.parentNode,l=s.parentNode,u=-1*l.childNodes.length+Array.prototype.indexOf.call(l.childNodes,s),f=(a=this.headerStateManager.getHeaderSettings(u,o))!==null&&a!==void 0?a:{},c=f.collapsible,h=f.origColspan;if(c&&h>1&&o>=this.hot.getSettings().fixedColumnsLeft){var d=this.generateIndicator(u,o);i.querySelector("div:first-child").appendChild(d)}}},{key:"onBeforeOnCellMouseDown",value:function(o,i){Ve(o.target,"collapsibleIndicator")&&(Ve(o.target,"expanded")?(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"collapse")):Ve(o.target,"collapsed")&&(this.eventManager.fireEvent(o.target,"mouseup"),this.toggleCollapsibleSection([i],"expand")),At(o))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Wg(this,hs,null),oa(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qP}},{key:"PLUGIN_PRIORITY",get:function(){return oye}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}}]),r}(vt);function ZP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function aye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZP(Object(r),!0).forEach(function(n){sye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZP(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JP(e,t){return cye(e)||fye(e,t)||uye(e,t)||lye()}function lye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uye(e,t){if(!!e){if(typeof e=="string")return e1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e1(e,t)}}function e1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fye(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function cye(e){if(Array.isArray(e))return e}function hye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dye(e,t,r){return t&&t1(e.prototype,t),r&&t1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var vye=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],pye=!1,gye=!0,yye=!0,mye=function(){function e(t,r){hye(this,e),this.hot=t,this.sortingStates=new Hv,this.sortEmptyCells=pye,this.indicator=gye,this.headerAction=yye,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return dye(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;!Ze(r)||ot(r,function(o,i){vye.includes(i)&&(n[i]=o)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var o=JP(n,1),i=o[0];return i===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Ze(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(o){var i=JP(o,2),a=i[0],s=i[1];return aye({column:r.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(He(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Id="asc",Pd="desc",bye="colHeader";function wye(e){if(Ze(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Id,Pd].includes(r)}function _ye(e){if(e.some(function(r){return wye(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function r1(e){if(e!==Pd)return e===Id?Pd:Id}function n1(e){var t=e.querySelector(".".concat(bye));return t}function o1(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function Bw(e,t,r){return e===-1&&t>=0&&Ci(r)===!1}var Sye="ascending",Cye="descending",fj="indicatorDisabled",cj="columnSorting",hj="sortAction",dj=new Map([[Id,Sye],[Pd,Cye]]);function Oye(e,t,r,n){var o=[cj];if(n&&o.push(hj),r===!1)return o.push(fj),o;var i=e.getSortOrderOfColumn(t);return He(i)&&o.push(dj.get(i)),o}function Rye(){return Array.from(dj.values()).concat(hj,fj,cj)}function vj(e,t,r){var n=t.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Wn:or(o)?or(i)?Wn:a&&e==="asc"?Ht:Lt:or(i)?a&&e==="asc"?Lt:Ht:isNaN(o)&&!isNaN(i)?e==="asc"?Lt:Ht:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?e==="asc"?Ht:Lt:o>i?e==="asc"?Lt:Ht:Wn}}var pj="default";function Eye(e,t,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),s=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Wn;if(s){if(or(n))return e==="asc"?Ht:Lt;if(or(o))return e==="asc"?Lt:Ht}return isNaN(i)?Lt:isNaN(a)?Ht:i<a?e==="asc"?Ht:Lt:i>a?e==="asc"?Lt:Ht:Wn}}var Tye="numeric";function kye(e,t,r){var n=t.checkedTemplate,o=t.uncheckedTemplate,i=r.sortEmptyCells;return function(a,s){var l=or(a),u=or(s),f=l?o:a,c=u?o:s,h=f===o||f===n,d=c===o||c===n;if(i===!1){if(l&&u===!1)return Lt;if(l===!1&&u)return Ht}return h===!1&&d?e==="asc"?Ht:Lt:h&&d===!1?e==="asc"?Lt:Ht:h===!1&&d===!1?vj(e,t,r)(a,s):f===o&&c===n?e==="asc"?Ht:Lt:f===n&&c===o?e==="asc"?Lt:Ht:Wn}}var Aye="checkbox";function Iye(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Wn;if(or(n))return or(o)?Wn:i&&e==="asc"?Ht:Lt;if(or(o))return i&&e==="asc"?Lt:Ht;var a=t.dateFormat,s=ve(n,a),l=ve(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?Ht:Lt:l.isBefore(s)?e==="asc"?Lt:Ht:Wn:Ht:Lt}}var Pye="date",IE=hn("sorting.compareFunctionFactory"),Gv=IE.register,i1=IE.getItem,Mye=IE.hasItem,gj=hn("sorting.mainSortComparator"),yj=gj.register,$ye=gj.getItem;function mj(e){return Mye(e)?i1(e):i1(pj)}Gv(Tye,Eye);Gv(Aye,kye);Gv(Pye,Iye);Gv(pj,vj);function a1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bj(e,t,r){return t&&a1(e.prototype,t),r&&a1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s1=bj(function e(t){wj(this,e),this.data=t,this.next=null,this.prev=null}),Dye=function(){function e(){wj(this,e),this.first=null,this.last=null}return bj(e,[{key:"push",value:function(r){var n=new s1(r);if(this.first===null)this.first=n,this.last=n;else{var o=this.last;this.last=n,n.prev=o,o.next=n}}},{key:"unshift",value:function(r){var n=new s1(r);if(this.first===null)this.first=n,this.last=n;else{var o=this.first;this.first=n,n.next=o,o.prev=n}}},{key:"inorder",value:function(r){for(var n=this.first;n;)r(n),n=n.next}},{key:"remove",value:function(r){if(this.first===null)return!1;for(var n=this.first,o,i;n;){if(n.data===r)return o=n.next,i=n.prev,o&&(o.prev=i),i&&(i.next=o),n===this.first&&(this.first=o),n===this.last&&(this.last=i),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var r=this.first,n=this.first;;){if(r===null||(r=r.next,r===null))return!1;if(r=r.next,n=n.next,r===n)return!0}}},{key:"pop",value:function(){if(this.last===null)return null;var r=this.last;return this.last=this.last.prev,r}},{key:"shift",value:function(){if(this.first===null)return null;var r=this.first;return this.first=this.first.next,r}},{key:"recursiveReverse",value:function(){function r(o,i){!i||(r(i,i.next),i.next=o)}if(!!this.first){r(this.first,this.first.next),this.first.next=null;var n=this.first;this.first=this.last,this.last=n}}},{key:"reverse",value:function(){if(!(!this.first||!this.first.next)){for(var r=this.first.next,n=this.first,o;r;)o=r.next,r.next=n,n.prev=r,n=r,r=o;this.first.next=null,this.last.prev=null,o=this.first,this.first=n,this.last=o}}}]),e}(),l1=Dye,xye=function(t,r){var n=t.toString(),o=r.toString();return n===o?0:n<o?-1:1};function Vw(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xye,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.length;if(Math.abs(n-r)<=1)return[];var o=Math.ceil((r+n)/2);return Vw(e,t,r,o),Vw(e,t,o,n),Nye(e,t,r,o,n)}function Nye(e,t,r,n,o){for(var i=new l1,a=new l1,s=n-r,l=o-n,u=Math.max(s,l),f=o-r,c=0;c<u;c+=1)c<s&&i.push(e[r+c]),c<l&&a.push(e[n+c]);for(var h=0;h<f;)i.first&&a.first?t(i.first.data,a.first.data)>0?e[r+h]=a.shift().data:e[r+h]=i.shift().data:i.first?e[r+h]=i.shift().data:e[r+h]=a.shift().data,h+=1;return e}var Wn=0,Ht=-1,Lt=1;function Hye(e,t){for(var r=$ye(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];Vw(e,r.apply(void 0,o))}function u1(e){return Bye(e)||jye(e)||Fye(e)||Lye()}function Lye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fye(e,t){if(!!e){if(typeof e=="string")return f1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f1(e,t)}}function f1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jye(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bye(e){if(Array.isArray(e))return e}function Vye(e,t){return function(r,n){var o=u1(r),i=o.slice(1),a=u1(n),s=a.slice(1);return function(u){var f=e[u],c=t[u],h=i[u],d=s[u],v=c.columnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:mj(c.type),b=p(f,c,v)(h,d);return b}(0)}}function Ww(e){return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}var Wye=["column"],Uye=["column"];function ds(e){return Kye(e)||Gye(e)||Yye(e)||zye()}function zye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yye(e,t){if(!!e){if(typeof e=="string")return Uw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uw(e,t)}}function Gye(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kye(e){if(Array.isArray(e))return Uw(e)}function Uw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function h1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c1(Object(r),!0).forEach(function(n){Xye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d1(e,t){if(e==null)return{};var r=qye(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function qye(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Qye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zye(e,t,r){return t&&v1(e.prototype,t),r&&v1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ia(){return typeof Reflect!="undefined"&&Reflect.get?ia=Reflect.get:ia=function(t,r,n){var o=Jye(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ia.apply(this,arguments)}function Jye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vo(e),e!==null););return e}function eme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zw(e,t)}function zw(e,t){return zw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},zw(e,t)}function tme(e){var t=ome();return function(){var n=vo(e),o;if(t){var i=vo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rme(this,o)}}function rme(e,t){if(t&&(Ww(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nme(e)}function nme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ome(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(e){return vo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},vo(e)}var Yw="columnSorting",ime=50,p1="append",ame="replace";yj(Yw,Vye);Ae.getSingleton().register("beforeColumnSort");Ae.getSingleton().register("afterColumnSort");var _j=function(e){eme(r,e);var t=tme(r);function r(n){var o;return Qye(this,r),o=t.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=Yw,o.indexesSequenceCache=null,o}return Zye(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnStatesManager=new mye(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new $i(function(i){var a=o.hot.toVisualColumn(i);return a===null&&(a=i),o.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(i,a){return o.onAfterOnCellMouseDown(i,a)}),this.addHook("afterInit",function(){return o.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.hot.view&&this.loadOrSortBySettings(),ia(vo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=this,i=function(s,l){var u=n1(l);o1(s,l)===!1||u===null||o.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("afterGetColHeader",i)}),this.hot.batchExecution(function(){o.indexesSequenceCache!==null&&(o.hot.rowIndexMapper.setIndexesSequence(o.indexesSequenceCache.getValues()),o.hot.rowIndexMapper.unregisterMap(o.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,ia(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){var i=this.getSortConfig(),a=this.getNormalizedSortConfigs(o),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",i,a,s);l!==!1&&(i.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new SF),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",i,s?a:i,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(o){return He(o)?this.columnStatesManager.getColumnSortState(o):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(o){var i=this.getNormalizedSortConfigs(o);this.areValidSortConfigs(i)&&this.columnStatesManager.setSortStates(i)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o.slice(0,1):[o]}},{key:"areValidSortConfigs",value:function(o){var i=this.hot.countCols();return _ye(o)&&o.every(function(a){var s=a.column;return s<=i&&s>=0})}},{key:"saveAllSortSettings",value:function(o){var i=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var f=u.column,c=d1(u,Wye);return h1({column:i.hot.toPhysicalColumn(f)},c)};a.initialConfig=et(o,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var o=this,i={};this.hot.runHooks("persistentStateLoad","columnSorting",i);var a=i.value,s=function(u){var f=u.column,c=d1(u,Uye);return h1({column:o.hot.toVisualColumn(f)},c)};return He(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=et(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(o){var i=this.columnStatesManager.getSortOrderOfColumn(o);if(He(i)){var a=r1(i);return He(a)?{column:o,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(o)&&o>=0&&o<s)return{column:o,sortOrder:r1()}}},{key:"getNextSortConfig",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p1,a=this.columnStatesManager.getIndexOfColumnInSortQueue(o),s=a!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(o);if(s){if(It(u))return[].concat(ds(l.slice(0,a)),ds(l.slice(a+1)));if(i===p1)return[].concat(ds(l.slice(0,a)),ds(l.slice(a+1)),[u]);if(i===ame)return[].concat(ds(l.slice(0,a)),[u],ds(l.slice(a+1)))}return He(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(o){if(Ze(o)){var i=o[this.pluginKey];if(Ze(i))return i}return{}}},{key:"getMergedPluginSettings",value:function(o){var i=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,o),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,i,this.getPluginColumnConfig(l.columns[o])):Ct(l.columns)?Object.assign(a,i,this.getPluginColumnConfig(l.columns(o))):Object.assign(a,i)}},{key:"getFirstCellSettings",value:function(o){var i=this.hot.getCellMeta(0,o),a=Object.create(i);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(o)),a}},{key:"getNumberOfRowsToSort",value:function(o){var i=this.hot.getSettings();return i.maxRows<=o?i.maxRows:o-i.minSpareRows}},{key:"sortByPresetSortStates",value:function(o){var i=this;if(o.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(b){return et(o,function(_){return i.hot.getDataAtCell(b,_.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(l(u)));var f=et(a,function(p){return p[0]});Hye(a,this.pluginKey,et(o,function(p){return p.sortOrder}),et(o,function(p){return i.getFirstCellSettings(p.column)}));for(var c=a.length;c<s;c+=1)a.push([c].concat(l(c)));var h=et(a,function(p){return p[0]}),d=new Map(et(f,function(p,b){return[p,h[b]]})),v=et(this.hot.rowIndexMapper.getIndexesSequence(),function(p){return d.has(p)?d.get(p):p});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var o=this.getAllSavedSortSettings();if(Ze(o))this.sortBySettings(o);else{var i=this.hot.getSettings()[this.pluginKey];this.sortBySettings(i)}}},{key:"sortBySettings",value:function(o){if(Ze(o)){this.columnStatesManager.updateAllColumnsProperties(o);var i=o.initialConfig;(Array.isArray(i)||Ze(i))&&this.sort(i)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(o,i){var a=n1(i);if(!(o1(o,i)===!1||a===null)){var s=this.getFirstCellSettings(o)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,o,l,u)}}},{key:"updateHeaderClasses",value:function(o){if(Ge(o,Rye()),this.enabled!==!1){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];le(o,Oye.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(o){ia(vo(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),He(o[this.pluginKey])&&this.sortBySettings(o[this.pluginKey])}},{key:"onAfterLoadData",value:function(o){o===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(o,i){var a=this.getFirstCellSettings(i)[this.pluginKey],s=a.headerAction;return s&&o.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){Bw(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&Rd()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){Bw(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(Rd()&&(this.hot.deselectCell(),this.hot.selectColumns(i.col)),this.sort(this.getColumnNextConfig(i.col)))}},{key:"destroy",value:function(){var o;(o=this.columnStatesManager)===null||o===void 0||o.destroy(),ia(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Yw}},{key:"PLUGIN_PRIORITY",get:function(){return ime}}]),r}(vt),sme=qe,Sj=De,PE=Ke,lme=Ii,ume=wx,fme=nH,g1=it,cme=Sj.RangeError,Cj=Sj.String,Oj=Math.floor,Gw=PE(fme),y1=PE("".slice),nu=PE(1 .toFixed),Is=function(e,t,r){return t===0?r:t%2===1?Is(e,t-1,r*e):Is(e*e,t/2,r)},hme=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},vs=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=Oj(o/1e7)},Ug=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=Oj(n/t),n=n%t*1e7},m1=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Cj(e[t]);r=r===""?n:r+Gw("0",7-n.length)+n}return r},dme=g1(function(){return nu(8e-5,3)!=="0.000"||nu(.9,0)!=="1"||nu(1.255,2)!=="1.25"||nu(1000000000000000100,0)!=="1000000000000000128"})||!g1(function(){nu({})});sme({target:"Number",proto:!0,forced:dme},{toFixed:function(t){var r=ume(this),n=lme(t),o=[0,0,0,0,0,0],i="",a="0",s,l,u,f;if(n<0||n>20)throw cme("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Cj(r);if(r<0&&(i="-",r=-r),r>1e-21)if(s=hme(r*Is(2,69,1))-69,l=s<0?r*Is(2,-s,1):r/Is(2,s,1),l*=4503599627370496,s=52-s,s>0){for(vs(o,0,l),u=n;u>=7;)vs(o,1e7,0),u-=7;for(vs(o,Is(10,u,1),0),u=s-1;u>=23;)Ug(o,1<<23),u-=23;Ug(o,1<<u),vs(o,1,1),Ug(o,2),a=m1(o)}else vs(o,0,l),vs(o,1<<-s,0),a=m1(o)+Gw("0",n);return n>0?(f=a.length,a=i+(f<=n?"0."+Gw("0",n-f)+a:y1(a,0,f-n)+"."+y1(a,f-n))):a=i+a,a}});function vme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pme(e,t,r){return t&&b1(e.prototype,t),r&&b1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var gme=function(){function e(t,r){vme(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return pme(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,o=[],i=r;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),P(i,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),o.push(s)}),o}},{key:"assignSetting",value:function(r,n,o,i){if(o==="ranges"&&r[o]===void 0){n[o]=i;return}else if(o==="ranges"&&r[o].length===0)return;if(r[o]===void 0){if(i instanceof Error)throw i;n[o]=i}else o==="destinationRow"&&n.reversedRowCoords?n[o]=this.hot.countRows()-r[o]-1:n[o]=r[o]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,o){if(this.settingsType==="function"){var i=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();P(a,function(s){i==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=o:r==="remove_row"&&(s.alterRowOffset=-1*o)),i==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=o:r==="remove_col"&&(s.alterColumnOffset=-1*o))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,o,i,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function p(){return s.hot.removeHook("beforeViewRender",p),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;P(h,function(p){f==="row"&&p.destinationRow>=v&&(p.alterRowOffset=c*o),f==="col"&&p.destinationColumn>=v&&(p.alterColumnOffset=c*o)}),this.resetAllEndpoints(h,!d),d?P(h,function(p){s.extendEndpointRanges(p,v,i[0],i.length),s.recreatePhysicalRanges(p),s.clearOffsetInformation(p)}):P(h,function(p){s.shiftEndpointCoordinates(p,v)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,o,i){P(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?o>a[1]?a[1]+=i:o<a[0]&&(a[0]-=i):o>=a[0]&&o<=a[1]&&(a[1]-=i,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,o=r.ranges,i=[],a=[];P(o,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),P(a,function(s){var l=[];P(s,function(u,f){f===0?l.push(u):s[f]!==s[f-1]+1&&(l.push(s[f-1]),i.push(l),l=[],l.push(u)),f===s.length-1&&(l.push(u),i.push(l))})}),r.ranges=i}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,P(r.ranges,function(o){P(o,function(i,a){i>=n&&(o[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=r.hot.countRows()||a.destinationColumn+l>=r.hot.countCols()});i||(this.cellsToSetCache=[],P(n,function(a){r.resetEndpointValue(a,o)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],P(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,o=[];this.cellsToSetCache=[],P(r,function(i,a,s){"".concat(i[2]||"")!=="".concat(i[3])&&P(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[a][1])===l.sourceColumn&&o.indexOf(u)===-1&&o.push(u)})}),P(o,function(i){n.refreshEndpoint(n.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.alterRowOffset||0,i=r.alterColumnOffset||0,a=[this.hot.toVisualRow(r.destinationRow),this.hot.toVisualColumn(r.destinationColumn)],s=a[0],l=a[1];if(l!==null&&s!==null){var u=this.hot.getCellMeta(s,l);u.readOnly=!1,u.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?o:0)),this.hot.toVisualColumn(r.destinationColumn+(n?i:0)),""])}},{key:"setEndpointValue",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=-1*r.alterRowOffset||0,a=-1*r.alterColumnOffset||0,s=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var l=this.hot.toVisualRow(r.destinationRow+i);if(l!==null){var u=this.hot.getCellMeta(l,r.destinationColumn+a);(n==="init"||u.readOnly!==r.readOnly)&&(u.readOnly=r.readOnly,u.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),o?this.hot.setDataAtCell(s,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){kt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}(),yme=gme;function Kw(e){return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(e)}var w1;function mme(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wme(e,t,r){return t&&_1(e.prototype,t),r&&_1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yh(){return typeof Reflect!="undefined"&&Reflect.get?yh=Reflect.get:yh=function(t,r,n){var o=_me(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},yh.apply(this,arguments)}function _me(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ll(e),e!==null););return e}function Sme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xw(e,t)}function Xw(e,t){return Xw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Xw(e,t)}function Cme(e){var t=Eme();return function(){var n=ll(e),o;if(t){var i=ll(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ome(this,o)}}function Ome(e,t){if(t&&(Kw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rme(e)}function Rme(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ll(e){return ll=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ll(e)}var zg="columnSummary",Tme=220,kme=function(e){Sme(r,e);var t=Cme(r);function r(n){var o;return bme(this,r),o=t.call(this,n),o.endpoints=null,o}return wme(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zg]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.settings=this.hot.getSettings()[zg],this.endpoints=new yme(this,this.settings),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeCreateRow",function(i,a,s){return o.endpoints.resetSetupBeforeStructureAlteration("insert_row",i,a,null,s)}),this.addHook("beforeCreateCol",function(i,a,s){return o.endpoints.resetSetupBeforeStructureAlteration("insert_col",i,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupBeforeStructureAlteration.apply(i,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(i,a,s){return o.endpoints.resetSetupAfterStructureAlteration("insert_row",i,a,null,s)}),this.addHook("afterCreateCol",function(i,a,s){return o.endpoints.resetSetupAfterStructureAlteration("insert_col",i,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=o.endpoints).resetSetupAfterStructureAlteration.apply(i,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return o.onAfterRowMove.apply(o,arguments)}),yh(ll(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(o){switch(o.type.toLowerCase()){case"sum":o.result=this.calculateSum(o);break;case"min":o.result=this.calculateMinMax(o,o.type);break;case"max":o.result=this.calculateMinMax(o,o.type);break;case"count":o.result=this.countEntries(o);break;case"average":o.result=this.calculateAverage(o);break;case"custom":o.result=o.customFunction.call(this,o);break}}},{key:"calculateSum",value:function(o){var i=this,a=0;return ot(o.ranges,function(s){a+=i.getPartialSum(s,o.sourceColumn)}),a}},{key:"getPartialSum",value:function(o,i){var a=0,s=o[1]||o[0],l=null,u=0;do{l=this.getCellValue(s,i)||0;var f=("".concat(l).split(".")[1]||[]).length||1;f>u&&(u=f),a+=l||0,s-=1}while(s>=o[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(o,i){var a=this,s=null;return ot(o.ranges,function(l){var u=a.getPartialMinMax(l,o.sourceColumn,i);if(s===null&&u!==null&&(s=u),u!==null)switch(i){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(o,i,a){var s=null,l=o[1]||o[0],u;do{if(u=this.getCellValue(l,i)||null,s===null)s=u;else if(u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=o[0]);return s}},{key:"countEmpty",value:function(o,i){var a,s=0,l=o[1]||o[0];do a=this.getCellValue(l,i),a||(s+=1),l-=1;while(l>=o[0]);return s}},{key:"countEntries",value:function(o){var i=this,a=0,s=o.ranges;return ot(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,f=i.countEmpty(l,o.sourceColumn);a+=u,a-=f}),a}},{key:"calculateAverage",value:function(o){var i=this.calculateSum(o),a=this.countEntries(o);return i/a}},{key:"getCellValue",value:function(o,i){var a=this.hot.toVisualRow(o),s=this.hot.toVisualColumn(i),l=this.hot.getSourceDataAtCell(o,i),u="";if(a!==null&&s!==null&&(u=this.hot.getCellMeta(a,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Rt(w1||(w1=mme(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),o,i));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(o,i){o&&i!=="ColumnSummary.reset"&&i!=="ColumnSummary.set"&&i!=="loadData"&&this.endpoints.refreshChangedEndpoints(o)}},{key:"onAfterRowMove",value:function(o,i){this.endpoints.resetSetupBeforeStructureAlteration("move_row",o[0],o.length,o,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",i,o.length,o,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return zg}},{key:"PLUGIN_PRIORITY",get:function(){return Tme}}]),r}(vt);function Ame(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ime(e,t,r){return t&&S1(e.prototype,t),r&&S1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Pme=function(){function e(t){Ame(this,e),this.container=null,this.rootDocument=t,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Ime(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var o=this.getInputElement();o.style.width="".concat(r,"px"),o.style.height="".concat(n,"px")}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),le(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),le(r,e.CLASS_EDITOR),le(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}(),Mme=Pme,rt="---------";function $me(){return{name:rt}}function Dme(e){return et(e,function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}})}function kc(e){return Ve(e,"htSeparator")}function xme(e){return Ve(e,"htSubmenu")}function Ac(e){return Ve(e,"htDisabled")}function Ic(e){return Ve(e,"htSelectionDisabled")}function qa(e){var t=e.getSelected();return!t||t[0]<0?null:t}function Nme(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function Hme(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Ui(e,t){var r={};return P(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=t(o,i))})}),r}function Jo(e,t,r,n,o){P(e,function(i){i.forAll(function(a,s){a>=0&&s>=0&&Lme(a,s,t,r,n,o)})})}function Lme(e,t,r,n,o,i){var a=o(e,t),s=n;a.className&&(r==="vertical"?s=Nme(a.className,n):s=Hme(a.className,n)),i(e,t,"className",s)}function Ln(e,t){var r=!1;return Array.isArray(e)&&P(e,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&t(o,i))return r=!0,!1}),r}),r}function no(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Fme(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function Rj(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function jme(e,t){var r=e.slice(0);return r.reverse(),r=Rj(r,t),r.reverse(),r}function Bme(e){var t=[];return P(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function Vme(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rt,r=e.slice(0);return r=Rj(r,t),r=jme(r,t),r=Bme(r),r}function Wme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ume(e,t,r){return t&&C1(e.prototype,t),r&&C1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var zme=250,Yme=250,Ej=function(){function e(t){Wme(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Ume(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Yme)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zme;this.showDebounced=OO(function(o){r.wasLastActionShow&&r.runLocalHooks("show",o.from.row,o.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();wt(Ej,Fr);var Gme=Ej;function qw(e){return qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qw(e)}function Yg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xme(e,t,r){return t&&O1(e.prototype,t),r&&O1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aa(){return typeof Reflect!="undefined"&&Reflect.get?aa=Reflect.get:aa=function(t,r,n){var o=qme(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},aa.apply(this,arguments)}function qme(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=po(e),e!==null););return e}function Qme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qw(e,t)}function Qw(e,t){return Qw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Qw(e,t)}function Zme(e){var t=ebe();return function(){var n=po(e),o;if(t){var i=po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Jme(this,o)}}function Jme(e,t){if(t&&(qw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tj(e)}function Tj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ebe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(e){return po=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},po(e)}var Gg="comments",tbe=60,Pc=new WeakMap,Pn="comment",ps="value",R1="style",Mc="readOnly",rbe=function(e){Qme(r,e);var t=Zme(r);function r(n){var o;return Kme(this,r),o=t.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,Pc.set(Tj(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return Xme(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gg]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.editor||(this.editor=new Mme(this.hot.rootDocument)),this.eventManager||(this.eventManager=new bt(this)),this.displaySwitch||(this.displaySwitch=new Gme(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(i){return o.addToContextMenu(i)}),this.addHook("afterRenderer",function(i,a,s,l,u,f){return o.onAfterRenderer(i,f)}),this.addHook("afterScrollHorizontally",function(){return o.hide()}),this.addHook("afterScrollVertically",function(){return o.hide()}),this.addHook("afterBeginEditing",function(){return o.hide()}),this.displaySwitch.addLocalHook("hide",function(){return o.hide()}),this.displaySwitch.addLocalHook("show",function(i,a){return o.showAtCell(i,a)}),this.registerListeners(),aa(po(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),aa(po(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){aa(po(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var o=this,i=this.hot.rootDocument;this.eventManager.addEventListener(i,"mouseover",function(a){return o.onMouseOver(a)}),this.eventManager.addEventListener(i,"mousedown",function(a){return o.onMouseDown(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return o.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return o.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return o.onEditorMouseUp(a)})}},{key:"setRange",value:function(o){this.range=o}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(o){var i=xo(o.target,"TD","TBODY");return!!(i&&Ve(i,"htCommentCell")&&xo(i,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(o){return this.editor.getInputElement()===o.target}},{key:"setComment",value:function(o){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.editor.getValue(),a="";o!=null?a=o:i!=null&&(a=i);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,Yg({},ps,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(o,i,a){this.setRange({from:new J(o,i)}),this.setComment(a)}},{key:"removeComment",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Pn),o&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:new J(o,i)}),this.removeComment(a)}},{key:"getComment",value:function(){var o=this.range.from.row,i=this.range.from.col;return this.getCommentMeta(o,i,ps)}},{key:"getCommentAtCell",value:function(o,i){return this.getCommentMeta(o,i,ps)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.range.from,i=o.row,a=o.col;if(i<0||i>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(s[Pn]?s[Pn][ps]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(o,i){return this.setRange({from:new J(o,i)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var o,i,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=l.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),p=d===null;d===null&&(d=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getFirstNotHiddenIndex(h,-1)));var b=d===null,_=v===null;d=(o=d)!==null&&o!==void 0?o:0,v=(i=v)!==null&&i!==void 0?i:0;var S=this.hot,E=S.rootWindow,M=S.view.wt,k=M.wtTable,U=M.wtOverlays,Y=M.wtViewport,ne=U.scrollableElement,Z=k.getCell({row:d,col:v}),te=Dt(Z),se=_?0:k.getStretchedColumnWidth(v),he=p&&!b?Ut(Z):0,ae=te.top,Ce=te.left;Y.hasVerticalScroll()&&ne!==E&&(ae-=U.topOverlay.getScrollPosition()),Y.hasHorizontalScroll()&&ne!==E&&(Ce-=U.leftOverlay.getScrollPosition());var y=Ce+se,w=ae+he,g=this.getCommentMeta(c,h,R1),m=this.getCommentMeta(c,h,Mc);g?this.editor.setSize(g.width,g.height):this.editor.resetSize(),this.editor.setReadOnlyState(m),this.editor.setPosition(y,w)}}},{key:"checkSelectionCommentsConsistency",value:function(){var o=this.hot.getSelectedRangeLast();if(!o)return!1;var i=!1,a=o.getTopLeftCorner();return this.getCommentMeta(a.row,a.col,ps)&&(i=!0),i}},{key:"updateCommentMeta",value:function(o,i,a){var s=this.hot.getCellMeta(o,i)[Pn],l;s?(l=kr(s),Cf(l,a)):l=a,this.hot.setCellMeta(o,i,Pn,l)}},{key:"getCommentMeta",value:function(o,i,a){var s=this.hot.getCellMeta(o,i);if(!!s[Pn])return s[Pn][a]}},{key:"onMouseDown",value:function(o){if(!(!this.hot.view||!this.hot.view.wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(o)){var i=xo(o.target,"TD","TBODY"),a=null;i&&(a=this.hot.getCoords(i)),(!i||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(o){var i=Pc.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ve(o.target,"wtBorder")||i.cellBelowCursor===o.target||!this.editor))if(i.cellBelowCursor=a.elementFromPoint(o.clientX,o.clientY),this.targetIsCellWithComment(o)){var s=new Kt(this.hot.getCoords(o.target));this.displaySwitch.show(s)}else ui(o.target,a)&&!this.targetIsCommentTextArea(o)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(o,i){i[Pn]&&i[Pn][ps]&&le(o,i.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(o){var i=Pc.get(this);i.tempEditorDimensions={width:Ft(o.target),height:Ut(o.target)}}},{key:"onEditorMouseUp",value:function(o){var i=Pc.get(this),a=Ft(o.target),s=Ut(o.target);(a!==i.tempEditorDimensions.width+1||s!==i.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Yg({},R1,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:o.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,s){a>=0&&s>=0&&o.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var o=this,i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,i.forAll(function(a,s){if(a>=0&&s>=0){var l=!!o.getCommentMeta(a,s,Mc);o.updateCommentMeta(a,s,Yg({},Mc,!l))}})}},{key:"addToContextMenu",value:function(o){var i=this,a=function(){return i.hot.rowIndexMapper.getRenderableIndexesLength()>0&&i.hot.columnIndexMapper.getRenderableIndexesLength()>0};o.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return i.checkSelectionCommentsConsistency()?i.hot.getTranslatedPhrase(pR):i.hot.getTranslatedPhrase(vR)},callback:function(){return i.onContextMenuAddComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(gR)},callback:function(){return i.onContextMenuRemoveComment()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(yR),f=Ln(this.getSelectedRangeLast(),function(c,h){var d=l.getCellMeta(c,h)[Pn];if(d&&(d=d[Mc]),d)return!0});return f&&(u=no(u)),u},callback:function(){return i.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(i.hot.getSelectedLast()&&!i.hot.selection.isSelectedByCorner())||!i.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var o=this.hot.getSettings()[Gg];if(Ze(o))return o.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),aa(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gg}},{key:"PLUGIN_PRIORITY",get:function(){return tbe}}]),r}(vt);function nbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function obe(e,t,r){return t&&E1(e.prototype,t),r&&E1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ibe=function(){function e(t){nbe(this,e),this.hot=t,this.commands={},this.commonCallback=null}return obe(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=abe(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!Ot(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(s.join(":")),P(c,function(h){return h.apply(n.hot,i)})}}}]),e}();function abe(e,t){var r;return P(t,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=n,!1}),r}var kj=ibe,en="alignment";function sbe(){return{key:en,name:function(){return this.getTranslatedPhrase(mR)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(en,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(bR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(en,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(wR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(en,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(_R),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htRight";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(en,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(SR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{name:rt},{key:"".concat(en,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(CR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htTop";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(en,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(OR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(en,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(RR),n=Ln(this.getSelectedRange(),function(o,i){var a=t.getCellMeta(o,i).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ui(r,function(a,s){return t.getCellMeta(a,s).className}),o="vertical",i="htBottom";this.runHooks("beforeCellAlignment",n,r,o,i),Jo(r,o,i,function(a,s){return t.getCellMeta(a,s)},function(a,s,l,u){return t.setCellMeta(a,s,l,u)}),this.render()},disabled:!1}]}}}var Kv="clear_column";function lbe(){return{key:Kv,name:function(){return this.getTranslatedPhrase(sR)},callback:function(t,r){var n=r[0].start.col,o=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){var t=qa(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var Lf="col_left";function ube(){return{key:Lf,name:function(){return this.getTranslatedPhrase(eR)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(!n){var i=r[Math.max(r.length-1,0)];o=i.start.col}this.alter("insert_col",o,1,"ContextMenu.columnLeft"),n&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Ff="col_right";function fbe(){return{key:Ff,name:function(){return this.getTranslatedPhrase(tR)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(n)o=this.countCols();else{var i,a=r[Math.max(r.length-1,0)],s=a==null||(i=a.end)===null||i===void 0?void 0:i.col;o=He(s)?s+1:0}this.alter("insert_col",o,1,"ContextMenu.columnRight"),n&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var jf="make_read_only";function cbe(){return{key:jf,name:function(){var t=this,r=this.getTranslatedPhrase(aR),n=Ln(this.getSelectedRange(),function(o,i){return t.getCellMeta(o,i).readOnly});return n&&(r=no(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ln(r,function(o,i){return t.getCellMeta(o,i).readOnly});P(r,function(o){o.forAll(function(i,a){i>=0&&a>=0&&t.setCellMeta(i,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Xv="redo";function hbe(){return{key:Xv,name:function(){return this.getTranslatedPhrase(iR)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function dbe(e,t){return ybe(e)||gbe(e,t)||pbe(e,t)||vbe()}function vbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pbe(e,t){if(!!e){if(typeof e=="string")return T1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T1(e,t)}}function T1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gbe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function ybe(e){if(Array.isArray(e))return e}var Bf="remove_col";function mbe(){return{key:Bf,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=dbe(t[0],4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(nR,r)},callback:function(){this.alter("remove_col",vce(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=qa(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function bbe(e,t){return Cbe(e)||Sbe(e,t)||_be(e,t)||wbe()}function wbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _be(e,t){if(!!e){if(typeof e=="string")return k1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k1(e,t)}}function k1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sbe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Cbe(e){if(Array.isArray(e))return e}var qv="remove_row";function Obe(){return{key:qv,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=bbe(t[0],3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(rR,r)},callback:function(){this.alter("remove_row",pce(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=qa(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Qv="row_above";function Rbe(){return{key:Qv,name:function(){return this.getTranslatedPhrase(ZO)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(!n){var i=r[Math.max(r.length-1,0)];o=i.start.row}this.alter("insert_row",o,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){var t=qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Zv="row_below";function Ebe(){return{key:Zv,name:function(){return this.getTranslatedPhrase(JO)},callback:function(t,r){var n=this.selection.isSelectedByCorner(),o=0;if(n)o=this.countRows();else{var i,a=r[Math.max(r.length-1,0)],s=a==null||(i=a.end)===null||i===void 0?void 0:i.row;o=He(s)?s+1:0}this.alter("insert_row",o,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){var t=qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Zu="no_items";function Tbe(){return{key:Zu,name:function(){return this.getTranslatedPhrase(QO)},disabled:!0,isCommand:!1}}var Jv="undo";function kbe(){return{key:Jv,name:function(){return this.getTranslatedPhrase(oR)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var Or;function jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Abe=[Qv,Zv,Lf,Ff,Kv,qv,Bf,Jv,Xv,jf,en,rt,Zu],Ibe=(Or={},jr(Or,rt,$me),jr(Or,Zu,Tbe),jr(Or,Qv,Rbe),jr(Or,Zv,Ebe),jr(Or,Lf,ube),jr(Or,Ff,fbe),jr(Or,Kv,lbe),jr(Or,qv,Obe),jr(Or,Bf,mbe),jr(Or,Jv,kbe),jr(Or,Xv,hbe),jr(Or,jf,cbe),jr(Or,en,sbe),Or);function Aj(){var e={};return ot(Ibe,function(t,r){e[r]=t()}),e}function Pbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mbe(e,t,r){return t&&A1(e.prototype,t),r&&A1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var $be=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Pbe(this,e),this.hot=t,this.predefinedItems=Aj(),this.defaultOrderPattern=r}return Mbe(e,[{key:"setPredefinedItems",value:function(r){var n=this,o={};this.defaultOrderPattern.length=0,ot(r,function(i,a){var s="";i.name===rt?(o[rt]=i,s=rt):isNaN(parseInt(a,10))?(i.key=i.key===void 0?a:i.key,o[a]=i,s=i.key):(o[i.key]=i,s=i.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=o}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Dbe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function Dbe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),Ze(o)?ot(o,function(i,a){var s=r[typeof i=="string"?i:a];s||(s=i),Ze(i)?xt(s,i):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):P(o,function(i,a){var s=r[i];!s&&Abe.indexOf(i)>=0||(s||(s={name:i,key:"".concat(a)}),Ze(i)&&xt(s,i),s.key===void 0&&(s.key=a),n.push(s))}),n}var Ij=$be;function xbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nbe(e,t,r){return t&&I1(e.prototype,t),r&&I1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Hbe=function(){function e(t,r){xbe(this,e);var n=$a(r),o=Si(r),i,a,s,l,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(i=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,f=t.width||0,a=i,l=s,i+=n,s+=o):this.type==="event"&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,a=i-n,l=s-o),this.top=i,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=f}return Nbe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}(),Lbe=Hbe;function Fbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jbe(e,t,r){return t&&P1(e.prototype,t),r&&P1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var M1=215,Pj=function(){function e(t,r){Fbe(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:M1,container:this.hot.rootDocument.documentElement},this.eventManager=new bt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return jbe(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(o){return r.onDocumentMouseDown(o)}),this.eventManager.addEventListener(n.document,"contextmenu",function(o){return r.onDocumentContextMenu(o)}),n=Pv(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=OO(function(u){return r.openSubMenu(u)},300),o=this.options.minWidth||M1,i=!1,a=Gr(this.menuItems,function(u){return u.key===Zu&&(i=!0),Fme(u,r.hot)});if(a.length<1&&!i)a.push(Aj()[Zu]);else if(a.length===0)return;a=Vme(a,rt);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(f){return He(f)&&f<o?o:f},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(f,c,h,d,v,p){return r.menuItemRenderer(f,c,h,d,v,p)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(f){return r.onBeforeKeyDown(f)},afterOnCellMouseOver:function(f,c){r.isAllSubMenusClosed()?n(c.row):r.openSubMenu(c.row)},rowHeights:function(f){return a[f].name===rt?1:23},afterOnCellContextMenu:function(f){f.preventDefault(),um()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(f){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(f))},afterOnCellMouseUp:function(f){(!um()||!Ci(f))&&s&&r.hasSelectedItem()&&(Sn()||eO()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new yE(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.isOpened()||(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!xme(n))return!1;var o=this.hotMenu.getSourceDataAtRow(r),i=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=i,i}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),o=this.hotSubMenus[n.key];o&&(o.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;P(this.hotMenu.getData(),function(n,o){return r.closeSubMenu(o)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var o=this.hot.getSelectedRange(),i=o?Dme(o):[];this.runLocalHooks("executeCommand",n.key,i,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,o=r.name,i=r.disabled,a=r.submenu,s=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return n===!1||o===rt||s===!0||a}},{key:"setPosition",value:function(r){var n=new Lbe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),n.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(n):this.setPositionOnLeftOfCursor(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n;this.isSubMenu()?n=1+r.left+r.cellWidth:n=this.offset.right+1+r.left,this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=fr(this.hot.rootDocument),o=this.offset.left+r.left-this.container.offsetWidth+n+4;this.container.style.left="".concat(o,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);kc(r)||Ac(r)||Ic(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);kc(n)||Ac(n)||Ic(n)?this.selectPrevCell(r,0):this.hotMenu.selectCell(r,0)}},{key:"selectNextCell",value:function(r,n){var o=r+1,i=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,n):null;!i||(kc(i)||Ac(i)||Ic(i)?this.selectNextCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"selectPrevCell",value:function(r,n){var o=r-1,i=o>=0?this.hotMenu.getCell(o,n):null;!i||(kc(i)||Ac(i)||Ic(i)?this.selectPrevCell(o,n):this.hotMenu.selectCell(o,n))}},{key:"menuItemRenderer",value:function(r,n,o,i,a,s){var l=this,u=r.getSourceDataAtRow(o),f=this.hot.rootDocument.createElement("div"),c=function(_){return Ot(_,"submenu")},h=function(_){return new RegExp(rt,"i").test(_.name)},d=function(_){return _.disabled===!0||typeof _.disabled=="function"&&_.disabled.call(l.hot)===!0},v=function(_){return _.disableSelection},p=s;typeof p=="function"&&(p=p.call(this.hot)),sn(n),le(f,"htItemWrapper"),n.appendChild(f),h(u)?le(n,"htSeparator"):typeof u.renderer=="function"?(le(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,o,i,a,p))):Mi(f,p),d(u)?(le(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(le(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(le(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)})):(Ge(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(o,i,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,o=r,i;return o&&(Ct(o)&&(o=o.call(this.hot),o===null||It(o)?o="":o=o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),i=n.querySelector(".".concat(this.options.className,".").concat(o))),i||(i=n.createElement("div"),le(i,"htMenu ".concat(this.options.className)),o&&le(i,o),this.options.container.appendChild(i)),i}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(r){if(Yu(r.target)&&this.container.contains(r.target)){At(r);return}var n=this.hotMenu.getSelectedLast(),o=!1;switch(this.keyEvent=!0,r.keyCode){case ue.ESCAPE:this.close(),o=!0;break;case ue.ENTER:n&&(this.hotMenu.getSourceDataAtRow(n[0]).submenu?o=!0:(this.executeCommand(r),this.close(!0)));break;case ue.ARROW_DOWN:n?this.selectNextCell(n[0],n[1]):this.selectFirstCell(),o=!0;break;case ue.ARROW_UP:n?this.selectPrevCell(n[0],n[1]):this.selectLastCell(),o=!0;break;case ue.ARROW_RIGHT:if(n){var i=this.openSubMenu(n[0]);i&&i.selectFirstCell()}o=!0;break;case ue.ARROW_LEFT:n&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),o=!0);break}o&&(r.preventDefault(),At(r)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view.wt.wtTable,n=this.hotMenu.getSettings().data,o=r.hider.style,i=r.holder.style,a=parseInt(o.width,10),s=zt(n,function(l,u){return l+(u.name===rt?1:26)},0);i.width="".concat(a+3,"px"),i.height="".concat(s+3,"px"),o.height=i.height}},{key:"onAfterSelection",value:function(r,n,o,i,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!ui(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ui(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){!this.isOpened()||Ve(r.target,"htCore")&&ui(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();wt(Pj,Fr);var ME=Pj;function Zw(e){return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function Bbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vbe(e,t,r){return t&&$1(e.prototype,t),r&&$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sa(){return typeof Reflect!="undefined"&&Reflect.get?sa=Reflect.get:sa=function(t,r,n){var o=Wbe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},sa.apply(this,arguments)}function Wbe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=go(e),e!==null););return e}function Ube(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jw(e,t)}function Jw(e,t){return Jw=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Jw(e,t)}function zbe(e){var t=Gbe();return function(){var n=go(e),o;if(t){var i=go(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Ybe(this,o)}}function Ybe(e,t){if(t&&(Zw(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mj(e)}function Mj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gbe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function go(e){return go=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},go(e)}var $c="contextMenu",Kbe=70;Ae.getSingleton().register("afterContextMenuDefaultOptions");Ae.getSingleton().register("beforeContextMenuShow");Ae.getSingleton().register("afterContextMenuShow");Ae.getSingleton().register("afterContextMenuHide");Ae.getSingleton().register("afterContextMenuExecute");var $j=function(e){Ube(r,e);var t=zbe(r);function r(n){var o;return Bbe(this,r),o=t.call(this,n),o.eventManager=new bt(Mj(o)),o.commandExecutor=new kj(o.hot),o.itemsFactory=null,o.menu=null,o}return Vbe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$c]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[$c];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new ME(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=o.executeCommand).call.apply(a,[o].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return o.onAfterOnCellContextMenu(a)}),sa(go(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sa(go(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),sa(go(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(o){if(!!this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;i=u-$a(o.view),a=f-Si(o.view)}else i=-1*$a(this.menu.hotMenu.rootWindow),a=-1*Si(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(o.pageY,10)+i,left:parseInt(o.pageX,10)+a})}}},{key:"close",value:function(){!this.menu||(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(o){var i;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=this.commandExecutor).execute.apply(i,[o].concat(s))}},{key:"prepareMenuItems",value:function(){var o=this;this.itemsFactory=new Ij(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[$c],a={items:this.itemsFactory.getItems(i)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(i);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),P(s,function(l){return o.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(o){var i=this.hot.getSettings(),a=i.rowHeaders,s=i.colHeaders;function l(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=o.target;this.close(),!Ve(u,"handsontableInput")&&(o.preventDefault(),o.stopPropagation(),!(!(a||s)&&!l(u)&&!(Ve(u,"current")&&Ve(u,"wtBorder")))&&this.open(o))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),sa(go(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $c}},{key:"PLUGIN_PRIORITY",get:function(){return Kbe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Qv,Zv,rt,Lf,Ff,rt,qv,Bf,rt,Jv,Xv,rt,jf,rt,en]}}]),r}(vt);$j.SEPARATOR={name:rt};function Xbe(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(lR)},callback:function(){e.copy()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function qbe(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(uR)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Qbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zbe(e,t,r){return t&&D1(e.prototype,t),r&&D1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Jbe=function(){function e(){Qbe(this,e),this.data={}}return Zbe(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function x1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ewe(e,t,r){return t&&x1(e.prototype,t),r&&x1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function twe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var rwe=ewe(function e(){twe(this,e),this.clipboardData=new Jbe}),nwe=pv,owe=dL;nwe("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},owe);function iwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function awe(e,t,r){return t&&N1(e.prototype,t),r&&N1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var $E=function(){function e(t){iwe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new bt(this),this.listenersCount=new WeakSet,this.container=t}return awe(e,[{key:"useSecondaryElement",value:function(){var r=uwe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),H1(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),H1(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Sn()||sL(this.mainElement)}}]),e}();wt($E,Fr);var Md=new WeakMap;function swe(e){var t=new $E(e),r=Md.get(e);return r=isNaN(r)?0:r,Md.set(e,r+1),t}function lwe(e){e.eventManager.clear()}var Kg=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function H1(e,t,r){e.addEventListener(t,"copy",Kg("copy",r)),e.addEventListener(t,"cut",Kg("cut",r)),e.addEventListener(t,"paste",Kg("paste",r))}var $d=new WeakMap;function uwe(e){var t=$d.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return $d.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function L1(e){if(e instanceof $E){var t=Md.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),lwe(e),t<=0){t=0;var r=$d.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),$d.delete(e.container)),e.mainElement=null}Md.set(e.container,t)}}function fwe(e,t){return vwe(e)||dwe(e,t)||hwe(e,t)||cwe()}function cwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hwe(e,t){if(!!e){if(typeof e=="string")return F1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F1(e,t)}}function F1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dwe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function vwe(e){if(Array.isArray(e))return e}function Dd(e){return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}function pwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gwe(e,t,r){return t&&j1(e.prototype,t),r&&j1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function la(){return typeof Reflect!="undefined"&&Reflect.get?la=Reflect.get:la=function(t,r,n){var o=ywe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},la.apply(this,arguments)}function ywe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yo(e),e!==null););return e}function mwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e_(e,t)}function e_(e,t){return e_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},e_(e,t)}function bwe(e){var t=_we();return function(){var n=yo(e),o;if(t){var i=yo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return wwe(this,o)}}function wwe(e,t){if(t&&(Dd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dj(e)}function Dj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _we(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(e){return yo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},yo(e)}Ae.getSingleton().register("afterCopyLimit");Ae.getSingleton().register("modifyCopyableRange");Ae.getSingleton().register("beforeCut");Ae.getSingleton().register("afterCut");Ae.getSingleton().register("beforePaste");Ae.getSingleton().register("afterPaste");Ae.getSingleton().register("beforeCopy");Ae.getSingleton().register("afterCopy");var Xg="copyPaste",Swe=80,Cwe=1/0,Owe=1/0,zi=new WeakMap,B1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Rwe=function(e){mwe(r,e);var t=bwe(r);function r(n){var o;return pwe(this,r),o=t.call(this,n),o.columnsLimit=Owe,o.copyableRanges=[],o.focusableElement=void 0,o.pasteMode="overwrite",o.rowsLimit=Cwe,o.uiContainer=o.hot.rootDocument.body,zi.set(Dj(o),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),o}return gwe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Xg]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i[Xg],s=i.fragmentSelection,l=zi.get(this);l.isFragmentSelectionEnabled=!!s,Dd(a)==="object"&&(this.pasteMode=a.pasteMode||this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,this.uiContainer=a.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",function(u){return o.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return o.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return o.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown()}),this.focusableElement=swe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return o.onCopy(u)}).addLocalHook("cut",function(u){return o.onCut(u)}).addLocalHook("paste",function(u){return o.onPaste(u)}),la(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),la(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&L1(this.focusableElement),la(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var o=zi.get(this);o.isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){var o=zi.get(this);o.isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(o){var i=this,a=[],s=[],l=[];return P(o,function(u){Ie(u.startRow,u.endRow,function(f){s.indexOf(f)===-1&&s.push(f)}),Ie(u.startCol,u.endCol,function(f){l.indexOf(f)===-1&&l.push(f)})}),P(s,function(u){var f=[];P(l,function(c){f.push(i.hot.getCopyableData(u,c))}),a.push(f)}),Tu(a)}},{key:"getRangedData",value:function(o){var i=this,a=[],s=[],l=[];return P(o,function(u){Ie(u.startRow,u.endRow,function(f){s.indexOf(f)===-1&&s.push(f)}),Ie(u.startCol,u.endCol,function(f){l.indexOf(f)===-1&&l.push(f)})}),P(s,function(u){var f=[];P(l,function(c){f.push(i.hot.getCopyableData(u,c))}),a.push(f)}),a}},{key:"paste",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;if(!(!o&&!i)){var a=new rwe;o&&a.clipboardData.setData("text/plain",o),i&&a.clipboardData.setData("text/html",i),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var o=this.hot.getSelectedRangeLast();if(!!o){var i=o.getTopLeftCorner(),a=o.getBottomRightCorner(),s=i.row,l=i.col,u=a.row,f=a.col,c=Math.min(u,s+this.rowsLimit-1),h=Math.min(f,l+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:s,startCol:l,endRow:c,endCol:h}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),(u!==c||f!==h)&&this.hot.runHooks("afterCopyLimit",u-s+1,f-l+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var o=this.hot.getActiveEditor(),i=o?o.TEXTAREA:void 0;i?this.focusableElement.setFocusableElement(i):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var o=this.hot.getActiveEditor();return o&&o.isOpened()}},{key:"populateValues",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!!o.length){for(var a=o.length,s=o[0].length,l=[],u=i.getTopLeftCorner(),f=u.row,c=u.col,h=i.getBottomRightCorner(),d=h.row,v=h.col,p=f,b=c,_=f,S=c;l.length<a||p<=d;){var E=this.hot.getCellMeta(p,c),M=E.skipRowOnPaste,k=E.visualRow;if(p=k+1,M!==!0){_=k,b=c;for(var U=[],Y=l.length%a;U.length<s||b<=v;){var ne=this.hot.getCellMeta(f,b),Z=ne.skipColumnOnPaste,te=ne.visualCol;if(b=te+1,Z!==!0){S=te;var se=U.length%s;U.push(o[Y][se])}}l.push(U)}}return this.hot.populateFromArray(f,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,_,S]}}},{key:"onCopy",value:function(o){var i=zi.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCopy||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCopy=!1;var a=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges);if(s){var l=Tu(a);if(o&&o.clipboardData){var u=gb(a,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[B1,u].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges)}o.preventDefault()}}},{key:"onCut",value:function(o){var i=zi.get(this);if(!(!this.hot.isListening()&&!i.isTriggeredByCut||this.isEditorOpened())){this.setCopyableText(),i.isTriggeredByCut=!1;var a=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(s){var l=Tu(a);if(o&&o.clipboardData){var u=gb(a,this.hot.rootDocument);o.clipboardData.setData("text/plain",l),o.clipboardData.setData("text/html",[B1,u].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}o.preventDefault()}}},{key:"onPaste",value:function(o){if(!(!this.hot.isListening()||this.isEditorOpened())){o&&o.preventDefault&&o.preventDefault();var i;if(o&&typeof o.clipboardData!="undefined"){var a=Iv(o.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=JL(a,this.hot.rootDocument);i=s.data}else i=o.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&typeof this.hot.rootWindow.clipboardData!="undefined"&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof i=="string"&&(i=Dce(i)),!(i&&i.length===0)&&this.hot.runHooks("beforePaste",i,this.copyableRanges)!==!1){var l=this.populateValues(i),u=fwe(l,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:"---------"},Xbe(this),qbe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var o=zi.get(this),i=o.isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(i&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&oL())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var o=this.hot.rootDocument.activeElement,i=this.hot.getActiveEditor();!i||o!==this.focusableElement.getFocusableElement()&&o!==i.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(L1(this.focusableElement),this.focusableElement=null),la(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Xg}},{key:"PLUGIN_PRIORITY",get:function(){return Swe}}]),r}(vt);function xj(e,t){return"border_row".concat(e,"col").concat(t)}function gu(){return{width:1,color:"#000"}}function mo(){return{hide:!0}}function Ewe(){return{width:1,color:"#000",cornerVisible:!1}}function qg(e,t){return{id:xj(e,t),border:Ewe(),row:e,col:t,top:mo(),right:mo(),bottom:mo(),left:mo()}}function Twe(e,t){return Ot(t,"border")&&(e.border=t.border),Ot(t,"top")&&(t.top?(Ze(t.top)||(t.top=gu()),e.top=t.top):(t.top=mo(),e.top=t.top)),Ot(t,"right")&&(t.right?(Ze(t.right)||(t.right=gu()),e.right=t.right):(t.right=mo(),e.right=t.right)),Ot(t,"bottom")&&(t.bottom?(Ze(t.bottom)||(t.bottom=gu()),e.bottom=t.bottom):(t.bottom=mo(),e.bottom=t.bottom)),Ot(t,"left")&&(t.left?(Ze(t.left)||(t.left=gu()),e.left=t.left):(t.left=mo(),e.left=t.left)),e}function Fo(e,t){var r=!1;return P(e.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=e.getCellMeta(o,i).borders;if(a)if(t){if(!Ot(a[t],"hide")||a[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function ep(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function kwe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(AR),n=Fo(this,"bottom");return n&&(r=ep(r)),r},callback:function(r,n){var o=Fo(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function Awe(e){return{key:"borders:left",name:function(){var r=this.getTranslatedPhrase(IR),n=Fo(this,"left");return n&&(r=ep(r)),r},callback:function(r,n){var o=Fo(this,"left");e.prepareBorder(n,"left",o)}}}function Iwe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(PR)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Fo(this)}}}function Pwe(e){return{key:"borders:right",name:function(){var r=this.getTranslatedPhrase(kR),n=Fo(this,"right");return n&&(r=ep(r)),r},callback:function(r,n){var o=Fo(this,"right");e.prepareBorder(n,"right",o)}}}function Mwe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(TR),n=Fo(this,"top");return n&&(r=ep(r)),r},callback:function(r,n){var o=Fo(this,"top");e.prepareBorder(n,"top",o)}}}function t_(e){return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function V1(e,t){return Nwe(e)||xwe(e,t)||Dwe(e,t)||$we()}function $we(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dwe(e,t){if(!!e){if(typeof e=="string")return W1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W1(e,t)}}function W1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xwe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Nwe(e){if(Array.isArray(e))return e}function Hwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lwe(e,t,r){return t&&U1(e.prototype,t),r&&U1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ua(){return typeof Reflect!="undefined"&&Reflect.get?ua=Reflect.get:ua=function(t,r,n){var o=Fwe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function Fwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bo(e),e!==null););return e}function jwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r_(e,t)}function r_(e,t){return r_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},r_(e,t)}function Bwe(e){var t=Uwe();return function(){var n=bo(e),o;if(t){var i=bo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Vwe(this,o)}}function Vwe(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wwe(e)}function Wwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uwe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(e){return bo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},bo(e)}var Dc="customBorders",zwe=90,Ywe=function(e){jwe(r,e);var t=Bwe(r);function r(n){var o;return Hwe(this,r),o=t.call(this,n),o.savedBorders=[],o}return Lwe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.onAfterContextMenuDefaultOptions(i)}),this.addHook("init",function(){return o.onAfterInit()}),ua(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),ua(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),ua(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(o,i){var a=this,s=["top","right","bottom","left"],l=i?Object.keys(i):s,u=rl(o),f=Qu(u);P(o,function(c){for(var h=f(c),d=V1(h,4),v=d[0],p=d[1],b=d[2],_=d[3],S=function(k){for(var U=function(Z){P(l,function(te){a.prepareBorderFromCustomAdded(k,Z,i,te)})},Y=p;Y<=_;Y+=1)U(Y)},E=v;E<=b;E+=1)S(E)}),this.hot.view.render()}},{key:"getBorders",value:function(o){var i=this;if(!Array.isArray(o))return this.savedBorders;var a=rl(o),s=Qu(a),l=[];return P(o,function(u){for(var f=s(u),c=V1(f,4),h=c[0],d=c[1],v=c[2],p=c[3],b=function(E){for(var M=function(Y){P(i.savedBorders,function(ne){ne.row===E&&ne.col===Y&&l.push(ne)})},k=d;k<=p;k+=1)M(k)},_=h;_<=v;_+=1)b(_)}),l}},{key:"clearBorders",value:function(o){var i=this;o?this.setBorders(o):(P(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange(),i.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(o,i){var a=this.checkSavedBorders(o);a||this.savedBorders.push(o);var s=new Kt(new J(o.row,o.col)),l=this.checkCustomSelections(o,s,i);l||this.hot.selection.highlight.addCustomSelection({border:o,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(o,i,a,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(o>=l||i>=u)){var f=qg(o,i);a&&(f=Twe(f,a),P(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,a),f.id=c.settings.id,f.left=c.settings.left,f.right=c.settings.right,f.top=c.settings.top,f.bottom=c.settings.bottom,!1})),this.hot.setCellMeta(o,i,"borders",f),this.insertBorderIntoSettings(f,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(o){var i=this,a=o.range,s=Math.min(a.to.row,this.hot.countRows()-1),l=Math.min(a.to.col,this.hot.countCols()-1);Ie(a.from.row,s,function(u){Ie(a.from.col,l,function(f){var c=qg(u,f),h=0;u===a.from.row&&Ot(o,"top")&&(h+=1,c.top=o.top),u===a.to.row&&Ot(o,"bottom")&&(h+=1,c.bottom=o.bottom),f===a.from.col&&Ot(o,"left")&&(h+=1,c.left=o.left),f===a.to.col&&Ot(o,"right")&&(h+=1,c.right=o.right),h>0&&(i.hot.setCellMeta(u,f,"borders",c),i.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(o,i){var a=xj(o,i);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(o,i,"borders")}},{key:"setBorder",value:function(o,i,a,s){var l=this.hot.getCellMeta(o,i).borders;if((!l||l.border===void 0)&&(l=qg(o,i)),s){l[a]=mo();var u=this.countHide(l);if(u===4)this.removeAllBorders(o,i);else{var f=this.checkCustomSelectionsFromContextMenu(l,a,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(o,i,"borders",l)}}else{l[a]=gu();var c=this.checkCustomSelectionsFromContextMenu(l,a,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(o,i,"borders",l)}}},{key:"prepareBorder",value:function(o,i,a){var s=this;P(o,function(l){var u=l.start,f=l.end;if(u.row===f.row&&u.col===f.col)i==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,i,a);else switch(i){case"noBorders":Ie(u.col,f.col,function(c){Ie(u.row,f.row,function(h){s.removeAllBorders(h,c)})});break;case"top":Ie(u.col,f.col,function(c){s.setBorder(u.row,c,i,a)});break;case"right":Ie(u.row,f.row,function(c){s.setBorder(c,f.col,i,a)});break;case"bottom":Ie(u.col,f.col,function(c){s.setBorder(f.row,c,i,a)});break;case"left":Ie(u.row,f.row,function(c){s.setBorder(c,u.col,i,a)});break}})}},{key:"createCustomBorders",value:function(o){var i=this;P(o,function(a){a.range?i.prepareBorderFromCustomAddedRange(a):i.prepareBorderFromCustomAdded(a.row,a.col,a)})}},{key:"countHide",value:function(o){var i=Object.values(o);return zt(i,function(a,s){var l=a;return s.hide&&(l+=1),l},0)}},{key:"clearBordersFromSelectionSettings",value:function(o){var i=et(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(o);i>-1&&this.hot.selection.highlight.customSelections[i].clear()}},{key:"clearNullCellRange",value:function(){var o=this;P(this.hot.selection.highlight.customSelections,function(i,a){if(i.cellRange===null)return o.hot.selection.highlight.customSelections[a].destroy(),o.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var o=this;P(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange()})}},{key:"spliceBorder",value:function(o){var i=et(this.savedBorders,function(a){return a.id}).indexOf(o);i>-1&&this.savedBorders.splice(i,1)}},{key:"checkSavedBorders",value:function(o){var i=this,a=!1,s=this.countHide(o);return s===4?(this.spliceBorder(o.id),a=!0):P(this.savedBorders,function(l,u){if(o.id===l.id)return i.savedBorders[u]=o,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(o,i,a){var s=!1;return P(this.hot.selection.highlight.customSelections,function(l){if(o.id===l.settings.id)return ot(l.instanceBorders,function(u){u.toggleHiddenClass(i,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(o,i,a){var s=this.countHide(o),l=!1;return s===4?(this.removeAllBorders(o.row,o.col),l=!0):P(this.hot.selection.highlight.customSelections,function(u){if(o.id===u.settings.id)return u.visualCellRange=i,u.commit(),a&&ot(u.instanceBorders,function(f){f.changeBorderStyle(a,o)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var o=this.hot.getSettings()[Dc];Array.isArray(o)?(o.length||(this.savedBorders=o),this.createCustomBorders(o)):o!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(o){!this.hot.getSettings()[Dc]||o.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(ER)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[Mwe(this),Pwe(this),kwe(this),Awe(this),Iwe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){ua(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dc}},{key:"PLUGIN_PRIORITY",get:function(){return zwe}}]),r}(vt);function n_(e){return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function Gwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kwe(e,t,r){return t&&z1(e.prototype,t),r&&z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fa(){return typeof Reflect!="undefined"&&Reflect.get?fa=Reflect.get:fa=function(t,r,n){var o=Xwe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fa.apply(this,arguments)}function Xwe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wo(e),e!==null););return e}function qwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o_(e,t)}function o_(e,t){return o_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},o_(e,t)}function Qwe(e){var t=Jwe();return function(){var n=wo(e),o;if(t){var i=wo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Zwe(this,o)}}function Zwe(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nj(e)}function Nj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jwe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(e)}var Y1="dragToScroll",e_e=100,t_e=function(e){qwe(r,e);var t=Qwe(r);function r(n){var o;return Gwe(this,r),o=t.call(this,n),o.eventManager=new bt(Nj(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return Kwe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Y1]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(i){return o.setupListening(i)}),this.addHook("afterOnCellCornerMouseDown",function(i){return o.setupListening(i)}),this.registerEvents(),fa(wo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fa(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),fa(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(o){this.boundaries=o}},{key:"setCallback",value:function(o){this.callback=o}},{key:"check",value:function(o,i){var a=0,s=0;i<this.boundaries.top?s=i-this.boundaries.top:i>this.boundaries.bottom&&(s=i-this.boundaries.bottom),o<this.boundaries.left?a=o-this.boundaries.left:o>this.boundaries.right&&(a=o-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var o=this,i=this.hot.rootWindow,a=i;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return o.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return o.onMouseMove(s)}),a=Pv(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(o){if(!Ci(o)){var i=this.hot.view.wt.wtTable.holder;i!==this.hot.rootWindow&&(this.setBoundaries(i.getBoundingClientRect()),this.setCallback(function(a,s){a<0?i.scrollLeft-=50:a>0&&(i.scrollLeft+=50),s<0?i.scrollTop-=20:s>0&&(i.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(o){!this.isListening()||this.check(o.clientX,o.clientY)}},{key:"destroy",value:function(){fa(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Y1}},{key:"PLUGIN_PRIORITY",get:function(){return e_e}}]),r}(vt);function i_(e){return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function r_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n_e(e,t,r){return t&&G1(e.prototype,t),r&&G1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ca(){return typeof Reflect!="undefined"&&Reflect.get?ca=Reflect.get:ca=function(t,r,n){var o=o_e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function o_e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_o(e),e!==null););return e}function i_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a_(e,t)}function a_(e,t){return a_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},a_(e,t)}function a_e(e){var t=l_e();return function(){var n=_o(e),o;if(t){var i=_o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return s_e(this,o)}}function s_e(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hj(e)}function Hj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_o(e)}Ae.getSingleton().register("afterDropdownMenuDefaultOptions");Ae.getSingleton().register("beforeDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuHide");Ae.getSingleton().register("afterDropdownMenuExecute");var Qg="dropdownMenu",u_e=230,Zg="changeType",Lj=function(e){i_e(r,e);var t=a_e(r);function r(n){var o;return r_e(this,r),o=t.call(this,n),o.eventManager=new bt(Hj(o)),o.commandExecutor=new kj(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return n_e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Qg]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.itemsFactory=new Ij(this.hot,r.DEFAULT_ITEMS);var i=this.hot.getSettings()[Qg],a={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),ca(_o(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){o.hot.runHooks("afterDropdownMenuDefaultOptions",a),o.itemsFactory.setPredefinedItems(a.items);var s=o.itemsFactory.getItems(i);o.menu&&o.menu.destroy(),o.menu=new ME(o.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||o.hot.rootDocument.body}),o.hot.runHooks("beforeDropdownMenuSetItems",s),o.menu.setMenuItems(s),o.menu.addLocalHook("beforeOpen",function(){return o.onMenuBeforeOpen()}),o.menu.addLocalHook("afterOpen",function(){return o.onMenuAfterOpen()}),o.menu.addLocalHook("afterClose",function(){return o.onMenuAfterClose()}),o.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(l=o.executeCommand).call.apply(l,[o].concat(f))}),P(s,function(l){return o.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ca(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ca(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"open",value:function(o){!this.menu||(this.menu.open(),o.width&&this.menu.setOffset("left",o.width),this.menu.setPosition(o))}},{key:"close",value:function(){!this.menu||this.menu.close()}},{key:"executeCommand",value:function(o){for(var i,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=this.commandExecutor).execute.apply(i,[o].concat(s))}},{key:"setListening",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(o?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(o){if(o.stopPropagation(),Ve(o.target,Zg)&&!this.menu.isOpened()){var i=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;i=u,a=f}var c=o.target.getBoundingClientRect();this.open({left:c.left+a,top:c.top+o.target.offsetHeight+3+i,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(o,i){var a=i.parentNode;if(!!a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(o<0||l!==s.length-1)){var u=i.querySelector(".".concat(Zg));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=Zg,f.onclick=function(){return!1},i.firstChild.insertBefore(f,i.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ca(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Qg}},{key:"PLUGIN_PRIORITY",get:function(){return u_e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Lf,Ff,rt,Bf,rt,Kv,rt,jf,rt,en]}}]),r}(vt);Lj.SEPARATOR={name:rt};function f_e(e,t){return v_e(e)||d_e(e,t)||h_e(e,t)||c_e()}function c_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h_e(e,t){if(!!e){if(typeof e=="string")return K1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K1(e,t)}}function K1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d_e(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function v_e(e){if(Array.isArray(e))return e}function p_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g_e(e,t,r){return t&&X1(e.prototype,t),r&&X1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var y_e=function(){function e(t){p_e(this,e),this.hot=t,this.options={}}return g_e(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),o=n.startRow,i=n.startCol,a=n.endRow,s=n.endCol,l=this.options,u=[];return Ie(o,a,function(f){var c=[];!l.exportHiddenRows&&r._isHiddenRow(f)||(Ie(i,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var o=this._getDataRange(),i=o.startRow,a=o.endRow,s=this.hot.getRowHeader();Ie(i,a,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var o=this._getDataRange(),i=o.startCol,a=o.endCol,s=this.hot.getColHeader();Ie(i,a,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,o=f_e(this.options.range,4),i=o[0],a=i===void 0?0:i,s=o[1],l=s===void 0?0:s,u=o[2],f=u===void 0?n:u,c=o[3],h=c===void 0?r:c;return a=Math.max(a,0),l=Math.max(l,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:a,startCol:l,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}(),m_e=y_e;function b_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w_e(e,t,r){return t&&q1(e.prototype,t),r&&q1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var __e=function(){function e(t,r){b_e(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return w_e(e,[{key:"_mergeOptions",value:function(r){var n=_r(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=xt(_r(e.DEFAULT_OPTIONS),n),n=xt(n,r),n.filename=bO(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}(),S_e=__e;function s_(e){return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function C_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O_e(e,t,r){return t&&Q1(e.prototype,t),r&&Q1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l_(e,t)}function l_(e,t){return l_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},l_(e,t)}function E_e(e){var t=A_e();return function(){var n=xd(e),o;if(t){var i=xd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return T_e(this,o)}}function T_e(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k_e(e)}function k_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xd(e){return xd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},xd(e)}var I_e=String.fromCharCode(13),P_e=String.fromCharCode(34),M_e=String.fromCharCode(10),$_e=function(e){R_e(r,e);var t=E_e(r);function r(){return C_e(this,r),t.apply(this,arguments)}return O_e(r,[{key:"export",value:function(){var o=this,i=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=i.bom?String.fromCharCode(65279):"";return l&&(s=et(s,function(h){return o._escapeCell(h,!0)}),f&&(c+=i.columnDelimiter),c+=s.join(i.columnDelimiter),c+=i.rowDelimiter),P(a,function(h,d){d>0&&(c+=i.rowDelimiter),f&&(c+=o._escapeCell(u[d])+i.columnDelimiter),c+=h.map(function(v){return o._escapeCell(v)}).join(i.columnDelimiter)}),c}},{key:"_escapeCell",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=jt(o);return a!==""&&(i||a.indexOf(I_e)>=0||a.indexOf(P_e)>=0||a.indexOf(M_e)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(S_e),D_e=$_e;function x_e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var N_e="csv",u_=x_e({},N_e,D_e);function H_e(e,t,r){return typeof u_[e]=="function"?new u_[e](t,r):null}function f_(e){return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function L_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F_e(e,t,r){return t&&Z1(e.prototype,t),r&&Z1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function j_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c_(e,t)}function c_(e,t){return c_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},c_(e,t)}function B_e(e){var t=U_e();return function(){var n=Nd(e),o;if(t){var i=Nd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return V_e(this,o)}}function V_e(e,t){if(t&&(f_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W_e(e)}function W_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nd(e){return Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Nd(e)}var z_e="exportFile",Y_e=240,G_e=function(e){j_e(r,e);var t=B_e(r);function r(){return L_e(this,r),t.apply(this,arguments)}return F_e(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(o,i).export()}},{key:"exportAsBlob",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(o,i))}},{key:"downloadFile",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,u=this._createTypeFormatter(o,i),f=this._createBlob(u),c=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!u_[o])throw new Error('Export format type "'.concat(o,'" is not supported.'));return H_e(o,new m_e(this.hot),i)}},{key:"_createBlob",value:function(o){var i=null;return typeof Blob!="undefined"&&(i=new Blob([o.export()],{type:"".concat(o.options.mimeType,";charset=").concat(o.options.encoding)})),i}}],[{key:"PLUGIN_KEY",get:function(){return z_e}},{key:"PLUGIN_PRIORITY",get:function(){return Y_e}}]),r}(vt);function K_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X_e(e,t,r){return t&&J1(e.prototype,t),r&&J1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Fj=function(){function e(t,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;K_e(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Hv)}return X_e(e,[{key:"reset",value:function(){P(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();wt(Fj,Fr);var tp=Fj,Ju={};function Ri(e,t){if(!Ju[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Ju[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Fs(e){if(!Ju[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Ju[e].descriptor}function Zt(e,t,r){r.key=e,Ju[e]={condition:t,descriptor:r}}var yr="none";function q_e(){return!0}Zt(yr,q_e,{name:Lv,inputsCount:0,showOperators:!1});var Pu="empty";function Q_e(e){return or(e.value)}Zt(Pu,Q_e,{name:LR,inputsCount:0,showOperators:!0});var mh="not_empty";function Z_e(e,t){return!Ri(Pu,t)(e)}Zt(mh,Z_e,{name:FR,inputsCount:0,showOperators:!0});function J_e(e,t){return nSe(e)||rSe(e,t)||tSe(e,t)||eSe()}function eSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tSe(e,t){if(!!e){if(typeof e=="string")return eM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eM(e,t)}}function eM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function nSe(e){if(Array.isArray(e))return e}var Mu="eq";function oSe(e,t){var r=J_e(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale)===jt(n)}Zt(Mu,oSe,{name:jR,inputsCount:1,showOperators:!0});var bh="neq";function iSe(e,t){return!Ri(Mu,t)(e)}Zt(bh,iSe,{name:BR,inputsCount:1,showOperators:!0});function aSe(e,t){return fSe(e)||uSe(e,t)||lSe(e,t)||sSe()}function sSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lSe(e,t){if(!!e){if(typeof e=="string")return tM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tM(e,t)}}function tM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function fSe(e){if(Array.isArray(e))return e}var jj="gt";function cSe(e,t){var r=aSe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>o}Zt(jj,cSe,{name:YR,inputsCount:1,showOperators:!0});function hSe(e,t){return gSe(e)||pSe(e,t)||vSe(e,t)||dSe()}function dSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vSe(e,t){if(!!e){if(typeof e=="string")return rM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rM(e,t)}}function rM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function gSe(e){if(Array.isArray(e))return e}var Bj="gte";function ySe(e,t){var r=hSe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value>=o}Zt(Bj,ySe,{name:GR,inputsCount:1,showOperators:!0});function mSe(e,t){return SSe(e)||_Se(e,t)||wSe(e,t)||bSe()}function bSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wSe(e,t){if(!!e){if(typeof e=="string")return nM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nM(e,t)}}function nM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Se(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function SSe(e){if(Array.isArray(e))return e}var Vj="lt";function CSe(e,t){var r=mSe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<o}Zt(Vj,CSe,{name:KR,inputsCount:1,showOperators:!0});function OSe(e,t){return kSe(e)||TSe(e,t)||ESe(e,t)||RSe()}function RSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ESe(e,t){if(!!e){if(typeof e=="string")return oM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oM(e,t)}}function oM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function kSe(e){if(Array.isArray(e))return e}var Wj="lte";function ASe(e,t){var r=OSe(t,1),n=r[0],o=n;return e.meta.type==="numeric"&&(o=parseFloat(o,10)),e.value<=o}Zt(Wj,ASe,{name:XR,inputsCount:1,showOperators:!0});function ISe(e,t){return DSe(e)||$Se(e,t)||MSe(e,t)||PSe()}function PSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MSe(e,t){if(!!e){if(typeof e=="string")return iM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iM(e,t)}}function iM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Se(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function DSe(e){if(Array.isArray(e))return e}var DE="date_after";function xSe(e,t){var r=ISe(t,1),n=r[0],o=ve(e.value,e.meta.dateFormat),i=ve(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Zt(DE,xSe,{name:ZR,inputsCount:1,showOperators:!0});function NSe(e,t){return jSe(e)||FSe(e,t)||LSe(e,t)||HSe()}function HSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LSe(e,t){if(!!e){if(typeof e=="string")return aM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aM(e,t)}}function aM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function jSe(e){if(Array.isArray(e))return e}var xE="date_before";function BSe(e,t){var r=NSe(t,1),n=r[0],o=ve(e.value,e.meta.dateFormat),i=ve(n,e.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Zt(xE,BSe,{name:JR,inputsCount:1,showOperators:!0});function VSe(e,t){return YSe(e)||zSe(e,t)||USe(e,t)||WSe()}function WSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function USe(e,t){if(!!e){if(typeof e=="string")return sM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sM(e,t)}}function sM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function YSe(e){if(Array.isArray(e))return e}var Hd="between";function GSe(e,t){var r=VSe(t,2),n=r[0],o=r[1],i=n,a=o;if(e.meta.type==="numeric"){var s=parseFloat(i,10),l=parseFloat(a,10);i=Math.min(s,l),a=Math.max(s,l)}else if(e.meta.type==="date"){var u=Ri(xE,[a]),f=Ri(DE,[i]);return u(e)&&f(e)}return e.value>=i&&e.value<=a}Zt(Hd,GSe,{name:qR,inputsCount:2,showOperators:!0});var Uj="not_between";function KSe(e,t){return!Ri(Hd,t)(e)}Zt(Uj,KSe,{name:QR,inputsCount:2,showOperators:!0});function XSe(e,t){return JSe(e)||ZSe(e,t)||QSe(e,t)||qSe()}function qSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QSe(e,t){if(!!e){if(typeof e=="string")return lM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lM(e,t)}}function lM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZSe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function JSe(e){if(Array.isArray(e))return e}var zj="begins_with";function eCe(e,t){var r=XSe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).startsWith(jt(n))}Zt(zj,eCe,{name:VR,inputsCount:1,showOperators:!0});var tCe=qe,Yj=Ke,rCe=Gn.f,nCe=Va,uM=dr,oCe=HC,iCe=Hr,aCe=LC,fM=Yj("".endsWith),sCe=Yj("".slice),lCe=Math.min,Gj=aCe("endsWith"),uCe=!Gj&&!!function(){var e=rCe(String.prototype,"endsWith");return e&&!e.writable}();tCe({target:"String",proto:!0,forced:!uCe&&!Gj},{endsWith:function(t){var r=uM(iCe(this));oCe(t);var n=arguments.length>1?arguments[1]:void 0,o=r.length,i=n===void 0?o:lCe(nCe(n),o),a=uM(t);return fM?fM(r,a,i):sCe(r,i-a.length,i)===a}});function fCe(e,t){return vCe(e)||dCe(e,t)||hCe(e,t)||cCe()}function cCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hCe(e,t){if(!!e){if(typeof e=="string")return cM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cM(e,t)}}function cM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dCe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function vCe(e){if(Array.isArray(e))return e}var Kj="ends_with";function pCe(e,t){var r=fCe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).endsWith(jt(n))}Zt(Kj,pCe,{name:WR,inputsCount:1,showOperators:!0});function gCe(e,t){return wCe(e)||bCe(e,t)||mCe(e,t)||yCe()}function yCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mCe(e,t){if(!!e){if(typeof e=="string")return hM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hM(e,t)}}function hM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bCe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function wCe(e){if(Array.isArray(e))return e}var NE="contains";function _Ce(e,t){var r=gCe(t,1),n=r[0];return jt(e.value).toLocaleLowerCase(e.meta.locale).indexOf(jt(n))>=0}Zt(NE,_Ce,{name:UR,inputsCount:1,showOperators:!0});var Xj="not_contains";function SCe(e,t){return!Ri(NE,t)(e)}Zt(Xj,SCe,{name:zR,inputsCount:1,showOperators:!0});var qj="date_tomorrow";function CCe(e){var t=ve(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ve().subtract(-1,"days").startOf("day"),"d"):!1}Zt(qj,CCe,{name:tE,inputsCount:0});var Qj="date_today";function OCe(e){var t=ve(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ve().startOf("day"),"d"):!1}Zt(Qj,OCe,{name:eE,inputsCount:0});var Zj="date_yesterday";function RCe(e){var t=ve(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ve().subtract(1,"days").startOf("day"),"d"):!1}Zt(Zj,RCe,{name:rE,inputsCount:0});DN();function ECe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var h_=new Set([1]).has(1),TCe=h_&&typeof Array.from=="function";function Vf(e){var t=e;return h_&&(t=new Set(t)),function(r){var n;return h_?n=t.has(r):n=!!~t.indexOf(r),n}}function Jj(e){return e==null?"":e}function d_(e){var t=e;return TCe?t=Array.from(new Set(t)):t=QC(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function dM(e,t,r,n){var o=[],i=e===t,a;return i||(a=Vf(t)),P(e,function(s){var l=!1;(i||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:ECe(s,r)};n&&n(u),o.push(u)}),o}function eB(e,t){return PCe(e)||ICe(e,t)||ACe(e,t)||kCe()}function kCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ACe(e,t){if(!!e){if(typeof e=="string")return vM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vM(e,t)}}function vM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ICe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function PCe(e){if(Array.isArray(e))return e}var ha="by_value";function MCe(e,t){var r=eB(t,1),n=r[0];return n(e.value)}Zt(ha,MCe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=eB(t,1),n=r[0];return[Vf(n)]},showOperators:!1});var ef={};function $Ce(e){if(!ef[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=ef[e].func;return function(r,n){return t(r,n)}}function DCe(e){return ef[e].name}function HE(e,t,r){ef[e]={name:t,func:r}}var di="conjunction",xCe=iE;function NCe(e,t){return e.every(function(r){return r.func(t)})}HE(di,xCe,NCe);var Ld="disjunction",HCe=Fv;function LCe(e,t){return e.some(function(r){return r.func(t)})}HE(Ld,HCe,LCe);var LE="disjunctionWithExtraCondition",FCe=Fv;function jCe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}HE(LE,FCe,jCe);var ou;function Jg(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var BCe="numeric",tB="text",VCe="date",pM=(ou={},Jg(ou,BCe,[yr,rt,Pu,mh,rt,Mu,bh,rt,jj,Bj,Vj,Wj,Hd,Uj]),Jg(ou,tB,[yr,rt,Pu,mh,rt,Mu,bh,rt,zj,Kj,rt,NE,Xj]),Jg(ou,VCe,[yr,rt,Pu,mh,rt,Mu,bh,rt,xE,DE,Hd,rt,qj,Qj,Zj]),ou);function WCe(e){var t=[],r=e;return pM[r]||(r=tB),P(pM[r],function(n){var o;n===rt?o={name:rt}:o=_r(Fs(n)),t.push(o)}),t}function UCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zCe(e,t,r){return t&&gM(e.prototype,t),r&&gM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ey="built",ty="building",yM=["click","input","keydown","keypress","keyup","focus","blur","change"],rB=function(){function e(t,r){UCe(this,e),this.hot=t,this.eventManager=new bt(this),this.options=xt(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return zCe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===ty?this._element:this.buildState===ey?(this.update(),this._element):(this.buildState=ty,this.build(),this.buildState=ey,this._element)}},{key:"isBuilt",value:function(){return this.buildState===ey}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Ir)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,s){r.eventManager.addEventListener(a,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=ty),this.options.className&&le(this._element,this.options.className),this.options.children.length)P(this.options.children,function(i){return r._element.appendChild(i.element)});else if(this.options.wrapIt){var o=this.hot.rootDocument.createElement(this.options.tagName);ot(this.options,function(i,a){o[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(o[a]=r.translateIfPossible(i))}),this._element.appendChild(o),P(yM,function(i){return n(o,i)})}else P(yM,function(i){return n(r._element,i)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return _r({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();wt(rB,Fr);var vi=rB;function v_(e){return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function YCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function GCe(e,t,r){return t&&mM(e.prototype,t),r&&mM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wh(){return typeof Reflect!="undefined"&&Reflect.get?wh=Reflect.get:wh=function(t,r,n){var o=KCe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wh.apply(this,arguments)}function KCe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ul(e),e!==null););return e}function XCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p_(e,t)}function p_(e,t){return p_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},p_(e,t)}function qCe(e){var t=ZCe();return function(){var n=ul(e),o;if(t){var i=ul(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return QCe(this,o)}}function QCe(e,t){if(t&&(v_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nB(e)}function nB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZCe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ul(e){return ul=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ul(e)}var xc=new WeakMap,JCe=function(e){XCe(r,e);var t=qCe(r);function r(n,o){var i;return YCe(this,r),i=t.call(this,n,xt(r.DEFAULTS,o)),xc.set(nB(i),{}),i.registerHooks(),i}return GCe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()}),this.addLocalHook("keyup",function(i){return o.onKeyup(i)})}},{key:"build",value:function(){wh(ul(r.prototype),"build",this).call(this);var o=xc.get(this),i=this.hot.rootDocument.createElement("div");o.input=this._element.firstChild,le(this._element,"htUIInput"),le(i,"htUIInputIcon"),this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var o=xc.get(this).input;o.type=this.options.type,o.placeholder=this.translateIfPossible(this.options.placeholder),o.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&xc.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(o){this.options.value=o.target.value}}],[{key:"DEFAULTS",get:function(){return _r({placeholder:"",type:"text",tagName:"input"})}}]),r}(vi),js=JCe;function g_(e){return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g_(e)}function eOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tOe(e,t,r){return t&&bM(e.prototype,t),r&&bM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bs(){return typeof Reflect!="undefined"&&Reflect.get?Bs=Reflect.get:Bs=function(t,r,n){var o=rOe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Bs.apply(this,arguments)}function rOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pi(e),e!==null););return e}function nOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y_(e,t)}function y_(e,t){return y_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},y_(e,t)}function oOe(e){var t=aOe();return function(){var n=pi(e),o;if(t){var i=pi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return iOe(this,o)}}function iOe(e,t){if(t&&(g_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oB(e)}function oB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e){return pi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},pi(e)}var Nc=new WeakMap,sOe=function(e){nOe(r,e);var t=oOe(r);function r(n,o){var i;return eOe(this,r),i=t.call(this,n,xt(r.DEFAULTS,o)),Nc.set(oB(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return tOe(r,[{key:"registerHooks",value:function(){var o=this;this.addLocalHook("click",function(){return o.onClick()})}},{key:"setItems",value:function(o){this.items=this.translateNames(o),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(o){var i=this;return P(o,function(a){a.name=i.translateIfPossible(a.name)}),o}},{key:"build",value:function(){var o=this;Bs(pi(r.prototype),"build",this).call(this),this.menu=new ME(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var i=new vi(this.hot,{className:"htUISelectCaption"}),a=new vi(this.hot,{className:"htUISelectDropdown"}),s=Nc.get(this);s.caption=i,s.captionElement=i.element,s.dropdown=a,P([i,a],function(l){return o._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return o.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return o.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var o;this.options.value?o=this.options.value.name:o=this.menu.hot.getTranslatedPhrase(Lv),Nc.get(this).captionElement.textContent=o,Bs(pi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var o=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:o.left-5,top:o.top-1,width:o.width,height:o.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(o){o.name!==rt&&(this.options.value=o,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var o=Nc.get(this),i=o.caption,a=o.dropdown;i&&i.destroy(),a&&a.destroy(),Bs(pi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return _r({className:"htUISelect",wrapIt:!1})}}]),r}(vi),wM=sOe;function m_(e){return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m_(e)}function lOe(e){return hOe(e)||cOe(e)||fOe(e)||uOe()}function uOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fOe(e,t){if(!!e){if(typeof e=="string")return b_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b_(e,t)}}function cOe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hOe(e){if(Array.isArray(e))return b_(e)}function b_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vOe(e,t,r){return t&&_M(e.prototype,t),r&&_M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _h(){return typeof Reflect!="undefined"&&Reflect.get?_h=Reflect.get:_h=function(t,r,n){var o=pOe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_h.apply(this,arguments)}function pOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fl(e),e!==null););return e}function gOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w_(e,t)}function w_(e,t){return w_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},w_(e,t)}function yOe(e){var t=wOe();return function(){var n=fl(e),o;if(t){var i=fl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return mOe(this,o)}}function mOe(e,t){if(t&&(m_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bOe(e)}function bOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fl(e){return fl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},fl(e)}var _Oe=function(e){gOe(r,e);var t=yOe(r);function r(n,o){var i;return dOe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new wM(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new js(i.hot,{placeholder:cE})),i.elements.push(new js(i.hot,{placeholder:hE})),i.registerHooks(),i}return vOe(r,[{key:"registerHooks",value:function(){var o=this;this.getSelectElement().addLocalHook("select",function(i){return o.onConditionSelect(i)}),this.getSelectElement().addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),P(this.getInputElements(),function(i){i.addLocalHook("keydown",function(a){return o.onInputKeyDown(a)})})}},{key:"setState",value:function(o){var i=this;if(this.reset(),!!o){var a=_r(o.command);a.name.startsWith(Vt)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),P(o.args,function(s,l){if(l>a.inputsCount-1)return!1;var u=i.getInputElement(l);u.setValue(s),u[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var o=this.getSelectElement().getValue()||Fs(yr),i=[];return P(this.getInputElements(),function(a,s){o.inputsCount>s&&i.push(a.getValue())}),{command:o,args:i}}},{key:"updateState",value:function(o,i){var a=Fs(o?o.name:yr);this.state.setValueAtIndex(i,{command:a,args:o?o.args:[]}),o||P(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof wM})[0]}},{key:"getInputElement",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[o]}},{key:"getInputElements",value:function(){return this.elements.filter(function(o){return o instanceof js})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s,l,u,f,c){le(s.parentNode,"htFiltersMenuCondition"),o.addSeparator&&le(s.parentNode,"border");var h=o.hot.rootDocument.createElement("div");return le(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||P(o.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var o,i=this.hot.getPlugin("filters").getSelectedColumn(),a=i&&i.visualIndex,s=(o=this.hot).getDataType.apply(o,lOe(this.hot.getSelectedLast()||[0,a])),l=WCe(s);P(this.getInputElements(),function(u){return u.hide()}),this.getSelectElement().setItems(l),_h(fl(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(l[0])}},{key:"onConditionSelect",value:function(o){P(this.getInputElements(),function(i,a){i[o.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return i.focus()},10)}),this.runLocalHooks("change",o)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(o){Oi(o.keyCode,"ENTER")?(this.runLocalHooks("accept"),At(o)):Oi(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),At(o))}}]),r}(tp),ry=_Oe;function __(e){return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function SOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function COe(e,t,r){return t&&SM(e.prototype,t),r&&SM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sh(){return typeof Reflect!="undefined"&&Reflect.get?Sh=Reflect.get:Sh=function(t,r,n){var o=OOe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sh.apply(this,arguments)}function OOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cl(e),e!==null););return e}function ROe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S_(e,t)}function S_(e,t){return S_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},S_(e,t)}function EOe(e){var t=kOe();return function(){var n=cl(e),o;if(t){var i=cl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return TOe(this,o)}}function TOe(e,t){if(t&&(__(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iB(e)}function iB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(e){return cl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},cl(e)}var Hc=new WeakMap,AOe=function(e){ROe(r,e);var t=EOe(r);function r(n,o){var i;return SOe(this,r),i=t.call(this,n,xt(r.DEFAULTS,o)),Hc.set(iB(i),{}),i}return COe(r,[{key:"build",value:function(){Sh(cl(r.prototype),"build",this).call(this);var o=Hc.get(this);o.input=this._element.firstChild;var i=this.hot.rootDocument.createElement("label");i.textContent=this.translateIfPossible(this.options.label.textContent),i.htmlFor=this.translateIfPossible(this.options.label.htmlFor),o.label=i,this._element.appendChild(i),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var o=Hc.get(this);o.input.checked=this.options.checked,o.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=o,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Hc.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return _r({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(vi),CM=AOe;function C_(e){return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}var OM;function IOe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function POe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MOe(e,t,r){return t&&RM(e.prototype,t),r&&RM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Oe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O_(e,t)}function O_(e,t){return O_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},O_(e,t)}function DOe(e){var t=HOe();return function(){var n=Fd(e),o;if(t){var i=Fd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return xOe(this,o)}}function xOe(e,t){if(t&&(C_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NOe(e)}function NOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fd(e){return Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Fd(e)}var EM=0,LOe=function(e){$Oe(r,e);var t=DOe(r);function r(n,o){var i;return POe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return MOe(r,[{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s){return le(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||P(o.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var o=this,i=[di,Ld];P(i,function(a){var s=new CM(o.hot,{name:"operator",label:{htmlFor:a,textContent:DCe(a)},value:a,checked:a===i[EM],id:a});s.addLocalHook("change",function(l){return o.onRadioInputChange(l)}),o.elements.push(s)})}},{key:"setChecked",value:function(o){if(this.elements.length<o)throw Error(Rt(OM||(OM=IOe(["Radio button with index "," doesn't exist."])),o));P(this.elements,function(i,a){i.setChecked(a===o)})}},{key:"getActiveOperationId",value:function(){var o=this.elements.find(function(i){return i instanceof CM&&i.isChecked()});return o?o.getValue():di}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(o){this.reset(),o&&this.getActiveOperationId()!==o&&P(this.elements,function(i){i.setChecked(i.getValue()===o)})}},{key:"updateState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:di,i=arguments.length>1?arguments[1]:void 0,a=o;a===LE&&(a=Ld),this.state.setValueAtIndex(i,a)}},{key:"reset",value:function(){this.setChecked(EM)}},{key:"onRadioInputChange",value:function(o){this.setState(o.target.value)}}]),r}(tp),FOe=LOe,jOe=Ke,BOe=Hr,TM=dr,VOe=/"/g,WOe=jOe("".replace),UOe=function(e,t,r,n){var o=TM(BOe(e)),i="<"+t;return r!==""&&(i+=" "+r+'="'+WOe(TM(n),VOe,"&quot;")+'"'),i+">"+o+"</"+t+">"},zOe=it,YOe=function(e){return zOe(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},GOe=qe,KOe=UOe,XOe=YOe;GOe({target:"String",proto:!0,forced:XOe("link")},{link:function(t){return KOe(this,"a","href",t)}});function R_(e){return R_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R_(e)}function qOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QOe(e,t,r){return t&&kM(e.prototype,t),r&&kM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ch(){return typeof Reflect!="undefined"&&Reflect.get?Ch=Reflect.get:Ch=function(t,r,n){var o=ZOe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ch.apply(this,arguments)}function ZOe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hl(e),e!==null););return e}function JOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E_(e,t)}function E_(e,t){return E_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},E_(e,t)}function eRe(e){var t=rRe();return function(){var n=hl(e),o;if(t){var i=hl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return tRe(this,o)}}function tRe(e,t){if(t&&(R_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aB(e)}function aB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hl(e){return hl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},hl(e)}var ny=new WeakMap,nRe=function(e){JOe(r,e);var t=eRe(r);function r(n,o){var i;return qOe(this,r),i=t.call(this,n,xt(r.DEFAULTS,o)),ny.set(aB(i),{}),i}return QOe(r,[{key:"build",value:function(){Ch(hl(r.prototype),"build",this).call(this);var o=ny.get(this);o.link=this._element.firstChild}},{key:"update",value:function(){!this.isBuilt()||(ny.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return _r({href:"#",tagName:"a"})}}]),r}(vi),AM=nRe;function T_(e){return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function IM(e){return sRe(e)||aRe(e)||iRe(e)||oRe()}function oRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iRe(e,t){if(!!e){if(typeof e=="string")return k_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k_(e,t)}}function aRe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sRe(e){if(Array.isArray(e))return k_(e)}function k_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uRe(e,t,r){return t&&PM(e.prototype,t),r&&PM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vs(){return typeof Reflect!="undefined"&&Reflect.get?Vs=Reflect.get:Vs=function(t,r,n){var o=fRe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vs.apply(this,arguments)}function fRe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gi(e),e!==null););return e}function cRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A_(e,t)}function A_(e,t){return A_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},A_(e,t)}function hRe(e){var t=vRe();return function(){var n=gi(e),o;if(t){var i=gi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dRe(this,o)}}function dRe(e,t){if(t&&(T_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sB(e)}function sB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gi(e){return gi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},gi(e)}var pRe=new WeakMap,gRe=function(e){cRe(r,e);var t=hRe(r);function r(n,o){var i;return lRe(this,r),i=t.call(this,n,xt(r.DEFAULTS,o)),pRe.set(sB(i),{}),i.searchInput=new js(i.hot,{placeholder:fE,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new AM(i.hot,{textContent:aE,className:"htUISelectAll"}),i.clearAllUI=new AM(i.hot,{textContent:sE,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return uRe(r,[{key:"registerHooks",value:function(){var o=this;this.searchInput.addLocalHook("keydown",function(i){return o.onInputKeyDown(i)}),this.searchInput.addLocalHook("input",function(i){return o.onInput(i)}),this.selectAllUI.addLocalHook("click",function(i){return o.onSelectAllClick(i)}),this.clearAllUI.addLocalHook("click",function(i){return o.onClearAllClick(i)})}},{key:"setItems",value:function(o){this.items=o,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(o){this.locale=o}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return IM(this.items)}},{key:"getValue",value:function(){return mRe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var o=this;Vs(gi(r.prototype),"build",this).call(this);var i=this.hot.rootDocument,a=i.createElement("div"),s=new vi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(f){!o._element||(o.itemsBox&&o.itemsBox.destroy(),le(f,"htUIMultipleSelectHot"),o.itemsBox=new o.hot.constructor(f,{data:o.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(h,d,v,p,b,_){h.title=_.instance.getDataAtRowProp(d,_.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return o.itemsBox.container.scrollWidth-fr(i)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(h){return o.onItemsBoxBeforeKeyDown(h)}}),o.itemsBox.init())};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){!this.isBuilt()||(this.itemsBox.loadData(yRe(this.items,this.options.value)),Vs(gi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Vs(gi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(o){var i=this,a=o.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=IM(this.items):s=Gr(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(i.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(o){this.runLocalHooks("keydown",o,this);var i=Gu(Oi,o.keyCode);i("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(At(o),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(o){var i=Gu(Oi,o.keyCode);i("ESCAPE")&&this.runLocalHooks("keydown",o,this),i("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(At(o),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(o){var i=[];o.preventDefault(),P(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,i.push(Pb(a,s)[0])}),this.itemsBox.setSourceDataAtCell(i)}},{key:"onClearAllClick",value:function(o){var i=[];o.preventDefault(),P(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,i.push(Pb(a,s)[0])}),this.itemsBox.setSourceDataAtCell(i)}}],[{key:"DEFAULTS",get:function(){return _r({className:"htUIMultipleSelect",value:[]})}}]),r}(vi),MM=gRe;function yRe(e,t){var r=Vf(t);return et(e,function(n){return n.checked=r(n.value),n})}function mRe(e){var t=[];return P(e,function(r){r.checked&&t.push(r.value)}),t}function I_(e){return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I_(e)}function bRe(e,t){return CRe(e)||SRe(e,t)||_Re(e,t)||wRe()}function wRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Re(e,t){if(!!e){if(typeof e=="string")return $M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $M(e,t)}}function $M(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SRe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function CRe(e){if(Array.isArray(e))return e}function ORe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RRe(e,t,r){return t&&DM(e.prototype,t),r&&DM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oh(){return typeof Reflect!="undefined"&&Reflect.get?Oh=Reflect.get:Oh=function(t,r,n){var o=ERe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oh.apply(this,arguments)}function ERe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dl(e),e!==null););return e}function TRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P_(e,t)}function P_(e,t){return P_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},P_(e,t)}function kRe(e){var t=PRe();return function(){var n=dl(e),o;if(t){var i=dl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return ARe(this,o)}}function ARe(e,t){if(t&&(I_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IRe(e)}function IRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dl(e){return dl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},dl(e)}var MRe=function(e){TRe(r,e);var t=kRe(r);function r(n,o){var i;return ORe(this,r),i=t.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new MM(i.hot)),i.registerHooks(),i}return RRe(r,[{key:"registerHooks",value:function(){var o=this;this.getMultipleSelectElement().addLocalHook("keydown",function(i){return o.onInputKeyDown(i)})}},{key:"setState",value:function(o){if(this.reset(),o&&o.command.key===ha){var i=this.getMultipleSelectElement();i.setItems(o.itemsSnapshot),i.setValue(o.args[0]),i.setLocale(o.locale)}}},{key:"getState",value:function(){var o=this.getMultipleSelectElement(),i=o.getItems();return{command:{key:o.isSelectedAllValues()||!i.length?yr:ha},args:[o.getValue()],itemsSnapshot:i}}},{key:"updateState",value:function(o){var i=this,a=function(l,u,f,c,h){var d=Gr(u,function(U){return U.name===ha}),v=bRe(d,1),p=v[0],b={},_=i.hot.getTranslatedPhrase(Od);if(p){var S=d_(et(c(l,h),function(U){return U.value}));f&&(p.args[0]=f);var E=[],M=dM(S,p.args[0],_,function(U){U.checked&&E.push(U.value)}),k=o.editedConditionStack.column;b.locale=i.hot.getCellMeta(0,k).locale,b.args=[E],b.command=Fs(ha),b.itemsSnapshot=M}else b.args=[],b.command=Fs(yr);i.state.setValueAtIndex(l,b)};a(o.editedConditionStack.column,o.editedConditionStack.conditions,o.conditionArgsChange,o.filteredRowsFactory),o.dependentConditionStacks.length&&a(o.dependentConditionStacks[0].column,o.dependentConditionStacks[0].conditions,o.conditionArgsChange,o.filteredRowsFactory,o.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(o){return o instanceof MM})[0]}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s,l,u,f,c){le(s.parentNode,"htFiltersMenuValue");var h=o.hot.rootDocument.createElement("div");return le(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||P(o.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var o=this.hot.getTranslatedPhrase(Od),i=d_(this._getColumnVisibleValues()),a=dM(i,i,o);this.getMultipleSelectElement().setItems(a),Oh(dl(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(i);var s=this.hot.getPlugin("filters").getSelectedColumn().visualIndex;this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s).locale)}},{key:"onInputKeyDown",value:function(o){Oi(o.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),At(o))}},{key:"_getColumnVisibleValues",value:function(){var o=this.hot.getPlugin("filters").getSelectedColumn(),i=o&&o.visualIndex;return et(this.hot.getDataAtCol(i),function(a){return Jj(a)})}}]),r}(tp),$Re=MRe;function M_(e){return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M_(e)}function DRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xRe(e,t,r){return t&&xM(e.prototype,t),r&&xM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$_(e,t)}function $_(e,t){return $_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},$_(e,t)}function HRe(e){var t=jRe();return function(){var n=jd(e),o;if(t){var i=jd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return LRe(this,o)}}function LRe(e,t){if(t&&(M_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FRe(e)}function FRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jd(e){return jd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},jd(e)}var BRe=function(e){NRe(r,e);var t=HRe(r);function r(n,o){var i;return DRe(this,r),i=t.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new js(i.hot,{type:"button",value:lE,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new js(i.hot,{type:"button",value:uE,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return xRe(r,[{key:"registerHooks",value:function(){var o=this;P(this.elements,function(i){i.addLocalHook("click",function(a,s){return o.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var o=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return o.isHidden()},renderer:function(a,s){return le(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||P(o.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(o,i){i.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(tp),VRe=BRe,NM,HM;function LM(e,t){return YRe(e)||zRe(e,t)||URe(e,t)||WRe()}function WRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function URe(e,t){if(!!e){if(typeof e=="string")return FM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FM(e,t)}}function FM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zRe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function YRe(e){if(Array.isArray(e))return e}function jM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function GRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function KRe(e,t,r){return t&&BM(e.prototype,t),r&&BM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var VM="ConditionCollection.filteringStates",lB=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;GRe(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new Hv,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(VM,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return KRe(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var o,i=this.filteringStates.getValueAtIndex(n),a=(o=i==null?void 0:i.conditions)!==null&&o!==void 0?o:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(a,r,s)}},{key:"isMatchInConditions",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:di;return r.length?$Ce(o)(r,n):!0}},{key:"addCondition",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:di,i=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,s=et(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(a):c}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==o)throw Error(Rt(NM||(NM=jM(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(It(ef[o]))throw new Error(Rt(HM||(HM=jM(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),o));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:o,conditions:[{name:l,args:s,func:Ri(l,s)}]},i):f.push({name:l,args:s,func:Ri(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,o;return(n=(o=this.filteringStates.getValueAtIndex(r))===null||o===void 0?void 0:o.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=LM(r,1),o=n[0];return o})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return zt(this.filteringStates.getEntries(),function(r,n){var o=LM(n,2),i=o[0],a=o[1],s=a.operation,l=a.conditions;return r.push({column:i,operation:s,conditions:et(l,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),P(r,function(o){P(o.conditions,function(i){return n.addCondition(o.column,i)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var o=this.getConditions(r);return n?o.some(function(i){return i.name===n}):o.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(VM),this.filteringStates=null,this.clearLocalHooks()}}]),e}();wt(lB,Fr);var uB=lB;function XRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qRe(e,t,r){return t&&WM(e.prototype,t),r&&WM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var QRe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};XRe(this,e),this.conditionCollection=t,this.columnDataFactory=r}return qRe(e,[{key:"filter",value:function(){var r=this,n=[];return P(this.conditionCollection.getFilteredColumns(),function(o,i){var a=r.columnDataFactory(o);i&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(o,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=[];return P(o,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&i.push(a)}),i}},{key:"_getIntersectData",value:function(r,n){var o=[];return P(n,function(i){var a=i.meta.visualRow;r[a]!==void 0&&(o[a]=r[a])}),o}}]),e}(),fB=QRe;function ZRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function JRe(e,t,r){return t&&UM(e.prototype,t),r&&UM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var cB=function(){function e(t,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};ZRe(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return JRe(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,P(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var o=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var i=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var s=i.slice(0,a),l=i.slice(a);l.length&&l[0].column===r&&l.shift();var u=uL(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new uB(o.hot,!1),p=[].concat(c,d);v.importAllConditions(p);var b=o.columnDataFactory(h),_;v.isEmpty()?_=b:_=new fB(v,function(E){return o.columnDataFactory(E)}).filter(),_=et(_,function(E){return E.meta.visualRow});var S=Vf(_);return v.destroy(),Gr(b,function(E){return S(E.meta.visualRow)})})(s),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;P(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),ot(this,function(n,o){r[o]=null})}}]),e}();wt(cB,Fr);var eEe=cB;function D_(e){return D_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D_(e)}var zM;function tEe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rEe(e,t){return aEe(e)||iEe(e,t)||oEe(e,t)||nEe()}function nEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oEe(e,t){if(!!e){if(typeof e=="string")return YM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YM(e,t)}}function YM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iEe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function aEe(e){if(Array.isArray(e))return e}function sEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GM(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lEe(e,t,r){return t&&GM(e.prototype,t),r&&GM(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ws(){return typeof Reflect!="undefined"&&Reflect.get?Ws=Reflect.get:Ws=function(t,r,n){var o=uEe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ws.apply(this,arguments)}function uEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yi(e),e!==null););return e}function fEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x_(e,t)}function x_(e,t){return x_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},x_(e,t)}function cEe(e){var t=dEe();return function(){var n=yi(e),o;if(t){var i=yi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hEe(this,o)}}function hEe(e,t){if(t&&(D_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hB(e)}function hB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dEe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yi(e){return yi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},yi(e)}var KM="filters",vEe=250,pEe=function(e){fEe(r,e);var t=cEe(r);function r(n){var o;return sEe(this,r),o=t.call(this,n),o.eventManager=new bt(hB(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.lastSelectedColumn=null,o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return lEe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[KM]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new xf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var i=this.hot.getSettings().dropdownMenu,a=i&&i.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return o.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return o.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return o.onComponentChange(d,v)}),d},l=function(){return"".concat(o.hot.getTranslatedPhrase(nE),":")},u=function(){return"".concat(o.hot.getTranslatedPhrase(oE),":")};if(!this.components.get("filter_by_condition")){var f=new ry(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});f.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition",s(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new FOe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new ry(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});c.addLocalHook("afterClose",function(){return o.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new $Re(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new VRe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new uB(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new eEe(this.hot,this.conditionCollection,function(h){return o.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return o.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(h){return o.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return o.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return o.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return o.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return o.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Ws(yi(r.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var o=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(i){return o.onTableClick(i)})}},{key:"disablePlugin",value:function(){var o=this;if(this.enabled){var i;(i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),o.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Ws(yi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(o,i,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:di,l=this.hot.toPhysicalColumn(o);this.conditionCollection.addCondition(l,{command:{key:i},args:a},s)}},{key:"removeConditions",value:function(o){var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}},{key:"clearConditions",value:function(o){if(o===void 0)this.conditionCollection.clean();else{var i=this.hot.toPhysicalColumn(o);this.conditionCollection.removeConditions(i)}}},{key:"filter",value:function(){var o=this,i=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(a){var f=[];this.hot.batchExecution(function(){o.filtersRowsMap.clear(),s=et(i.filter(),function(h){return h.meta.visualRow});var c=Vf(s);Ie(o.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),P(f,function(h){o.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var o,i=(o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.getTopLeftCorner();i!==void 0&&this.hot.selectCell(i.row,i.col)}},{key:"getDataMapAtColumn",value:function(o){var i=this,a=this.hot.toVisualColumn(o),s=[];return P(this.hot.getSourceDataAtCol(a),function(l,u){var f=i.hot.getCellMeta(u,a),c=f.row,h=f.col,d=f.visualCol,v=f.visualRow,p=f.type,b=f.instance,_=f.dateFormat,S=f.locale;s.push({meta:{row:c,col:h,visualCol:d,visualRow:v,type:p,instance:b,dateFormat:_,locale:S},value:Jj(l)})}),s}},{key:"onAfterChange",value:function(o){var i=this;o&&P(o,function(a){var s=rEe(a,2),l=s[1],u=i.hot.propToCol(l);i.conditionCollection.hasConditions(u)&&i.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(o){var i=this.hot.getDataAtCol(o),a=d_(i);this.conditionUpdateObserver.updateStatesAtColumn(o,a)}},{key:"restoreComponents",value:function(o){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex;o.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var o=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){o.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(o){o.items.push({name:rt}),this.components.forEach(function(i){o.items.push(i.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(o,i,a,s){var l=o;return l===Ld&&i.command.key!==yr&&a.command.key!==yr&&s.command.key!==yr?l=LE:s.command.key!==yr&&(i.command.key===yr||a.command.key===yr)&&(l=di),l}},{key:"onActionBarSubmit",value:function(o){if(o==="accept"){var i,a=(i=this.getSelectedColumn())===null||i===void 0?void 0:i.physicalIndex,s=this.components.get("filter_by_condition").getState(),l=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),f=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,l,u);this.conditionUpdateObserver.groupChanges();var c=this.conditionCollection.getColumnStackPosition(a);c===-1&&(c=void 0),this.conditionCollection.removeConditions(a),s.command.key!==yr&&(this.conditionCollection.addCondition(a,s,f,c),l.command.key!==yr&&this.conditionCollection.addCondition(a,l,f,c)),u.command.key!==yr&&this.conditionCollection.addCondition(a,u,f,c),this.conditionUpdateObserver.flush(),this.components.forEach(function(h){return h.saveState(a)}),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(o,i){this.updateDependentComponentsVisibility(),o.constructor===ry&&!i.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var o=this.components.get("filter_by_condition"),i=o.getState(),a=i.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(o,i){var a=this.hot.toPhysicalColumn(o);this.enabled&&this.conditionCollection.hasConditions(a)?le(i,"htFiltersActive"):Ge(i,"htFiltersActive")}},{key:"onTableClick",value:function(o){var i=xo(o.target,"TH");if(i){var a=this.hot.getCoords(i).col,s=this.hot.toPhysicalColumn(a);this.lastSelectedColumn={visualIndex:a,physicalIndex:s}}}},{key:"_createDataFilter",value:function(){var o=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new fB(i,function(a){return o.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(o){var i;if(!!((i=this.dropdownMenuPlugin)!==null&&i!==void 0&&i.enabled)){var a=o.editedConditionStack,s=a.conditions,l=a.column,u=s.filter(function(h){return h.name===ha}),f=s.filter(function(h){return h.name!==ha});if(u.length>=2||f.length>=3)kt(Rt(zM||(zM=tEe([`The filter conditions have been applied properly, but couldn\u2019t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn\u2019t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(f[0],l),this.components.get("filter_by_condition2").updateState(f[1],l),this.components.get("filter_operators").updateState(c,l),this.components.get("filter_by_value").updateState(o)}}}},{key:"getIndexesOfComponents",value:function(){var o=[];if(!this.dropdownMenuPlugin)return o;for(var i=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return P(s,function(u){P(i.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&o.push(c)})}),o}},{key:"changeComponentsVisibility",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!!this.dropdownMenuPlugin){for(var i=this.dropdownMenuPlugin.menu,a=i.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);o?s.showRows(c):s.hideRows(c),a.render()}}},{key:"hideComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(i))}},{key:"showComponents",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(i))}},{key:"destroy",value:function(){var o=this;this.enabled&&(this.components.forEach(function(i,a){i!==null&&(i.destroy(),o.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Ws(yi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return KM}},{key:"PLUGIN_PRIORITY",get:function(){return vEe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(vt);function XM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $u(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XM(Object(r),!0).forEach(function(n){gEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gEe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dB="internal-use-in-handsontable",yEe={licenseKey:dB,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function vB(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[Tr])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function pB(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function mEe(e){var t,r=e[Tr],n=pB(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=vB(e);return $u($u($u({},yEe),n),o)}function bEe(e){var t,r=e[Tr],n=pB(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=vB(e);return $u($u({},n),o)}function N_(e){return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}function rp(){var e="engine_relationship",t=hn(Tr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function FE(){var e="shared_engine_usage",t=hn(Tr);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function wEe(e){var t=e.getSettings(),r=t[Tr],n=r==null?void 0:r.engine;if(r===!0||It(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return _Ee((o=n.hyperformula)!==null&&o!==void 0?o:n,t,e)}else if(N_(n)==="object"&&It(n.hyperformula)){var i=rp(),a=FE().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(e),a&&a.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:dB}),n}return null}function _Ee(e,t,r){var n=t[Tr],o=mEe(t),i=rp(),a=FE();SEe(e,n.functions),CEe(e,n.language);var s=e.buildEmpty(o);return i.set(s,[r]),a.set(s,[r.guid]),OEe(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function qM(e){var t,r=rp(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function QM(e,t){if(e){var r=rp(),n=r.get(e),o=FE(),i=o.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),i.length===0&&(o.delete(e),e.destroy()))}}function SEe(e,t){t&&t.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{e.registerFunction(n,o,i)}catch(a){kt(a.message)}})}function CEe(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){kt(n.message)}}}function OEe(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{e.addNamedExpression(n,o,i,a)}catch(s){kt(s.message)}}),e.resumeEvaluation())}function REe(e,t){return(It(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function gB(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function EEe(e){return gB(e)?e.substr(1):e}function TEe(e){return IEe(e)||AEe(e)||yB(e)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AEe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IEe(e){if(Array.isArray(e))return H_(e)}function ZM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZM(Object(r),!0).forEach(function(n){Rh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tf(e){return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function gs(e,t){return $Ee(e)||MEe(e,t)||yB(e,t)||PEe()}function PEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yB(e,t){if(!!e){if(typeof e=="string")return H_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H_(e,t)}}function H_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MEe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function $Ee(e){if(Array.isArray(e))return e}function DEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xEe(e,t,r){return t&&e$(e.prototype,t),r&&e$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function da(){return typeof Reflect!="undefined"&&Reflect.get?da=Reflect.get:da=function(t,r,n){var o=NEe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},da.apply(this,arguments)}function NEe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=So(e),e!==null););return e}function HEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L_(e,t)}function L_(e,t){return L_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},L_(e,t)}function LEe(e){var t=jEe();return function(){var n=So(e),o;if(t){var i=So(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return FEe(this,o)}}function FEe(e,t){if(t&&(tf(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qi(e)}function Qi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jEe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},So(e)}function Rh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oy(e,t,r){BEe(e,t),t.set(e,r)}function BEe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(e,t,r){var n=mB(e,t,"set");return VEe(e,n,r),r}function VEe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ms(e,t){var r=mB(e,t,"get");return WEe(e,r)}function mB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function WEe(e,t){return t.get?t.get.call(e):t.value}var Tr="formulas",UEe=260,t$="row_move";Ae.getSingleton().register("afterNamedExpressionAdded");Ae.getSingleton().register("afterNamedExpressionRemoved");Ae.getSingleton().register("afterSheetAdded");Ae.getSingleton().register("afterSheetRemoved");Ae.getSingleton().register("afterSheetRenamed");Ae.getSingleton().register("afterFormulasValuesUpdate");var bs=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Yi=new WeakMap,iy=new WeakMap,iu=new WeakMap,zEe=function(e){HEe(r,e);var t=LEe(r);function r(){var n;DEe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),oy(Qi(n),Yi,{writable:!0,value:!1}),oy(Qi(n),iy,{writable:!0,value:!1}),oy(Qi(n),iu,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),Rh(Qi(n),"staticRegister",hn("formulas")),Rh(Qi(n),"engine",null),Rh(Qi(n),"sheetName",null),n}return xEe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Tr]}},{key:"enablePlugin",value:function(){var o,i=this;if(!this.enabled){if(this.engine=(o=wEe(this.hot))!==null&&o!==void 0?o:this.engine,!this.engine){kt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return i.onBeforeLoadData.apply(i,arguments)}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("modifyData",function(){return i.onModifyData.apply(i,arguments)}),this.addHook("modifySourceData",function(){return i.onModifySourceData.apply(i,arguments)}),this.addHook("beforeValidate",function(){return i.onBeforeValidate.apply(i,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return i.onAfterSetSourceDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtCell",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return i.onAfterSetDataAtCell.apply(i,arguments)}),this.addHook("beforeCreateRow",function(){return i.onBeforeCreateRow.apply(i,arguments)}),this.addHook("beforeCreateCol",function(){return i.onBeforeCreateCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("beforeRemoveCol",function(){return i.onBeforeRemoveCol.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==t$&&i.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==t$&&i.engine.redo()}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("beforeAutofill",function(){return i.onBeforeAutofill.apply(i,arguments)}),ms(this,iu).forEach(function(s){var l=gs(s,2),u=l[0],f=l[1];return i.engine.on(u,f)}),da(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this;ms(this,iu).forEach(function(i){var a=gs(i,2),s=a[0],l=a[1];return o.engine.off(s,l)}),QM(this.engine,this.hot),this.engine=null,da(So(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(o){this.engine.updateConfig(bEe(this.hot.getSettings()));var i=this.hot.getSettings()[Tr];if(He(i)&&He(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!o.data&&this.sheetName===null){var a=this.hot.getSettings()[Tr].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a!=null?a:void 0,this.hot.getSourceDataArray())}da(So(r.prototype),"updatePlugin",this).call(this,o)}},{key:"destroy",value:function(){var o=this;ms(this,iu).forEach(function(i){var a,s=gs(i,2),l=s[0],u=s[1];return(a=o.engine)===null||a===void 0?void 0:a.off(l,u)}),ys(this,iu,null),QM(this.engine,this.hot),this.engine=null,da(So(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(o,i,a,s,l){return!l&&o>=a?s+(o-a):i}},{key:"toPhysicalRowPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalRow(o),this.hot.countRows(),this.hot.countSourceRows(),i)}},{key:"toPhysicalColumnPosition",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(o,this.hot.toPhysicalColumn(o),this.hot.countCols(),this.hot.countSourceCols(),i)}},{key:"addSheet",value:function(o,i){if(He(i)&&!vF(i))return kt("The provided data should be an array of arrays."),!1;if(o!=null&&this.engine.doesSheetExist(o))return kt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(o!=null?o:void 0);return i&&this.engine.setSheetContent(this.engine.getSheetId(a),i),a}catch(s){return kt(s.message),!1}}},{key:"switchSheet",value:function(o){if(!this.engine.doesSheetExist(o)){TO("The sheet named `".concat(o,"` does not exist, switch aborted."));return}this.sheetName=o;var i=this.engine.getSheetSerialized(this.sheetId);i.length>0&&this.hot.loadData(i,"".concat(an(Tr),".switchSheet"))}},{key:"getCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(o),l=this.hot.toPhysicalColumn(i);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(o),l=this.hot.toPhysicalColumn(i);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:s,col:l})}},{key:"renderDependentSheets",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;o.forEach(function(l){var u,f=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(s.has(f)||s.add(f))}),qM(this.engine).forEach(function(l,u){if((a||u!==i.sheetId)&&s.has(u)){var f;l.render(),(f=l.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,p=h.sheet;return He(p)?"".concat(p,":").concat(d,"x").concat(v):""},l=new Set(a.map(function(u){return s(u)}));o.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,p=He(d)?i.hot.toVisualRow(d):null,b=He(v)?i.hot.toVisualColumn(v):null;if(!(p===null||b===null)){var _=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,S=s(u);if(_!==void 0&&!l.has(S)){var E=qM(i.engine).get(_);E.validateCell(E.getDataAtCell(p,b),E.getCellMeta(p,b),function(){})}}})}},{key:"syncChangeWithEngine",value:function(o,i,a){var s={row:this.toPhysicalRowPosition(o),col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){kt("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(o,i,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(i,s)){var l={row:this.hot.toPhysicalRow(i),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return tf(u)==="object"&&u!==null?u.value:u}return o}},{key:"onBeforeAutofill",value:function(o,i,a){var s=this,l=function(h){return JM(JM({},h),{},{sheet:s.sheetId})},u={start:l(i.getTopLeftCorner()),end:l(i.getBottomRightCorner())},f={start:l(a.getTopLeftCorner()),end:l(a.getBottomRightCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(an(Tr))||ys(this,iy,It(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(o,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(an(Tr)))if(this.sheetName=REe(this.engine,this.hot.getSettings()[Tr].sheetName),ms(this,iy))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){ys(this,Yi,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),ys(this,Yi,!1)}}}},{key:"onModifyData",value:function(o,i,a,s){if(!(s!=="get"||ms(this,Yi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(o),u=this.isFormulaCellType(l,i);if(!u){var f=this.getCellType(l,i);if(f!=="ARRAY"){gB(a.value)&&(a.value=EEe(a.value));return}}var c={row:o,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId},h=this.engine.getCellValue(c),d=tf(h)==="object"&&h!==null?h.value:h;a.value=d}}},{key:"onModifySourceData",value:function(o,i,a,s){if(!(s!=="get"||ms(this,Yi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(o),u=this.hot.propToCol(i),f=this.isFormulaCellType(l,u);if(!f){var c=this.getCellType(l,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:o,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(o,i){var a=this;if(!bs(i)){var s=[],l=[],u=this.engine.batch(function(){o.forEach(function(f){var c=gs(f,4),h=c[0],d=c[1],v=c[3],p=a.hot.propToCol(d),b=a.hot.toPhysicalRow(h),_=a.hot.toPhysicalColumn(p),S={row:b,col:_,sheet:a.sheetId};b!==null&&_!==null?a.syncChangeWithEngine(h,p,v):s.push([h,p,v]),l.push({address:S})})});s.length&&this.hot.addHookOnce("afterChange",function(){var f=a.engine.batch(function(){s.forEach(function(c){var h=gs(c,3),d=h[0],v=h[1],p=h[2];a.syncChangeWithEngine(d,v,p)})});a.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(o,i){var a=this;if(!bs(i)){var s=[],l=[];o.forEach(function(u){var f=gs(u,4),c=f[0],h=f[1],d=f[3],v=a.hot.propToCol(h);if(!!zr(v)){var p={row:c,col:a.toPhysicalColumnPosition(v),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(p)){kt("Not possible to set source cell data at ".concat(JSON.stringify(p)));return}l.push({address:p}),s.push.apply(s,TEe(a.engine.setCellContents(p,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(o),i]))return!1}},{key:"onBeforeCreateCol",value:function(o,i){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]))return!1}},{key:"onBeforeRemoveRow",value:function(o,i,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(o,i,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(o,i,a){if(!bs(a)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(o),i]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(o,i,a){if(!bs(a)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(o),i]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(o,i,a,s){var l=this;if(!bs(s)){var u=a.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeRows(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(o,i,a,s){var l=this;if(!bs(s)){var u=a.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeColumns(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(o,i,a){var s,l=this;ys(this,Yi,!0);var u=this.hot.getSourceDataArray(a,0,a+(((s=i.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());ys(this,Yi,!1),u.forEach(function(f,c){f.forEach(function(h,d){l.engine.setCellContents({col:d,row:a+c,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(o){this.hot.runHooks("afterFormulasValuesUpdate",o)}},{key:"onEngineNamedExpressionsAdded",value:function(o,i){this.hot.runHooks("afterNamedExpressionAdded",o,i)}},{key:"onEngineNamedExpressionsRemoved",value:function(o,i){this.hot.runHooks("afterNamedExpressionRemoved",o,i)}},{key:"onEngineSheetAdded",value:function(o){this.hot.runHooks("afterSheetAdded",o)}},{key:"onEngineSheetRenamed",value:function(o,i){this.hot.runHooks("afterSheetRenamed",o,i)}},{key:"onEngineSheetRemoved",value:function(o,i){this.hot.runHooks("afterSheetRemoved",o,i)}}],[{key:"PLUGIN_KEY",get:function(){return Tr}},{key:"PLUGIN_PRIORITY",get:function(){return UEe}}]),r}(vt);function YEe(e,t){return qEe(e)||XEe(e,t)||KEe(e,t)||GEe()}function GEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KEe(e,t){if(!!e){if(typeof e=="string")return r$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r$(e,t)}}function r$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XEe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function qEe(e){if(Array.isArray(e))return e}function QEe(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=YEe(r,4),i=o[1],a=o[3];i-a!==0&&(n=1)}return this.getTranslatedPhrase(DR,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.col,o.col),0),a=Math.max(n.col,o.col),s=[],l=i;l<=a;l+=1)s.push(l);var u=s[0],f=s[s.length-1],c=this.columnIndexMapper.getFirstNotHiddenIndex(f+1,1,!0,u-1);e.hideColumns(s),Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Lc(e){return tTe(e)||eTe(e)||JEe(e)||ZEe()}function ZEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JEe(e,t){if(!!e){if(typeof e=="string")return F_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F_(e,t)}}function eTe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tTe(e){if(Array.isArray(e))return F_(e)}function F_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rTe(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(xR,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.columnIndexMapper.getFirstNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.columnIndexMapper.getFirstNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=a-i+1===this.countCols();s||this.selectColumns(i,a)}},disabled:!1,hidden:function(){var n=this,o=et(e.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopLeftCorner().col,s=i.getBottomRightCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(a),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,v=f-u+1;if(d>v){var p=c.slice(a,s+1);h.push.apply(h,Lc(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Lc(c.slice(0,a)));else if(u===null)h.push.apply(h,Lc(c.slice(0,this.countCols())));else{var b=this.countCols()-1,_=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(b,-1));f===_&&b>s&&h.push.apply(h,Lc(c.slice(s+1)))}return P(h,function(S){t.push(n.toVisualColumn(S))}),t.length===0}}}function j_(e){return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j_(e)}function nTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oTe(e,t,r){return t&&n$(e.prototype,t),r&&n$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function va(){return typeof Reflect!="undefined"&&Reflect.get?va=Reflect.get:va=function(t,r,n){var o=iTe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},va.apply(this,arguments)}function iTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Co(e),e!==null););return e}function aTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B_(e,t)}function B_(e,t){return B_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},B_(e,t)}function sTe(e){var t=uTe();return function(){var n=Co(e),o;if(t){var i=Co(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lTe(this,o)}}function lTe(e,t){if(t&&(j_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V_(e)}function V_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(e){return Co=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Co(e)}function o$(e,t,r){fTe(e,t),t.set(e,r)}function fTe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(e,t){var r=bB(e,t,"get");return cTe(e,r)}function cTe(e,t){return t.get?t.get.call(e):t.value}function au(e,t,r){var n=bB(e,t,"set");return hTe(e,n,r),r}function bB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Ae.getSingleton().register("beforeHideColumns");Ae.getSingleton().register("afterHideColumns");Ae.getSingleton().register("beforeUnhideColumns");Ae.getSingleton().register("afterUnhideColumns");var ay="hiddenColumns",dTe=310,Mn=new WeakMap,$n=new WeakMap,vTe=function(e){aTe(r,e);var t=sTe(r);function r(){var n;nTe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),o$(V_(n),Mn,{writable:!0,value:{}}),o$(V_(n),$n,{writable:!0,value:null}),n}return oTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ay]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[ay];Ze(i)&&(au(this,Mn,i),It(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),au(this,$n,new Nv),Br(this,$n).addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Br(this,$n)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return o.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return o.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return o.onAfterGetColHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),va(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),va(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),au(this,Mn,{}),va(Co(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(o){var i=this,a=this.getHiddenColumns(),s=this.isValidConfig(o),l=a,u=Br(this,$n).getValues().slice(),f=o.length>0;if(s&&f){var c=o.map(function(d){return i.hot.toPhysicalColumn(d)});P(c,function(d){u[d]=!1}),l=zt(u,function(d,v,p){return v&&d.push(i.hot.toVisualColumn(p)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,l,s&&f);h!==!1&&(s&&f&&Br(this,$n).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&f,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showColumns(i)}},{key:"hideColumns",value:function(o){var i=this,a=this.getHiddenColumns(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideColumns",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){P(o,function(f){Br(i,$n).setValueAtIndex(i.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideColumns(i)}},{key:"getHiddenColumns",value:function(){var o=this;return et(Br(this,$n).getHiddenIndexes(),function(i){return o.hot.toVisualColumn(i)})}},{key:"isHidden",value:function(o){return Br(this,$n).getValueAtIndex(this.hot.toPhysicalColumn(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countCols();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){P(this.hot.getCellsMeta(),function(o){o&&(o.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(o,i){if(this.isHidden(i))return 0;if(Br(this,Mn).indicators&&(this.isHidden(i+1)||this.isHidden(i-1))&&typeof o=="number"&&this.hot.hasColHeaders())return o+15}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Br(this,Mn).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipColumnOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Br(this,Mn).copyPasteEnabled)return o;var a=[],s=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return P(o,function(l){var u=!0,f=0;Ie(l.startCol,l.endCol,function(c){i.isHidden(c)?(u||s(l.startRow,l.endRow,f,c-1),u=!0):(u&&(f=c),c===l.endCol&&s(l.startRow,l.endRow,f,c),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(o,i){if(!(!Br(this,Mn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenColumn"),o<this.hot.countCols()-1&&this.isHidden(o+1)&&a.push("beforeHiddenColumn"),le(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:rt},QEe(this),rTe(this))}},{key:"onMapInit",value:function(){Array.isArray(Br(this,Mn).columns)&&this.hideColumns(Br(this,Mn).columns)}},{key:"destroy",value:function(){au(this,Mn,null),au(this,$n,null),va(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ay}},{key:"PLUGIN_PRIORITY",get:function(){return dTe}}]),r}(vt);function pTe(e,t){return bTe(e)||mTe(e,t)||yTe(e,t)||gTe()}function gTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yTe(e,t){if(!!e){if(typeof e=="string")return i$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i$(e,t)}}function i$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function bTe(e){if(Array.isArray(e))return e}function wTe(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var o=pTe(r,3),i=o[0],a=o[2];i-a!==0&&(n=1)}return this.getTranslatedPhrase(NR,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,o=r.to,i=Math.max(Math.min(n.row,o.row),0),a=Math.max(n.row,o.row),s=[],l=i;l<=a;l+=1)s.push(l);var u=s[0],f=s[s.length-1],c=this.rowIndexMapper.getFirstNotHiddenIndex(f+1,1,!0,u-1);e.hideRows(s),Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Fc(e){return OTe(e)||CTe(e)||STe(e)||_Te()}function _Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function STe(e,t){if(!!e){if(typeof e=="string")return W_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W_(e,t)}}function CTe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OTe(e){if(Array.isArray(e))return W_(e)}function W_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RTe(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(HR,n)},callback:function(){var n,o;if(t.length!==0){var i=t[0],a=t[t.length-1];i=(n=this.rowIndexMapper.getFirstNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,a=(o=this.rowIndexMapper.getFirstNotHiddenIndex(a+1,1))!==null&&o!==void 0?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=a-i+1===this.countRows();s||this.selectRows(i,a)}},disabled:!1,hidden:function(){var n=this,o=et(e.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||o.length<1)return!0;t.length=0;var i=this.getSelectedRangeLast(),a=i.getTopLeftCorner().row,s=i.getBottomRightCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(a),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,v=f-u+1;if(d>v){var p=c.slice(a,s+1);h.push.apply(h,Fc(p.filter(function(S){return o.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Fc(c.slice(0,a)));else if(u===null)h.push.apply(h,Fc(c.slice(0,this.countRows())));else{var b=this.countRows()-1,_=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(b,-1));f===_&&b>s&&h.push.apply(h,Fc(c.slice(s+1)))}return P(h,function(S){t.push(n.toVisualRow(S))}),t.length===0}}}function U_(e){return U_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U_(e)}function ETe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function TTe(e,t,r){return t&&a$(e.prototype,t),r&&a$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pa(){return typeof Reflect!="undefined"&&Reflect.get?pa=Reflect.get:pa=function(t,r,n){var o=kTe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},pa.apply(this,arguments)}function kTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oo(e),e!==null););return e}function ATe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z_(e,t)}function z_(e,t){return z_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},z_(e,t)}function ITe(e){var t=MTe();return function(){var n=Oo(e),o;if(t){var i=Oo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return PTe(this,o)}}function PTe(e,t){if(t&&(U_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y_(e)}function Y_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(e){return Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Oo(e)}function s$(e,t,r){$Te(e,t),t.set(e,r)}function $Te(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(e,t){var r=wB(e,t,"get");return DTe(e,r)}function DTe(e,t){return t.get?t.get.call(e):t.value}function su(e,t,r){var n=wB(e,t,"set");return xTe(e,n,r),r}function wB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function xTe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Ae.getSingleton().register("beforeHideRows");Ae.getSingleton().register("afterHideRows");Ae.getSingleton().register("beforeUnhideRows");Ae.getSingleton().register("afterUnhideRows");var sy="hiddenRows",NTe=320,Zn=new WeakMap,Dn=new WeakMap,HTe=function(e){ATe(r,e);var t=ITe(r);function r(){var n;ETe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),s$(Y_(n),Zn,{writable:!0,value:{}}),s$(Y_(n),Dn,{writable:!0,value:null}),n}return TTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[sy];Ze(i)&&(su(this,Zn,i),It(i.copyPasteEnabled)&&(i.copyPasteEnabled=!0)),su(this,Dn,new Nv),Jr(this,Dn).addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Jr(this,Dn)),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return o.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return o.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("modifyCopyableRange",function(a){return o.onModifyCopyableRange(a)}),pa(Oo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),su(this,Zn,{}),pa(Oo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(o){var i=this,a=this.getHiddenRows(),s=this.isValidConfig(o),l=a,u=Jr(this,Dn).getValues().slice(),f=o.length>0;if(s&&f){var c=o.map(function(d){return i.hot.toPhysicalRow(d)});P(c,function(d){u[d]=!1}),l=zt(u,function(d,v,p){return v&&d.push(i.hot.toVisualRow(p)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,l,s&&f);h!==!1&&(s&&f&&Jr(this,Dn).setValues(u),this.hot.runHooks("afterUnhideRows",a,l,s&&f,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.showRows(i)}},{key:"hideRows",value:function(o){var i=this,a=this.getHiddenRows(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeHideRows",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){P(o,function(f){Jr(i,Dn).setValueAtIndex(i.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.hideRows(i)}},{key:"getHiddenRows",value:function(){var o=this;return et(Jr(this,Dn).getHiddenIndexes(),function(i){return o.hot.toVisualRow(i)})}},{key:"isHidden",value:function(o){return Jr(this,Dn).getValueAtIndex(this.hot.toPhysicalRow(o))||!1}},{key:"isValidConfig",value:function(o){var i=this.hot.countRows();return Array.isArray(o)&&o.length>0?o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i}):!1}},{key:"resetCellsMeta",value:function(){P(this.hot.getCellsMeta(),function(o){o&&(o.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(o,i){return this.isHidden(i)?0:o}},{key:"onAfterGetCellMeta",value:function(o,i,a){if(Jr(this,Zn).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipRowOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(o){var i=this;if(Jr(this,Zn).copyPasteEnabled)return o;var a=[],s=function(u,f,c,h){a.push({startRow:u,endRow:f,startCol:c,endCol:h})};return P(o,function(l){var u=!0,f=0;Ie(l.startRow,l.endRow,function(c){i.isHidden(c)?(u||s(f,c-1,l.startCol,l.endCol),u=!0):(u&&(f=c),c===l.endRow&&s(f,c,l.startCol,l.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(o,i){if(!(!Jr(this,Zn).indicators||o<0)){var a=[];o>=1&&this.isHidden(o-1)&&a.push("afterHiddenRow"),o<this.hot.countRows()-1&&this.isHidden(o+1)&&a.push("beforeHiddenRow"),le(i,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(o){o.items.push({name:rt},wTe(this),RTe(this))}},{key:"onMapInit",value:function(){Array.isArray(Jr(this,Zn).rows)&&this.hideRows(Jr(this,Zn).rows)}},{key:"destroy",value:function(){su(this,Zn,null),su(this,Dn,null),pa(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sy}},{key:"PLUGIN_PRIORITY",get:function(){return NTe}}]),r}(vt);function LTe(e,t){return VTe(e)||BTe(e,t)||jTe(e,t)||FTe()}function FTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jTe(e,t){if(!!e){if(typeof e=="string")return l$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l$(e,t)}}function l$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function VTe(e){if(Array.isArray(e))return e}function WTe(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(fR)},callback:function(r,n){var o=LTe(n,1),i=o[0].start.col;e.freezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(n=!0),n}}}function UTe(e,t){return KTe(e)||GTe(e,t)||YTe(e,t)||zTe()}function zTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YTe(e,t){if(!!e){if(typeof e=="string")return u$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u$(e,t)}}function u$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GTe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function KTe(e){if(Array.isArray(e))return e}function XTe(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(cR)},callback:function(r,n){var o=UTe(n,1),i=o[0].start.col;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsLeft)&&(n=!0),n}}}function G_(e){return G_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G_(e)}function qTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QTe(e,t,r){return t&&f$(e.prototype,t),r&&f$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Us(){return typeof Reflect!="undefined"&&Reflect.get?Us=Reflect.get:Us=function(t,r,n){var o=ZTe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Us.apply(this,arguments)}function ZTe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mi(e),e!==null););return e}function JTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},K_(e,t)}function e0e(e){var t=r0e();return function(){var n=mi(e),o;if(t){var i=mi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return t0e(this,o)}}function t0e(e,t){if(t&&(G_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _B(e)}function _B(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},mi(e)}var c$="manualColumnFreeze",n0e=110,lu=new WeakMap,o0e=function(e){JTe(r,e);var t=e0e(r);function r(n){var o;return qTe(this,r),o=t.call(this,n),lu.set(_B(o),{afterFirstUse:!1}),o}return QTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[c$]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(i){return o.addContextMenuEntry(i)}),this.addHook("beforeColumnMove",function(i,a){return o.onBeforeColumnMove(i,a)}),Us(mi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var o=lu.get(this);o.afterFirstUse=!1,Us(mi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Us(mi(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(o){var i=lu.get(this),a=this.hot.getSettings();i.afterFirstUse||(i.afterFirstUse=!0),!(a.fixedColumnsLeft===this.hot.countCols()||o<=a.fixedColumnsLeft-1)&&(this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsLeft),a.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(o){var i=lu.get(this),a=this.hot.getSettings();i.afterFirstUse||(i.afterFirstUse=!0),!(a.fixedColumnsLeft<=0||o>a.fixedColumnsLeft-1)&&(a.fixedColumnsLeft-=1,this.hot.columnIndexMapper.moveIndexes(o,a.fixedColumnsLeft))}},{key:"addContextMenuEntry",value:function(o){o.items.push({name:"---------"},WTe(this),XTe(this))}},{key:"onBeforeColumnMove",value:function(o,i){var a=lu.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsLeft;if(i<s||o.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return c$}},{key:"PLUGIN_PRIORITY",get:function(){return n0e}}]),r}(vt);function i0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a0e(e,t,r){return t&&h$(e.prototype,t),r&&h$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var ly=0,d$=1,v$=2,ws="px",s0e=function(){function e(t){i0e(this,e),this.hot=t,this._element=null,this.state=ly}return a0e(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=v$}},{key:"build",value:function(){this.state===ly&&(this._element=this.hot.rootDocument.createElement("div"),this.state=d$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ly}},{key:"isAppended",value:function(){return this.state===v$}},{key:"isBuilt",value:function(){return this.state>=d$}},{key:"setPosition",value:function(r,n){zr(r)&&(this._element.style.top=r+ws),zr(n)&&(this._element.style.left=n+ws)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){zr(r)&&(this._element.style.width=r+ws),zr(n)&&(this._element.style.height=n+ws)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){zr(r)&&(this._element.style.marginTop=r+ws),zr(n)&&(this._element.style.marginLeft=n+ws)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}(),SB=s0e;function X_(e){return X_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X_(e)}function l0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u0e(e,t,r){return t&&p$(e.prototype,t),r&&p$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eh(){return typeof Reflect!="undefined"&&Reflect.get?Eh=Reflect.get:Eh=function(t,r,n){var o=f0e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eh.apply(this,arguments)}function f0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vl(e),e!==null););return e}function c0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q_(e,t)}function q_(e,t){return q_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},q_(e,t)}function h0e(e){var t=p0e();return function(){var n=vl(e),o;if(t){var i=vl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return d0e(this,o)}}function d0e(e,t){if(t&&(X_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v0e(e)}function v0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vl(e){return vl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},vl(e)}var g0e="ht__manualColumnMove--backlight",y0e=function(e){c0e(r,e);var t=h0e(r);function r(){return l0e(this,r),t.apply(this,arguments)}return u0e(r,[{key:"build",value:function(){Eh(vl(r.prototype),"build",this).call(this),le(this._element,g0e)}}]),r}(SB),m0e=y0e;function Q_(e){return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q_(e)}function b0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w0e(e,t,r){return t&&g$(e.prototype,t),r&&g$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Th(){return typeof Reflect!="undefined"&&Reflect.get?Th=Reflect.get:Th=function(t,r,n){var o=_0e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Th.apply(this,arguments)}function _0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pl(e),e!==null););return e}function S0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z_(e,t)}function Z_(e,t){return Z_=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Z_(e,t)}function C0e(e){var t=E0e();return function(){var n=pl(e),o;if(t){var i=pl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return O0e(this,o)}}function O0e(e,t){if(t&&(Q_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R0e(e)}function R0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pl(e){return pl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},pl(e)}var T0e="ht__manualColumnMove--guideline",k0e=function(e){S0e(r,e);var t=C0e(r);function r(){return b0e(this,r),t.apply(this,arguments)}return w0e(r,[{key:"build",value:function(){Th(pl(r.prototype),"build",this).call(this),le(this._element,T0e)}}]),r}(SB),A0e=k0e;function J_(e){return J_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J_(e)}function I0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P0e(e,t,r){return t&&y$(e.prototype,t),r&&y$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ga(){return typeof Reflect!="undefined"&&Reflect.get?ga=Reflect.get:ga=function(t,r,n){var o=M0e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ga.apply(this,arguments)}function M0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ro(e),e!==null););return e}function $0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eS(e,t)}function eS(e,t){return eS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},eS(e,t)}function D0e(e){var t=N0e();return function(){var n=Ro(e),o;if(t){var i=Ro(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return x0e(this,o)}}function x0e(e,t){if(t&&(J_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tS(e)}function tS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(e){return Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(e)}Ae.getSingleton().register("beforeColumnMove");Ae.getSingleton().register("afterColumnMove");var uy="manualColumnMove",H0e=120,Ko=new WeakMap,m$="ht__manualColumnMove",jc="show-ui",fy="on-moving--columns",cy="after-selection--columns",L0e=function(e){$0e(r,e);var t=D0e(r);function r(n){var o;return I0e(this,r),o=t.call(this,n),Ko.set(tS(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new bt(tS(o)),o.backlight=new m0e(n),o.guideline=new A0e(n),o}return P0e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[uy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollVertically",function(){return o.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),le(this.hot.rootElement,m$),ga(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ga(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ge(this.hot.rootElement,m$),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ga(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(o,i){return this.moveColumns([o],i)}},{key:"moveColumns",value:function(o,i){var a=Ko.get(this),s=a.cachedDropIndex,l=this.isMovePossible(o,i),u=this.hot.runHooks("beforeColumnMove",o,i,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(o,i);var f=l&&this.isColumnOrderChanged(o,i);return this.hot.runHooks("afterColumnMove",o,i,s,l,f),f}}},{key:"dragColumn",value:function(o,i){return this.dragColumns([o],i)}},{key:"dragColumns",value:function(o,i){var a=this.countFinalIndex(o,i),s=Ko.get(this);return s.cachedDropIndex=i,this.moveColumns(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=o.length+i>a,l=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(s||l||u||f)}},{key:"isColumnOrderChanged",value:function(o,i){return o.some(function(a,s){return a-s!==i})}},{key:"countFinalIndex",value:function(o,i){var a=zt(o,function(s,l){return l<i&&(s+=1),s},0);return i-a}},{key:"getColumnsWidth",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=0,l=o;l<=i;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view.wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[uy];if(Array.isArray(o))this.moveColumns(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveColumns(i,0)}}},{key:"isFixedColumnsLeft",value:function(o){return o<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",o),o.value?o.value:[]}},{key:"prepareColumnsToMoving",value:function(o,i){var a=[];return Ie(o,i,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var o=Ko.get(this),i=this.hot.view.wt.wtTable.getFirstVisibleColumn(),a=this.hot.view.wt.wtTable.getLastVisibleColumn(),s=this.hot.view.wt.wtTable,l=this.hot.view.wt.wtOverlays.scrollableElement,u=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,f=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,o.coords-1),c=o.target.eventPageX-(o.rootElementOffset-(l.scrollX===void 0?u:0)),h=s.hider.offsetWidth,d=s.TBODY.offsetLeft,v=this.backlight.getOffset().left,p=this.backlight.getSize().width,b=0;if(o.rootElementOffset+s.holder.offsetWidth+u<o.target.eventPageX&&o.coords<o.countCols&&(o.coords+=1),o.hasRowHeaders&&(b=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(o.coords)&&(f+=u),f+=b,o.coords<0)o.fixedColumns>0?o.target.col=0:o.target.col=i>0?i-1:i;else if(o.target.TD.offsetWidth/2+f<=c){var _=o.coords>=o.countCols?o.countCols-1:o.coords;o.target.col=_+1,f+=o.target.TD.offsetWidth,o.target.col>a&&a<o.countCols&&this.hot.scrollViewportTo(void 0,a+1,void 0,!0)}else o.target.col=o.coords,o.target.col<=i&&o.target.col>=o.fixedColumns&&i>0&&this.hot.scrollViewportTo(void 0,i-1);o.target.col<=i&&o.target.col>=o.fixedColumns&&i>0&&this.hot.scrollViewportTo(void 0,i-1);var S=c,E=f;c+p+v>=h?S=h-p-v:c+v<d+b&&(S=d+b+Math.abs(v)),f>=h-1?E=h-1:E===0?E=1:l.scrollX!==void 0&&o.coords<o.fixedColumns&&(E-=o.rootElementOffset<=l.scrollX?o.rootElementOffset:0),this.backlight.setPosition(null,S),this.guideline.setPosition(null,E)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this.hot.view.wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Ko.get(this),h=Ve(o.target,"sortAction");if(!f||!u||c.pressed||o.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Ge(this.hot.rootElement,[fy,jc]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var p=f.from,b=f.to,_=Math.min(p.col,b.col),S=Math.max(p.col,b.col);if(i.row<0&&i.col>=_&&i.col<=S){s.column=!0,c.pressed=!0,c.target.eventPageX=o.pageX,c.coords=i.col,c.target.TD=a,c.target.col=i.col,c.columnsToMove=this.prepareColumnsToMoving(_,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumns=this.hot.getSettings().fixedColumnsLeft,c.rootElementOffset=Dt(this.hot.rootElement).left;var E=c.hasRowHeaders?-1:0,M=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,k=i.col<c.fixedColumns,U=this.hot.view.wt.wtOverlays.scrollableElement,Y=U.scrollX?U.scrollX-c.rootElementOffset:0,ne=o.offsetX-(k?Y:0),Z=Math.abs(this.getColumnsWidth(_,i.col-1)+ne);this.backlight.setPosition(M,this.getColumnsWidth(E,_-1)+Z),this.backlight.setSize(this.getColumnsWidth(_,S),l.hider.offsetHeight-M),this.backlight.setOffset(null,Z*-1),le(this.hot.rootElement,fy)}else Ge(this.hot.rootElement,cy),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Ko.get(this);if(!!i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}i.target.eventPageX=o.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l=this.hot.getSelectedRangeLast(),u=Ko.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(i.col)>-1?Ge(this.hot.rootElement,jc):le(this.hot.rootElement,jc),s.row=!0,s.column=!0,s.cell=!0,u.coords=i.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Ko.get(this),i=o.target.col,a=o.columnsToMove.length;if(o.coords=void 0,o.pressed=!1,o.backlightWidth=0,Ge(this.hot.rootElement,[fy,jc,cy]),this.hot.selection.isSelectedByColumnHeader()&&le(this.hot.rootElement,cy),!(a<1||i===void 0)){var s=o.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(o.columnsToMove,i);if(o.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),c=f+a-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var o=this.hot.view.wt.wtTable,i=o.getColumnHeaderHeight(0)+1,a=o.holder.scrollTop,s=i+a;this.backlight.setPosition(s),this.backlight.setSize(null,o.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ga(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uy}},{key:"PLUGIN_PRIORITY",get:function(){return H0e}}]),r}(vt);function rS(e){return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(e)}function F0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j0e(e,t,r){return t&&b$(e.prototype,t),r&&b$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ya(){return typeof Reflect!="undefined"&&Reflect.get?ya=Reflect.get:ya=function(t,r,n){var o=B0e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ya.apply(this,arguments)}function B0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eo(e),e!==null););return e}function V0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nS(e,t)}function nS(e,t){return nS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},nS(e,t)}function W0e(e){var t=z0e();return function(){var n=Eo(e),o;if(t){var i=Eo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return U0e(this,o)}}function U0e(e,t){if(t&&(rS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oS(e)}function oS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Eo(e)}var Bc="manualColumnResize",Y0e=130,w$="manualColumnWidths",hy=new WeakMap,G0e=function(e){V0e(r,e);var t=W0e(r);function r(n){var o;F0e(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new bt(oS(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,hy.set(oS(o),{config:void 0}),le(o.handle,"manualColumnResizer"),le(o.guide,"manualColumnResizerGuide"),o}return j0e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Bc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.columnWidthsMap=new $i,this.columnWidthsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(i,a){return o.onModifyColWidth(i,a)}),this.addHook("beforeStretchingColumnWidth",function(i,a){return o.onBeforeStretchingColumnWidth(i,a)}),this.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),this.bindEvents(),ya(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ya(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=hy.get(this);o.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ya(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",w$,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",w$,o),o.value}},{key:"setManualSize",value:function(o,i){var a=Math.max(i,20),s=this.hot.toPhysicalColumn(o);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(o){var i=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(i,null)}},{key:"onMapInit",value:function(){var o=this,i=hy.get(this),a=this.hot.getSettings()[Bc],s=this.loadManualColumnWidths();typeof s!="undefined"?this.hot.batchExecution(function(){s.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0),i.config=a):a===!0&&Array.isArray(i.config)&&this.hot.batchExecution(function(){i.config.forEach(function(l,u){o.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(o){var i=this;if(!!o.parentNode){this.currentTH=o;var a=this.hot.view.wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=Ut(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=l<a.getSetting("fixedColumnsLeft"),h;c&&(h=a.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();P(v,function(p){var b=p.getTopLeftCorner().col,_=p.getBottomRightCorner().col;Ie(b,_,function(S){i.selectedCols.includes(S)||i.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.left-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Ut(this.handle),10),i=parseInt(this.handle.style.top,10)+o,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);le(this.handle,"active"),le(this.guide,"active"),this.guide.style.top="".concat(i,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Ge(this.handle,"active"),Ge(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(o){return!!xo(o,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"onMouseOver",value:function(o){if(!CO(o.target)&&this.checkIfColumnHeader(o.target)){var i=this.getClosestTHParent(o.target);if(!i)return;var a=i.getAttribute("colspan");i&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeColumnResize",o.newSize,u,!0);c!==void 0&&(o.newSize=c),o.hot.getSettings().stretchH==="all"?o.clearManualSize(u):o.setManualSize(u,o.newSize),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!0),f&&i()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(P(this.selectedCols,function(l){a(l)}),i()):P(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;Ve(o.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=o.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentWidth=this.startWidth+(o.pageX-this.startX),P(this.selectedCols,function(a){i.newSize=i.setManualSize(a,i.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeColumnResize",o.newSize,u,!1),f&&i(),o.saveManualColumnWidths(),o.hot.runHooks("afterColumnResize",o.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(P(this.selectedCols,function(l){a(l)}),i()):P(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootWindow,s=i.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return o.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return o.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return o.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyColWidth",value:function(o,i){var a=o;if(this.enabled){var s=this.hot.toPhysicalColumn(i),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[Bc]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(o,i){var a=this.columnWidthsMap.getValueAtIndex(i);return a===null&&(a=o),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ya(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bc}},{key:"PLUGIN_PRIORITY",get:function(){return Y0e}}]),r}(vt);function K0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X0e(e,t,r){return t&&_$(e.prototype,t),r&&_$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var dy=0,S$=1,C$=2,_s="px",q0e=function(){function e(t){K0e(this,e),this.hot=t,this._element=null,this.state=dy}return X0e(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=C$}},{key:"build",value:function(){this.state===dy&&(this._element=this.hot.rootDocument.createElement("div"),this.state=S$)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=dy}},{key:"isAppended",value:function(){return this.state===C$}},{key:"isBuilt",value:function(){return this.state>=S$}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+_s),n!==void 0&&(this._element.style.left=n+_s)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+_s),n&&(this._element.style.height=n+_s)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+_s),n&&(this._element.style.marginLeft=n+_s)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}(),CB=q0e;function iS(e){return iS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iS(e)}function Q0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z0e(e,t,r){return t&&O$(e.prototype,t),r&&O$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kh(){return typeof Reflect!="undefined"&&Reflect.get?kh=Reflect.get:kh=function(t,r,n){var o=J0e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},kh.apply(this,arguments)}function J0e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gl(e),e!==null););return e}function eke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aS(e,t)}function aS(e,t){return aS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},aS(e,t)}function tke(e){var t=oke();return function(){var n=gl(e),o;if(t){var i=gl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return rke(this,o)}}function rke(e,t){if(t&&(iS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nke(e)}function nke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gl(e){return gl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},gl(e)}var ike="ht__manualRowMove--backlight",ake=function(e){eke(r,e);var t=tke(r);function r(){return Q0e(this,r),t.apply(this,arguments)}return Z0e(r,[{key:"build",value:function(){kh(gl(r.prototype),"build",this).call(this),le(this._element,ike)}}]),r}(CB),ske=ake;function sS(e){return sS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sS(e)}function lke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uke(e,t,r){return t&&R$(e.prototype,t),r&&R$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ah(){return typeof Reflect!="undefined"&&Reflect.get?Ah=Reflect.get:Ah=function(t,r,n){var o=fke(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ah.apply(this,arguments)}function fke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yl(e),e!==null););return e}function cke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lS(e,t)}function lS(e,t){return lS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},lS(e,t)}function hke(e){var t=pke();return function(){var n=yl(e),o;if(t){var i=yl(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return dke(this,o)}}function dke(e,t){if(t&&(sS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vke(e)}function vke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yl(e){return yl=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},yl(e)}var gke="ht__manualRowMove--guideline",yke=function(e){cke(r,e);var t=hke(r);function r(){return lke(this,r),t.apply(this,arguments)}return uke(r,[{key:"build",value:function(){Ah(yl(r.prototype),"build",this).call(this),le(this._element,gke)}}]),r}(CB),mke=yke;function uS(e){return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uS(e)}function bke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wke(e,t,r){return t&&E$(e.prototype,t),r&&E$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ma(){return typeof Reflect!="undefined"&&Reflect.get?ma=Reflect.get:ma=function(t,r,n){var o=_ke(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ma.apply(this,arguments)}function _ke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=To(e),e!==null););return e}function Ske(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fS(e,t)}function fS(e,t){return fS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},fS(e,t)}function Cke(e){var t=Rke();return function(){var n=To(e),o;if(t){var i=To(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return Oke(this,o)}}function Oke(e,t){if(t&&(uS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cS(e)}function cS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(e){return To=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},To(e)}Ae.getSingleton().register("beforeRowMove");Ae.getSingleton().register("afterRowMove");var vy="manualRowMove",Eke=140,Xo=new WeakMap,T$="ht__manualRowMove",Vc="show-ui",py="on-moving--rows",gy="after-selection--rows",Tke=function(e){Ske(r,e);var t=Cke(r);function r(n){var o;return bke(this,r),o=t.call(this,n),Xo.set(cS(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new bt(cS(o)),o.backlight=new ske(n),o.guideline=new mke(n),o}return wke(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterScrollHorizontally",function(){return o.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.buildPluginUI(),this.registerEvents(),le(this.hot.rootElement,T$),ma(To(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ma(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ge(this.hot.rootElement,T$),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ma(To(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(o,i){return this.moveRows([o],i)}},{key:"moveRows",value:function(o,i){var a=Xo.get(this),s=a.cachedDropIndex,l=this.isMovePossible(o,i),u=this.hot.runHooks("beforeRowMove",o,i,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(o,i);var f=l&&this.isRowOrderChanged(o,i);return this.hot.runHooks("afterRowMove",o,i,s,l,f),f}}},{key:"dragRow",value:function(o,i){return this.dragRows([o],i)}},{key:"dragRows",value:function(o,i){var a=this.countFinalIndex(o,i),s=Xo.get(this);return s.cachedDropIndex=i,this.moveRows(o,a)}},{key:"isMovePossible",value:function(o,i){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=o.length+i>a,l=i<0,u=o.some(function(c){return c<0}),f=o.some(function(c){return c>=a});return!(s||l||u||f)}},{key:"isRowOrderChanged",value:function(o,i){return o.some(function(a,s){return a-s!==i})}},{key:"countFinalIndex",value:function(o,i){var a=zt(o,function(s,l){return l<i&&(s+=1),s},0);return i-a}},{key:"getRowsHeight",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=0,l=o;l<=i;l++){var u=a.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view.wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var o=this.hot.getSettings()[vy];if(Array.isArray(o))this.moveRows(o,0);else if(o!==void 0){var i=this.persistentStateLoad();i.length&&this.moveRows(i,0)}}},{key:"isFixedRowTop",value:function(o){return o<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(o){return o>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var o={};return this.hot.runHooks("persistentStateLoad","manualRowMove",o),o.value?o.value:[]}},{key:"prepareRowsToMoving",value:function(){var o=this.hot.getSelectedRangeLast(),i=[];if(!o)return i;var a=o.from,s=o.to,l=Math.min(a.row,s.row),u=Math.max(a.row,s.row);return Ie(l,u,function(f){i.push(f)}),i}},{key:"refreshPositions",value:function(){var o=Xo.get(this),i=o.target.coords,a=this.hot.view.wt.wtTable.getFirstVisibleRow(),s=this.hot.view.wt.wtTable.getLastVisibleRow(),l=this.hot.getSettings().fixedRowsTop,u=this.hot.countRows();i.row<l&&a>0&&this.hot.scrollViewportTo(a-1),i.row>=s&&s<u&&this.hot.scrollViewportTo(s+1,void 0,!0);var f=this.hot.view.wt.wtTable,c=o.target.TD,h=Dt(this.hot.rootElement),d=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,i.row-1),v=o.target.eventPageY-h.top+f.holder.scrollTop,p=f.hider.offsetHeight,b=f.TBODY.offsetTop,_=this.backlight.getOffset().top,S=this.backlight.getSize().height;this.isFixedRowTop(i.row)&&(d+=f.holder.scrollTop),i.row<0?o.target.row=a>0?a-1:a:c.offsetHeight/2+d<=v?(o.target.row=i.row+1,d+=i.row===0?c.offsetHeight-1:c.offsetHeight):o.target.row=i.row;var E=v,M=d;v+S+_>=p?E=p-S-_:v+_<b&&(E=b+Math.abs(_)),d>=p-1&&(M=p-1);var k=0;this.hot.view.wt.wtOverlays.topOverlay&&(k=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),i.row>=l&&M-f.holder.scrollTop<k&&this.hot.scrollViewportTo(i.row),this.backlight.setPosition(E),this.guideline.setPosition(M)}},{key:"registerEvents",value:function(){var o=this,i=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(i,"mousemove",function(a){return o.onMouseMove(a)}),this.eventManager.addEventListener(i,"mouseup",function(){return o.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this.hot.view.wt,u=l.wtTable,f=l.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Xo.get(this);if(!h||!c||d.pressed||o.button!==0){d.pressed=!1,d.rowsToMove.length=0,Ge(this.hot.rootElement,[py,Vc]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&p&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var b=h.from,_=h.to,S=Math.min(b.row,_.row),E=Math.max(b.row,_.row);if(i.col<0&&i.row>=S&&i.row<=E){s.row=!0,d.pressed=!0,d.target.eventPageY=o.pageY,d.target.coords=i,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var M=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,M),this.backlight.setSize(u.hider.offsetWidth-M,this.getRowsHeight(S,E)),this.backlight.setOffset((this.getRowsHeight(S,i.row-1)+o.offsetY)*-1,null),le(this.hot.rootElement,py),this.refreshPositions()}else Ge(this.hot.rootElement,gy),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(o){var i=Xo.get(this);if(!!i.pressed){if(o.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}i.target.eventPageY=o.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l=this.hot.getSelectedRangeLast(),u=Xo.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(i.row)>-1?Ge(this.hot.rootElement,Vc):le(this.hot.rootElement,Vc),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=i,u.target.TD=a)}},{key:"onMouseUp",value:function(){var o=Xo.get(this),i=o.target.row,a=o.rowsToMove.length;if(o.pressed=!1,o.backlightHeight=0,Ge(this.hot.rootElement,[py,Vc,gy]),this.hot.selection.isSelectedByRowHeader()&&le(this.hot.rootElement,gy),!(a<1||i===void 0)){var s=o.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(o.rowsToMove,i);if(o.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),c=f+a-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var o=this.hot.view.wt.wtTable,i=this.hot.view.wt.wtViewport.getRowHeaderWidth(),a=o.holder.scrollLeft,s=i+a;this.backlight.setPosition(null,s),this.backlight.setSize(o.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ma(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return vy}},{key:"PLUGIN_PRIORITY",get:function(){return Eke}}]),r}(vt);function hS(e){return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hS(e)}function kke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ake(e,t,r){return t&&k$(e.prototype,t),r&&k$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ba(){return typeof Reflect!="undefined"&&Reflect.get?ba=Reflect.get:ba=function(t,r,n){var o=Ike(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ba.apply(this,arguments)}function Ike(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ko(e),e!==null););return e}function Pke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dS(e,t)}function dS(e,t){return dS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},dS(e,t)}function Mke(e){var t=Dke();return function(){var n=ko(e),o;if(t){var i=ko(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return $ke(this,o)}}function $ke(e,t){if(t&&(hS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vS(e)}function vS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(e){return ko=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ko(e)}var Wc="manualRowResize",xke=30,A$="manualRowHeights",yy=new WeakMap,Nke=function(e){Pke(r,e);var t=Mke(r);function r(n){var o;kke(this,r),o=t.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new bt(vS(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,yy.set(vS(o),{config:void 0}),le(o.handle,"manualRowResizer"),le(o.guide,"manualRowResizerGuide"),o}return Ake(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Wc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.rowHeightsMap=new $i,this.rowHeightsMap.addLocalHook("init",function(){return o.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(i,a){return o.onModifyRowHeight(i,a)}),this.bindEvents(),ba(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var o=yy.get(this);o.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ba(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",A$,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var o={};return this.hot.runHooks("persistentStateLoad",A$,o),o.value}},{key:"setManualSize",value:function(o,i){var a=this.hot.toPhysicalRow(o),s=Math.max(i,gL.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(o){var i=this;this.currentTH=o;var a=this.hot.view,s=a.wt,l=a.wt.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var f=Ft(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),v;h?v=s.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(v=s.wtOverlays.bottomLeftCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),v||(v=s.wtOverlays.leftOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){var b=this.hot.getSelectedRange();P(b,function(_){var S=_.getTopLeftCorner().row,E=_.getBottomLeftCorner().row;Ie(S,E,function(M){i.selectedRows.includes(M)||i.selectedRows.push(M)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(v.left,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var o=parseInt(Ft(this.handle),10),i=parseInt(this.handle.style.left,10)+o,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);le(this.handle,"active"),le(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(i,"px"),this.guide.style.width="".concat(a-o,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Ge(this.handle,"active"),Ge(this.guide,"active")}},{key:"checkIfRowHeader",value:function(o){var i,a,s=xo(o,["TH"],this.hot.rootElement);return s&&((i=o.parentNode)===null||i===void 0||(a=i.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(o){return o.tagName!=="TABLE"?o.tagName==="TH"?o:this.getClosestTHParent(o.parentNode):null}},{key:"getActualRowHeight",value:function(o){var i=this.hot.view.wt.wtTable.getRowHeight(o);return i!==void 0&&this.newSize<i?i:this.newSize}},{key:"onMouseOver",value:function(o){if(!CO(o.target)&&this.checkIfRowHeader(o.target)){var i=this.getClosestTHParent(o.target);i&&(this.pressed||this.setupHandlePosition(i))}}},{key:"afterMouseDownTimeout",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){var c=o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!0);c!==void 0&&(o.newSize=c),o.setManualSize(u,o.newSize),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!0),f&&i()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(P(this.selectedRows,function(l){a(l)}),i()):P(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(o){var i=this;Ve(o.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return i.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=o.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(o){var i=this;this.pressed&&(this.currentHeight=this.startHeight+(o.pageY-this.startY),P(this.selectedRows,function(a){i.newSize=i.setManualSize(a,i.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var o=this,i=function(){o.hot.forceFullRender=!0,o.hot.view.render(),o.hot.view.adjustElementsSize(!0)},a=function(u,f){o.hot.runHooks("beforeRowResize",o.getActualRowHeight(u),u,!1),f&&i(),o.saveManualRowHeights(),o.hot.runHooks("afterRowResize",o.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(P(this.selectedRows,function(l){a(l)}),i()):P(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var o=this,i=this.hot,a=i.rootElement,s=i.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return o.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return o.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return o.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return o.onMouseUp()})}},{key:"onModifyRowHeight",value:function(o,i){var a=o;if(this.enabled){var s=this.hot.toPhysicalRow(i),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[Wc]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var o=this,i=yy.get(this),a=this.hot.getSettings()[Wc],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s!="undefined"?s.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(a)?(a.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)}),i.config=a):a===!0&&Array.isArray(i.config)&&i.config.forEach(function(l,u){o.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){ba(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Wc}},{key:"PLUGIN_PRIORITY",get:function(){return xke}}]),r}(vt),I$,P$,M$,$$;function Uc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Hke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lke(e,t,r){return t&&D$(e.prototype,t),r&&D$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Fke=function(){function e(t,r,n,o){Hke(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1}return Lke(e,[{key:"normalize",value:function(r){var n=r.countRows(),o=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var o=r[0]||r[1],i=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,i),u=Math.max(n,i),f=this[s],c=this[s]+this[a]-1;if(f>=n&&(this[s]+=o),o>0)n<=c&&n>f&&(this[a]+=o);else if(o<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(o)-h;this[s]-=d+o,this[a]-=h}else if(f<=l&&c>=u)this[a]+=o;else if(f<=l&&c>=l&&c<u){var v=c-l+1;this[a]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new Kt(new J(this.row,this.col),new J(this.row,this.col),new J(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Rt(I$||(I$=Uc(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Rt(P$||(P$=Uc(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Rt(M$||(M$=Uc(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Rt($$||($$=Uc(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,o){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=o||r.col+r.colspan-1>=o}}]),e}(),Nn=Fke;function pS(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}var x$;function jke(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function N$(e){return Uke(e)||Wke(e)||Vke(e)||Bke()}function Bke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vke(e,t){if(!!e){if(typeof e=="string")return gS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gS(e,t)}}function Wke(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uke(e){if(Array.isArray(e))return gS(e)}function gS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yke(e,t,r){return t&&H$(e.prototype,t),r&&H$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gke=function(){function e(t){zke(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return Yke(e,[{key:"get",value:function(r,n){var o=this.mergedCells,i=!1;return P(o,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(i=a,!1):!0}),i}},{key:"getByRange",value:function(r){var n=this.mergedCells,o=!1;return P(n,function(i){return i.row<=r.from.row&&i.row+i.rowspan-1>=r.to.row&&i.col<=r.from.col&&i.col+i.colspan-1>=r.to.col?(o=i,o):!0}),o}},{key:"getWithinRange",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,i=[],a=r;if(!a.includesRange){var s=new J(a.from.row,a.from.col),l=new J(a.to.row,a.to.col);a=new Kt(s,s,l)}return P(o,function(u){var f=new J(u.row,u.col),c=new J(u.row+u.rowspan-1,u.col+u.colspan-1),h=new Kt(f,f,c);n?a.overlaps(h)&&i.push(u):a.includesRange(h)&&i.push(u)}),i.length?i:!1}},{key:"add",value:function(r){var n=this.mergedCells,o=r.row,i=r.col,a=r.rowspan,s=r.colspan,l=new Nn(o,i,a,s),u=this.get(o,i),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(kt(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var o=this.mergedCells,i=this.get(r,n),a=i?this.mergedCells.indexOf(i):-1;return i&&a!==-1?(o.splice(a,1),i):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,o=[],i=[];P(n,function(a){var s=r.hot.getCell(a.row,a.col);s&&o.push([s,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,P(o,function(a,s){Ie(0,a.rowspan-1,function(l){Ie(0,a.colspan-1,function(u){if(u!==0||l!==0){var f=r.hot.getCell(a.row+l,a.col+u);f&&i.push([f,null,null,null])}})}),o[s][1]=null}),P(o,function(a){pS.apply(void 0,N$(a))}),P(i,function(a){pS.apply(void 0,N$(a))})}},{key:"isOverlapping",value:function(r){var n=new Kt(new J(0,0),new J(r.row,r.col),new J(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return P(this.mergedCells,function(i){var a=new Kt(new J(0,0),new J(i.row,i.col),new J(i.row+i.rowspan-1,i.col+i.colspan-1));return a.overlaps(n)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var o=this.get(r,n);return o&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(o.row,1)===r&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(o.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var o=this.get(r,n);if(!o||this.isFirstRenderableMergedCell(r,n))return new J(r,n);var i=this.hot.rowIndexMapper.getFirstNotHiddenIndex(o.row,1),a=this.hot.columnIndexMapper.getFirstNotHiddenIndex(o.col,1);return new J(i,a)}},{key:"shiftCollections",value:function(r,n,o){var i=this,a=[0,0];switch(r){case"right":a[0]+=o;break;case"left":a[0]-=o;break;case"down":a[1]+=o;break;case"up":a[1]-=o;break}P(this.mergedCells,function(s){s.shift(a,n)}),wd(this.mergedCells.length-1,0,function(s){var l=i.mergedCells[s];l&&l.removed&&i.mergedCells.splice(i.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Rt(x$||(x$=jke(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}(),Kke=Gke;function Gi(e,t){return Zke(e)||Qke(e,t)||qke(e,t)||Xke()}function Xke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qke(e,t){if(!!e){if(typeof e=="string")return L$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L$(e,t)}}function L$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qke(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Zke(e){if(Array.isArray(e))return e}function Jke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function eAe(e,t,r){return t&&F$(e.prototype,t),r&&F$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var tAe=function(){function e(t){Jke(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return eAe(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var o=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?o="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?o="up":n[1]===r[1]&&n[2]===r[2]?o="right":o="left",o}},{key:"snapDragArea",value:function(r,n,o,i){var a=n.slice(0),s=this.getAutofillSize(r,n,o),l=Gi(r,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(o)>-1,v=d?c-u+1:h-f+1,p=Math.floor(s/v)*v,b=s-p,_=this.getFarthestCollection(r,n,o,i);if(_){if(o==="down"){var S=_.row+_.rowspan-u-b,E=a[2]+S;E>=this.plugin.hot.countRows()?a[2]-=b:a[2]+=b?S:0}else if(o==="right"){var M=_.col+_.colspan-f-b,k=a[3]+M;k>=this.plugin.hot.countCols()?a[3]-=b:a[3]+=b?M:0}else if(o==="up"){var U=c-b-_.row+1,Y=a[0]+U;Y<0?a[0]+=b:a[0]-=b?U:0}else if(o==="left"){var ne=h-b-_.col+1,Z=a[1]+ne;Z<0?a[1]+=b:a[1]-=b?ne:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:o,foundMergedCells:i,fillSize:s,dragArea:a,cycleLength:v}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),xt(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,o){var i=Gi(r,4),a=i[0],s=i[1],l=i[2],u=i[3],f=Gi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return a-c;case"down":return d-l;case"left":return s-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,o){var i=Gi(r,4),a=i[0],s=i[1],l=i[2],u=i[3],f=Gi(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(o){case"up":return[c,h,a-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[a,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,o,i){var a=Gi(r,4),s=a[0],l=a[1],u=a[2],f=a[3],c=["up","down"].indexOf(o)>-1,h=c?u:f,d=c?s:l,v=this.getAutofillSize(r,n,o),p=c?u-s+1:f-l+1,b=Math.floor(v/p)*p,_=v-b,S=null,E=null,M=null;switch(o){case"up":S="includesVertically",M=h-_+1;break;case"left":S="includesHorizontally",M=h-_+1;break;case"down":S="includesVertically",M=d+_-1;break;case"right":S="includesHorizontally",M=d+_-1;break}return P(i,function(k){k[S](M)&&k.isFarther(E,o)&&(E=k)}),E}},{key:"recreateAfterDataPopulation",value:function(r){if(!!this.currentFillData){var n=this.getRangeFromChanges(r),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,a=function(h,d){switch(i){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<o.length;f+=1){if(l=o[f],s=u*this.currentFillData.cycleLength,a(l,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===o.length-1&&(u+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(r){var n=this,o={min:null,max:null},i={min:null,max:null};return P(r,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(o.min===null||s<o.min)&&(o.min=s),(o.max===null||s>o.max)&&(o.max=s),(i.min===null||l<i.min)&&(i.min=l),(i.max===null||l>i.max)&&(i.max=l)}),{from:{row:o.min,column:i.min},to:{row:o.max,column:i.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,o){var i=this.getDragArea(r,n,o),a=Gi(i,4),s=a[0],l=a[1],u=a[2],f=a[3],c=new J(s,l),h=new J(u,f),d=new Kt(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}(),rAe=tAe;function nAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oAe(e,t,r){return t&&j$(e.prototype,t),r&&j$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var iAe=function(){function e(t){nAe(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return oAe(e,[{key:"snapDelta",value:function(r,n,o){var i=n.to,a=i.row+r.row,s=i.col+r.col;r.row?this.jumpOverMergedCell(r,o,a):r.col&&this.jumpOverMergedCell(r,o,s)}},{key:"jumpOverMergedCell",value:function(r,n,o){var i=r.row||r.col,a=null,s=null,l=null;r.row?(a=n.includesVertically(o),s=n.row,l=n.getLastRow()):r.col&&(a=n.includesHorizontally(o),s=n.col,l=n.getLastColumn()),i!==0&&(i>0?a&&o!==s&&(i+=l-o+1):a&&o!==l&&(i-=o-s+1),r.row?r.row=i:r.col&&(r.col=i))}},{key:"getUpdatedSelectionRange",value:function(r,n){return new Kt(r.highlight,r.from,new J(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,o,i){var a=Math.min(o[0],o[2]),s=Math.min(o[1],o[3]),l=Math.max(o[0],o[2]),u=Math.max(o[1],o[3]);if(i!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(!!f){var c=this.plugin.mergedCellsCollection.get(r,n);if(!!c){var h=c.getLastRow(),d=c.getLastColumn(),v=a<=c.row&&s<=c.col&&l>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(i);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var o=[];if(!n||!r)return!1;for(var i=0;i<r.rowspan;i+=1)for(var a=0;a<r.colspan;a+=1)o.push(new J(r.row+i,r.col+a));for(var s=0;s<o.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(o[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}(),aAe=iAe;function sAe(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(dR)}return this.getTranslatedPhrase(hR)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Nn.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function yS(e){return yS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yS(e)}function B$(e,t){return fAe(e)||uAe(e,t)||OB(e,t)||lAe()}function lAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uAe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function fAe(e){if(Array.isArray(e))return e}function V$(e){return dAe(e)||hAe(e)||OB(e)||cAe()}function cAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OB(e,t){if(!!e){if(typeof e=="string")return mS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mS(e,t)}}function hAe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dAe(e){if(Array.isArray(e))return mS(e)}function mS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pAe(e,t,r){return t&&W$(e.prototype,t),r&&W$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zs(){return typeof Reflect!="undefined"&&Reflect.get?zs=Reflect.get:zs=function(t,r,n){var o=gAe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zs.apply(this,arguments)}function gAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bi(e),e!==null););return e}function yAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bS(e,t)}function bS(e,t){return bS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},bS(e,t)}function mAe(e){var t=wAe();return function(){var n=bi(e),o;if(t){var i=bi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return bAe(this,o)}}function bAe(e,t){if(t&&(yS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RB(e)}function RB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wAe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},bi(e)}Ae.getSingleton().register("beforeMergeCells");Ae.getSingleton().register("afterMergeCells");Ae.getSingleton().register("beforeUnmergeCells");Ae.getSingleton().register("afterUnmergeCells");var zc="mergeCells",_Ae=150,U$=new WeakMap,SAe=function(e){yAe(r,e);var t=mAe(r);function r(n){var o;return vAe(this,r),o=t.call(this,n),U$.set(RB(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return pAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.mergedCellsCollection=new Kke(this),this.autofillCalculations=new rAe(this),this.selectionCalculations=new aAe(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeKeyDown",function(){return o.onBeforeKeyDown.apply(o,arguments)}),this.addHook("modifyTransformStart",function(){return o.onModifyTransformStart.apply(o,arguments)}),this.addHook("afterModifyTransformStart",function(){return o.onAfterModifyTransformStart.apply(o,arguments)}),this.addHook("modifyTransformEnd",function(){return o.onModifyTransformEnd.apply(o,arguments)}),this.addHook("modifyGetCellCoords",function(){return o.onModifyGetCellCoords.apply(o,arguments)}),this.addHook("beforeSetRangeStart",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return o.onBeforeSetRangeStart.apply(o,arguments)}),this.addHook("beforeSetRangeEnd",function(){return o.onBeforeSetRangeEnd.apply(o,arguments)}),this.addHook("afterIsMultipleSelection",function(){return o.onAfterIsMultipleSelection.apply(o,arguments)}),this.addHook("afterRenderer",function(){return o.onAfterRenderer.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.addMergeActionsToContextMenu.apply(o,arguments)}),this.addHook("afterGetCellMeta",function(){return o.onAfterGetCellMeta.apply(o,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return o.onAfterViewportRowCalculatorOverride.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),this.addHook("modifyAutofillRange",function(){return o.onModifyAutofillRange.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterChange",function(){return o.onAfterChange.apply(o,arguments)}),this.addHook("beforeDrawBorders",function(){return o.onBeforeDrawAreaBorders.apply(o,arguments)}),this.addHook("afterDrawSelection",function(){return o.onAfterDrawSelection.apply(o,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return o.onBeforeRemoveCellClassNames.apply(o,arguments)}),this.addHook("beforeUndoStackChange",function(i,a){if(a==="MergeCells")return!1}),zs(bi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),zs(bi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var o=this.hot.getSettings()[zc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(o),zs(bi(r.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(o){var i=!0;return o?(Nn.containsNegativeValues(o)?(kt(Nn.NEGATIVE_VALUES_WARNING(o)),i=!1):Nn.isOutOfBounds(o,this.hot.countRows(),this.hot.countCols())?(kt(Nn.IS_OUT_OF_BOUNDS_WARNING(o)),i=!1):Nn.isSingleCell(o)?(kt(Nn.IS_SINGLE_CELL(o)),i=!1):Nn.containsZeroSpan(o)&&(kt(Nn.ZERO_SPAN_WARNING(o)),i=!1),i):!1}},{key:"generateFromSettings",value:function(o){var i=this;if(Array.isArray(o)){var a,s=[];P(o,function(u){if(!!i.validateSetting(u)){var f=new J(u.row,u.col),c=new J(u.row+u.rowspan-1,u.col+u.colspan-1),h=new Kt(f,f,c);s.push(i.mergeRange(h,!0,!0))}}),s=s.filter(function(u){return u!==!0});var l=this.getBulkCollectionData(s);(a=this.hot).populateFromArray.apply(a,V$(l))}}},{key:"getBulkCollectionData",value:function(o){var i,a=this.getBulkCollectionDataRange(o),s=(i=this.hot).getData.apply(i,V$(a)),l=s.splice(0);return P(o,function(u){var f=B$(u,3),c=f[0],h=f[1],d=f[2];P(d,function(v,p){P(v,function(b,_){l[c-a[0]+p][h-a[1]+_]=b})})}),[a[0],a[1],l]}},{key:"getBulkCollectionDataRange",value:function(o){var i=[0,0],a=[0,0],s=null,l=null,u=null;return P(o,function(f){s=f[0],l=f[1],u=f[2],i[0]=Math.min(s,i[0]),i[1]=Math.min(l,i[1]),a[0]=Math.max(s+u.length-1,a[0]),a[1]=Math.max(l+u[0].length-1,a[1])}),[].concat(i,a)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return i?!0:this.validateSetting(o)}},{key:"toggleMergeOnSelection",value:function(){var o=this.hot.getSelectedRangeLast();if(!!o){o.setDirection("NW-SE");var i=o.from,a=o.to;this.toggleMerge(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!o){o.setDirection("NW-SE");var i=o.from,a=o.to;this.unmergeRange(o,!0),this.mergeRange(o),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!o){var i=o.from,a=o.to;this.unmergeRange(o,!0),this.hot.selectCell(i.row,i.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=o.getTopLeftCorner(),u=o.getBottomRightCorner(),f={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},c=[],h=null;if(!this.canMergeRange(f,a))return!1;this.hot.runHooks("beforeMergeCells",o,a),Ie(0,f.rowspan-1,function(v){Ie(0,f.colspan-1,function(p){var b=null;c[v]||(c[v]=[]),v===0&&p===0?b=i.hot.getDataAtCell(f.row,f.col):i.hot.setCellMeta(f.row+v,f.col+p,"hidden",!0),c[v][p]=b})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(s?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",o,f,a),h):!0}},{key:"unmergeRange",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(o);!s||(this.hot.runHooks("beforeUnmergeCells",o,a),P(s,function(l){i.mergedCellsCollection.remove(l.row,l.col),Ie(0,l.rowspan-1,function(u){Ie(0,l.colspan-1,function(f){i.hot.removeCellMeta(l.row+u,l.col+f,"hidden")})}),i.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",o,a),this.hot.render())}},{key:"toggleMerge",value:function(o){var i=this.mergedCellsCollection.get(o.from.row,o.from.col),a=i.row===o.from.row&&i.col===o.from.col&&i.row+i.rowspan-1===o.to.row&&i.col+i.colspan-1===o.to.col;a?this.unmergeRange(o):this.mergeSelection(o)}},{key:"merge",value:function(o,i,a,s){var l=new J(o,i),u=new J(a,s);this.mergeRange(new Kt(l,l,u))}},{key:"unmerge",value:function(o,i,a,s){var l=new J(o,i),u=new J(a,s);this.unmergeRange(new Kt(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[zc]),this.hot.render()}},{key:"onBeforeKeyDown",value:function(o){var i=(o.ctrlKey||o.metaKey)&&!o.altKey;i&&o.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),At(o))}},{key:"onAfterIsMultipleSelection",value:function(o){if(o){for(var i=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<i.length;s+=1)if(a.from.row===i[s].row&&a.from.col===i[s].col&&a.to.row===i[s].row+i[s].rowspan-1&&a.to.col===i[s].col+i[s].colspan-1)return!1}return o}},{key:"onModifyTransformStart",value:function(o){var i=U$.get(this),a=this.hot.getSelectedRangeLast(),s={row:o.row,col:o.col},l=null,u=new J(a.highlight.row,a.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(i.lastDesiredCoords||(i.lastDesiredCoords=new J(null,null)),f){var c=new J(f.row,f.col),h=new J(f.row+f.rowspan-1,f.col+f.colspan-1),d=new Kt(c,c,h);d.includes(i.lastDesiredCoords)||(i.lastDesiredCoords=new J(null,null)),s.row=i.lastDesiredCoords.row?i.lastDesiredCoords.row-u.row:s.row,s.col=i.lastDesiredCoords.col?i.lastDesiredCoords.col-u.col:s.col,o.row>0?s.row=f.row+f.rowspan-1-u.row+o.row:o.row<0&&(s.row=u.row-f.row+o.row),o.col>0?s.col=f.col+f.colspan-1-u.col+o.col:o.col<0&&(s.col=u.col-f.col+o.col)}l=new J(a.highlight.row+s.row,a.highlight.col+s.col);var v=this.mergedCellsCollection.get(l.row,l.col);if(v){var p=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);i.lastDesiredCoords=l,s={row:p.row-u.row,col:p.col-u.col}}s.row!==0&&(o.row=s.row),s.col!==0&&(o.col=s.col)}},{key:"onModifyTransformEnd",value:function(o){var i=this,a=this.hot.getSelectedRangeLast(),s=_r(o),l=this.selectionCalculations.getUpdatedSelectionRange(a,o),u=_r(s),f=this.mergedCellsCollection.getWithinRange(l,!0);do u=_r(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),P(f,function(c){i.selectionCalculations.snapDelta(s,a,c)});while(s.row!==u.row||s.col!==u.col);o.row=s.row,o.col=s.col}},{key:"onModifyGetCellCoords",value:function(o,i){if(!(o<0||i<0)){var a=this.mergedCellsCollection.get(o,i);if(!!a){var s=a.row,l=a.col,u=a.colspan,f=a.rowspan;return[s,l,s+f-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(o){o.items.push({name:"---------"},sAe(this))}},{key:"onAfterRenderer",value:function(o,i,a){var s=this.mergedCellsCollection.get(i,a),l=Ze(s)?_r(s):void 0;if(Ze(l)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=l.row,d=l.col,v=l.colspan,p=l.rowspan,b=this.translateMergedCellToRenderable(h,p,d,v),_=B$(b,2),S=_[0],E=_[1],M=f.getRenderableFromVisualIndex(i),k=c.getRenderableFromVisualIndex(a),U=S-M+1,Y=E-k+1;l.row=f.getFirstNotHiddenIndex(l.row,1),l.col=c.getFirstNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,U),l.colspan=Math.min(l.colspan,Y)}pS(o,l,i,a)}},{key:"onBeforeSetRangeStart",value:function(o){if(this.mergedCellsCollection.isFirstRenderableMergedCell(o.row,o.col)){var i=this.mergedCellsCollection.get(o.row,o.col),a=[i.row,i.col];o.row=a[0],o.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(o){var i=this.hot.getSelectedRangeLast();i.highlight=new J(i.highlight.row,i.highlight.col),i.to=o;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();i.expandByRange(u)&&(o.row=i.to.row,o.col=i.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(o,i,a){var s=this.mergedCellsCollection.get(o,i);s&&(s.row!==o||s.col!==i?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(o){var i=this.hot.countCols();this.modifyViewportRowStart(o,i),this.modifyViewportRowEnd(o,i)}},{key:"modifyViewportRowStart",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(o.startRow),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(s,l);if(Ze(u)){var f=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(u.row,1));if(f<o.startRow){o.startRow=f,this.modifyViewportRowStart(o,i);return}}}}},{key:"modifyViewportRowEnd",value:function(o,i){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(o.endRow),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(s,l);if(Ze(u)){var f=u.row+u.rowspan-1,c=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(f,-1));if(c>o.endRow){o.endRow=c,this.modifyViewportRowEnd(o,i);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){var i=this.hot.countRows();this.modifyViewportColumnStart(o,i),this.modifyViewportColumnEnd(o,i)}},{key:"modifyViewportColumnStart",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(o.startColumn),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(l,s);if(Ze(u)){var f=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(u.col,1));if(f<o.startColumn){o.startColumn=f,this.modifyViewportColumnStart(o,i);return}}}}},{key:"modifyViewportColumnEnd",value:function(o,i){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(o.endColumn),l=0;l<i;l+=1){var u=this.mergedCellsCollection.get(l,s);if(Ze(u)){var f=u.col+u.colspan-1,c=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(f,-1));if(c>o.endColumn){o.endColumn=c,this.modifyViewportColumnEnd(o,i);return}}}}},{key:"translateMergedCellToRenderable",value:function(o,i,a,s){var l=this.hot,u=l.rowIndexMapper,f=l.columnIndexMapper,c,h;i===0?c=u.getFirstNotHiddenIndex(o,1):c=u.getFirstNotHiddenIndex(o+i-1,-1),s===0?h=f.getFirstNotHiddenIndex(a,1):h=f.getFirstNotHiddenIndex(a+s-1,-1);var d=o>=0?u.getRenderableFromVisualIndex(c):o,v=a>=0?f.getRenderableFromVisualIndex(h):a;return[d,v]}},{key:"onModifyAutofillRange",value:function(o,i){this.autofillCalculations.correctSelectionAreaSize(i);var a=this.autofillCalculations.getDirection(i,o),s=o;if(this.autofillCalculations.dragAreaOverlapsCollections(i,s,a))return s=i,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:i[0],col:i[1]},to:{row:i[2],col:i[3]}});return l&&(s=this.autofillCalculations.snapDragArea(i,s,a,l)),s}},{key:"onAfterCreateCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("right",o,i)}},{key:"onAfterRemoveCol",value:function(o,i){this.mergedCellsCollection.shiftCollections("left",o,i)}},{key:"onAfterCreateRow",value:function(o,i,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",o,i)}},{key:"onAfterRemoveRow",value:function(o,i){this.mergedCellsCollection.shiftCollections("up",o,i)}},{key:"onAfterChange",value:function(o,i){i==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(o)}},{key:"onBeforeDrawAreaBorders",value:function(o,i){if(i&&i==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);P(s,function(l){a.getBottomRightCorner().row===l.getLastRow()&&a.getBottomRightCorner().col===l.getLastColumn()&&(o[2]=l.row,o[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(o,i,a){if(!!this.enabled){var s=this.mergedCellsCollection.get(o.row,o.col);if(!!s){var l=i>0,u=i<0,f=a<0,c=a>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,v=s.col+s.colspan-1===this.hot.countCols()-1,p=s.col===0;(l&&h||u&&d||c&&v||f&&p)&&(o.row=s.row,o.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(o,i,a,s){if(!!a)return this.selectionCalculations.getSelectedMergedCellClassName(o,i,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return zc}},{key:"PLUGIN_PRIORITY",get:function(){return _Ae}}]),r}(vt);function z$(e){return EAe(e)||RAe(e)||OAe(e)||CAe()}function CAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OAe(e,t){if(!!e){if(typeof e=="string")return Y$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y$(e,t)}}function Y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RAe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EAe(e){if(Array.isArray(e))return e}function TAe(e,t){return function(r,n){var o=z$(r),i=o.slice(1),a=z$(n),s=a.slice(1);return function l(u){var f=e[u],c=t[u],h=i[u],d=s[u],v=c.multiColumnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:mj(c.type),b=p(f,c,v)(h,d);if(b===Wn){var _=u+1;if(typeof t[_]!="undefined")return l(_)}return b}(0)}}var G$;function kAe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function K$(){kt(Rt(G$||(G$=kAe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var EB="sort";function AAe(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(EB,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function IAe(e){var t=e.className.split(" "),r=new RegExp("^".concat(EB,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function wS(e){return wS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wS(e)}function PAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MAe(e,t,r){return t&&X$(e.prototype,t),r&&X$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ur(){return typeof Reflect!="undefined"&&Reflect.get?Ur=Reflect.get:Ur=function(t,r,n){var o=$Ae(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ur.apply(this,arguments)}function $Ae(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Er(e),e!==null););return e}function DAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_S(e,t)}function _S(e,t){return _S=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},_S(e,t)}function xAe(e){var t=LAe();return function(){var n=Er(e),o;if(t){var i=Er(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NAe(this,o)}}function NAe(e,t){if(t&&(wS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HAe(e)}function HAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LAe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Er(e){return Er=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Er(e)}var SS="multiColumnSorting",FAe=170,jAe="append",q$="columnSorting";yj(SS,TAe);var BAe=function(e){DAe(r,e);var t=xAe(r);function r(n){var o;return PAe(this,r),o=t.call(this,n),o.pluginKey=SS,o}return MAe(r,[{key:"isEnabled",value:function(){return Ur(Er(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[q$]&&K$(),Ur(Er(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ur(Er(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(o){Ur(Er(r.prototype),"sort",this).call(this,o)}},{key:"clearSort",value:function(){Ur(Er(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Ur(Er(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(o){return Ur(Er(r.prototype),"getSortConfig",this).call(this,o)}},{key:"setSortConfig",value:function(o){Ur(Er(r.prototype),"setSortConfig",this).call(this,o)}},{key:"getNormalizedSortConfigs",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(o)?o:[o]}},{key:"updateHeaderClasses",value:function(o){for(var i,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(i=Ur(Er(r.prototype),"updateHeaderClasses",this)).call.apply(i,[this,o].concat(s)),Ge(o,IAe(o)),this.enabled!==!1&&le(o,AAe.apply(void 0,s))}},{key:"onUpdateSettings",value:function(o){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[q$]&&K$(),Ur(Er(r.prototype),"onUpdateSettings",this).call(this,o)}},{key:"onAfterOnCellMouseDown",value:function(o,i){Bw(i.row,i.col,o)!==!1&&this.wasClickableHeaderClicked(o,i.col)&&(Rd()?(this.hot.deselectCell(),this.hot.selectColumns(i.col),this.sort(this.getNextSortConfig(i.col,jAe))):this.sort(this.getColumnNextConfig(i.col)))}}],[{key:"PLUGIN_KEY",get:function(){return SS}},{key:"PLUGIN_PRIORITY",get:function(){return FAe}}]),r}(_j);function CS(e){return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CS(e)}function VAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function WAe(e,t,r){return t&&Q$(e.prototype,t),r&&Q$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ih(){return typeof Reflect!="undefined"&&Reflect.get?Ih=Reflect.get:Ih=function(t,r,n){var o=UAe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ih.apply(this,arguments)}function UAe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ml(e),e!==null););return e}function zAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OS(e,t)}function OS(e,t){return OS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},OS(e,t)}function YAe(e){var t=XAe();return function(){var n=ml(e),o;if(t){var i=ml(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return GAe(this,o)}}function GAe(e,t){if(t&&(CS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KAe(e)}function KAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XAe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ml(e){return ml=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},ml(e)}var qAe="multipleSelectionHandles",QAe=160,ZAe=function(e){zAe(r,e);var t=YAe(r);function r(n){var o;return VAe(this,r),o=t.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return WAe(r,[{key:"isEnabled",value:function(){return Sn()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new bt(this)),this.registerListeners(),Ih(ml(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var o=this,i=this,a=this.hot.rootElement;function s(l){if(i.dragged.length===1)return i.dragged.splice(0,i.dragged.length),!0;var u=i.dragged.indexOf(l);if(u===-1)return!1;u===0?i.dragged=i.dragged.slice(0,1):u===1&&(i.dragged=i.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var u;if(Ve(l.target,"topLeftSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("topLeft"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(Ve(l.target,"bottomRightSelectionHandle-HitArea"))return u=i.hot.getSelectedRangeLast(),i.dragged.push("bottomRight"),i.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(Ve(l.target,"topLeftSelectionHandle-HitArea"))return s.call(i,"topLeft"),i.touchStartRange=void 0,l.preventDefault(),!1;if(Ve(l.target,"bottomRightSelectionHandle-HitArea"))return s.call(i,"bottomRight"),i.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var u=o.hot,f=u.rootWindow,c=u.rootDocument,h=$a(f),d=Si(f),v,p,b,_,S,E;if(i.dragged.length!==0){var M=c.elementFromPoint(l.touches[0].screenX-d,l.touches[0].screenY-h);!M||M===i.lastSetCell||((M.nodeName==="TD"||M.nodeName==="TH")&&(v=i.hot.getCoords(M),v.col===-1&&(v.col=0),p=i.hot.getSelectedRangeLast(),b=p.getWidth(),_=p.getHeight(),S=p.getDirection(),b===1&&_===1&&i.hot.selection.setRangeEnd(v),E=i.getCurrentRangeCoords(p,v,i.touchStartRange.direction,S,i.dragged[0]),E.start!==null&&i.hot.selection.setRangeStart(E.start),i.hot.selection.setRangeEnd(E.end),i.lastSetCell=M),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(o,i,a,s,l){var u=o.getTopLeftCorner(),f=o.getBottomRightCorner(),c=o.getBottomLeftCorner(),h=o.getTopRightCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="topLeft"?d={start:new J(i.row,o.highlight.col),end:new J(c.row,i.col)}:d={start:new J(o.highlight.row,i.col),end:new J(i.row,u.col)};break;case"SE-NW":l==="bottomRight"&&(d={start:new J(f.row,i.col),end:new J(i.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="topLeft"?d={start:i,end:c}:d.end=i;break;case"NW-SE":l==="topLeft"?d={start:i,end:f}:d.end=i;break;case"SE-NW":l==="topLeft"?d={start:i,end:u}:d.end=i;break;case"SW-NE":l==="topLeft"?d={start:i,end:h}:d.end=i;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottomRight"?d={start:new J(i.row,u.col),end:new J(c.row,i.col)}:d={start:new J(u.row,i.col),end:new J(i.row,f.col)};break;case"SW-NE":l==="topLeft"?d={start:new J(o.highlight.row,i.col),end:new J(i.row,f.col)}:d={start:new J(i.row,u.col),end:new J(u.row,i.col)};break;case"SE-NW":l==="bottomRight"?d={start:new J(i.row,h.col),end:new J(u.row,i.col)}:l==="topLeft"&&(d={start:c,end:i});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="topLeft"&&(d.end=i);break;case"SE-NW":l==="topLeft"?d.end=i:d={start:i,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return qAe}},{key:"PLUGIN_PRIORITY",get:function(){return QAe}}]),r}(vt);function RS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,o=n===void 0?1:n,i=e.origColspan,a=i===void 0?1:i,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,p=e.isRoot,b=p===void 0?!1:p,_=e.isPlaceholder,S=_===void 0?!1:_;return{label:r,colspan:o,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:b,isPlaceholder:S}}function TB(){return{label:"",isPlaceholder:!0}}function Z$(e){return rIe(e)||tIe(e)||eIe(e)||JAe()}function JAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eIe(e,t){if(!!e){if(typeof e=="string")return ES(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ES(e,t)}}function tIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rIe(e){if(Array.isArray(e))return ES(e)}function ES(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nIe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;P(e,function(o){var i=[],a=0;r.push(i),P(o,function(s){var l=RS();if(Ze(s)){var u=s.label,f=s.colspan;l.label=jt(u),typeof f=="number"&&f>1&&(l.colspan=f,l.origColspan=f)}else l.label=jt(s);a+=l.origColspan;var c=!1;if(a>=t&&(l.colspan=l.origColspan-(a-t),l.origColspan=l.colspan,c=!0),i.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)i.push(TB());return!c})});var n=Math.max.apply(Math,Z$(et(r,function(o){return o.length})));return P(r,function(o){if(o.length<n){var i=et(new Array(n-o.length),function(){return RS()});o.splice.apply(o,[o.length,0].concat(Z$(i)))}}),r}var oIe=["row","col"];function J$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function iIe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J$(Object(r),!0).forEach(function(n){aIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aIe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sIe(e,t){if(e==null)return{};var r=lIe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function lIe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function uIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fIe(e,t,r){return t&&eD(e.prototype,t),r&&eD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function my(e,t,r){cIe(e,t),t.set(e,r)}function cIe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pn(e,t){var r=kB(e,t,"get");return hIe(e,r)}function hIe(e,t){return t.get?t.get.call(e):t.value}function uu(e,t,r){var n=kB(e,t,"set");return dIe(e,n,r),r}function kB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function dIe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var tD=["label","collapsible"],Jn=new WeakMap,Ki=new WeakMap,by=new WeakMap,vIe=function(){function e(){uIe(this,e),my(this,Jn,{writable:!0,value:[]}),my(this,Ki,{writable:!0,value:0}),my(this,by,{writable:!0,value:1/0})}return fIe(e,[{key:"setColumnsLimit",value:function(r){uu(this,by,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];uu(this,Jn,nIe(r,pn(this,by))),uu(this,Ki,pn(this,Jn).length)}},{key:"getData",value:function(){return pn(this,Jn)}},{key:"mergeWith",value:function(r){var n=this;P(r,function(o){var i=o.row,a=o.col,s=sIe(o,oIe),l=n.getHeaderSettings(i,a);l!==null&&xt(l,s,tD)})}},{key:"map",value:function(r){P(pn(this,Jn),function(n){P(n,function(o){var i=r(iIe({},o));Ze(i)&&xt(o,i,tD)})})}},{key:"getHeaderSettings",value:function(r,n){var o;if(r>=pn(this,Ki)||r<0)return null;var i=pn(this,Jn)[r];return n>=i.length?null:(o=i[n])!==null&&o!==void 0?o:null}},{key:"getHeadersSettings",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(r>=pn(this,Ki)||r<0)return i;for(var a=pn(this,Jn)[r],s=0,l=n;l<a.length;l++){var u=a[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,i.push(u),u.colspan>1&&(l+=u.colspan-1),s===o)break;if(s>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}},{key:"getLayersCount",value:function(){return pn(this,Ki)}},{key:"getColumnsCount",value:function(){return pn(this,Ki)>0?pn(this,Jn)[0].length:0}},{key:"clear",value:function(){uu(this,Jn,[]),uu(this,Ki,0)}}]),e}();function rD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rD(Object(r),!0).forEach(function(n){Ph(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gIe(e,t,r){return t&&oD(e.prototype,t),r&&oD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ph(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yIe(e){return _Ie(e)||wIe(e)||bIe(e)||mIe()}function mIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bIe(e,t){if(!!e){if(typeof e=="string")return TS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TS(e,t)}}function wIe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Ie(e){if(Array.isArray(e))return TS(e)}function TS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SIe="DF-pre-order";function AB(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=AB.call(this.childs[n],e,t)}return r}var CIe="DF-post-order";function IB(e,t){for(var r=0;r<this.childs.length;r++){var n=IB.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var PB="BF";function OIe(e,t){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,yIe(o.childs)),e.call(t,o)!==!1&&n()}}n()}var RIe=PB,iD=new Map([[SIe,AB],[CIe,IB],[PB,OIe]]),aD=function(){function e(t){pIe(this,e),Ph(this,"data",{}),Ph(this,"parent",null),Ph(this,"childs",[]),this.data=t}return gIe(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(nD({},r.data)),o=0;o<r.childs.length;o++)n.addChild(this.cloneTree(r.childs[o]));return n}},{key:"replaceTreeWith",value:function(r){this.data=nD({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:RIe;if(!iD.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));iD.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,o=function i(a){var s=r.call(n,a);s!==!1&&a.parent!==null&&i(a.parent)};o(this)}}]),e}();function sD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sD(Object(r),!0).forEach(function(n){EIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EIe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TIe(e,t){return PIe(e)||IIe(e,t)||AIe(e,t)||kIe()}function kIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AIe(e,t){if(!!e){if(typeof e=="string")return uD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uD(e,t)}}function uD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IIe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function PIe(e){if(Array.isArray(e))return e}function MIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $Ie(e,t,r){return t&&fD(e.prototype,t),r&&fD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wy(e,t,r){DIe(e,t),t.set(e,r)}function DIe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(e,t){var r=MB(e,t,"get");return xIe(e,r)}function xIe(e,t){return t.get?t.get.call(e):t.value}function NIe(e,t,r){var n=MB(e,t,"set");return HIe(e,n,r),r}function MB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HIe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Ss=new WeakMap,Xi=new WeakMap,Cs=new WeakMap,LIe=function(){function e(t){MIe(this,e),wy(this,Ss,{writable:!0,value:new Map}),wy(this,Xi,{writable:!0,value:new Map}),wy(this,Cs,{writable:!0,value:null}),NIe(this,Cs,t)}return $Ie(e,[{key:"getRoots",value:function(){return Array.from(Rr(this,Ss).values())}},{key:"getRootByColumn",value:function(r){var n;return Rr(this,Xi).has(r)&&(n=Rr(this,Ss).get(Rr(this,Xi).get(r))),n}},{key:"getNode",value:function(r,n){var o=this.getRootByColumn(n);if(!!o){var i=n-Rr(this,Xi).get(n),a=0,s;return o.walkDown(function(l){var u=l.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(i>=a&&i<=a+f-1)return s=l,!1;a+=f}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;Rr(this,Xi).clear(),P(Rr(this,Ss),function(o){for(var i=TIe(o,2),a=i[1].data.colspan,s=n;s<n+a;s++)Rr(r,Xi).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=Rr(this,Cs).getColumnsCount(),n=0;n<r;){var o=Rr(this,Cs).getHeaderSettings(0,n),i=new aD;Rr(this,Ss).set(n,i),this.buildLeaves(i,n,0,o.origColspan),n+=o.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,o){var i=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Rr(this,Cs).getHeadersSettings(o,n,a);o+=1,P(s,function(l){var u=lD(lD({},l),{},{headerLevel:o-1,columnIndex:n}),f;o===1?(r.data=u,f=r):(f=new aD(u),r.addChild(f)),o<Rr(i,Cs).getLayersCount()&&i.buildLeaves(f,n,o,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Rr(this,Ss).clear(),Rr(this,Xi).clear()}}]),e}();function $B(e,t){e.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(t(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Bd(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function Vd(e){return Bd(e,"origColspan")===e.data.origColspan}function jE(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Vd(e);if(n)return jE(r[0]);t.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)P(o,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;a+=h.colspan,$B(c,function(d){i.add(d)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;a=l-s;for(var f=1;f<l;f++)i.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Vd(c)&&(h.isCollapsed=Bd(c,"isCollapsed"))}),{rollbackModification:function(){return BE(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function BE(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Vd(e);if(o)return BE(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)P(i,function(h){$B(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var f=l+u;a.add(f)}var c=r.colspan-((t=Bd(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Vd(h)&&(d.isCollapsed=Bd(h,"isCollapsed"))}),{rollbackModification:function(){return jE(e)},affectedColumns:Array.from(a),colspanCompensation:c}}var cD;function FIe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jIe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Rt(cD||(cD=FIe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var hD;function BIe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function VIe(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Rt(hD||(hD=BIe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!!r.includes(t)){var n=!1;e.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&e.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var dD=new Map([["collapse",BE],["expand",jE],["hide-column",jIe],["show-column",VIe]]);function WIe(e,t,r){if(!dD.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return dD.get(e)(t,r)}var UIe=["crossHiddenColumns"];function zIe(e,t){if(e==null)return{};var r=YIe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function YIe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Yc(e){var t=[];return P(e,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,s=o.headerLevel,l=o.crossHiddenColumns,u=KIe(t,s),f=!1,c=a;c<a+i;c++){var h=l.includes(c);if(h||f)u.push(TB());else{var d=GIe(o);d.isRoot=!0,u.push(d),f=!0}}})}),t}function GIe(e){var t=RS(e);t.crossHiddenColumns;var r=zIe(t,UIe);return r}function KIe(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}var XIe=["row"];function vD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function pD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vD(Object(r),!0).forEach(function(n){qIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qIe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QIe(e,t){if(e==null)return{};var r=ZIe(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function ZIe(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function JIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ePe(e,t,r){return t&&gD(e.prototype,t),r&&gD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _y(e,t,r){tPe(e,t),t.set(e,r)}function tPe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fu(e,t,r){var n=DB(e,t,"set");return rPe(e,n,r),r}function rPe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Wt(e,t){var r=DB(e,t,"get");return nPe(e,r)}function DB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function nPe(e,t){return t.get?t.get.call(e):t.value}var xn=new WeakMap,Vr=new WeakMap,qi=new WeakMap,oPe=function(){function e(){JIe(this,e),_y(this,xn,{writable:!0,value:new vIe}),_y(this,Vr,{writable:!0,value:new LIe(Wt(this,xn))}),_y(this,qi,{writable:!0,value:[[]]})}return ePe(e,[{key:"setState",value:function(r){Wt(this,xn).setData(r);var n=!1;try{Wt(this,Vr).buildTree()}catch{Wt(this,Vr).clear(),Wt(this,xn).clear(),n=!0}return fu(this,qi,Yc(Wt(this,Vr).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Wt(this,xn).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,o=et(r,function(i){var a=i.row,s=QIe(i,XIe);return pD({row:a<0?n.rowCoordsToLevel(a):a},s)});Wt(this,xn).mergeWith(o),Wt(this,Vr).buildTree(),fu(this,qi,Yc(Wt(this,Vr).getRoots()))}},{key:"mapState",value:function(r){Wt(this,xn).map(r),Wt(this,Vr).buildTree(),fu(this,qi,Yc(Wt(this,Vr).getRoots()))}},{key:"mapNodes",value:function(r){return zt(Wt(this,Vr).getRoots(),function(n,o){return o.walkDown(function(i){var a=r(i.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,o){n<0&&(n=this.rowCoordsToLevel(n));var i=Wt(this,Vr).getNode(n,o),a;return i&&(a=WIe(r,i,o),fu(this,qi,Yc(Wt(this,Vr).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){var n=Math.max(this.getLayersCount(),1),o=n-1,i=0;return Math.min(Math.max(r+n,i),o)}},{key:"levelToRowCoords",value:function(r){var n=Math.max(this.getLayersCount(),1),o=-1,i=-n;return Math.min(Math.max(r-n,i),o)}},{key:"getHeaderSettings",value:function(r,n){var o,i;return r<0&&(r=this.rowCoordsToLevel(r)),r>=this.getLayersCount()?null:(o=(i=Wt(this,qi)[r])===null||i===void 0?void 0:i[n])!==null&&o!==void 0?o:null}},{key:"getHeaderTreeNodeData",value:function(r,n){r<0&&(r=this.rowCoordsToLevel(r));var o=Wt(this,Vr).getNode(r,n);return o?pD({},o.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var o,i=(o=this.getHeaderSettings(r,n))!==null&&o!==void 0?o:{isRoot:!0},a=i.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},f=u.isRoot;if(f)break;s-=1}return s}},{key:"getLayersCount",value:function(){return Wt(this,xn).getLayersCount()}},{key:"getColumnsCount",value:function(){return Wt(this,xn).getColumnsCount()}},{key:"clear",value:function(){fu(this,qi,[]),Wt(this,xn).clear(),Wt(this,Vr).clear()}}]),e}();function iPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function aPe(e,t,r){return t&&yD(e.prototype,t),r&&yD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var sPe=function(){function e(t){iPe(this,e),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}return aPe(e,[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsCache.length=0;for(var o=0;o<n;o++)this.widthsCache.push(r[o].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(r){for(var n=this.nestedHeaders.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("table"),a=!1,s=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.getLayersCount(),u=this.nestedHeaders.hot.countCols(),f=l-1,c=0;c<l;c++){var h=n.createElement("tr");a=!1;for(var d=0;d<u;d++){var v=n.createElement("th"),p=_r(this.nestedHeaders.getHeaderSettings(c,d));p&&!p.isHidden&&(c===f&&(p.colspan>1&&(a=!0),s&&(p.label+='<button class="changeType"></button>')),Mi(v,p.label),p.colspan!==void 0&&(v.colSpan=p.colspan),h.appendChild(v))}i.appendChild(h)}if(a){for(var b=n.createElement("tr"),_=0;_<u;_++){var S=n.createElement("th");b.appendChild(S)}i.appendChild(b)}o.appendChild(i),r.appendChild(o)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),e}(),lPe=sPe;function kS(e){return kS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kS(e)}var mD,bD;function wD(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function uPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fPe(e,t,r){return t&&_D(e.prototype,t),r&&_D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wa(){return typeof Reflect!="undefined"&&Reflect.get?wa=Reflect.get:wa=function(t,r,n){var o=cPe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},wa.apply(this,arguments)}function cPe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ao(e),e!==null););return e}function hPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AS(e,t)}function AS(e,t){return AS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},AS(e,t)}function dPe(e){var t=pPe();return function(){var n=Ao(e),o;if(t){var i=Ao(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return vPe(this,o)}}function vPe(e,t){if(t&&(kS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ts(e)}function Ts(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pPe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(e){return Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ao(e)}function SD(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CD(e,t,r){gPe(e,t),t.set(e,r)}function gPe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gc(e,t,r){var n=xB(e,t,"set");return yPe(e,n,r),r}function yPe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function rr(e,t){var r=xB(e,t,"get");return mPe(e,r)}function xB(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mPe(e,t){return t.get?t.get.call(e):t.value}var OD="nestedHeaders",bPe=280,gr=new WeakMap,qo=new WeakMap,wPe=function(e){hPe(r,e);var t=dPe(r);function r(){var n;uPe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=t.call.apply(t,[this].concat(i)),CD(Ts(n),gr,{writable:!0,value:new oPe}),CD(Ts(n),qo,{writable:!0,value:null}),SD(Ts(n),"ghostTable",new lPe(Ts(n))),SD(Ts(n),"detectedOverlappedHeaders",!1),n}return fPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OD]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings(),a=i.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&kt(Rt(mD||(mD=wD([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return o.onInit()}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("afterOnCellMouseDown",function(){return o.onAfterOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return o.onBeforeOnCellMouseOver.apply(o,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return o.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return o.onModifyColWidth.apply(o,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return o.onBeforeHighlightingColumnHeader.apply(o,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return o.onAfterViewportColumnCalculatorOverride.apply(o,arguments)}),wa(Ao(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var o=this;if(!!this.hot.view){var i=this.hot.getSettings(),a=i.nestedHeaders;rr(this,gr).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=rr(this,gr).setState(a)),this.detectedOverlappedHeaders&&kt(Rt(bD||(bD=wD([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";rr(o,gr).triggerColumnModification(u,l)}),!rr(this,qo)&&this.enabled&&Gc(this,qo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,f=l.index,c=l.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";rr(o,gr).triggerColumnModification(h,f)}})})),this.ghostTable.buildWidthsMapper(),wa(Ao(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),rr(this,gr).clear(),rr(this,qo).unsubscribe(),Gc(this,qo,null),this.ghostTable.clear(),wa(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return rr(this,gr)}},{key:"getLayersCount",value:function(){return rr(this,gr).getLayersCount()}},{key:"getHeaderSettings",value:function(o,i){return rr(this,gr).getHeaderSettings(o,i)}},{key:"clearColspans",value:function(){if(!!this.hot.view)for(var o=this.hot.view.wt,i=o.getSetting("columnHeaders").length,a=o.wtTable.THEAD,s=o.wtOverlays.topOverlay.clone.wtTable.THEAD,l=o.wtOverlays.topLeftCornerOverlay?o.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,u=0;u<i;u++){var f=a.childNodes[u];if(!f)break;for(var c=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Ge(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Ge(c.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Ge(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(o){var i=this,a=this.hot.view.wt.getSetting("fixedColumnsLeft");return function(s,l){var u,f=i.hot,c=f.rootDocument,h=f.columnIndexMapper,d=f.view,v=h.getVisualFromRenderableIndex(s);v===null&&(v=s),l.removeAttribute("colspan"),Ge(l,"hiddenHeader");var p=(u=rr(i,gr).getHeaderSettings(o,v))!==null&&u!==void 0?u:{label:""},b=p.colspan,_=p.label,S=p.isHidden,E=p.isPlaceholder;if(E||S)le(l,"hiddenHeader");else if(b>1){var M,k,U=(M=d.wt.wtOverlays.topLeftCornerOverlay)===null||M===void 0?void 0:M.clone.wtTable.THEAD.contains(l),Y=(k=d.wt.wtOverlays.leftOverlay)===null||k===void 0?void 0:k.clone.wtTable.THEAD.contains(l),ne=U||Y?Math.min(b,a-s):b;ne>1&&l.setAttribute("colspan",ne)}var Z=c.createElement("div"),te=c.createElement("span");le(Z,"relative"),le(te,"colHeader"),Mi(te,_),Z.appendChild(te),sn(l),l.appendChild(Z),i.hot.runHooks("afterGetColHeader",v,l)}}},{key:"onBeforeHighlightingColumnHeader",value:function(o,i,a){var s=rr(this,gr).getHeaderTreeNodeData(i,o);if(!s)return o;var l=a.classNames,u=a.columnCursor,f=a.selectionType,c=a.selectionWidth,h=rr(this,gr).getHeaderSettings(i,o),d=h.isRoot,v=h.colspan;if(f===Nf){if(!d)return s.columnIndex}else f===Bv&&(v>c-u||!d)&&(l.length=0);return o}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a,s){var l=this._getHeaderTreeNodeDataByCoords(i);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(o,i){var a=this._getHeaderTreeNodeDataByCoords(i);if(!!a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],f=a.columnIndex,c=a.origColspan,h=!s.inInSelection(i);o.shiftKey&&l?i.col<l.from.col?u.push(l.getTopRightCorner().col,f,i.row):i.col>l.from.col?u.push(l.getTopLeftCorner().col,f+c-1,i.row):u.push(f,f+c-1,i.row):($v(o)||Ci(o)&&h)&&u.push(f,f+c-1,i.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(o,i,a,s){var l;if(!!this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(i);if(!!u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopLeftCorner(),v=h.getBottomRightCorner(),p=h.from;s.column=!0,s.cell=!0;var b=[];i.col<p.col?b.push(v.col,f):i.col>p.col?b.push(d.col,f+c-1):b.push(f,f+c-1),(l=this.hot).selectColumns.apply(l,b)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(o){if(o){o.length=0;for(var i=0;i<rr(this,gr).getLayersCount();i++)o.push(this.headerRendererFactory(i))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(o){for(var i=rr(this,gr).getLayersCount(),a=o.startColumn,s=!!i,l=0;l<i;l++){var u=rr(this,gr).findLeftMostColumnIndex(l,o.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),zr(f)&&f<o.startColumn){a=f;break}}o.startColumn=s?rr(this,gr).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(o,i){var a=this.ghostTable.widthsCache[i];return o>a?o:a}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(o,i){i||this.updatePlugin()}},{key:"destroy",value:function(){Gc(this,gr,null),rr(this,qo)!==null&&(rr(this,qo).unsubscribe(),Gc(this,qo,null)),wa(Ao(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(o){if(!(o.row>=0||o.col<0))return rr(this,gr).getHeaderTreeNodeData(o.row,o.col)}}],[{key:"PLUGIN_KEY",get:function(){return OD}},{key:"PLUGIN_PRIORITY",get:function(){return bPe}}]),r}(vt);function RD(e){return OPe(e)||CPe(e)||SPe(e)||_Pe()}function _Pe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SPe(e,t){if(!!e){if(typeof e=="string")return IS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IS(e,t)}}function CPe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OPe(e){if(Array.isArray(e))return IS(e)}function IS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PS(e){return PS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PS(e)}function RPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ED(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EPe(e,t,r){return t&&ED(e.prototype,t),r&&ED(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var TPe=function(){function e(t,r){RPe(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return EPe(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ie(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,o){var i=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:o,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&P(r.__children,function(a){i.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,o,i){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),o!=null&&l===o?{result:u,end:!0}:i!=null&&u===i?{result:l,end:!0}:(l+=1,u.__children&&P(u.__children,function(f){if(a.parentReference.set(f,s?null:u),l=a.readTreeNodes(f,l,o,i),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return ot(this.data[0],function(n,o){r[o]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var o=this.getRowParent(r);return o==null?this.data.indexOf(n):o.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,o=0,i=r;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(P(i.__children,function(a){o+=1,a.__children&&(o+=n.countChildren(a))}),o)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||PS(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var o;return((o=r.__children)===null||o===void 0?void 0:o[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,o=r;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&((n=o.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var o=n;this.hot.runHooks("beforeAddChild",r,o);var i=null;r&&(i=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),o||(o=this.mockNode()),a.__children.push(o),this.rewriteCache();var s=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,o)}},{key:"addChildAtIndex",value:function(r,n,o){var i=o,a;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",r,i,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);i=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,i,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",o=this.translateTrimmedRow(r),i=this.getRowParent(o),a=this.getRowIndexWithinParent(o);switch(n){case"below":this.addChildAtIndex(i,a+1,null);break;case"above":this.addChildAtIndex(i,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null,a=[];Array.isArray(r)?(Ie(r[0],r[2],function(_){var S=n.translateTrimmedRow(_);a.push(n.getDataObject(S))}),Ie(0,a.length-2,function(_){n.detachFromParent(a[_],!1)}),i=a[a.length-1]):i=r;var s=this.getRowIndex(i),l=this.countChildren(i),u=this.getRowIndexWithinParent(i),f=this.getRowParent(i),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,i),u!=null){var v=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var p=this.getChild(c,this.countChildren(c)-1),b=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",b+1,l+1,this.plugin.pluginName),c.__children.push(i)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,i,this.getRowIndex(i)),o&&this.hot.render()}},{key:"filterData",value:function(r,n,o){var i=this,a=[];P(o,function(s){a.push(i.getDataObject(s))}),P(a,function(s){var l=i.getRowIndexWithinParent(s),u=i.getRowParent(s);u===null?i.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,o){var i=this.getDataObject(r-1),a=null,s=r;if(i&&i.__children&&i.__children.length===0?(a=i,s=0):r<this.countAllRows()&&(a=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),a)if(o){var l;(l=a.__children).splice.apply(l,[s,n].concat(RD(o)))}else a.__children.splice(s,n);else if(o){var u;(u=this.data).splice.apply(u,[s,n].concat(RD(o)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,o=null;do o=this.getRowParent(o),o!==null&&(n=o);while(o!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,o,i){var a=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),f=r>n,c=a?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=a||o||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,u[0]),s.__children.splice(l+(f&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}(),kPe=TPe;function TD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function APe(e,t,r){return t&&TD(e.prototype,t),r&&TD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PPe=APe(function e(t,r){IPe(this,e),this.hot=r,this.plugin=t}),VE=PPe;function MS(e){return MS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MS(e)}function MPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $Pe(e,t,r){return t&&kD(e.prototype,t),r&&kD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$S(e,t)}function $S(e,t){return $S=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},$S(e,t)}function xPe(e){var t=LPe();return function(){var n=Wd(e),o;if(t){var i=Wd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return NPe(this,o)}}function NPe(e,t){if(t&&(MS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HPe(e)}function HPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LPe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wd(e){return Wd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Wd(e)}var FPe=function(e){DPe(r,e);var t=xPe(r);function r(n,o){var i;return MPe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return $Pe(r,[{key:"appendLevelIndicators",value:function(o,i){var a=this.hot.toPhysicalRow(o),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),u=i.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(P(c,function(p){p&&u.removeChild(p)}),le(i,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",Ie(0,s-1,function(){var p=h.createElement("SPAN");le(p,r.CSS_CLASSES.emptyIndicator),u.appendChild(p)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var v=this.hot.rootDocument.createElement("DIV");le(i,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?le(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):le(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(o){var i=o;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(VE),NB=FPe;function DS(e){return DS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DS(e)}function AD(e){return WPe(e)||VPe(e)||BPe(e)||jPe()}function jPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BPe(e,t){if(!!e){if(typeof e=="string")return xS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xS(e,t)}}function VPe(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WPe(e){if(Array.isArray(e))return xS(e)}function xS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ID(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zPe(e,t,r){return t&&ID(e.prototype,t),r&&ID(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NS(e,t)}function NS(e,t){return NS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},NS(e,t)}function GPe(e){var t=qPe();return function(){var n=Ud(e),o;if(t){var i=Ud(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return KPe(this,o)}}function KPe(e,t){if(t&&(DS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XPe(e)}function XPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qPe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ud(e){return Ud=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ud(e)}var QPe=function(e){YPe(r,e);var t=GPe(r);function r(n,o){var i;return UPe(this,r),i=t.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),P(i.lastCollapsedRows,function(f,c){f>=s&&f<l&&(i.lastCollapsedRows[c]=f+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:function(s,l){Ie(s,s+l-1,function(u){var f=i.lastCollapsedRows.indexOf(u);f>-1&&i.lastCollapsedRows.splice(f,1)})}},i}return zPe(r,[{key:"collapseChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(o),f=o),this.dataManager.hasChildren(u)&&P(u.__children,function(h){l.push(i.dataManager.getRowIndex(h))}),c=this.collapseRows(l,!0,!1),s&&this.trimRows(c),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];P(o,function(u){l.push.apply(l,AD(i.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([o],i)}},{key:"collapseRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return P(o,function(u){l.push(u),a&&i.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var l=this.dataManager.getDataObject(o);P(l.__children,function(u){var f=i.dataManager.getRowIndex(u);a.push(f),i.collapseChildRows(f,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([o],i)}},{key:"expandRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return P(o,function(u){l.push(u),a&&i.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(o)){var l=this.dataManager.getDataObject(o);P(l.__children,function(u){if(!i.isAnyParentCollapsed(u)){var f=i.dataManager.getRowIndex(u);a.push(f),i.expandChildRows(f,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(o)?(u=o,f=this.dataManager.getRowIndex(o)):(u=this.dataManager.getDataObject(o),f=o),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&P(u.__children,function(h){var d=i.dataManager.getRowIndex(h);l.push(d)}),c=this.expandRows(l,!0,!1),s&&this.untrimRows(c),a&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];P(o,function(u){l.push.apply(l,AD(i.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];P(i,function(s){o.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var o=this,i=this.dataManager.getData(),a=[];P(i,function(s){o.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(o){var i=this;this.hot.batchExecution(function(){P(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(o){var i=this;this.hot.batchExecution(function(){P(o,function(a){i.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(o){var i=this,a=isNaN(o)?o:this.dataManager.getDataObject(o),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&P(a.__children,function(l){var u=i.dataManager.getRowIndex(l);if(!i.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(o){for(var i=o;i!==null;){i=this.dataManager.getRowParent(i);var a=this.dataManager.getRowIndex(i);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(o,i){if(!(i.col>=0)){var a=this.translateTrimmedRow(i.row);Ve(o.target,NB.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),At(o))}}},{key:"translateTrimmedRow",value:function(o){return this.hot.toPhysicalRow(o)}},{key:"untranslateTrimmedRow",value:function(o){return this.hot.toVisualRow(o)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(VE),ZPe=QPe;function HS(e){return HS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HS(e)}function JPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function e1e(e,t,r){return t&&PD(e.prototype,t),r&&PD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function t1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LS(e,t)}function LS(e,t){return LS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},LS(e,t)}function r1e(e){var t=o1e();return function(){var n=zd(e),o;if(t){var i=zd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return n1e(this,o)}}function n1e(e,t){if(t&&(HS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HB(e)}function HB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zd(e){return zd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},zd(e)}var MD=new WeakMap,i1e=function(e){t1e(r,e);var t=r1e(r);function r(n,o){var i;return JPe(this,r),i=t.call(this,n,o),MD.set(HB(i),{row_above:function(s,l){var u=l[l.length-1];i.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];i.dataManager.addSibling(u.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return e1e(r,[{key:"appendOptions",value:function(o){var i=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(MR)},callback:function(){var l=i.dataManager.translateTrimmedRow(i.hot.getSelectedLast()[0]),u=i.dataManager.getDataObject(l);i.dataManager.addChild(u)},disabled:function(){var l=i.hot.getSelectedLast();return!l||l[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase($R)},callback:function(){i.dataManager.detachFromParent(i.hot.getSelectedLast())},disabled:function(){var l=i.hot.getSelectedLast(),u=i.dataManager.translateTrimmedRow(l[0]),f=i.dataManager.getRowParent(u);return!f||!l||l[0]<0||i.hot.selection.isSelectedByColumnHeader()||i.hot.countRows()>=i.hot.getSettings().maxRows}},{name:"---------"}];return Ie(0,o.items.length-1,function(s){if(s===0)return P(a,function(l,u){o.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(o)}},{key:"modifyRowInsertingOptions",value:function(o){var i=MD.get(this);return Ie(0,o.items.length-1,function(a){var s=i[o.items[a].key];s!=null&&(o.items[a].callback=s)}),o}}]),r}(VE),a1e=i1e,$D;function DD(e){return f1e(e)||u1e(e)||l1e(e)||s1e()}function s1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l1e(e,t){if(!!e){if(typeof e=="string")return FS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FS(e,t)}}function u1e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function f1e(e){if(Array.isArray(e))return FS(e)}function FS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c1e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d1e(e,t,r){return t&&xD(e.prototype,t),r&&xD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var v1e=function(){function e(t){h1e(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return d1e(e,[{key:"onBeforeRowMove",value:function(r,n,o,i){var a=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:o,movePossible:i});if(s)return!1;this.movedToCollapsed=!1;var l=o===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o),f=!0,c=r.map(function(b){if(!f)return!1;var _=a.dataManager.translateTrimmedRow(b);return f=a.shouldAllowMoving(_,u),_}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(l,u),p=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,p),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,o,i,i&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,o),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,o=r.finalIndex,i=r.dropIndex,a=r.movePossible,s=!1;return It(i)&&(kt(Rt($D||($D=c1e([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,o,i,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var o=this.dataManager.getRowParent(r?n-1:n);return o==null&&(o=this.dataManager.getRowParent(n-1)),o}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,o){o||(Math.max.apply(Math,DD(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,o){var i=this,a=n===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(function(){r.forEach(function(s){i.dataManager.moveRow(s,n,i.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var o=this,i,a=[],s=Math.max.apply(Math,DD(r))<n;r.forEach(function(l){a.push(o.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(i=this.hot).spliceCellsMeta.apply(i,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var o=r.length,i=0,a=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[o-1]<n?u=this.dataManager.translateTrimmedRow(n-o):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);i=this.dataManager.untranslateTrimmedRow(c),a=i}else r[o-1]<n?(a=n-1,i=a-o+1):(i=n,a=i+o-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(new J(i,0)),s.setRangeEnd(new J(a,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(o,i){return o-i!==n})}}]),e}();function jS(e){return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jS(e)}function ND(e){return m1e(e)||y1e(e)||g1e(e)||p1e()}function p1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g1e(e,t){if(!!e){if(typeof e=="string")return BS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BS(e,t)}}function y1e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m1e(e){if(Array.isArray(e))return BS(e)}function BS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w1e(e,t,r){return t&&HD(e.prototype,t),r&&HD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _a(){return typeof Reflect!="undefined"&&Reflect.get?_a=Reflect.get:_a=function(t,r,n){var o=_1e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_a.apply(this,arguments)}function _1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Io(e),e!==null););return e}function S1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VS(e,t)}function VS(e,t){return VS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},VS(e,t)}function C1e(e){var t=R1e();return function(){var n=Io(e),o;if(t){var i=Io(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return O1e(this,o)}}function O1e(e,t){if(t&&(jS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LB(e)}function LB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Io(e){return Io=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Io(e)}var Sy="nestedRows",E1e=300,eo=new WeakMap,T1e="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",k1e=function(e){S1e(r,e);var t=C1e(r);function r(n){var o;return b1e(this,r),o=t.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,eo.set(LB(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return w1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Sy]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new xf),this.dataManager=new kPe(this,this.hot),this.collapsingUI=new ZPe(this,this.hot),this.headersUI=new NB(this,this.hot),this.contextMenuUI=new a1e(this,this.hot),this.rowMoveController=new v1e(this),this.addHook("afterInit",function(){return o.onAfterInit.apply(o,arguments)}),this.addHook("beforeViewRender",function(){return o.onBeforeViewRender.apply(o,arguments)}),this.addHook("modifyRowData",function(){return o.onModifyRowData.apply(o,arguments)}),this.addHook("modifySourceLength",function(){return o.onModifySourceLength.apply(o,arguments)}),this.addHook("beforeDataSplice",function(){return o.onBeforeDataSplice.apply(o,arguments)}),this.addHook("filterData",function(){return o.onFilterData.apply(o,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return o.onAfterContextMenuDefaultOptions.apply(o,arguments)}),this.addHook("afterGetRowHeader",function(){return o.onAfterGetRowHeader.apply(o,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return o.onBeforeOnCellMouseDown.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("beforeAddChild",function(){return o.onBeforeAddChild.apply(o,arguments)}),this.addHook("afterAddChild",function(){return o.onAfterAddChild.apply(o,arguments)}),this.addHook("beforeDetachChild",function(){return o.onBeforeDetachChild.apply(o,arguments)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return o.onModifyRowHeaderWidth.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("beforeRowMove",function(){return o.onBeforeRowMove.apply(o,arguments)}),this.addHook("beforeLoadData",function(i){return o.onBeforeLoadData(i)}),_a(Io(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),_a(Io(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var o=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(o),_a(Io(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(o,i,a,s){return this.rowMoveController.onBeforeRowMove(o,i,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var o=eo.get(this);o.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var o=eo.get(this);o.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(o,i,a){this.collapsingUI.toggleState(o,i,a)}},{key:"onModifyRowData",value:function(o){var i=eo.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.getDataObject(o)}},{key:"onModifySourceLength",value:function(){var o=eo.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(o,i,a){var s=eo.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(o)?!0:(this.dataManager.spliceData(o,i,a),!1)}},{key:"onFilterData",value:function(o,i,a){var s=eo.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],i),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*i),this.dataManager.filterData(o,i,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(o){return this.contextMenuUI.appendOptions(o)}},{key:"onAfterGetRowHeader",value:function(o,i){this.headersUI.appendLevelIndicators(o,i)}},{key:"onModifyRowHeaderWidth",value:function(o){return this.headersUI.rowHeaderWidthCache||o}},{key:"onAfterRemoveRow",value:function(o,i,a,s){var l=this;if(s!==this.pluginName){var u=eo.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(o,i,a){var s=this,l=Array.from(a.reduce(function(u,f){if(s.dataManager.isParent(f)){var c=s.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));a.length=0,a.push.apply(a,ND(l))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(o,i){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(i)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(o,i,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var o=Math.max.apply(Math,ND(this.dataManager.cache.levels));o>0&&this.headersUI.updateRowHeaderWidth(o)}},{key:"onBeforeViewRender",value:function(o,i){var a=eo.get(this);a.skipRender&&(i.skipRender=!0)}},{key:"destroy",value:function(){_a(Io(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(o){if(!pF(o)){TO(T1e),this.hot.getSettings()[Sy]=!1,this.disablePlugin();return}this.dataManager.setData(o),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return Sy}},{key:"PLUGIN_PRIORITY",get:function(){return E1e}}]),r}(vt);function A1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I1e(e,t,r){return t&&LD(e.prototype,t),r&&LD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var P1e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;A1e(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return I1e(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var o=typeof r=="undefined"?n:r,i=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(o));return i===null?void 0:JSON.parse(i)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;P(this.savedKeys,function(n,o){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[o]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}(),M1e=P1e;function WS(e){return WS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WS(e)}function $1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D1e(e,t,r){return t&&FD(e.prototype,t),r&&FD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sa(){return typeof Reflect!="undefined"&&Reflect.get?Sa=Reflect.get:Sa=function(t,r,n){var o=x1e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Sa.apply(this,arguments)}function x1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Po(e),e!==null););return e}function N1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&US(e,t)}function US(e,t){return US=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},US(e,t)}function H1e(e){var t=j1e();return function(){var n=Po(e),o;if(t){var i=Po(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return L1e(this,o)}}function L1e(e,t){if(t&&(WS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F1e(e)}function F1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j1e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(e){return Po=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Po(e)}Ae.getSingleton().register("persistentStateSave");Ae.getSingleton().register("persistentStateLoad");Ae.getSingleton().register("persistentStateReset");var jD="persistentState",B1e=0,V1e=function(e){N1e(r,e);var t=H1e(r);function r(n){var o;return $1e(this,r),o=t.call(this,n),o.storage=void 0,o}return D1e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jD]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.storage||(this.storage=new M1e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(i,a){return o.saveValue(i,a)}),this.addHook("persistentStateLoad",function(i,a){return o.loadValue(i,a)}),this.addHook("persistentStateReset",function(){return o.resetValue()}),Sa(Po(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Sa(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Sa(Po(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(o,i){i.value=this.storage.loadValue(o)}},{key:"saveValue",value:function(o,i){this.storage.saveValue(o,i)}},{key:"resetValue",value:function(o){typeof o=="undefined"?this.storage.resetAll():this.storage.reset(o)}},{key:"destroy",value:function(){Sa(Po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jD}},{key:"PLUGIN_PRIORITY",get:function(){return B1e}}]),r}(vt);function zS(e){return zS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zS(e)}function W1e(e){return G1e(e)||Y1e(e)||z1e(e)||U1e()}function U1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z1e(e,t){if(!!e){if(typeof e=="string")return YS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YS(e,t)}}function Y1e(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G1e(e){if(Array.isArray(e))return YS(e)}function YS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X1e(e,t,r){return t&&BD(e.prototype,t),r&&BD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ca(){return typeof Reflect!="undefined"&&Reflect.get?Ca=Reflect.get:Ca=function(t,r,n){var o=q1e(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function q1e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Mo(e),e!==null););return e}function Q1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GS(e,t)}function GS(e,t){return GS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},GS(e,t)}function Z1e(e){var t=tMe();return function(){var n=Mo(e),o;if(t){var i=Mo(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return J1e(this,o)}}function J1e(e,t){if(t&&(zS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eMe(e)}function eMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tMe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Mo(e)}var Cy="search",rMe=190,nMe="htSearchResult",oMe=function(t,r,n,o,i){t.getCellMeta(r,n).isSearchResult=i},iMe=function(t,r,n){return It(t)||t===null||!t.toLocaleLowerCase||t.length===0||It(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},aMe=function(e){Q1e(r,e);var t=Z1e(r);function r(n){var o;return K1e(this,r),o=t.call(this,n),o.callback=oMe,o.queryMethod=iMe,o.searchResultClass=nMe,o}return X1e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Cy]}},{key:"enablePlugin",value:function(){var o=this;if(!this.enabled){var i=this.hot.getSettings()[Cy];this.updatePluginSettings(i),this.addHook("beforeRenderer",function(){return o.onBeforeRenderer.apply(o,arguments)}),Ca(Mo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var o=this,i=function(){return o.onBeforeRenderer.apply(o,arguments)};this.hot.addHook("beforeRenderer",i),this.hot.addHookOnce("afterViewRender",function(){o.hot.removeHook("beforeRenderer",i)}),Ca(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ca(Mo(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(o){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return Ie(0,l-1,function(h){Ie(0,u-1,function(d){var v=i.hot.getDataAtCell(h,d),p=i.hot.getCellMeta(h,d),b=p.search.callback||a,_=p.search.queryMethod||s,S=_(o,v,p);if(S){var E={row:h,col:d,data:v};f.push(E)}b&&b(c,h,d,v,S)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(o){this.callback=o}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(o){this.queryMethod=o}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(o){this.searchResultClass=o}},{key:"updatePluginSettings",value:function(o){Ze(o)&&(o.searchResultClass&&this.setSearchResultClass(o.searchResultClass),o.queryMethod&&this.setQueryMethod(o.queryMethod),o.callback&&this.setCallback(o.callback))}},{key:"onBeforeRenderer",value:function(o,i,a,s,l,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,W1e(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){Ca(Mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cy}},{key:"PLUGIN_PRIORITY",get:function(){return rMe}}]),r}(vt);function KS(e){return KS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KS(e)}function sMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lMe(e,t,r){return t&&VD(e.prototype,t),r&&VD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ys(){return typeof Reflect!="undefined"&&Reflect.get?Ys=Reflect.get:Ys=function(t,r,n){var o=uMe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ys.apply(this,arguments)}function uMe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wi(e),e!==null););return e}function fMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XS(e,t)}function XS(e,t){return XS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},XS(e,t)}function cMe(e){var t=vMe();return function(){var n=wi(e),o;if(t){var i=wi(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return hMe(this,o)}}function hMe(e,t){if(t&&(KS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dMe(e)}function dMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vMe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(e){return wi=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},wi(e)}var pMe="touchScroll",gMe=200,yMe=function(e){fMe(r,e);var t=cMe(r);function r(n){var o;return sMe(this,r),o=t.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return lMe(r,[{key:"isEnabled",value:function(){return WC()}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.addHook("afterViewRender",function(){return o.onAfterViewRender()}),this.registerEvents(),Ys(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Ys(wi(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ys(wi(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var o=this;this.addHook("beforeTouchScroll",function(){return o.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return o.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var o=this.hot.view.wt.wtOverlays,i=o.topOverlay,a=o.bottomOverlay,s=o.leftOverlay,l=o.topLeftCornerOverlay,u=o.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(i),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,P(this.clones,function(o){le(o,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var o=this;this.freezeOverlays=!1,P(this.clones,function(i){Ge(i,"hide-tween"),le(i,"show-tween")}),this.hot._registerTimeout(function(){P(o.clones,function(i){Ge(i,"show-tween")})},400),P(this.scrollbars,function(i){i.refresh(),i.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return pMe}},{key:"PLUGIN_PRIORITY",get:function(){return gMe}}]),r}(vt);function qS(e){return qS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qS(e)}function mMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bMe(e,t,r){return t&&WD(e.prototype,t),r&&WD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oa(){return typeof Reflect!="undefined"&&Reflect.get?Oa=Reflect.get:Oa=function(t,r,n){var o=wMe(t,r);if(!!o){var i=Object.getOwnPropertyDescriptor(o,r);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oa.apply(this,arguments)}function wMe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$o(e),e!==null););return e}function _Me(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QS(e,t)}function QS(e,t){return QS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},QS(e,t)}function SMe(e){var t=RMe();return function(){var n=$o(e),o;if(t){var i=$o(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return CMe(this,o)}}function CMe(e,t){if(t&&(qS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OMe(e)}function OMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RMe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $o(e){return $o=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},$o(e)}var Kc="trimRows",EMe=330,TMe=function(e){_Me(r,e);var t=SMe(r);function r(n){var o;return mMe(this,r),o=t.call(this,n),o.trimmedRowsMap=null,o}return bMe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kc]}},{key:"enablePlugin",value:function(){var o=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new xf),this.trimmedRowsMap.addLocalHook("init",function(){return o.onMapInit()}),Oa($o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var o=this,i=this.hot.getSettings()[Kc];Array.isArray(i)&&this.hot.batchExecution(function(){o.trimmedRowsMap.clear(),P(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Oa($o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Oa($o(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(o){var i=this,a=this.getTrimmedRows(),s=this.isValidConfig(o),l=a;s&&(l=Array.from(new Set(a.concat(o))));var u=this.hot.runHooks("beforeTrimRow",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){P(o,function(f){i.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.trimRows(i)}},{key:"untrimRows",value:function(o){var i=this.getTrimmedRows(),a=this.isValidConfig(o),s=i,l=this.trimmedRowsMap.getValues().slice(),u=o.length>0;a&&u&&(P(o,function(c){l[c]=!1}),s=zt(l,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",i,s,a&&u);f!==!1&&(a&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",i,s,a&&u,a&&s.length<i.length))}},{key:"untrimRow",value:function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];this.untrimRows(i)}},{key:"isTrimmed",value:function(o){return this.trimmedRowsMap.getValueAtIndex(o)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(o){var i=this.hot.countSourceRows();return o.every(function(a){return Number.isInteger(a)&&a>=0&&a<i})}},{key:"onMapInit",value:function(){var o=this,i=this.hot.getSettings()[Kc];Array.isArray(i)&&this.hot.batchExecution(function(){P(i,function(a){o.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Oa($o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Kc}},{key:"PLUGIN_PRIORITY",get:function(){return EMe}}]),r}(vt);function ZS(e){return ZS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZS(e)}function FB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UD(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jB(e,t,r){return t&&UD(e.prototype,t),r&&UD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JS(e,t)}function JS(e,t){return JS=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},JS(e,t)}function VB(e){var t=IMe();return function(){var n=Yd(e),o;if(t){var i=Yd(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return kMe(this,o)}}function kMe(e,t){if(t&&(ZS(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AMe(e)}function AMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IMe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yd(e){return Yd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Yd(e)}function PMe(e){return DMe(e)||$Me(e)||UB(e)||MMe()}function MMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Me(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DMe(e){if(Array.isArray(e))return eC(e)}function WB(e,t){return HMe(e)||NMe(e,t)||UB(e,t)||xMe()}function xMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UB(e,t){if(!!e){if(typeof e=="string")return eC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eC(e,t)}}function eC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NMe(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(l){i=!0,s=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function HMe(e){if(Array.isArray(e))return e}var LMe="undoRedo";function Re(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(!!i){var a=r.find(function(l){var u=WB(l,4),f=u[2],c=u[3];return f!==c});if(!!a){var s=function(){var u=r.reduce(function(c,h){return c.push(PMe(h)),c},[]);P(u,function(c){c[1]=e.propToCol(c[1])});var f=i>1?o.getSelected():[[u[0][0],u[0][1]]];return new Re.ChangeAction(u,f)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,o){t.done(function(){return new Re.CreateRowAction(r,n)},o)}),e.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var l=t.instance.getSourceDataArray(),u=(l.length+r)%l.length,f=e.toPhysicalRow(u),c=kr(l.slice(f,f+n));return new Re.RemoveRowAction(u,c,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)};t.done(a,i)}),e.addHook("afterCreateCol",function(r,n,o){t.done(function(){return new Re.CreateColumnAction(r,n)},o)}),e.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];Ie(l.length-1,function(p){var b=[],_=l[p];Ie(u,u+(n-1),function(S){b.push(_[e.toPhysicalColumn(S)])}),f.push(b)}),Ie(n-1,function(p){h.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&Ie(n-1,function(p){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new Re.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsLeft)};t.done(a,i)}),e.addHook("beforeCellAlignment",function(r,n,o,i){t.done(function(){return new Re.CellAlignmentAction(r,n,o,i)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new Re.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new Re.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new Re.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new Re.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}Re.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,t);if(o!==!1){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};Re.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=kr(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Re.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=kr(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Re.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Re.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Re.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Re.prototype.isEnabled=function(){return this.enabled};Re.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,BMe(e),e.addHook("beforeKeyDown",zB),e.addHook("afterChange",YB)}};Re.prototype.disable=function(){if(!!this.isEnabled()){var e=this.instance;this.enabled=!1,VMe(e),e.removeHook("beforeKeyDown",zB),e.removeHook("afterChange",YB)}};Re.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Re.Action=function(){};Re.Action.prototype.undo=function(){};Re.Action.prototype.redo=function(){};Re.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Bo(Re.ChangeAction,Re.Action);Re.ChangeAction.prototype.undo=function(e,t){for(var r=kr(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=WB(r[s],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};Re.ChangeAction.prototype.redo=function(e,t){for(var r=kr(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};Re.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Bo(Re.CreateRowAction,Re.Action);Re.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Re.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};Re.RemoveRowAction=function(e,t,r,n){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n};Bo(Re.RemoveRowAction,Re.Action);Re.RemoveRowAction.prototype.undo=function(e,t){var r=e.getSettings();r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};Re.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Re.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Bo(Re.CreateColumnAction,Re.Action);Re.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Re.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};Re.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsLeft=a};Bo(Re.RemoveColumnAction,Re.Action);Re.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsLeft=this.fixedColumnsLeft;for(var o=this.indexes.slice(0).sort(),i=function(h,d,v){return v[r.indexes.indexOf(o[d])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(et(this.data[l],i));var u=et(this.headers,i),f=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),P(e.getSourceDataArray(),function(c,h){P(o,function(d,v){c[d]=s[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),typeof this.headers!="undefined"&&P(u,function(c,h){e.getSettings().colHeaders[o[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};Re.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Re.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};Re.CellAlignmentAction.prototype.undo=function(e,t){var r=this;P(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&e.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};Re.CellAlignmentAction.prototype.redo=function(e,t){Jo(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,o,i){return e.setCellMeta(r,n,o,i)}),e.addHookOnce("afterViewRender",t),e.render()};Re.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Bo(Re.FiltersAction,Re.Action);Re.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};Re.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var FMe=function(e){BB(r,e);var t=VB(r);function r(n,o){var i;FB(this,r),i=t.call(this),i.cellRange=o;var a=i.cellRange.getTopLeftCorner(),s=i.cellRange.getBottomRightCorner();return i.rangeData=n.getData(a.row,a.col,s.row,s.col),i}return jB(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopLeftCorner();o.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange)}}]),r}(Re.Action);Re.MergeCellsAction=FMe;var jMe=function(e){BB(r,e);var t=VB(r);function r(n,o){var i;return FB(this,r),i=t.call(this),i.cellRange=o,i}return jB(r,[{key:"undo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(o,i){var a=o.getPlugin("mergeCells");o.addHookOnce("afterViewRender",i),a.unmergeRange(this.cellRange,!0),o.render()}}]),r}(Re.Action);Re.UnmergeCellsAction=jMe;Re.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Bo(Re.RowMoveAction,Re.Action);Re.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(f){return f>r.finalIndex}),a=o.filter(function(f){return f<=r.finalIndex}),s=i.sort(function(f,c){return c-f}).concat(a.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Re.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};Re.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e=="undefined"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};function zB(e){if(!_n(e)){var t=this,r=t.getActiveEditor();if(!(r&&r.isOpened())){var n=e.altKey,o=e.ctrlKey,i=e.keyCode,a=e.metaKey,s=e.shiftKey,l=(o||a)&&!n;if(!!l){var u=i===89||s&&i===90;u?(t.undoRedo.redo(),At(e)):i===90&&(t.undoRedo.undo(),At(e))}}}}function YB(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function BMe(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function VMe(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var Wf=Ae.getSingleton();Wf.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});Wf.register("beforeUndo");Wf.register("afterUndo");Wf.register("beforeRedo");Wf.register("afterRedo");Re.PLUGIN_KEY=LMe;function WMe(){ht(gpe),ht(Fpe),ht(tge),ht(Vge),ht(iye),ht(_j),ht(kme),ht(rbe),ht($j),ht(Rwe),ht(Ywe),ht(t_e),ht(Lj),ht(G_e),ht(pEe),ht(zEe),ht(vTe),ht(HTe),ht(o0e),ht(L0e),ht(G0e),ht(Tke),ht(Nke),ht(SAe),ht(BAe),ht(ZAe),ht(wPe),ht(k1e),ht(V1e),ht(aMe),ht(yMe),ht(TMe),ht(Re)}function UMe(){Yde(),ove(),bve(),Nve(),WMe()}function zMe(e){var t=typeof window=="undefined"?!1:window.jQuery;!t||(t.fn.handsontable=function(r){var n=this.first(),o=n.data("handsontable");if(typeof r!="string"){var i=r||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var a;if(o)if(typeof o[r]!="undefined"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];a=(s=o[r]).call.apply(s,[o].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return a})}var Oy,Ry,Ey,Ty,ky;UMe();zMe(Xe);Xe.__GhostTable=AE;Xe._getListenersCounter=bre;Xe._getRegisteredMapsCounter=Yle;Xe.EventManager=bt;var YMe=[v7,b7,Rse,dve,s5,vJ,ZZ,lae,p7,eJ,Xne,rae],GMe=[fJ,vre];Xe.helper={};Xe.dom={};P(YMe,function(e){P(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Xe.helper[t]=e[t])})});P(GMe,function(e){P(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(Xe.dom[t]=e[t])})});Xe.cellTypes=(Oy=Xe.cellTypes)!==null&&Oy!==void 0?Oy:{};P(wse(),function(e){Xe.cellTypes[e]=Dv(e)});Xe.cellTypes.registerCellType=gn;Xe.cellTypes.getCellType=Dv;Xe.editors=(Ry=Xe.editors)!==null&&Ry!==void 0?Ry:{};P(Uoe(),function(e){Xe.editors["".concat(an(e),"Editor")]=GL(e)});Xe.editors.registerEditor=Wr;Xe.editors.getEditor=GL;Xe.renderers=(Ey=Xe.renderers)!==null&&Ey!==void 0?Ey:{};P(Jae(),function(e){var t=BO(e);e==="base"&&(Xe.renderers.cellDecorator=t),Xe.renderers["".concat(an(e),"Renderer")]=t});Xe.renderers.registerRenderer=ro;Xe.renderers.getRenderer=BO;Xe.validators=(Ty=Xe.validators)!==null&&Ty!==void 0?Ty:{};P(rse(),function(e){Xe.validators["".concat(an(e),"Validator")]=VO(e)});Xe.validators.registerValidator=As;Xe.validators.getValidator=VO;Xe.plugins=(ky=Xe.plugins)!==null&&ky!==void 0?ky:{};P(jO(),function(e){Xe.plugins[e]=Pf(e)});Xe.plugins["".concat(an(vt.PLUGIN_KEY),"Plugin")]=vt;Xe.plugins.registerPlugin=ht;Xe.plugins.getPlugin=Pf;var KMe={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function a(u,f){if(!o[u]){if(!n[u]){var c=typeof oi=="function"&&oi;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=o[u]={exports:{}};n[u][0].call(d.exports,function(v){var p=n[u][1][v];return a(p||v)},d,d.exports,r,n,o,i)}return o[u].exports}for(var s=typeof oi=="function"&&oi,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(r,n,o){(function(i){var a=i.MutationObserver||i.WebKitMutationObserver,s;if(a){var l=0,u=new a(v),f=i.document.createTextNode("");u.observe(f,{characterData:!0}),s=function(){f.data=l=++l%2}}else if(!i.setImmediate&&typeof i.MessageChannel!="undefined"){var c=new i.MessageChannel;c.port1.onmessage=v,s=function(){c.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?s=function(){var b=i.document.createElement("script");b.onreadystatechange=function(){v(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:s=function(){setTimeout(v,0)};var h,d=[];function v(){h=!0;for(var b,_,S=d.length;S;){for(_=d,d=[],b=-1;++b<S;)_[b]();S=d.length}h=!1}n.exports=p;function p(b){d.push(b)===1&&!h&&s()}}).call(this,typeof Ji!="undefined"?Ji:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(r,n,o){var i=r(1);function a(){}var s={},l=["REJECTED"],u=["FULFILLED"],f=["PENDING"];n.exports=c;function c(k){if(typeof k!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,k!==a&&p(this,k)}c.prototype.catch=function(k){return this.then(null,k)},c.prototype.then=function(k,U){if(typeof k!="function"&&this.state===u||typeof U!="function"&&this.state===l)return this;var Y=new this.constructor(a);if(this.state!==f){var ne=this.state===u?k:U;d(Y,ne,this.outcome)}else this.queue.push(new h(Y,k,U));return Y};function h(k,U,Y){this.promise=k,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof Y=="function"&&(this.onRejected=Y,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(k){s.resolve(this.promise,k)},h.prototype.otherCallFulfilled=function(k){d(this.promise,this.onFulfilled,k)},h.prototype.callRejected=function(k){s.reject(this.promise,k)},h.prototype.otherCallRejected=function(k){d(this.promise,this.onRejected,k)};function d(k,U,Y){i(function(){var ne;try{ne=U(Y)}catch(Z){return s.reject(k,Z)}ne===k?s.reject(k,new TypeError("Cannot resolve promise with itself")):s.resolve(k,ne)})}s.resolve=function(k,U){var Y=b(v,U);if(Y.status==="error")return s.reject(k,Y.value);var ne=Y.value;if(ne)p(k,ne);else{k.state=u,k.outcome=U;for(var Z=-1,te=k.queue.length;++Z<te;)k.queue[Z].callFulfilled(U)}return k},s.reject=function(k,U){k.state=l,k.outcome=U;for(var Y=-1,ne=k.queue.length;++Y<ne;)k.queue[Y].callRejected(U);return k};function v(k){var U=k&&k.then;if(k&&(typeof k=="object"||typeof k=="function")&&typeof U=="function")return function(){U.apply(k,arguments)}}function p(k,U){var Y=!1;function ne(he){Y||(Y=!0,s.reject(k,he))}function Z(he){Y||(Y=!0,s.resolve(k,he))}function te(){U(Z,ne)}var se=b(te);se.status==="error"&&ne(se.value)}function b(k,U){var Y={};try{Y.value=k(U),Y.status="success"}catch(ne){Y.status="error",Y.value=ne}return Y}c.resolve=_;function _(k){return k instanceof this?k:s.resolve(new this(a),k)}c.reject=S;function S(k){var U=new this(a);return s.reject(U,k)}c.all=E;function E(k){var U=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Y=k.length,ne=!1;if(!Y)return this.resolve([]);for(var Z=new Array(Y),te=0,se=-1,he=new this(a);++se<Y;)ae(k[se],se);return he;function ae(Ce,y){U.resolve(Ce).then(w,function(g){ne||(ne=!0,s.reject(he,g))});function w(g){Z[y]=g,++te===Y&&!ne&&(ne=!0,s.resolve(he,Z))}}}c.race=M;function M(k){var U=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Y=k.length,ne=!1;if(!Y)return this.resolve([]);for(var Z=-1,te=new this(a);++Z<Y;)se(k[Z]);return te;function se(he){U.resolve(he).then(function(ae){ne||(ne=!0,s.resolve(te,ae))},function(ae){ne||(ne=!0,s.reject(te,ae))})}}},{"1":1}],3:[function(r,n,o){(function(i){typeof i.Promise!="function"&&(i.Promise=r(2))}).call(this,typeof Ji!="undefined"?Ji:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(r,n,o){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C};function a(C,x){if(!(C instanceof x))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}var l=s();function u(){try{if(!l||!l.open)return!1;var C=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),x=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!C||x)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}function f(C,x){C=C||[],x=x||{};try{return new Blob(C,x)}catch(F){if(F.name!=="TypeError")throw F;for(var A=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,B=new A,X=0;X<C.length;X+=1)B.append(C[X]);return B.getBlob(x.type)}}typeof Promise=="undefined"&&r(3);var c=Promise;function h(C,x){x&&C.then(function(A){x(null,A)},function(A){x(A)})}function d(C,x,A){typeof x=="function"&&C.then(x),typeof A=="function"&&C.catch(A)}function v(C){return typeof C!="string"&&(console.warn(C+" used as a key, but it is not a string."),C=String(C)),C}function p(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var b="local-forage-detect-blob-support",_=void 0,S={},E=Object.prototype.toString,M="readonly",k="readwrite";function U(C){for(var x=C.length,A=new ArrayBuffer(x),B=new Uint8Array(A),X=0;X<x;X++)B[X]=C.charCodeAt(X);return A}function Y(C){return new c(function(x){var A=C.transaction(b,k),B=f([""]);A.objectStore(b).put(B,"key"),A.onabort=function(X){X.preventDefault(),X.stopPropagation(),x(!1)},A.oncomplete=function(){var X=navigator.userAgent.match(/Chrome\/(\d+)/),F=navigator.userAgent.match(/Edge\//);x(F||!X||parseInt(X[1],10)>=43)}}).catch(function(){return!1})}function ne(C){return typeof _=="boolean"?c.resolve(_):Y(C).then(function(x){return _=x,_})}function Z(C){var x=S[C.name],A={};A.promise=new c(function(B,X){A.resolve=B,A.reject=X}),x.deferredOperations.push(A),x.dbReady?x.dbReady=x.dbReady.then(function(){return A.promise}):x.dbReady=A.promise}function te(C){var x=S[C.name],A=x.deferredOperations.pop();if(A)return A.resolve(),A.promise}function se(C,x){var A=S[C.name],B=A.deferredOperations.pop();if(B)return B.reject(x),B.promise}function he(C,x){return new c(function(A,B){if(S[C.name]=S[C.name]||V(),C.db)if(x)Z(C),C.db.close();else return A(C.db);var X=[C.name];x&&X.push(C.version);var F=l.open.apply(l,X);x&&(F.onupgradeneeded=function(ie){var ce=F.result;try{ce.createObjectStore(C.storeName),ie.oldVersion<=1&&ce.createObjectStore(b)}catch(ge){if(ge.name==="ConstraintError")console.warn('The database "'+C.name+'" has been upgraded from version '+ie.oldVersion+" to version "+ie.newVersion+', but the storage "'+C.storeName+'" already exists.');else throw ge}}),F.onerror=function(ie){ie.preventDefault(),B(F.error)},F.onsuccess=function(){var ie=F.result;ie.onversionchange=function(ce){ce.target.close()},A(ie),te(C)}})}function ae(C){return he(C,!1)}function Ce(C){return he(C,!0)}function y(C,x){if(!C.db)return!0;var A=!C.db.objectStoreNames.contains(C.storeName),B=C.version<C.db.version,X=C.version>C.db.version;if(B&&(C.version!==x&&console.warn('The database "'+C.name+`" can't be downgraded from version `+C.db.version+" to version "+C.version+"."),C.version=C.db.version),X||A){if(A){var F=C.db.version+1;F>C.version&&(C.version=F)}return!0}return!1}function w(C){return new c(function(x,A){var B=new FileReader;B.onerror=A,B.onloadend=function(X){var F=btoa(X.target.result||"");x({__local_forage_encoded_blob:!0,data:F,type:C.type})},B.readAsBinaryString(C)})}function g(C){var x=U(atob(C.data));return f([x],{type:C.type})}function m(C){return C&&C.__local_forage_encoded_blob}function R(C){var x=this,A=x._initReady().then(function(){var B=S[x._dbInfo.name];if(B&&B.dbReady)return B.dbReady});return d(A,C,C),A}function $(C){Z(C);for(var x=S[C.name],A=x.forages,B=0;B<A.length;B++){var X=A[B];X._dbInfo.db&&(X._dbInfo.db.close(),X._dbInfo.db=null)}return C.db=null,ae(C).then(function(F){return C.db=F,y(C)?Ce(C):F}).then(function(F){C.db=x.db=F;for(var ie=0;ie<A.length;ie++)A[ie]._dbInfo.db=F}).catch(function(F){throw se(C,F),F})}function I(C,x,A,B){B===void 0&&(B=1);try{var X=C.db.transaction(C.storeName,x);A(null,X)}catch(F){if(B>0&&(!C.db||F.name==="InvalidStateError"||F.name==="NotFoundError"))return c.resolve().then(function(){if(!C.db||F.name==="NotFoundError"&&!C.db.objectStoreNames.contains(C.storeName)&&C.version<=C.db.version)return C.db&&(C.version=C.db.version+1),Ce(C)}).then(function(){return $(C).then(function(){I(C,x,A,B-1)})}).catch(A);A(F)}}function V(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function q(C){var x=this,A={db:null};if(C)for(var B in C)A[B]=C[B];var X=S[A.name];X||(X=V(),S[A.name]=X),X.forages.push(x),x._initReady||(x._initReady=x.ready,x.ready=R);var F=[];function ie(){return c.resolve()}for(var ce=0;ce<X.forages.length;ce++){var ge=X.forages[ce];ge!==x&&F.push(ge._initReady().catch(ie))}var ye=X.forages.slice(0);return c.all(F).then(function(){return A.db=X.db,ae(A)}).then(function(we){return A.db=we,y(A,x._defaultConfig.version)?Ce(A):we}).then(function(we){A.db=X.db=we,x._dbInfo=A;for(var Me=0;Me<ye.length;Me++){var at=ye[Me];at!==x&&(at._dbInfo.db=A.db,at._dbInfo.version=A.version)}})}function oe(C,x){var A=this;C=v(C);var B=new c(function(X,F){A.ready().then(function(){I(A._dbInfo,M,function(ie,ce){if(ie)return F(ie);try{var ge=ce.objectStore(A._dbInfo.storeName),ye=ge.get(C);ye.onsuccess=function(){var we=ye.result;we===void 0&&(we=null),m(we)&&(we=g(we)),X(we)},ye.onerror=function(){F(ye.error)}}catch(we){F(we)}})}).catch(F)});return h(B,x),B}function ee(C,x){var A=this,B=new c(function(X,F){A.ready().then(function(){I(A._dbInfo,M,function(ie,ce){if(ie)return F(ie);try{var ge=ce.objectStore(A._dbInfo.storeName),ye=ge.openCursor(),we=1;ye.onsuccess=function(){var Me=ye.result;if(Me){var at=Me.value;m(at)&&(at=g(at));var yt=C(at,Me.key,we++);yt!==void 0?X(yt):Me.continue()}else X()},ye.onerror=function(){F(ye.error)}}catch(Me){F(Me)}})}).catch(F)});return h(B,x),B}function de(C,x,A){var B=this;C=v(C);var X=new c(function(F,ie){var ce;B.ready().then(function(){return ce=B._dbInfo,E.call(x)==="[object Blob]"?ne(ce.db).then(function(ge){return ge?x:w(x)}):x}).then(function(ge){I(B._dbInfo,k,function(ye,we){if(ye)return ie(ye);try{var Me=we.objectStore(B._dbInfo.storeName);ge===null&&(ge=void 0);var at=Me.put(ge,C);we.oncomplete=function(){ge===void 0&&(ge=null),F(ge)},we.onabort=we.onerror=function(){var yt=at.error?at.error:at.transaction.error;ie(yt)}}catch(yt){ie(yt)}})}).catch(ie)});return h(X,A),X}function Te(C,x){var A=this;C=v(C);var B=new c(function(X,F){A.ready().then(function(){I(A._dbInfo,k,function(ie,ce){if(ie)return F(ie);try{var ge=ce.objectStore(A._dbInfo.storeName),ye=ge.delete(C);ce.oncomplete=function(){X()},ce.onerror=function(){F(ye.error)},ce.onabort=function(){var we=ye.error?ye.error:ye.transaction.error;F(we)}}catch(we){F(we)}})}).catch(F)});return h(B,x),B}function me(C){var x=this,A=new c(function(B,X){x.ready().then(function(){I(x._dbInfo,k,function(F,ie){if(F)return X(F);try{var ce=ie.objectStore(x._dbInfo.storeName),ge=ce.clear();ie.oncomplete=function(){B()},ie.onabort=ie.onerror=function(){var ye=ge.error?ge.error:ge.transaction.error;X(ye)}}catch(ye){X(ye)}})}).catch(X)});return h(A,C),A}function Pe(C){var x=this,A=new c(function(B,X){x.ready().then(function(){I(x._dbInfo,M,function(F,ie){if(F)return X(F);try{var ce=ie.objectStore(x._dbInfo.storeName),ge=ce.count();ge.onsuccess=function(){B(ge.result)},ge.onerror=function(){X(ge.error)}}catch(ye){X(ye)}})}).catch(X)});return h(A,C),A}function We(C,x){var A=this,B=new c(function(X,F){if(C<0){X(null);return}A.ready().then(function(){I(A._dbInfo,M,function(ie,ce){if(ie)return F(ie);try{var ge=ce.objectStore(A._dbInfo.storeName),ye=!1,we=ge.openKeyCursor();we.onsuccess=function(){var Me=we.result;if(!Me){X(null);return}C===0||ye?X(Me.key):(ye=!0,Me.advance(C))},we.onerror=function(){F(we.error)}}catch(Me){F(Me)}})}).catch(F)});return h(B,x),B}function Le(C){var x=this,A=new c(function(B,X){x.ready().then(function(){I(x._dbInfo,M,function(F,ie){if(F)return X(F);try{var ce=ie.objectStore(x._dbInfo.storeName),ge=ce.openKeyCursor(),ye=[];ge.onsuccess=function(){var we=ge.result;if(!we){B(ye);return}ye.push(we.key),we.continue()},ge.onerror=function(){X(ge.error)}}catch(we){X(we)}})}).catch(X)});return h(A,C),A}function je(C,x){x=p.apply(this,arguments);var A=this.config();C=typeof C!="function"&&C||{},C.name||(C.name=C.name||A.name,C.storeName=C.storeName||A.storeName);var B=this,X;if(!C.name)X=c.reject("Invalid arguments");else{var F=C.name===A.name&&B._dbInfo.db,ie=F?c.resolve(B._dbInfo.db):ae(C).then(function(ce){var ge=S[C.name],ye=ge.forages;ge.db=ce;for(var we=0;we<ye.length;we++)ye[we]._dbInfo.db=ce;return ce});C.storeName?X=ie.then(function(ce){if(!!ce.objectStoreNames.contains(C.storeName)){var ge=ce.version+1;Z(C);var ye=S[C.name],we=ye.forages;ce.close();for(var Me=0;Me<we.length;Me++){var at=we[Me];at._dbInfo.db=null,at._dbInfo.version=ge}var yt=new c(function(mt,tr){var Yt=l.open(C.name,ge);Yt.onerror=function(Qr){var Nl=Yt.result;Nl.close(),tr(Qr)},Yt.onupgradeneeded=function(){var Qr=Yt.result;Qr.deleteObjectStore(C.storeName)},Yt.onsuccess=function(){var Qr=Yt.result;Qr.close(),mt(Qr)}});return yt.then(function(mt){ye.db=mt;for(var tr=0;tr<we.length;tr++){var Yt=we[tr];Yt._dbInfo.db=mt,te(Yt._dbInfo)}}).catch(function(mt){throw(se(C,mt)||c.resolve()).catch(function(){}),mt})}}):X=ie.then(function(ce){Z(C);var ge=S[C.name],ye=ge.forages;ce.close();for(var we=0;we<ye.length;we++){var Me=ye[we];Me._dbInfo.db=null}var at=new c(function(yt,mt){var tr=l.deleteDatabase(C.name);tr.onerror=function(){var Yt=tr.result;Yt&&Yt.close(),mt(tr.error)},tr.onblocked=function(){console.warn('dropInstance blocked for database "'+C.name+'" until all open connections are closed')},tr.onsuccess=function(){var Yt=tr.result;Yt&&Yt.close(),yt(Yt)}});return at.then(function(yt){ge.db=yt;for(var mt=0;mt<ye.length;mt++){var tr=ye[mt];te(tr._dbInfo)}}).catch(function(yt){throw(se(C,yt)||c.resolve()).catch(function(){}),yt})})}return h(X,x),X}var Fe={_driver:"asyncStorage",_initStorage:q,_support:u(),iterate:ee,getItem:oe,setItem:de,removeItem:Te,clear:me,length:Pe,key:We,keys:Le,dropInstance:je};function re(){return typeof openDatabase=="function"}var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Be="~~local_forage_type~",pt=/^~~local_forage_type~([^~]+)~/,nt="__lfsc__:",ze=nt.length,O="arbf",T="blob",D="si08",z="ui08",H="uic8",K="si16",L="si32",N="ur16",W="ui32",j="fl32",Q="fl64",fe=ze+O.length,Se=Object.prototype.toString;function ke(C){var x=C.length*.75,A=C.length,B,X=0,F,ie,ce,ge;C[C.length-1]==="="&&(x--,C[C.length-2]==="="&&x--);var ye=new ArrayBuffer(x),we=new Uint8Array(ye);for(B=0;B<A;B+=4)F=Ue.indexOf(C[B]),ie=Ue.indexOf(C[B+1]),ce=Ue.indexOf(C[B+2]),ge=Ue.indexOf(C[B+3]),we[X++]=F<<2|ie>>4,we[X++]=(ie&15)<<4|ce>>2,we[X++]=(ce&3)<<6|ge&63;return ye}function Qe(C){var x=new Uint8Array(C),A="",B;for(B=0;B<x.length;B+=3)A+=Ue[x[B]>>2],A+=Ue[(x[B]&3)<<4|x[B+1]>>4],A+=Ue[(x[B+1]&15)<<2|x[B+2]>>6],A+=Ue[x[B+2]&63];return x.length%3===2?A=A.substring(0,A.length-1)+"=":x.length%3===1&&(A=A.substring(0,A.length-2)+"=="),A}function ct(C,x){var A="";if(C&&(A=Se.call(C)),C&&(A==="[object ArrayBuffer]"||C.buffer&&Se.call(C.buffer)==="[object ArrayBuffer]")){var B,X=nt;C instanceof ArrayBuffer?(B=C,X+=O):(B=C.buffer,A==="[object Int8Array]"?X+=D:A==="[object Uint8Array]"?X+=z:A==="[object Uint8ClampedArray]"?X+=H:A==="[object Int16Array]"?X+=K:A==="[object Uint16Array]"?X+=N:A==="[object Int32Array]"?X+=L:A==="[object Uint32Array]"?X+=W:A==="[object Float32Array]"?X+=j:A==="[object Float64Array]"?X+=Q:x(new Error("Failed to get type for BinaryArray"))),x(X+Qe(B))}else if(A==="[object Blob]"){var F=new FileReader;F.onload=function(){var ie=Be+C.type+"~"+Qe(this.result);x(nt+T+ie)},F.readAsArrayBuffer(C)}else try{x(JSON.stringify(C))}catch(ie){console.error("Couldn't convert value into a JSON string: ",C),x(null,ie)}}function Je(C){if(C.substring(0,ze)!==nt)return JSON.parse(C);var x=C.substring(fe),A=C.substring(ze,fe),B;if(A===T&&pt.test(x)){var X=x.match(pt);B=X[1],x=x.substring(X[0].length)}var F=ke(x);switch(A){case O:return F;case T:return f([F],{type:B});case D:return new Int8Array(F);case z:return new Uint8Array(F);case H:return new Uint8ClampedArray(F);case K:return new Int16Array(F);case N:return new Uint16Array(F);case L:return new Int32Array(F);case W:return new Uint32Array(F);case j:return new Float32Array(F);case Q:return new Float64Array(F);default:throw new Error("Unkown type: "+A)}}var Ne={serialize:ct,deserialize:Je,stringToBuffer:ke,bufferToString:Qe};function ft(C,x,A,B){C.executeSql("CREATE TABLE IF NOT EXISTS "+x.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],A,B)}function Tt(C){var x=this,A={db:null};if(C)for(var B in C)A[B]=typeof C[B]!="string"?C[B].toString():C[B];var X=new c(function(F,ie){try{A.db=openDatabase(A.name,String(A.version),A.description,A.size)}catch(ce){return ie(ce)}A.db.transaction(function(ce){ft(ce,A,function(){x._dbInfo=A,F()},function(ge,ye){ie(ye)})},ie)});return A.serializer=Ne,X}function ir(C,x,A,B,X,F){C.executeSql(A,B,X,function(ie,ce){ce.code===ce.SYNTAX_ERR?ie.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[x.storeName],function(ge,ye){ye.rows.length?F(ge,ce):ft(ge,x,function(){ge.executeSql(A,B,X,F)},F)},F):F(ie,ce)},F)}function Tn(C,x){var A=this;C=v(C);var B=new c(function(X,F){A.ready().then(function(){var ie=A._dbInfo;ie.db.transaction(function(ce){ir(ce,ie,"SELECT * FROM "+ie.storeName+" WHERE key = ? LIMIT 1",[C],function(ge,ye){var we=ye.rows.length?ye.rows.item(0).value:null;we&&(we=ie.serializer.deserialize(we)),X(we)},function(ge,ye){F(ye)})})}).catch(F)});return h(B,x),B}function dn(C,x){var A=this,B=new c(function(X,F){A.ready().then(function(){var ie=A._dbInfo;ie.db.transaction(function(ce){ir(ce,ie,"SELECT * FROM "+ie.storeName,[],function(ge,ye){for(var we=ye.rows,Me=we.length,at=0;at<Me;at++){var yt=we.item(at),mt=yt.value;if(mt&&(mt=ie.serializer.deserialize(mt)),mt=C(mt,yt.key,at+1),mt!==void 0){X(mt);return}}X()},function(ge,ye){F(ye)})})}).catch(F)});return h(B,x),B}function Jt(C,x,A,B){var X=this;C=v(C);var F=new c(function(ie,ce){X.ready().then(function(){x===void 0&&(x=null);var ge=x,ye=X._dbInfo;ye.serializer.serialize(x,function(we,Me){Me?ce(Me):ye.db.transaction(function(at){ir(at,ye,"INSERT OR REPLACE INTO "+ye.storeName+" (key, value) VALUES (?, ?)",[C,we],function(){ie(ge)},function(yt,mt){ce(mt)})},function(at){if(at.code===at.QUOTA_ERR){if(B>0){ie(Jt.apply(X,[C,ge,A,B-1]));return}ce(at)}})})}).catch(ce)});return h(F,A),F}function Pr(C,x,A){return Jt.apply(this,[C,x,A,1])}function er(C,x){var A=this;C=v(C);var B=new c(function(X,F){A.ready().then(function(){var ie=A._dbInfo;ie.db.transaction(function(ce){ir(ce,ie,"DELETE FROM "+ie.storeName+" WHERE key = ?",[C],function(){X()},function(ge,ye){F(ye)})})}).catch(F)});return h(B,x),B}function _t(C){var x=this,A=new c(function(B,X){x.ready().then(function(){var F=x._dbInfo;F.db.transaction(function(ie){ir(ie,F,"DELETE FROM "+F.storeName,[],function(){B()},function(ce,ge){X(ge)})})}).catch(X)});return h(A,C),A}function St(C){var x=this,A=new c(function(B,X){x.ready().then(function(){var F=x._dbInfo;F.db.transaction(function(ie){ir(ie,F,"SELECT COUNT(key) as c FROM "+F.storeName,[],function(ce,ge){var ye=ge.rows.item(0).c;B(ye)},function(ce,ge){X(ge)})})}).catch(X)});return h(A,C),A}function Uf(C,x){var A=this,B=new c(function(X,F){A.ready().then(function(){var ie=A._dbInfo;ie.db.transaction(function(ce){ir(ce,ie,"SELECT key FROM "+ie.storeName+" WHERE id = ? LIMIT 1",[C+1],function(ge,ye){var we=ye.rows.length?ye.rows.item(0).key:null;X(we)},function(ge,ye){F(ye)})})}).catch(F)});return h(B,x),B}function zf(C){var x=this,A=new c(function(B,X){x.ready().then(function(){var F=x._dbInfo;F.db.transaction(function(ie){ir(ie,F,"SELECT key FROM "+F.storeName,[],function(ce,ge){for(var ye=[],we=0;we<ge.rows.length;we++)ye.push(ge.rows.item(we).key);B(ye)},function(ce,ge){X(ge)})})}).catch(X)});return h(A,C),A}function np(C){return new c(function(x,A){C.transaction(function(B){B.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(X,F){for(var ie=[],ce=0;ce<F.rows.length;ce++)ie.push(F.rows.item(ce).name);x({db:C,storeNames:ie})},function(X,F){A(F)})},function(B){A(B)})})}function xi(C,x){x=p.apply(this,arguments);var A=this.config();C=typeof C!="function"&&C||{},C.name||(C.name=C.name||A.name,C.storeName=C.storeName||A.storeName);var B=this,X;return C.name?X=new c(function(F){var ie;C.name===A.name?ie=B._dbInfo.db:ie=openDatabase(C.name,"","",0),C.storeName?F({db:ie,storeNames:[C.storeName]}):F(np(ie))}).then(function(F){return new c(function(ie,ce){F.db.transaction(function(ge){function ye(yt){return new c(function(mt,tr){ge.executeSql("DROP TABLE IF EXISTS "+yt,[],function(){mt()},function(Yt,Qr){tr(Qr)})})}for(var we=[],Me=0,at=F.storeNames.length;Me<at;Me++)we.push(ye(F.storeNames[Me]));c.all(we).then(function(){ie()}).catch(function(yt){ce(yt)})},function(ge){ce(ge)})})}):X=c.reject("Invalid arguments"),h(X,x),X}var vn={_driver:"webSQLStorage",_initStorage:Tt,_support:re(),iterate:dn,getItem:Tn,setItem:Pr,removeItem:er,clear:_t,length:St,key:Uf,keys:zf,dropInstance:xi};function Yf(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Dl(C,x){var A=C.name+"/";return C.storeName!==x.storeName&&(A+=C.storeName+"/"),A}function Gf(){var C="_localforage_support_test";try{return localStorage.setItem(C,!0),localStorage.removeItem(C),!1}catch{return!0}}function Kf(){return!Gf()||localStorage.length>0}function op(C){var x=this,A={};if(C)for(var B in C)A[B]=C[B];return A.keyPrefix=Dl(C,x._defaultConfig),Kf()?(x._dbInfo=A,A.serializer=Ne,c.resolve()):c.reject()}function $e(C){var x=this,A=x.ready().then(function(){for(var B=x._dbInfo.keyPrefix,X=localStorage.length-1;X>=0;X--){var F=localStorage.key(X);F.indexOf(B)===0&&localStorage.removeItem(F)}});return h(A,C),A}function G(C,x){var A=this;C=v(C);var B=A.ready().then(function(){var X=A._dbInfo,F=localStorage.getItem(X.keyPrefix+C);return F&&(F=X.serializer.deserialize(F)),F});return h(B,x),B}function pe(C,x){var A=this,B=A.ready().then(function(){for(var X=A._dbInfo,F=X.keyPrefix,ie=F.length,ce=localStorage.length,ge=1,ye=0;ye<ce;ye++){var we=localStorage.key(ye);if(we.indexOf(F)===0){var Me=localStorage.getItem(we);if(Me&&(Me=X.serializer.deserialize(Me)),Me=C(Me,we.substring(ie),ge++),Me!==void 0)return Me}}});return h(B,x),B}function Ee(C,x){var A=this,B=A.ready().then(function(){var X=A._dbInfo,F;try{F=localStorage.key(C)}catch{F=null}return F&&(F=F.substring(X.keyPrefix.length)),F});return h(B,x),B}function gt(C){var x=this,A=x.ready().then(function(){for(var B=x._dbInfo,X=localStorage.length,F=[],ie=0;ie<X;ie++){var ce=localStorage.key(ie);ce.indexOf(B.keyPrefix)===0&&F.push(ce.substring(B.keyPrefix.length))}return F});return h(A,C),A}function vr(C){var x=this,A=x.keys().then(function(B){return B.length});return h(A,C),A}function pr(C,x){var A=this;C=v(C);var B=A.ready().then(function(){var X=A._dbInfo;localStorage.removeItem(X.keyPrefix+C)});return h(B,x),B}function ar(C,x,A){var B=this;C=v(C);var X=B.ready().then(function(){x===void 0&&(x=null);var F=x;return new c(function(ie,ce){var ge=B._dbInfo;ge.serializer.serialize(x,function(ye,we){if(we)ce(we);else try{localStorage.setItem(ge.keyPrefix+C,ye),ie(F)}catch(Me){(Me.name==="QuotaExceededError"||Me.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ce(Me),ce(Me)}})})});return h(X,A),X}function Qa(C,x){if(x=p.apply(this,arguments),C=typeof C!="function"&&C||{},!C.name){var A=this.config();C.name=C.name||A.name,C.storeName=C.storeName||A.storeName}var B=this,X;return C.name?X=new c(function(F){C.storeName?F(Dl(C,B._defaultConfig)):F(C.name+"/")}).then(function(F){for(var ie=localStorage.length-1;ie>=0;ie--){var ce=localStorage.key(ie);ce.indexOf(F)===0&&localStorage.removeItem(ce)}}):X=c.reject("Invalid arguments"),h(X,x),X}var wr={_driver:"localStorageWrapper",_initStorage:op,_support:Yf(),iterate:pe,getItem:G,setItem:ar,removeItem:pr,clear:$e,length:vr,key:Ee,keys:gt,dropInstance:Qa},Xf=function(x,A){return x===A||typeof x=="number"&&typeof A=="number"&&isNaN(x)&&isNaN(A)},ip=function(x,A){for(var B=x.length,X=0;X<B;){if(Xf(x[X],A))return!0;X++}return!1},ap=Array.isArray||function(C){return Object.prototype.toString.call(C)==="[object Array]"},xl={},WE={},Za={INDEXEDDB:Fe,WEBSQL:vn,LOCALSTORAGE:wr},GB=[Za.INDEXEDDB._driver,Za.WEBSQL._driver,Za.LOCALSTORAGE._driver],qf=["dropInstance"],sp=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(qf),KB={description:"",driver:GB.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function XB(C,x){C[x]=function(){var A=arguments;return C.ready().then(function(){return C[x].apply(C,A)})}}function lp(){for(var C=1;C<arguments.length;C++){var x=arguments[C];if(x)for(var A in x)x.hasOwnProperty(A)&&(ap(x[A])?arguments[0][A]=x[A].slice():arguments[0][A]=x[A])}return arguments[0]}var qB=function(){function C(x){a(this,C);for(var A in Za)if(Za.hasOwnProperty(A)){var B=Za[A],X=B._driver;this[A]=X,xl[X]||this.defineDriver(B)}this._defaultConfig=lp({},KB),this._config=lp({},this._defaultConfig,x),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return C.prototype.config=function(A){if((typeof A=="undefined"?"undefined":i(A))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var B in A){if(B==="storeName"&&(A[B]=A[B].replace(/\W/g,"_")),B==="version"&&typeof A[B]!="number")return new Error("Database version must be a number.");this._config[B]=A[B]}return"driver"in A&&A.driver?this.setDriver(this._config.driver):!0}else return typeof A=="string"?this._config[A]:this._config},C.prototype.defineDriver=function(A,B,X){var F=new c(function(ie,ce){try{var ge=A._driver,ye=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!A._driver){ce(ye);return}for(var we=sp.concat("_initStorage"),Me=0,at=we.length;Me<at;Me++){var yt=we[Me],mt=!ip(qf,yt);if((mt||A[yt])&&typeof A[yt]!="function"){ce(ye);return}}var tr=function(){for(var Nl=function(JB){return function(){var eV=new Error("Method "+JB+" is not implemented by the current driver"),UE=c.reject(eV);return h(UE,arguments[arguments.length-1]),UE}},up=0,ZB=qf.length;up<ZB;up++){var fp=qf[up];A[fp]||(A[fp]=Nl(fp))}};tr();var Yt=function(Nl){xl[ge]&&console.info("Redefining LocalForage driver: "+ge),xl[ge]=A,WE[ge]=Nl,ie()};"_support"in A?A._support&&typeof A._support=="function"?A._support().then(Yt,ce):Yt(!!A._support):Yt(!0)}catch(Qr){ce(Qr)}});return d(F,B,X),F},C.prototype.driver=function(){return this._driver||null},C.prototype.getDriver=function(A,B,X){var F=xl[A]?c.resolve(xl[A]):c.reject(new Error("Driver not found."));return d(F,B,X),F},C.prototype.getSerializer=function(A){var B=c.resolve(Ne);return d(B,A),B},C.prototype.ready=function(A){var B=this,X=B._driverSet.then(function(){return B._ready===null&&(B._ready=B._initDriver()),B._ready});return d(X,A,A),X},C.prototype.setDriver=function(A,B,X){var F=this;ap(A)||(A=[A]);var ie=this._getSupportedDrivers(A);function ce(){F._config.driver=F.driver()}function ge(Me){return F._extend(Me),ce(),F._ready=F._initStorage(F._config),F._ready}function ye(Me){return function(){var at=0;function yt(){for(;at<Me.length;){var mt=Me[at];return at++,F._dbInfo=null,F._ready=null,F.getDriver(mt).then(ge).catch(yt)}ce();var tr=new Error("No available storage method found.");return F._driverSet=c.reject(tr),F._driverSet}return yt()}}var we=this._driverSet!==null?this._driverSet.catch(function(){return c.resolve()}):c.resolve();return this._driverSet=we.then(function(){var Me=ie[0];return F._dbInfo=null,F._ready=null,F.getDriver(Me).then(function(at){F._driver=at._driver,ce(),F._wrapLibraryMethodsWithReady(),F._initDriver=ye(ie)})}).catch(function(){ce();var Me=new Error("No available storage method found.");return F._driverSet=c.reject(Me),F._driverSet}),d(this._driverSet,B,X),this._driverSet},C.prototype.supports=function(A){return!!WE[A]},C.prototype._extend=function(A){lp(this,A)},C.prototype._getSupportedDrivers=function(A){for(var B=[],X=0,F=A.length;X<F;X++){var ie=A[X];this.supports(ie)&&B.push(ie)}return B},C.prototype._wrapLibraryMethodsWithReady=function(){for(var A=0,B=sp.length;A<B;A++)XB(this,sp[A])},C.prototype.createInstance=function(A){return new C(A)},C}(),QB=new qB;n.exports=QB},{"3":3}]},{},[4])(4)})})(KMe);export{Xe as H,KMe as l};
